{"version":3,"file":"rpa-web-ui.umd.js","sources":["../node_modules/vue-resize/dist/vue-resize.esm.js","../node_modules/vue-observe-visibility/dist/vue-observe-visibility.esm.js","../node_modules/vue-virtual-scroller/node_modules/mitt/dist/mitt.es.js","../node_modules/vue-virtual-scroller/dist/vue-virtual-scroller.esm.js","../src/composables/useFiltering.ts","../src/composables/useSearch.ts","../src/stores/dataGridStore.ts","../node_modules/@vueuse/shared/index.mjs","../src/composables/useValidation.ts","../src/composables/useCopyPaste.ts","../src/composables/useImportExport.ts","../src/composables/useAutoRowHeight.ts","../src/composables/useShortcuts.ts","../src/composables/useLogger.ts","../src/services/gridApi.ts","../src/composables/useTheme.ts","../node_modules/@imengyu/vue3-context-menu/lib/vue3-context-menu.es.js","../src/components/DataGrid/DataGridHeader.vue","../src/components/DataGrid/DataGridCell.vue","../src/components/DataGrid/SpecialColumnCell.vue","../src/components/DataGrid/DataGridRow.vue","../src/components/DataGrid/PaginationControl.vue","../src/components/DataGrid/FilterFlyout.vue","../src/components/DataGrid/DataGrid.vue","../src/components/ListBox/ListBox.vue","../src/composables/useSorting.ts","../src/composables/useSelection.ts","../node_modules/@microsoft/signalr/dist/esm/Errors.js","../node_modules/@microsoft/signalr/dist/esm/HttpClient.js","../node_modules/@microsoft/signalr/dist/esm/ILogger.js","../node_modules/@microsoft/signalr/dist/esm/Loggers.js","../node_modules/@microsoft/signalr/dist/esm/Utils.js","../node_modules/@microsoft/signalr/dist/esm/FetchHttpClient.js","../node_modules/@microsoft/signalr/dist/esm/XhrHttpClient.js","../node_modules/@microsoft/signalr/dist/esm/DefaultHttpClient.js","../node_modules/@microsoft/signalr/dist/esm/TextMessageFormat.js","../node_modules/@microsoft/signalr/dist/esm/HandshakeProtocol.js","../node_modules/@microsoft/signalr/dist/esm/IHubProtocol.js","../node_modules/@microsoft/signalr/dist/esm/Subject.js","../node_modules/@microsoft/signalr/dist/esm/MessageBuffer.js","../node_modules/@microsoft/signalr/dist/esm/HubConnection.js","../node_modules/@microsoft/signalr/dist/esm/DefaultReconnectPolicy.js","../node_modules/@microsoft/signalr/dist/esm/HeaderNames.js","../node_modules/@microsoft/signalr/dist/esm/AccessTokenHttpClient.js","../node_modules/@microsoft/signalr/dist/esm/ITransport.js","../node_modules/@microsoft/signalr/dist/esm/AbortController.js","../node_modules/@microsoft/signalr/dist/esm/LongPollingTransport.js","../node_modules/@microsoft/signalr/dist/esm/ServerSentEventsTransport.js","../node_modules/@microsoft/signalr/dist/esm/WebSocketTransport.js","../node_modules/@microsoft/signalr/dist/esm/HttpConnection.js","../node_modules/@microsoft/signalr/dist/esm/JsonHubProtocol.js","../node_modules/@microsoft/signalr/dist/esm/HubConnectionBuilder.js","../src/composables/useSignalR.ts","../src/plugin.ts","../src/index.ts"],"sourcesContent":["import { nextTick, pushScopeId, popScopeId, openBlock, createBlock, withScopeId } from 'vue';\n\nfunction getInternetExplorerVersion() {\n  var ua = window.navigator.userAgent;\n  var msie = ua.indexOf('MSIE ');\n\n  if (msie > 0) {\n    // IE 10 or older => return version number\n    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n  }\n\n  var trident = ua.indexOf('Trident/');\n\n  if (trident > 0) {\n    // IE 11 => return version number\n    var rv = ua.indexOf('rv:');\n    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n  }\n\n  var edge = ua.indexOf('Edge/');\n\n  if (edge > 0) {\n    // Edge (IE 12+) => return version number\n    return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n  } // other browser\n\n\n  return -1;\n}\n\nlet isIE;\n\nfunction initCompat () {\n  if (!initCompat.init) {\n    initCompat.init = true;\n    isIE = getInternetExplorerVersion() !== -1;\n  }\n}\n\nvar script = {\n  name: 'ResizeObserver',\n\n  props: {\n    emitOnMount: {\n      type: Boolean,\n      default: false,\n    },\n\n    ignoreWidth: {\n      type: Boolean,\n      default: false,\n    },\n\n    ignoreHeight: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  emits: [\n    'notify',\n  ],\n\n  mounted () {\n    initCompat();\n    nextTick(() => {\n      this._w = this.$el.offsetWidth;\n      this._h = this.$el.offsetHeight;\n      if (this.emitOnMount) {\n        this.emitSize();\n      }\n    });\n    const object = document.createElement('object');\n    this._resizeObject = object;\n    object.setAttribute('aria-hidden', 'true');\n    object.setAttribute('tabindex', -1);\n    object.onload = this.addResizeHandlers;\n    object.type = 'text/html';\n    if (isIE) {\n      this.$el.appendChild(object);\n    }\n    object.data = 'about:blank';\n    if (!isIE) {\n      this.$el.appendChild(object);\n    }\n  },\n\n  beforeUnmount () {\n    this.removeResizeHandlers();\n  },\n\n  methods: {\n    compareAndNotify () {\n      if ((!this.ignoreWidth && this._w !== this.$el.offsetWidth) || (!this.ignoreHeight && this._h !== this.$el.offsetHeight)) {\n        this._w = this.$el.offsetWidth;\n        this._h = this.$el.offsetHeight;\n        this.emitSize();\n      }\n    },\n\n    emitSize () {\n      this.$emit('notify', {\n        width: this._w,\n        height: this._h,\n      });\n    },\n\n    addResizeHandlers () {\n      this._resizeObject.contentDocument.defaultView.addEventListener('resize', this.compareAndNotify);\n      this.compareAndNotify();\n    },\n\n    removeResizeHandlers () {\n      if (this._resizeObject && this._resizeObject.onload) {\n        if (!isIE && this._resizeObject.contentDocument) {\n          this._resizeObject.contentDocument.defaultView.removeEventListener('resize', this.compareAndNotify);\n        }\n        this.$el.removeChild(this._resizeObject);\n        this._resizeObject.onload = null;\n        this._resizeObject = null;\n      }\n    },\n  },\n};\n\nconst _withId = /*#__PURE__*/withScopeId(\"data-v-b329ee4c\");\n\npushScopeId(\"data-v-b329ee4c\");\nconst _hoisted_1 = {\n  class: \"resize-observer\",\n  tabindex: \"-1\"\n};\npopScopeId();\n\nconst render = /*#__PURE__*/_withId((_ctx, _cache, $props, $setup, $data, $options) => {\n  return (openBlock(), createBlock(\"div\", _hoisted_1))\n});\n\nscript.render = render;\nscript.__scopeId = \"data-v-b329ee4c\";\nscript.__file = \"src/components/ResizeObserver.vue\";\n\nfunction install(app) {\n  // eslint-disable-next-line vue/component-definition-name-casing\n  app.component('resize-observer', script);\n  app.component('ResizeObserver', script);\n}\n\nvar plugin = {\n  // eslint-disable-next-line no-undef\n  version: \"2.0.0-alpha.1\",\n  install: install\n};\n\nexport default plugin;\nexport { script as ResizeObserver, install };\n//# sourceMappingURL=vue-resize.esm.js.map\n","import { nextTick } from 'vue';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction processOptions(value) {\n  var options;\n\n  if (typeof value === 'function') {\n    // Simple options (callback-only)\n    options = {\n      callback: value\n    };\n  } else {\n    // Options object\n    options = value;\n  }\n\n  return options;\n}\nfunction throttle(callback, delay) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var timeout;\n  var lastState;\n  var currentArgs;\n\n  var throttled = function throttled(state) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    currentArgs = args;\n    if (timeout && state === lastState) return;\n    var leading = options.leading;\n\n    if (typeof leading === 'function') {\n      leading = leading(state, lastState);\n    }\n\n    if ((!timeout || state !== lastState) && leading) {\n      callback.apply(void 0, [state].concat(_toConsumableArray(currentArgs)));\n    }\n\n    lastState = state;\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      callback.apply(void 0, [state].concat(_toConsumableArray(currentArgs)));\n      timeout = 0;\n    }, delay);\n  };\n\n  throttled._clear = function () {\n    clearTimeout(timeout);\n    timeout = null;\n  };\n\n  return throttled;\n}\nfunction deepEqual(val1, val2) {\n  if (val1 === val2) return true;\n\n  if (_typeof(val1) === 'object') {\n    for (var key in val1) {\n      if (!deepEqual(val1[key], val2[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\n\nvar VisibilityState = /*#__PURE__*/function () {\n  function VisibilityState(el, options, vnode) {\n    _classCallCheck(this, VisibilityState);\n\n    this.el = el;\n    this.observer = null;\n    this.frozen = false;\n    this.createObserver(options, vnode);\n  }\n\n  _createClass(VisibilityState, [{\n    key: \"createObserver\",\n    value: function createObserver(options, vnode) {\n      var _this = this;\n\n      if (this.observer) {\n        this.destroyObserver();\n      }\n\n      if (this.frozen) return;\n      this.options = processOptions(options);\n\n      this.callback = function (result, entry) {\n        _this.options.callback(result, entry);\n\n        if (result && _this.options.once) {\n          _this.frozen = true;\n\n          _this.destroyObserver();\n        }\n      }; // Throttle\n\n\n      if (this.callback && this.options.throttle) {\n        var _ref = this.options.throttleOptions || {},\n            _leading = _ref.leading;\n\n        this.callback = throttle(this.callback, this.options.throttle, {\n          leading: function leading(state) {\n            return _leading === 'both' || _leading === 'visible' && state || _leading === 'hidden' && !state;\n          }\n        });\n      }\n\n      this.oldResult = undefined;\n      this.observer = new IntersectionObserver(function (entries) {\n        var entry = entries[0];\n\n        if (entries.length > 1) {\n          var intersectingEntry = entries.find(function (e) {\n            return e.isIntersecting;\n          });\n\n          if (intersectingEntry) {\n            entry = intersectingEntry;\n          }\n        }\n\n        if (_this.callback) {\n          // Use isIntersecting if possible because browsers can report isIntersecting as true, but intersectionRatio as 0, when something very slowly enters the viewport.\n          var result = entry.isIntersecting && entry.intersectionRatio >= _this.threshold;\n          if (result === _this.oldResult) return;\n          _this.oldResult = result;\n\n          _this.callback(result, entry);\n        }\n      }, this.options.intersection); // Wait for the element to be in document\n\n      nextTick(function () {\n        if (_this.observer) {\n          _this.observer.observe(_this.el);\n        }\n      });\n    }\n  }, {\n    key: \"destroyObserver\",\n    value: function destroyObserver() {\n      if (this.observer) {\n        this.observer.disconnect();\n        this.observer = null;\n      } // Cancel throttled call\n\n\n      if (this.callback && this.callback._clear) {\n        this.callback._clear();\n\n        this.callback = null;\n      }\n    }\n  }, {\n    key: \"threshold\",\n    get: function get() {\n      return this.options.intersection && typeof this.options.intersection.threshold === 'number' ? this.options.intersection.threshold : 0;\n    }\n  }]);\n\n  return VisibilityState;\n}();\n\nfunction beforeMount(el, _ref2, vnode) {\n  var value = _ref2.value;\n  if (!value) return;\n\n  if (typeof IntersectionObserver === 'undefined') {\n    console.warn('[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill');\n  } else {\n    var state = new VisibilityState(el, value, vnode);\n    el._vue_visibilityState = state;\n  }\n}\n\nfunction updated(el, _ref3, vnode) {\n  var value = _ref3.value,\n      oldValue = _ref3.oldValue;\n  if (deepEqual(value, oldValue)) return;\n  var state = el._vue_visibilityState;\n\n  if (!value) {\n    unmounted(el);\n    return;\n  }\n\n  if (state) {\n    state.createObserver(value, vnode);\n  } else {\n    beforeMount(el, {\n      value: value\n    }, vnode);\n  }\n}\n\nfunction unmounted(el) {\n  var state = el._vue_visibilityState;\n\n  if (state) {\n    state.destroyObserver();\n    delete el._vue_visibilityState;\n  }\n}\n\nvar ObserveVisibility = {\n  beforeMount: beforeMount,\n  updated: updated,\n  unmounted: unmounted\n};\n\nfunction install(app) {\n  app.directive('observe-visibility', ObserveVisibility);\n  /* -- Add more components here -- */\n}\n/* -- Plugin definition & Auto-install -- */\n\n/* You shouldn't have to modify the code below */\n// Plugin\n\nvar plugin = {\n  // eslint-disable-next-line no-undef\n  version: \"2.0.0-alpha.1\",\n  install: install\n};\n\nexport default plugin;\nexport { ObserveVisibility, install };\n","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i&&i.push(e)||n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&i.splice(i.indexOf(e)>>>0,1)},emit:function(t,e){(n.get(t)||[]).slice().map(function(n){n(e)}),(n.get(\"*\")||[]).slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.es.js.map\n","import { markRaw, shallowReactive, resolveComponent, resolveDirective, withDirectives, openBlock, createElementBlock, normalizeClass, renderSlot, createCommentVNode, createBlock, resolveDynamicComponent, normalizeStyle, withCtx, Fragment, renderList, mergeProps, toHandlers, createVNode, normalizeProps, guardReactiveProps, h, reactive } from 'vue';\nimport { ResizeObserver as ResizeObserver$1 } from 'vue-resize';\nimport { ObserveVisibility } from 'vue-observe-visibility';\nimport mitt from 'mitt';\n\nvar config = {\n  itemsLimit: 1000\n};\n\n// Fork of https://github.com/olahol/scrollparent.js to be able to build with Rollup\n\nvar regex = /(auto|scroll)/;\nfunction parents(node, ps) {\n  if (node.parentNode === null) {\n    return ps;\n  }\n  return parents(node.parentNode, ps.concat([node]));\n}\nvar style = function style(node, prop) {\n  return getComputedStyle(node, null).getPropertyValue(prop);\n};\nvar overflow = function overflow(node) {\n  return style(node, 'overflow') + style(node, 'overflow-y') + style(node, 'overflow-x');\n};\nvar scroll = function scroll(node) {\n  return regex.test(overflow(node));\n};\nfunction getScrollParent(node) {\n  if (!(node instanceof HTMLElement || node instanceof SVGElement)) {\n    return;\n  }\n  var ps = parents(node.parentNode, []);\n  for (var i = 0; i < ps.length; i += 1) {\n    if (scroll(ps[i])) {\n      return ps[i];\n    }\n  }\n  return document.scrollingElement || document.documentElement;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nvar props = {\n  items: {\n    type: Array,\n    required: true\n  },\n  keyField: {\n    type: String,\n    default: 'id'\n  },\n  direction: {\n    type: String,\n    default: 'vertical',\n    validator: function validator(value) {\n      return ['vertical', 'horizontal'].includes(value);\n    }\n  },\n  listTag: {\n    type: String,\n    default: 'div'\n  },\n  itemTag: {\n    type: String,\n    default: 'div'\n  }\n};\nfunction simpleArray() {\n  return this.items.length && _typeof(this.items[0]) !== 'object';\n}\n\nvar supportsPassive = false;\nif (typeof window !== 'undefined') {\n  supportsPassive = false;\n  try {\n    var opts = Object.defineProperty({}, 'passive', {\n      get: function get() {\n        supportsPassive = true;\n      }\n    });\n    window.addEventListener('test', null, opts);\n  } catch (e) {}\n}\n\nlet uid = 0;\n\nvar script$2 = {\n  name: 'RecycleScroller',\n\n  components: {\n    ResizeObserver: ResizeObserver$1,\n  },\n\n  directives: {\n    ObserveVisibility,\n  },\n\n  props: {\n    ...props,\n\n    itemSize: {\n      type: Number,\n      default: null,\n    },\n\n    gridItems: {\n      type: Number,\n      default: undefined,\n    },\n\n    itemSecondarySize: {\n      type: Number,\n      default: undefined,\n    },\n\n    minItemSize: {\n      type: [Number, String],\n      default: null,\n    },\n\n    sizeField: {\n      type: String,\n      default: 'size',\n    },\n\n    typeField: {\n      type: String,\n      default: 'type',\n    },\n\n    buffer: {\n      type: Number,\n      default: 200,\n    },\n\n    pageMode: {\n      type: Boolean,\n      default: false,\n    },\n\n    prerender: {\n      type: Number,\n      default: 0,\n    },\n\n    emitUpdate: {\n      type: Boolean,\n      default: false,\n    },\n\n    updateInterval: {\n      type: Number,\n      default: 0,\n    },\n\n    skipHover: {\n      type: Boolean,\n      default: false,\n    },\n\n    listTag: {\n      type: String,\n      default: 'div',\n    },\n\n    itemTag: {\n      type: String,\n      default: 'div',\n    },\n\n    listClass: {\n      type: [String, Object, Array],\n      default: '',\n    },\n\n    itemClass: {\n      type: [String, Object, Array],\n      default: '',\n    },\n  },\n\n  emits: [\n    'resize',\n    'visible',\n    'hidden',\n    'update',\n    'scroll-start',\n    'scroll-end',\n  ],\n\n  data () {\n    return {\n      pool: [],\n      totalSize: 0,\n      ready: false,\n      hoverKey: null,\n    }\n  },\n\n  computed: {\n    sizes () {\n      if (this.itemSize === null) {\n        const sizes = {\n          '-1': { accumulator: 0 },\n        };\n        const items = this.items;\n        const field = this.sizeField;\n        const minItemSize = this.minItemSize;\n        let computedMinSize = 10000;\n        let accumulator = 0;\n        let current;\n        for (let i = 0, l = items.length; i < l; i++) {\n          current = items[i][field] || minItemSize;\n          if (current < computedMinSize) {\n            computedMinSize = current;\n          }\n          accumulator += current;\n          sizes[i] = { accumulator, size: current };\n        }\n        // eslint-disable-next-line\n        this.$_computedMinItemSize = computedMinSize;\n        return sizes\n      }\n      return []\n    },\n\n    simpleArray,\n\n    itemIndexByKey () {\n      const { keyField, items } = this;\n      const result = {};\n      for (let i = 0, l = items.length; i < l; i++) {\n        result[items[i][keyField]] = i;\n      }\n      return result\n    },\n  },\n\n  watch: {\n    items () {\n      this.updateVisibleItems(true);\n    },\n\n    pageMode () {\n      this.applyPageMode();\n      this.updateVisibleItems(false);\n    },\n\n    sizes: {\n      handler () {\n        this.updateVisibleItems(false);\n      },\n      deep: true,\n    },\n\n    gridItems () {\n      this.updateVisibleItems(true);\n    },\n\n    itemSecondarySize () {\n      this.updateVisibleItems(true);\n    },\n  },\n\n  created () {\n    this.$_startIndex = 0;\n    this.$_endIndex = 0;\n    this.$_views = new Map();\n    this.$_unusedViews = new Map();\n    this.$_scrollDirty = false;\n    this.$_lastUpdateScrollPosition = 0;\n\n    // In SSR mode, we also prerender the same number of item for the first render\n    // to avoir mismatch between server and client templates\n    if (this.prerender) {\n      this.$_prerender = true;\n      this.updateVisibleItems(false);\n    }\n\n    if (this.gridItems && !this.itemSize) {\n      console.error('[vue-recycle-scroller] You must provide an itemSize when using gridItems');\n    }\n  },\n\n  mounted () {\n    this.applyPageMode();\n    this.$nextTick(() => {\n      // In SSR mode, render the real number of visible items\n      this.$_prerender = false;\n      this.updateVisibleItems(true);\n      this.ready = true;\n    });\n  },\n\n  activated () {\n    const lastPosition = this.$_lastUpdateScrollPosition;\n    if (typeof lastPosition === 'number') {\n      this.$nextTick(() => {\n        this.scrollToPosition(lastPosition);\n      });\n    }\n  },\n\n  beforeUnmount () {\n    this.removeListeners();\n  },\n\n  methods: {\n    addView (pool, index, item, key, type) {\n      const nr = markRaw({\n        id: uid++,\n        index,\n        used: true,\n        key,\n        type,\n      });\n      const view = shallowReactive({\n        item,\n        position: 0,\n        nr,\n      });\n      pool.push(view);\n      return view\n    },\n\n    unuseView (view, fake = false) {\n      const unusedViews = this.$_unusedViews;\n      const type = view.nr.type;\n      let unusedPool = unusedViews.get(type);\n      if (!unusedPool) {\n        unusedPool = [];\n        unusedViews.set(type, unusedPool);\n      }\n      unusedPool.push(view);\n      if (!fake) {\n        view.nr.used = false;\n        view.position = -9999;\n      }\n    },\n\n    handleResize () {\n      this.$emit('resize');\n      if (this.ready) this.updateVisibleItems(false);\n    },\n\n    handleScroll (event) {\n      if (!this.$_scrollDirty) {\n        this.$_scrollDirty = true;\n        if (this.$_updateTimeout) return\n\n        const requestUpdate = () => requestAnimationFrame(() => {\n          this.$_scrollDirty = false;\n          const { continuous } = this.updateVisibleItems(false, true);\n\n          // It seems sometimes chrome doesn't fire scroll event :/\n          // When non continous scrolling is ending, we force a refresh\n          if (!continuous) {\n            clearTimeout(this.$_refreshTimout);\n            this.$_refreshTimout = setTimeout(this.handleScroll, this.updateInterval + 100);\n          }\n        });\n\n        requestUpdate();\n\n        // Schedule the next update with throttling\n        if (this.updateInterval) {\n          this.$_updateTimeout = setTimeout(() => {\n            this.$_updateTimeout = 0;\n            if (this.$_scrollDirty) requestUpdate();\n          }, this.updateInterval);\n        }\n      }\n    },\n\n    handleVisibilityChange (isVisible, entry) {\n      if (this.ready) {\n        if (isVisible || entry.boundingClientRect.width !== 0 || entry.boundingClientRect.height !== 0) {\n          this.$emit('visible');\n          requestAnimationFrame(() => {\n            this.updateVisibleItems(false);\n          });\n        } else {\n          this.$emit('hidden');\n        }\n      }\n    },\n\n    updateVisibleItems (checkItem, checkPositionDiff = false) {\n      const itemSize = this.itemSize;\n      const gridItems = this.gridItems || 1;\n      const itemSecondarySize = this.itemSecondarySize || itemSize;\n      const minItemSize = this.$_computedMinItemSize;\n      const typeField = this.typeField;\n      const keyField = this.simpleArray ? null : this.keyField;\n      const items = this.items;\n      const count = items.length;\n      const sizes = this.sizes;\n      const views = this.$_views;\n      const unusedViews = this.$_unusedViews;\n      const pool = this.pool;\n      const itemIndexByKey = this.itemIndexByKey;\n      let startIndex, endIndex;\n      let totalSize;\n      let visibleStartIndex, visibleEndIndex;\n\n      if (!count) {\n        startIndex = endIndex = visibleStartIndex = visibleEndIndex = totalSize = 0;\n      } else if (this.$_prerender) {\n        startIndex = visibleStartIndex = 0;\n        endIndex = visibleEndIndex = Math.min(this.prerender, items.length);\n        totalSize = null;\n      } else {\n        const scroll = this.getScroll();\n\n        // Skip update if use hasn't scrolled enough\n        if (checkPositionDiff) {\n          let positionDiff = scroll.start - this.$_lastUpdateScrollPosition;\n          if (positionDiff < 0) positionDiff = -positionDiff;\n          if ((itemSize === null && positionDiff < minItemSize) || positionDiff < itemSize) {\n            return {\n              continuous: true,\n            }\n          }\n        }\n        this.$_lastUpdateScrollPosition = scroll.start;\n\n        const buffer = this.buffer;\n        scroll.start -= buffer;\n        scroll.end += buffer;\n\n        // account for leading slot\n        let beforeSize = 0;\n        if (this.$refs.before) {\n          beforeSize = this.$refs.before.scrollHeight;\n          scroll.start -= beforeSize;\n        }\n\n        // account for trailing slot\n        if (this.$refs.after) {\n          const afterSize = this.$refs.after.scrollHeight;\n          scroll.end += afterSize;\n        }\n\n        // Variable size mode\n        if (itemSize === null) {\n          let h;\n          let a = 0;\n          let b = count - 1;\n          let i = ~~(count / 2);\n          let oldI;\n\n          // Searching for startIndex\n          do {\n            oldI = i;\n            h = sizes[i].accumulator;\n            if (h < scroll.start) {\n              a = i;\n            } else if (i < count - 1 && sizes[i + 1].accumulator > scroll.start) {\n              b = i;\n            }\n            i = ~~((a + b) / 2);\n          } while (i !== oldI)\n          i < 0 && (i = 0);\n          startIndex = i;\n\n          // For container style\n          totalSize = sizes[count - 1].accumulator;\n\n          // Searching for endIndex\n          for (endIndex = i; endIndex < count && sizes[endIndex].accumulator < scroll.end; endIndex++);\n          if (endIndex === -1) {\n            endIndex = items.length - 1;\n          } else {\n            endIndex++;\n            // Bounds\n            endIndex > count && (endIndex = count);\n          }\n\n          // search visible startIndex\n          for (visibleStartIndex = startIndex; visibleStartIndex < count && (beforeSize + sizes[visibleStartIndex].accumulator) < scroll.start; visibleStartIndex++);\n\n          // search visible endIndex\n          for (visibleEndIndex = visibleStartIndex; visibleEndIndex < count && (beforeSize + sizes[visibleEndIndex].accumulator) < scroll.end; visibleEndIndex++);\n        } else {\n          // Fixed size mode\n          startIndex = ~~(scroll.start / itemSize * gridItems);\n          const remainer = startIndex % gridItems;\n          startIndex -= remainer;\n          endIndex = Math.ceil(scroll.end / itemSize * gridItems);\n          visibleStartIndex = Math.max(0, Math.floor((scroll.start - beforeSize) / itemSize * gridItems));\n          visibleEndIndex = Math.floor((scroll.end - beforeSize) / itemSize * gridItems);\n\n          // Bounds\n          startIndex < 0 && (startIndex = 0);\n          endIndex > count && (endIndex = count);\n          visibleStartIndex < 0 && (visibleStartIndex = 0);\n          visibleEndIndex > count && (visibleEndIndex = count);\n\n          totalSize = Math.ceil(count / gridItems) * itemSize;\n        }\n      }\n\n      if (endIndex - startIndex > config.itemsLimit) {\n        this.itemsLimitError();\n      }\n\n      this.totalSize = totalSize;\n\n      let view;\n\n      const continuous = startIndex <= this.$_endIndex && endIndex >= this.$_startIndex;\n\n      // Unuse views that are no longer visible\n      if (continuous) {\n        for (let i = 0, l = pool.length; i < l; i++) {\n          view = pool[i];\n          if (view.nr.used) {\n            // Update view item index\n            if (checkItem) {\n              view.nr.index = itemIndexByKey[view.item[keyField]];\n            }\n\n            // Check if index is still in visible range\n            if (\n              view.nr.index == null ||\n              view.nr.index < startIndex ||\n              view.nr.index >= endIndex\n            ) {\n              this.unuseView(view);\n            }\n          }\n        }\n      }\n\n      const unusedIndex = continuous ? null : new Map();\n\n      let item, type;\n      let v;\n      for (let i = startIndex; i < endIndex; i++) {\n        item = items[i];\n        const key = keyField ? item[keyField] : item;\n        if (key == null) {\n          throw new Error(`Key is ${key} on item (keyField is '${keyField}')`)\n        }\n        view = views.get(key);\n\n        if (!itemSize && !sizes[i].size) {\n          if (view) this.unuseView(view);\n          continue\n        }\n\n        type = item[typeField];\n\n        let unusedPool = unusedViews.get(type);\n        let newlyUsedView = false;\n\n        // No view assigned to item\n        if (!view) {\n          if (continuous) {\n            // Reuse existing view\n            if (unusedPool && unusedPool.length) {\n              view = unusedPool.pop();\n            } else {\n              view = this.addView(pool, i, item, key, type);\n            }\n          } else {\n            // Use existing view\n            // We don't care if they are already used\n            // because we are not in continous scrolling\n            v = unusedIndex.get(type) || 0;\n\n            if (!unusedPool || v >= unusedPool.length) {\n              view = this.addView(pool, i, item, key, type);\n              this.unuseView(view, true);\n              unusedPool = unusedViews.get(type);\n            }\n\n            view = unusedPool[v];\n            unusedIndex.set(type, v + 1);\n          }\n\n          // Assign view to item\n          views.delete(view.nr.key);\n          view.nr.used = true;\n          view.nr.index = i;\n          view.nr.key = key;\n          view.nr.type = type;\n          views.set(key, view);\n\n          newlyUsedView = true;\n        } else {\n          // View already assigned to item\n          if (!view.nr.used) {\n            view.nr.used = true;\n            newlyUsedView = true;\n            if (unusedPool) {\n              const index = unusedPool.indexOf(view);\n              if (index !== -1) unusedPool.splice(index, 1);\n            }\n          }\n        }\n\n        // Always set item in case it's a new object with the same key\n        view.item = item;\n\n        if (newlyUsedView) {\n          if (i === items.length - 1) this.$emit('scroll-end');\n          if (i === 0) this.$emit('scroll-start');\n        }\n\n        // Update position\n        if (itemSize === null) {\n          view.position = sizes[i - 1].accumulator;\n          view.offset = 0;\n        } else {\n          view.position = Math.floor(i / gridItems) * itemSize;\n          view.offset = (i % gridItems) * itemSecondarySize;\n        }\n      }\n\n      this.$_startIndex = startIndex;\n      this.$_endIndex = endIndex;\n\n      if (this.emitUpdate) this.$emit('update', startIndex, endIndex, visibleStartIndex, visibleEndIndex);\n\n      // After the user has finished scrolling\n      // Sort views so text selection is correct\n      clearTimeout(this.$_sortTimer);\n      this.$_sortTimer = setTimeout(this.sortViews, this.updateInterval + 300);\n\n      return {\n        continuous,\n      }\n    },\n\n    getListenerTarget () {\n      let target = getScrollParent(this.$el);\n      // Fix global scroll target for Chrome and Safari\n      if (window.document && (target === window.document.documentElement || target === window.document.body)) {\n        target = window;\n      }\n      return target\n    },\n\n    getScroll () {\n      const { $el: el, direction } = this;\n      const isVertical = direction === 'vertical';\n      let scrollState;\n\n      if (this.pageMode) {\n        const bounds = el.getBoundingClientRect();\n        const boundsSize = isVertical ? bounds.height : bounds.width;\n        let start = -(isVertical ? bounds.top : bounds.left);\n        let size = isVertical ? window.innerHeight : window.innerWidth;\n        if (start < 0) {\n          size += start;\n          start = 0;\n        }\n        if (start + size > boundsSize) {\n          size = boundsSize - start;\n        }\n        scrollState = {\n          start,\n          end: start + size,\n        };\n      } else if (isVertical) {\n        scrollState = {\n          start: el.scrollTop,\n          end: el.scrollTop + el.clientHeight,\n        };\n      } else {\n        scrollState = {\n          start: el.scrollLeft,\n          end: el.scrollLeft + el.clientWidth,\n        };\n      }\n\n      return scrollState\n    },\n\n    applyPageMode () {\n      if (this.pageMode) {\n        this.addListeners();\n      } else {\n        this.removeListeners();\n      }\n    },\n\n    addListeners () {\n      this.listenerTarget = this.getListenerTarget();\n      this.listenerTarget.addEventListener('scroll', this.handleScroll, supportsPassive\n        ? {\n            passive: true,\n          }\n        : false);\n      this.listenerTarget.addEventListener('resize', this.handleResize);\n    },\n\n    removeListeners () {\n      if (!this.listenerTarget) {\n        return\n      }\n\n      this.listenerTarget.removeEventListener('scroll', this.handleScroll);\n      this.listenerTarget.removeEventListener('resize', this.handleResize);\n\n      this.listenerTarget = null;\n    },\n\n    scrollToItem (index) {\n      let scroll;\n      const gridItems = this.gridItems || 1;\n      if (this.itemSize === null) {\n        scroll = index > 0 ? this.sizes[index - 1].accumulator : 0;\n      } else {\n        scroll = Math.floor(index / gridItems) * this.itemSize;\n      }\n      this.scrollToPosition(scroll);\n    },\n\n    scrollToPosition (position) {\n      const direction = this.direction === 'vertical'\n        ? { scroll: 'scrollTop', start: 'top' }\n        : { scroll: 'scrollLeft', start: 'left' };\n\n      let viewport;\n      let scrollDirection;\n      let scrollDistance;\n\n      if (this.pageMode) {\n        const viewportEl = getScrollParent(this.$el);\n        // HTML doesn't overflow like other elements\n        const scrollTop = viewportEl.tagName === 'HTML' ? 0 : viewportEl[direction.scroll];\n        const bounds = viewportEl.getBoundingClientRect();\n\n        const scroller = this.$el.getBoundingClientRect();\n        const scrollerPosition = scroller[direction.start] - bounds[direction.start];\n\n        viewport = viewportEl;\n        scrollDirection = direction.scroll;\n        scrollDistance = position + scrollTop + scrollerPosition;\n      } else {\n        viewport = this.$el;\n        scrollDirection = direction.scroll;\n        scrollDistance = position;\n      }\n\n      viewport[scrollDirection] = scrollDistance;\n    },\n\n    itemsLimitError () {\n      setTimeout(() => {\n        console.log('It seems the scroller element isn\\'t scrolling, so it tries to render all the items at once.', 'Scroller:', this.$el);\n        console.log('Make sure the scroller has a fixed height (or width) and \\'overflow-y\\' (or \\'overflow-x\\') set to \\'auto\\' so it can scroll correctly and only render the items visible in the scroll viewport.');\n      });\n      throw new Error('Rendered items limit reached')\n    },\n\n    sortViews () {\n      this.pool.sort((viewA, viewB) => viewA.nr.index - viewB.nr.index);\n    },\n  },\n};\n\nconst _hoisted_1 = {\n  key: 0,\n  ref: \"before\",\n  class: \"vue-recycle-scroller__slot\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  ref: \"after\",\n  class: \"vue-recycle-scroller__slot\"\n};\n\nfunction render$1(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ResizeObserver = resolveComponent(\"ResizeObserver\");\n  const _directive_observe_visibility = resolveDirective(\"observe-visibility\");\n\n  return withDirectives((openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass([\"vue-recycle-scroller\", {\n      ready: $data.ready,\n      'page-mode': $props.pageMode,\n      [`direction-${_ctx.direction}`]: true,\n    }]),\n    onScrollPassive: _cache[0] || (_cache[0] = (...args) => ($options.handleScroll && $options.handleScroll(...args)))\n  }, [\n    (_ctx.$slots.before)\n      ? (openBlock(), createElementBlock(\"div\", _hoisted_1, [\n          renderSlot(_ctx.$slots, \"before\")\n        ], 512 /* NEED_PATCH */))\n      : createCommentVNode(\"v-if\", true),\n    (openBlock(), createBlock(resolveDynamicComponent($props.listTag), {\n      ref: \"wrapper\",\n      style: normalizeStyle({ [_ctx.direction === 'vertical' ? 'minHeight' : 'minWidth']: $data.totalSize + 'px' }),\n      class: normalizeClass([\"vue-recycle-scroller__item-wrapper\", $props.listClass])\n    }, {\n      default: withCtx(() => [\n        (openBlock(true), createElementBlock(Fragment, null, renderList($data.pool, (view) => {\n          return (openBlock(), createBlock(resolveDynamicComponent($props.itemTag), mergeProps({\n            key: view.nr.id,\n            style: $data.ready ? {\n          transform: `translate${_ctx.direction === 'vertical' ? 'Y' : 'X'}(${view.position}px) translate${_ctx.direction === 'vertical' ? 'X' : 'Y'}(${view.offset}px)`,\n          width: $props.gridItems ? `${_ctx.direction === 'vertical' ? $props.itemSecondarySize || $props.itemSize : $props.itemSize}px` : undefined,\n          height: $props.gridItems ? `${_ctx.direction === 'horizontal' ? $props.itemSecondarySize || $props.itemSize : $props.itemSize}px` : undefined,\n        } : null,\n            class: [\"vue-recycle-scroller__item-view\", [\n          $props.itemClass,\n          {\n            hover: !$props.skipHover && $data.hoverKey === view.nr.key\n          },\n        ]]\n          }, toHandlers($props.skipHover ? {} : {\n          mouseenter: () => { $data.hoverKey = view.nr.key; },\n          mouseleave: () => { $data.hoverKey = null; },\n        })), {\n            default: withCtx(() => [\n              renderSlot(_ctx.$slots, \"default\", {\n                item: view.item,\n                index: view.nr.index,\n                active: view.nr.used\n              })\n            ]),\n            _: 2 /* DYNAMIC */\n          }, 1040 /* FULL_PROPS, DYNAMIC_SLOTS */, [\"style\", \"class\"]))\n        }), 128 /* KEYED_FRAGMENT */)),\n        renderSlot(_ctx.$slots, \"empty\")\n      ]),\n      _: 3 /* FORWARDED */\n    }, 8 /* PROPS */, [\"style\", \"class\"])),\n    (_ctx.$slots.after)\n      ? (openBlock(), createElementBlock(\"div\", _hoisted_2, [\n          renderSlot(_ctx.$slots, \"after\")\n        ], 512 /* NEED_PATCH */))\n      : createCommentVNode(\"v-if\", true),\n    createVNode(_component_ResizeObserver, { onNotify: $options.handleResize }, null, 8 /* PROPS */, [\"onNotify\"])\n  ], 34 /* CLASS, HYDRATE_EVENTS */)), [\n    [_directive_observe_visibility, $options.handleVisibilityChange]\n  ])\n}\n\nscript$2.render = render$1;\nscript$2.__file = \"src/components/RecycleScroller.vue\";\n\nvar script$1 = {\n  name: 'DynamicScroller',\n\n  components: {\n    RecycleScroller: script$2,\n  },\n\n  provide () {\n    if (typeof ResizeObserver !== 'undefined') {\n      this.$_resizeObserver = new ResizeObserver(entries => {\n        requestAnimationFrame(() => {\n          if (!Array.isArray(entries)) {\n            return\n          }\n          for (const entry of entries) {\n            if (entry.target && entry.target.$_vs_onResize) {\n              let width, height;\n              if (entry.borderBoxSize) {\n                const resizeObserverSize = entry.borderBoxSize[0];\n                width = resizeObserverSize.inlineSize;\n                height = resizeObserverSize.blockSize;\n              } else {\n                // @TODO remove when contentRect is deprecated\n                width = entry.contentRect.width;\n                height = entry.contentRect.height;\n              }\n              entry.target.$_vs_onResize(entry.target.$_vs_id, width, height);\n            }\n          }\n        });\n      });\n    }\n\n    return {\n      vscrollData: this.vscrollData,\n      vscrollParent: this,\n      vscrollResizeObserver: this.$_resizeObserver,\n    }\n  },\n\n  inheritAttrs: false,\n\n  props: {\n    ...props,\n\n    minItemSize: {\n      type: [Number, String],\n      required: true,\n    },\n  },\n\n  emits: [\n    'resize',\n    'visible',\n  ],\n\n  data () {\n    return {\n      vscrollData: {\n        active: true,\n        sizes: {},\n        keyField: this.keyField,\n        simpleArray: false,\n      },\n    }\n  },\n\n  computed: {\n    simpleArray,\n\n    itemsWithSize () {\n      const result = [];\n      const { items, keyField, simpleArray } = this;\n      const sizes = this.vscrollData.sizes;\n      const l = items.length;\n      for (let i = 0; i < l; i++) {\n        const item = items[i];\n        const id = simpleArray ? i : item[keyField];\n        let size = sizes[id];\n        if (typeof size === 'undefined' && !this.$_undefinedMap[id]) {\n          size = 0;\n        }\n        result.push({\n          item,\n          id,\n          size,\n        });\n      }\n      return result\n    },\n  },\n\n  watch: {\n    items () {\n      this.forceUpdate();\n    },\n\n    simpleArray: {\n      handler (value) {\n        this.vscrollData.simpleArray = value;\n      },\n      immediate: true,\n    },\n\n    direction (value) {\n      this.forceUpdate(true);\n    },\n\n    itemsWithSize (next, prev) {\n      const scrollTop = this.$el.scrollTop;\n\n      // Calculate total diff between prev and next sizes\n      // over current scroll top. Then add it to scrollTop to\n      // avoid jumping the contents that the user is seeing.\n      let prevActiveTop = 0; let activeTop = 0;\n      const length = Math.min(next.length, prev.length);\n      for (let i = 0; i < length; i++) {\n        if (prevActiveTop >= scrollTop) {\n          break\n        }\n        prevActiveTop += prev[i].size || this.minItemSize;\n        activeTop += next[i].size || this.minItemSize;\n      }\n      const offset = activeTop - prevActiveTop;\n\n      if (offset === 0) {\n        return\n      }\n\n      this.$el.scrollTop += offset;\n    },\n  },\n\n  beforeCreate () {\n    this.$_updates = [];\n    this.$_undefinedSizes = 0;\n    this.$_undefinedMap = {};\n    this.$_events = mitt();\n  },\n\n  activated () {\n    this.vscrollData.active = true;\n  },\n\n  deactivated () {\n    this.vscrollData.active = false;\n  },\n\n  unmounted () {\n    this.$_events.all.clear();\n  },\n\n  methods: {\n    onScrollerResize () {\n      const scroller = this.$refs.scroller;\n      if (scroller) {\n        this.forceUpdate();\n      }\n      this.$emit('resize');\n    },\n\n    onScrollerVisible () {\n      this.$_events.emit('vscroll:update', { force: false });\n      this.$emit('visible');\n    },\n\n    forceUpdate (clear = false) {\n      if (clear || this.simpleArray) {\n        this.vscrollData.sizes = {};\n      }\n      this.$_events.emit('vscroll:update', { force: true });\n    },\n\n    scrollToItem (index) {\n      const scroller = this.$refs.scroller;\n      if (scroller) scroller.scrollToItem(index);\n    },\n\n    getItemSize (item, index = undefined) {\n      const id = this.simpleArray ? (index != null ? index : this.items.indexOf(item)) : item[this.keyField];\n      return this.vscrollData.sizes[id] || 0\n    },\n\n    scrollToBottom () {\n      if (this.$_scrollingToBottom) return\n      this.$_scrollingToBottom = true;\n      const el = this.$el;\n      // Item is inserted to the DOM\n      this.$nextTick(() => {\n        el.scrollTop = el.scrollHeight + 5000;\n        // Item sizes are computed\n        const cb = () => {\n          el.scrollTop = el.scrollHeight + 5000;\n          requestAnimationFrame(() => {\n            el.scrollTop = el.scrollHeight + 5000;\n            if (this.$_undefinedSizes === 0) {\n              this.$_scrollingToBottom = false;\n            } else {\n              requestAnimationFrame(cb);\n            }\n          });\n        };\n        requestAnimationFrame(cb);\n      });\n    },\n  },\n};\n\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_RecycleScroller = resolveComponent(\"RecycleScroller\");\n\n  return (openBlock(), createBlock(_component_RecycleScroller, mergeProps({\n    ref: \"scroller\",\n    items: $options.itemsWithSize,\n    \"min-item-size\": $props.minItemSize,\n    direction: _ctx.direction,\n    \"key-field\": \"id\",\n    \"list-tag\": _ctx.listTag,\n    \"item-tag\": _ctx.itemTag\n  }, _ctx.$attrs, {\n    onResize: $options.onScrollerResize,\n    onVisible: $options.onScrollerVisible\n  }), {\n    default: withCtx(({ item: itemWithSize, index, active }) => [\n      renderSlot(_ctx.$slots, \"default\", normalizeProps(guardReactiveProps({\n          item: itemWithSize.item,\n          index,\n          active,\n          itemWithSize\n        })))\n    ]),\n    before: withCtx(() => [\n      renderSlot(_ctx.$slots, \"before\")\n    ]),\n    after: withCtx(() => [\n      renderSlot(_ctx.$slots, \"after\")\n    ]),\n    empty: withCtx(() => [\n      renderSlot(_ctx.$slots, \"empty\")\n    ]),\n    _: 3 /* FORWARDED */\n  }, 16 /* FULL_PROPS */, [\"items\", \"min-item-size\", \"direction\", \"list-tag\", \"item-tag\", \"onResize\", \"onVisible\"]))\n}\n\nscript$1.render = render;\nscript$1.__file = \"src/components/DynamicScroller.vue\";\n\nvar script = {\n  name: 'DynamicScrollerItem',\n\n  inject: [\n    'vscrollData',\n    'vscrollParent',\n    'vscrollResizeObserver',\n  ],\n\n  props: {\n    // eslint-disable-next-line vue/require-prop-types\n    item: {\n      required: true,\n    },\n\n    watchData: {\n      type: Boolean,\n      default: false,\n    },\n\n    /**\n     * Indicates if the view is actively used to display an item.\n     */\n    active: {\n      type: Boolean,\n      required: true,\n    },\n\n    index: {\n      type: Number,\n      default: undefined,\n    },\n\n    sizeDependencies: {\n      type: [Array, Object],\n      default: null,\n    },\n\n    emitResize: {\n      type: Boolean,\n      default: false,\n    },\n\n    tag: {\n      type: String,\n      default: 'div',\n    },\n  },\n\n  emits: [\n    'resize',\n  ],\n\n  computed: {\n    id () {\n      if (this.vscrollData.simpleArray) return this.index\n      // eslint-disable-next-line no-prototype-builtins\n      if (this.vscrollData.keyField in this.item) return this.item[this.vscrollData.keyField]\n      throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)\n    },\n\n    size () {\n      return this.vscrollData.sizes[this.id] || 0\n    },\n\n    finalActive () {\n      return this.active && this.vscrollData.active\n    },\n  },\n\n  watch: {\n    watchData: 'updateWatchData',\n\n    id (value, oldValue) {\n      this.$el.$_vs_id = this.id;\n      if (!this.size) {\n        this.onDataUpdate();\n      }\n\n      if (this.$_sizeObserved) {\n        // In case the old item had the same size, it won't trigger the ResizeObserver\n        // since we are reusing the same DOM node\n        const oldSize = this.vscrollData.sizes[oldValue];\n        const size = this.vscrollData.sizes[value];\n        if (oldSize != null && oldSize !== size) {\n          this.applySize(oldSize);\n        }\n      }\n    },\n\n    finalActive (value) {\n      if (!this.size) {\n        if (value) {\n          if (!this.vscrollParent.$_undefinedMap[this.id]) {\n            this.vscrollParent.$_undefinedSizes++;\n            this.vscrollParent.$_undefinedMap[this.id] = true;\n          }\n        } else {\n          if (this.vscrollParent.$_undefinedMap[this.id]) {\n            this.vscrollParent.$_undefinedSizes--;\n            this.vscrollParent.$_undefinedMap[this.id] = false;\n          }\n        }\n      }\n\n      if (this.vscrollResizeObserver) {\n        if (value) {\n          this.observeSize();\n        } else {\n          this.unobserveSize();\n        }\n      } else if (value && this.$_pendingVScrollUpdate === this.id) {\n        this.updateSize();\n      }\n    },\n  },\n\n  created () {\n    if (this.$isServer) return\n\n    this.$_forceNextVScrollUpdate = null;\n    this.updateWatchData();\n\n    if (!this.vscrollResizeObserver) {\n      for (const k in this.sizeDependencies) {\n        this.$watch(() => this.sizeDependencies[k], this.onDataUpdate);\n      }\n\n      this.vscrollParent.$_events.on('vscroll:update', this.onVscrollUpdate);\n    }\n  },\n\n  mounted () {\n    if (this.finalActive) {\n      this.updateSize();\n      this.observeSize();\n    }\n  },\n\n  beforeUnmount () {\n    this.vscrollParent.$_events.off('vscroll:update', this.onVscrollUpdate);\n    this.unobserveSize();\n  },\n\n  methods: {\n    updateSize () {\n      if (this.finalActive) {\n        if (this.$_pendingSizeUpdate !== this.id) {\n          this.$_pendingSizeUpdate = this.id;\n          this.$_forceNextVScrollUpdate = null;\n          this.$_pendingVScrollUpdate = null;\n          this.computeSize(this.id);\n        }\n      } else {\n        this.$_forceNextVScrollUpdate = this.id;\n      }\n    },\n\n    updateWatchData () {\n      if (this.watchData && !this.vscrollResizeObserver) {\n        this.$_watchData = this.$watch('item', () => {\n          this.onDataUpdate();\n        }, {\n          deep: true,\n        });\n      } else if (this.$_watchData) {\n        this.$_watchData();\n        this.$_watchData = null;\n      }\n    },\n\n    onVscrollUpdate ({ force }) {\n      // If not active, sechedule a size update when it becomes active\n      if (!this.finalActive && force) {\n        this.$_pendingVScrollUpdate = this.id;\n      }\n\n      if (this.$_forceNextVScrollUpdate === this.id || force || !this.size) {\n        this.updateSize();\n      }\n    },\n\n    onDataUpdate () {\n      this.updateSize();\n    },\n\n    computeSize (id) {\n      this.$nextTick(() => {\n        if (this.id === id) {\n          const width = this.$el.offsetWidth;\n          const height = this.$el.offsetHeight;\n          this.applyWidthHeight(width, height);\n        }\n        this.$_pendingSizeUpdate = null;\n      });\n    },\n\n    applyWidthHeight (width, height) {\n      const size = ~~(this.vscrollParent.direction === 'vertical' ? height : width);\n      if (size && this.size !== size) {\n        this.applySize(size);\n      }\n    },\n\n    applySize (size) {\n      if (this.vscrollParent.$_undefinedMap[this.id]) {\n        this.vscrollParent.$_undefinedSizes--;\n        this.vscrollParent.$_undefinedMap[this.id] = undefined;\n      }\n      this.vscrollData.sizes[this.id] = size;\n      if (this.emitResize) this.$emit('resize', this.id);\n    },\n\n    observeSize () {\n      if (!this.vscrollResizeObserver) return\n      if (this.$_sizeObserved) return\n      this.vscrollResizeObserver.observe(this.$el);\n      this.$el.$_vs_id = this.id;\n      this.$el.$_vs_onResize = this.onResize;\n      this.$_sizeObserved = true;\n    },\n\n    unobserveSize () {\n      if (!this.vscrollResizeObserver) return\n      if (!this.$_sizeObserved) return\n      this.vscrollResizeObserver.unobserve(this.$el);\n      this.$el.$_vs_onResize = undefined;\n      this.$_sizeObserved = false;\n    },\n\n    onResize (id, width, height) {\n      if (this.id === id) {\n        this.applyWidthHeight(width, height);\n      }\n    },\n  },\n\n  render () {\n    return h(this.tag, this.$slots.default())\n  },\n};\n\nscript.__file = \"src/components/DynamicScrollerItem.vue\";\n\nfunction IdState () {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    _ref$idProp = _ref.idProp,\n    idProp = _ref$idProp === void 0 ? function (vm) {\n      return vm.item.id;\n    } : _ref$idProp;\n  var store = reactive({});\n\n  // @vue/component\n  return {\n    data: function data() {\n      return {\n        idState: null\n      };\n    },\n    created: function created() {\n      var _this = this;\n      this.$_id = null;\n      if (typeof idProp === 'function') {\n        this.$_getId = function () {\n          return idProp.call(_this, _this);\n        };\n      } else {\n        this.$_getId = function () {\n          return _this[idProp];\n        };\n      }\n      this.$watch(this.$_getId, {\n        handler: function handler(value) {\n          var _this2 = this;\n          this.$nextTick(function () {\n            _this2.$_id = value;\n          });\n        },\n        immediate: true\n      });\n      this.$_updateIdState();\n    },\n    beforeUpdate: function beforeUpdate() {\n      this.$_updateIdState();\n    },\n    methods: {\n      /**\n       * Initialize an idState\n       * @param {number|string} id Unique id for the data\n       */$_idStateInit: function $_idStateInit(id) {\n        var factory = this.$options.idState;\n        if (typeof factory === 'function') {\n          var data = factory.call(this, this);\n          store[id] = data;\n          this.$_id = id;\n          return data;\n        } else {\n          throw new Error('[mixin IdState] Missing `idState` function on component definition.');\n        }\n      },\n      /**\n       * Ensure idState is created and up-to-date\n       */$_updateIdState: function $_updateIdState() {\n        var id = this.$_getId();\n        if (id == null) {\n          console.warn(\"No id found for IdState with idProp: '\".concat(idProp, \"'.\"));\n        }\n        if (id !== this.$_id) {\n          if (!store[id]) {\n            this.$_idStateInit(id);\n          }\n          this.idState = store[id];\n        }\n      }\n    }\n  };\n}\n\nfunction registerComponents(app, prefix) {\n  app.component(\"\".concat(prefix, \"recycle-scroller\"), script$2);\n  app.component(\"\".concat(prefix, \"RecycleScroller\"), script$2);\n  app.component(\"\".concat(prefix, \"dynamic-scroller\"), script$1);\n  app.component(\"\".concat(prefix, \"DynamicScroller\"), script$1);\n  app.component(\"\".concat(prefix, \"dynamic-scroller-item\"), script);\n  app.component(\"\".concat(prefix, \"DynamicScrollerItem\"), script);\n}\nvar plugin = {\n  // eslint-disable-next-line no-undef\n  version: \"2.0.0-beta.8\",\n  install: function install(app, options) {\n    var finalOptions = Object.assign({}, {\n      installComponents: true,\n      componentsPrefix: ''\n    }, options);\n    for (var key in finalOptions) {\n      if (typeof finalOptions[key] !== 'undefined') {\n        config[key] = finalOptions[key];\n      }\n    }\n    if (finalOptions.installComponents) {\n      registerComponents(app, finalOptions.componentsPrefix);\n    }\n  }\n};\n\nexport { script$1 as DynamicScroller, script as DynamicScrollerItem, IdState, script$2 as RecycleScroller, plugin as default };\n//# sourceMappingURL=vue-virtual-scroller.esm.js.map\n","// composables/useFiltering.ts\r\nimport { ref } from 'vue'\r\nimport type { GridRow } from '@/stores/dataGridStore'\r\n\r\n//  FIX: Store interface for accessing checkbox state\r\ninterface DataGridStoreInterface {\r\n  checkedRows: string[]\r\n  isRowChecked(rowId: string): boolean\r\n}\r\n\r\nexport type FilterOperator =\r\n  | 'Equals'\r\n  | 'NotEquals'\r\n  | 'Contains'\r\n  | 'StartsWith'\r\n  | 'EndsWith'\r\n  | 'GreaterThan'\r\n  | 'LessThan'\r\n  | 'GreaterThanOrEquals'\r\n  | 'LessThanOrEquals'\r\n  | 'IsEmpty'\r\n  | 'IsNotEmpty'\r\n\r\nexport interface FilterExpression {\r\n  type: 'simple' | 'composite'\r\n}\r\n\r\nexport interface SimpleFilter extends FilterExpression {\r\n  type: 'simple'\r\n  columnName: string\r\n  operator: FilterOperator\r\n  value: any\r\n}\r\n\r\nexport interface CompositeFilter extends FilterExpression {\r\n  type: 'composite'\r\n  left: FilterExpression\r\n  right: FilterExpression\r\n  operator: 'AND' | 'OR'\r\n}\r\n\r\nexport function useFiltering() {\r\n  const currentFilter = ref<FilterExpression | null>(null)\r\n\r\n  function evaluateFilter(row: GridRow, filter: FilterExpression, store?: DataGridStoreInterface): boolean {\r\n    if (filter.type === 'simple') {\r\n      return evaluateSimpleFilter(row, filter as SimpleFilter, store)\r\n    } else {\r\n      return evaluateCompositeFilter(row, filter as CompositeFilter, store)\r\n    }\r\n  }\r\n\r\n  function evaluateSimpleFilter(row: GridRow, filter: SimpleFilter, store?: DataGridStoreInterface): boolean {\r\n    //  FIX: Special handling for checkbox column (__checkbox)\r\n    // Checkbox values are stored in store.checkedRows, NOT in row.cells\r\n    let cellValue: any\r\n\r\n    if (filter.columnName === '__checkbox' && store) {\r\n      // Get checkbox state from store.checkedRows\r\n      cellValue = store.isRowChecked(row.rowId)\r\n    } else {\r\n      // Normal columns - get value from row.cells\r\n      const cell = row.cells.find(c => c.columnName === filter.columnName)\r\n      cellValue = cell?.value\r\n    }\r\n\r\n    const filterValue = filter.value\r\n\r\n    switch (filter.operator) {\r\n      case 'Equals':\r\n        return cellValue === filterValue\r\n\r\n      case 'NotEquals':\r\n        return cellValue !== filterValue\r\n\r\n      case 'GreaterThan':\r\n        return Number(cellValue) > Number(filterValue)\r\n\r\n      case 'LessThan':\r\n        return Number(cellValue) < Number(filterValue)\r\n\r\n      case 'GreaterThanOrEquals':\r\n        return Number(cellValue) >= Number(filterValue)\r\n\r\n      case 'LessThanOrEquals':\r\n        return Number(cellValue) <= Number(filterValue)\r\n\r\n      case 'Contains':\r\n        return String(cellValue).toLowerCase().includes(String(filterValue).toLowerCase())\r\n\r\n      case 'StartsWith':\r\n        return String(cellValue).toLowerCase().startsWith(String(filterValue).toLowerCase())\r\n\r\n      case 'EndsWith':\r\n        return String(cellValue).toLowerCase().endsWith(String(filterValue).toLowerCase())\r\n\r\n      case 'IsEmpty':\r\n        return cellValue == null || String(cellValue).trim() === ''\r\n\r\n      case 'IsNotEmpty':\r\n        return cellValue != null && String(cellValue).trim() !== ''\r\n\r\n      default:\r\n        return true\r\n    }\r\n  }\r\n\r\n  function evaluateCompositeFilter(row: GridRow, filter: CompositeFilter, store?: DataGridStoreInterface): boolean {\r\n    //  FIX: Defensive check for null/undefined children\r\n    if (!filter.left || !filter.right) {\r\n      console.error('[evaluateCompositeFilter] Invalid filter structure - missing children:', filter)\r\n      return true // Return true to not filter out rows when filter is corrupted\r\n    }\r\n\r\n    const leftResult = evaluateFilter(row, filter.left, store)\r\n\r\n    // Short-circuit evaluation\r\n    if (filter.operator === 'AND' && !leftResult) {\r\n      return false // No need to evaluate right if left is false\r\n    }\r\n    if (filter.operator === 'OR' && leftResult) {\r\n      return true // No need to evaluate right if left is true\r\n    }\r\n\r\n    const rightResult = evaluateFilter(row, filter.right, store)\r\n\r\n    return filter.operator === 'AND' ? leftResult && rightResult : leftResult || rightResult\r\n  }\r\n\r\n  function filterRows(rows: GridRow[], filter: FilterExpression | null, store?: DataGridStoreInterface): GridRow[] {\r\n    if (!filter) return rows\r\n    return rows.filter(row => evaluateFilter(row, filter, store))\r\n  }\r\n\r\n  function setFilter(filter: FilterExpression | null) {\r\n    currentFilter.value = filter\r\n  }\r\n\r\n  function clearFilter() {\r\n    currentFilter.value = null\r\n  }\r\n\r\n  return {\r\n    currentFilter,\r\n    filterRows,\r\n    setFilter,\r\n    clearFilter,\r\n    evaluateFilter\r\n  }\r\n}\r\n","// composables/useSearch.ts\r\nimport { ref, type Ref } from 'vue'\r\nimport type { GridRow } from '@/stores/dataGridStore'\r\n\r\nexport type SearchMode = 'Exact' | 'Contains' | 'StartsWith' | 'EndsWith' | 'Regex' | 'Fuzzy'\r\n\r\nexport interface SearchMatch {\r\n  rowId: string\r\n  columnName: string\r\n  value: string\r\n}\r\n\r\nexport interface SearchOptions {\r\n  caseSensitive?: boolean\r\n  fuzzyThreshold?: number\r\n}\r\n\r\nexport function useSearch(rows: Ref<GridRow[]>) {\r\n  const searchTerm = ref('')\r\n  const searchMode = ref<SearchMode>('Contains')\r\n  const searchResults = ref<SearchMatch[]>([])\r\n  const currentResultIndex = ref(-1)\r\n\r\n  function searchInRows(term: string, mode: SearchMode, options: SearchOptions = {}) {\r\n    if (!term) {\r\n      searchResults.value = []\r\n      currentResultIndex.value = -1\r\n      return\r\n    }\r\n\r\n    const matches: SearchMatch[] = []\r\n    const caseSensitive = options.caseSensitive ?? false\r\n    const fuzzyThreshold = options.fuzzyThreshold ?? 3\r\n\r\n    for (const row of rows.value) {\r\n      for (const cell of row.cells) {\r\n        const cellValue = String(cell.value || '')\r\n        let isMatch = false\r\n\r\n        const searchValue = caseSensitive ? cellValue : cellValue.toLowerCase()\r\n        const searchTerm = caseSensitive ? term : term.toLowerCase()\r\n\r\n        switch (mode) {\r\n          case 'Exact':\r\n            isMatch = caseSensitive ? cellValue === term : cellValue.toLowerCase() === term.toLowerCase()\r\n            break\r\n\r\n          case 'Contains':\r\n            isMatch = searchValue.includes(searchTerm)\r\n            break\r\n\r\n          case 'StartsWith':\r\n            isMatch = searchValue.startsWith(searchTerm)\r\n            break\r\n\r\n          case 'EndsWith':\r\n            isMatch = searchValue.endsWith(searchTerm)\r\n            break\r\n\r\n          case 'Regex':\r\n            try {\r\n              const flags = caseSensitive ? '' : 'i'\r\n              const regex = new RegExp(term, flags)\r\n              isMatch = regex.test(cellValue)\r\n            } catch {\r\n              isMatch = false\r\n            }\r\n            break\r\n\r\n          case 'Fuzzy':\r\n            isMatch = fuzzyMatch(cellValue, term, fuzzyThreshold)\r\n            break\r\n        }\r\n\r\n        if (isMatch) {\r\n          matches.push({\r\n            rowId: row.rowId,\r\n            columnName: cell.columnName,\r\n            value: cellValue\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    searchResults.value = matches\r\n    currentResultIndex.value = matches.length > 0 ? 0 : -1\r\n  }\r\n\r\n  function fuzzyMatch(text: string, pattern: string, threshold: number): boolean {\r\n    const distance = levenshteinDistance(text.toLowerCase(), pattern.toLowerCase())\r\n    return distance <= threshold\r\n  }\r\n\r\n  function levenshteinDistance(a: string, b: string): number {\r\n    const matrix: number[][] = []\r\n\r\n    // Initialize matrix\r\n    for (let i = 0; i <= b.length; i++) {\r\n      matrix[i] = [i]\r\n    }\r\n\r\n    for (let j = 0; j <= a.length; j++) {\r\n      matrix[0][j] = j\r\n    }\r\n\r\n    // Calculate distances\r\n    for (let i = 1; i <= b.length; i++) {\r\n      for (let j = 1; j <= a.length; j++) {\r\n        if (b.charAt(i - 1) === a.charAt(j - 1)) {\r\n          matrix[i][j] = matrix[i - 1][j - 1]\r\n        } else {\r\n          matrix[i][j] = Math.min(\r\n            matrix[i - 1][j - 1] + 1, // substitution\r\n            matrix[i][j - 1] + 1,      // insertion\r\n            matrix[i - 1][j] + 1       // deletion\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    return matrix[b.length][a.length]\r\n  }\r\n\r\n  function goToNextResult() {\r\n    if (currentResultIndex.value < searchResults.value.length - 1) {\r\n      currentResultIndex.value++\r\n    }\r\n  }\r\n\r\n  function goToPreviousResult() {\r\n    if (currentResultIndex.value > 0) {\r\n      currentResultIndex.value--\r\n    }\r\n  }\r\n\r\n  function clearSearch() {\r\n    searchTerm.value = ''\r\n    searchResults.value = []\r\n    currentResultIndex.value = -1\r\n  }\r\n\r\n  function isSearchMatch(rowId: string, columnName: string): boolean {\r\n    return searchResults.value.some(\r\n      m => m.rowId === rowId && m.columnName === columnName\r\n    )\r\n  }\r\n\r\n  return {\r\n    searchTerm,\r\n    searchMode,\r\n    searchResults,\r\n    currentResultIndex,\r\n    searchInRows,\r\n    goToNextResult,\r\n    goToPreviousResult,\r\n    clearSearch,\r\n    isSearchMatch\r\n  }\r\n}\r\n","import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\nimport { useFiltering, type FilterExpression } from '@/composables/useFiltering'\r\nimport { useSearch } from '@/composables/useSearch'\r\n\r\nexport interface GridCell {\r\n  rowId: string\r\n  columnName: string\r\n  value: any\r\n  isSelected: boolean\r\n  isValidationError: boolean\r\n  validationMessage?: string\r\n}\r\n\r\nexport interface GridRow {\r\n  rowId: string\r\n  rowIndex: number\r\n  height: number\r\n  cells: GridCell[]\r\n  validationErrorCount?: number  // Track validation errors for DynamicScroller size-dependencies\r\n}\r\n\r\nexport interface GridColumn {\r\n  name: string\r\n  header: string\r\n  width: number\r\n  minWidth: number\r\n  maxWidth: number\r\n  isVisible: boolean\r\n  isReadOnly: boolean\r\n  isSortable: boolean\r\n  isFilterable: boolean\r\n  autoWidth?: boolean  // Star sizing - column expands to fill remaining space\r\n  specialType?: 'RowNumber' | 'Checkbox' | 'ValidationAlerts' | 'DeleteRow' | 'InsertRow'\r\n  dataType?: 'string' | 'number' | 'boolean' | 'date' | 'datetime' | 'time'  // Data type for validation and formatting\r\n  visibleForGrid?: boolean  // Default: true. If false, column holds data but is not shown in UI, validation, filter, or sort\r\n}\r\n\r\nexport interface GridConfig {\r\n  pageSize: number\r\n  pageSizeOptions?: number[]\r\n  enableSort: boolean\r\n  enableFilter: boolean\r\n  enableSearch: boolean\r\n  enableValidation: boolean\r\n  autoValidate: boolean  // true = validate on every change, false = validate only on manual request\r\n  showRowNumber: boolean\r\n  showCheckbox: boolean\r\n  showValidationAlerts: boolean\r\n  showDeleteButton: boolean\r\n  showInsertButton: boolean\r\n}\r\n\r\nexport const useDataGridStore = (storeId: string = 'dataGrid') => {\r\n  return defineStore(storeId, () => {\r\n  // State\r\n  //  RIEENIE E: Map-based storage for O(1) lookup and thread-safety\r\n  const rowsMap = ref<Map<string, GridRow>>(new Map())  // O(1) lookup by rowId\r\n  const rowsOrder = ref<string[]>([])  // Maintain insertion order for rendering\r\n\r\n  const columns = ref<GridColumn[]>([])\r\n  const selectedCells = ref<Set<string>>(new Set())\r\n  const checkedRows = ref<string[]>([])\r\n  const pageSize = ref(100)\r\n  const currentPage = ref(1)\r\n\r\n  //  RIEENIE E: Map-based storage for sortColumns (O(1) lookup)\r\n  const sortColumnsMap = ref<Map<string, { direction: 'asc' | 'desc'; order: number }>>(new Map())\r\n  const sortColumnsOrder = ref<string[]>([])  // Maintain sort order\r\n\r\n  const filterExpression = ref<FilterExpression | null>(null)\r\n  const searchQuery = ref('')\r\n  const config = ref<GridConfig>({\r\n    pageSize: 100,\r\n    enableSort: true,\r\n    enableFilter: true,\r\n    enableSearch: true,\r\n    enableValidation: true,\r\n    autoValidate: true,  // Default: validate automatically on every change\r\n    showRowNumber: false,\r\n    showCheckbox: false,\r\n    showValidationAlerts: true,\r\n    showDeleteButton: false,\r\n    showInsertButton: false\r\n  })\r\n\r\n  // Selection state (based on WinUI3 patterns)\r\n  const pressedCell = ref<{ rowId: string; columnName: string } | null>(null)\r\n  const isDragging = ref(false)\r\n  const wasCtrlPressed = ref(false)\r\n\r\n  // Auto row height state\r\n  const isAutoRowHeightEnabled = ref(false)\r\n\r\n  // Validation tracking state (for optimized validation)\r\n  const validatedCells = ref<Set<string>>(new Set())  // Cells that have been validated: \"rowId:columnName\"\r\n  const changedCellsSinceValidation = ref<Set<string>>(new Set())  // Cells changed since last validation\r\n\r\n  //  RIEENIE E: Computed properties - convert Map to Array for rendering\r\n  const rows = computed(() => {\r\n    return rowsOrder.value.map(rowId => rowsMap.value.get(rowId)!).filter(Boolean)\r\n  })\r\n\r\n  const sortColumns = computed(() => {\r\n    return sortColumnsOrder.value.map(columnName => {\r\n      const sortInfo = sortColumnsMap.value.get(columnName)!\r\n      return {\r\n        columnName,\r\n        direction: sortInfo.direction\r\n      }\r\n    })\r\n  })\r\n\r\n  //  RIEENIE E: Helper functions for O(1) access\r\n  function getRow(rowId: string): GridRow | undefined {\r\n    return rowsMap.value.get(rowId)\r\n  }\r\n\r\n  function hasRow(rowId: string): boolean {\r\n    return rowsMap.value.has(rowId)\r\n  }\r\n\r\n  function getSortInfo(columnName: string) {\r\n    return sortColumnsMap.value.get(columnName) ?? null\r\n  }\r\n\r\n  // Composables\r\n  const { filterRows, evaluateFilter } = useFiltering()\r\n  const { searchResults, isSearchMatch } = useSearch(rows)\r\n\r\n  // Computed\r\n  const totalRows = computed(() => rowsOrder.value.length)\r\n  const totalPages = computed(() => Math.ceil(totalRows.value / pageSize.value))\r\n\r\n  const visibleRows = computed(() => {\r\n    let filteredRows = rows.value\r\n\r\n    // Apply filtering\r\n    if (filterExpression.value) {\r\n      //  FIX: Pass store interface so filterRows can access checkbox state\r\n      const storeInterface = {\r\n        checkedRows: checkedRows.value,\r\n        isRowChecked: (rowId: string) => checkedRows.value.includes(rowId)\r\n      }\r\n      filteredRows = filterRows(filteredRows, filterExpression.value, storeInterface)\r\n    }\r\n\r\n    // Apply search filtering\r\n    if (searchQuery.value && searchResults.value.length > 0) {\r\n      const searchRowIds = new Set(searchResults.value.map(r => r.rowId))\r\n      filteredRows = filteredRows.filter(row => searchRowIds.has(row.rowId))\r\n    }\r\n\r\n    // Apply sorting\r\n    if (sortColumns.value.length > 0) {\r\n      filteredRows = sortRows(filteredRows, sortColumns.value)\r\n    }\r\n\r\n    // Apply pagination\r\n    const start = (currentPage.value - 1) * pageSize.value\r\n    const end = start + pageSize.value\r\n    return filteredRows.slice(start, end)\r\n  })\r\n\r\n  // Actions\r\n  //  RIEENIE E: loadRows using Map structure\r\n  function loadRows(data: Record<string, any>[]) {\r\n    console.log('[dataGridStore] loadRows:', {\r\n      rowCount: data.length,\r\n      columnCount: columns.value.length,\r\n      autoValidate: config.value.autoValidate\r\n    })\r\n\r\n    const newMap = new Map<string, GridRow>()\r\n    const newOrder: string[] = []\r\n\r\n    data.forEach((rowData, idx) => {\r\n      const rowId = rowData.__rowId || generateULID()\r\n      const height = rowData.__rowHeight || 40\r\n\r\n      const row: GridRow = {\r\n        rowId,\r\n        rowIndex: idx,\r\n        height,\r\n        cells: columns.value.map(col => ({\r\n          rowId,\r\n          columnName: col.name,\r\n          value: rowData[col.name],\r\n          isSelected: false,\r\n          isValidationError: false\r\n        }))\r\n      }\r\n\r\n      newMap.set(rowId, row)  //  O(1) insert\r\n      newOrder.push(rowId)\r\n    })\r\n\r\n    rowsMap.value = newMap\r\n    rowsOrder.value = newOrder\r\n\r\n    console.log('[dataGridStore] loadRows complete:', {\r\n      loadedRows: rowsOrder.value.length,\r\n      firstRowId: rowsOrder.value[0],\r\n      firstRowCells: newMap.get(rowsOrder.value[0])?.cells.length\r\n    })\r\n  }\r\n\r\n  //  RIEENIE E: updateCell using O(1) Map.get()\r\n  function updateCell(rowId: string, columnName: string, value: any) {\r\n    const row = getRow(rowId)  //  O(1) instead of O(n)\r\n    if (row) {\r\n      const cell = row.cells.find(c => c.columnName === columnName)\r\n      if (cell) {\r\n        const oldValue = cell.value\r\n        cell.value = value\r\n\r\n        console.log('[dataGridStore] updateCell:', {\r\n          rowId,\r\n          columnName,\r\n          oldValue,\r\n          newValue: value,\r\n          autoValidate: config.value.autoValidate\r\n        })\r\n\r\n        // Mark cell as changed for validation tracking\r\n        const cellKey = `${rowId}:${columnName}`\r\n        changedCellsSinceValidation.value.add(cellKey)\r\n      } else {\r\n        console.warn('[dataGridStore] updateCell: cell not found', { rowId, columnName })\r\n      }\r\n    } else {\r\n      console.warn('[dataGridStore] updateCell: row not found', { rowId })\r\n    }\r\n  }\r\n\r\n  //  RIEENIE E: updateRowHeight using O(1) Map.get()\r\n  function updateRowHeight(rowId: string, newHeight: number) {\r\n    const row = getRow(rowId)  //  O(1) instead of O(n)\r\n    if (row) {\r\n      const oldHeight = row.height\r\n      row.height = newHeight\r\n\r\n      console.log('[dataGridStore] updateRowHeight:', {\r\n        rowId,\r\n        oldHeight,\r\n        newHeight,\r\n        autoRowHeightEnabled: isAutoRowHeightEnabled.value\r\n      })\r\n    } else {\r\n      console.warn('[dataGridStore] updateRowHeight: row not found', { rowId })\r\n    }\r\n  }\r\n\r\n  function setAutoRowHeightEnabled(enabled: boolean) {\r\n    console.log(`[dataGridStore] setAutoRowHeightEnabled: oldValue=${isAutoRowHeightEnabled.value}, newValue=${enabled}`)\r\n    isAutoRowHeightEnabled.value = enabled\r\n  }\r\n\r\n  function sortRows(rowsToSort: GridRow[], sorts: { columnName: string; direction: 'asc' | 'desc' }[]) {\r\n    if (sorts.length === 0) return rowsToSort\r\n\r\n    return [...rowsToSort].sort((a, b) => {\r\n      for (const { columnName, direction } of sorts) {\r\n        const aCell = a.cells.find(c => c.columnName === columnName)\r\n        const bCell = b.cells.find(c => c.columnName === columnName)\r\n\r\n        const aVal = aCell?.value\r\n        const bVal = bCell?.value\r\n\r\n        const cmp = compareValues(aVal, bVal)\r\n        if (cmp !== 0) {\r\n          return direction === 'asc' ? cmp : -cmp\r\n        }\r\n      }\r\n      return 0\r\n    })\r\n  }\r\n\r\n  function compareValues(a: any, b: any): number {\r\n    if (a == null && b == null) return 0\r\n    if (a == null) return -1\r\n    if (b == null) return 1\r\n\r\n    if (typeof a === 'number' && typeof b === 'number') {\r\n      return a - b\r\n    }\r\n\r\n    return String(a).localeCompare(String(b))\r\n  }\r\n\r\n  //  RIEENIE E: addSort using Map - O(1) lookup instead of O(n) findIndex\r\n  function addSort(columnName: string, direction: 'asc' | 'desc', multiSort = false) {\r\n    if (!multiSort) {\r\n      // Single sort - clear all and add new\r\n      sortColumnsMap.value.clear()\r\n      sortColumnsOrder.value = [columnName]\r\n      sortColumnsMap.value.set(columnName, { direction, order: 1 })\r\n    } else {\r\n      // Multi-sort\r\n      if (sortColumnsMap.value.has(columnName)) {\r\n        // Update existing - keep same order\r\n        const existing = sortColumnsMap.value.get(columnName)!\r\n        sortColumnsMap.value.set(columnName, { direction, order: existing.order })\r\n      } else {\r\n        // Add new - append to end\r\n        const newOrder = sortColumnsOrder.value.length + 1\r\n        sortColumnsMap.value.set(columnName, { direction, order: newOrder })\r\n        sortColumnsOrder.value.push(columnName)\r\n      }\r\n    }\r\n  }\r\n\r\n  function clearSort() {\r\n    sortColumnsMap.value.clear()\r\n    sortColumnsOrder.value = []\r\n  }\r\n\r\n  function setPageSize(size: number) {\r\n    pageSize.value = size\r\n    currentPage.value = 1 // Reset to first page\r\n  }\r\n\r\n  function goToPage(page: number) {\r\n    if (page >= 1 && page <= totalPages.value) {\r\n      currentPage.value = page\r\n    }\r\n  }\r\n\r\n  function generateULID(): string {\r\n    // Simple ULID-like generator\r\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\r\n  }\r\n\r\n  //  RIEENIE E: deleteRow using Map.delete() - O(1)\r\n  function deleteRow(rowId: string) {\r\n    if (hasRow(rowId)) {\r\n      console.log('[dataGridStore] deleteRow:', {\r\n        rowId,\r\n        rowsBefore: rowsOrder.value.length,\r\n        wasChecked: checkedRows.value.includes(rowId)\r\n      })\r\n\r\n      rowsMap.value.delete(rowId)  //  O(1) delete from Map\r\n      rowsOrder.value = rowsOrder.value.filter(id => id !== rowId)  //  O(n) but only on string[]\r\n\r\n      // Remove from checked rows\r\n      const checkedIndex = checkedRows.value.indexOf(rowId)\r\n      if (checkedIndex > -1) {\r\n        checkedRows.value.splice(checkedIndex, 1)\r\n      }\r\n\r\n      // Reindex rows (update rowIndex in remaining rows)\r\n      rowsOrder.value.forEach((id, idx) => {\r\n        const row = rowsMap.value.get(id)\r\n        if (row) {\r\n          row.rowIndex = idx\r\n        }\r\n      })\r\n\r\n      console.log('[dataGridStore] deleteRow complete:', {\r\n        rowsAfter: rowsOrder.value.length\r\n      })\r\n    } else {\r\n      console.warn('[dataGridStore] deleteRow: row not found', { rowId })\r\n    }\r\n  }\r\n\r\n  //  RIEENIE E: insertRow using Map - O(n) only for indexOf on string[]\r\n  function insertRow(afterRowId: string) {\r\n    const index = rowsOrder.value.indexOf(afterRowId)  //  O(n) but on string[] (fast)\r\n    const newRowId = generateULID()\r\n\r\n    console.log('[dataGridStore] insertRow:', {\r\n      afterRowId,\r\n      index,\r\n      newRowId,\r\n      rowsBefore: rowsOrder.value.length\r\n    })\r\n\r\n    const newRow: GridRow = {\r\n      rowId: newRowId,\r\n      rowIndex: index + 1,\r\n      height: 32,\r\n      cells: columns.value\r\n        .filter(col => !col.specialType)\r\n        .map(col => ({\r\n          rowId: newRowId,\r\n          columnName: col.name,\r\n          value: null,\r\n          isSelected: false,\r\n          isValidationError: false\r\n        }))\r\n    }\r\n\r\n    rowsMap.value.set(newRowId, newRow)  //  O(1) insert into Map\r\n    rowsOrder.value.splice(index + 1, 0, newRowId)  //  O(1) insert into order array\r\n\r\n    // Reindex rows\r\n    rowsOrder.value.forEach((id, idx) => {\r\n      const row = rowsMap.value.get(id)\r\n      if (row) {\r\n        row.rowIndex = idx\r\n      }\r\n    })\r\n\r\n    console.log('[dataGridStore] insertRow complete:', {\r\n      rowsAfter: rowsOrder.value.length\r\n    })\r\n  }\r\n\r\n  //  RIEENIE E: insertMultipleRows using Map\r\n  function insertMultipleRows(rowId: string, count: number, position: 'above' | 'below') {\r\n    const index = rowsOrder.value.indexOf(rowId)\r\n    if (index === -1) {\r\n      console.warn('[dataGridStore] insertMultipleRows: row not found', { rowId })\r\n      return\r\n    }\r\n\r\n    console.log('[dataGridStore] insertMultipleRows:', {\r\n      rowId,\r\n      count,\r\n      position,\r\n      index,\r\n      rowsBefore: rowsOrder.value.length\r\n    })\r\n\r\n    const insertIndex = position === 'above' ? index : index + 1\r\n    const newRowIds: string[] = []\r\n\r\n    for (let i = 0; i < count; i++) {\r\n      const newRowId = generateULID()\r\n      const newRow: GridRow = {\r\n        rowId: newRowId,\r\n        rowIndex: insertIndex + i,\r\n        height: 32,\r\n        cells: columns.value\r\n          .filter(col => !col.specialType)\r\n          .map(col => ({\r\n            rowId: newRowId,\r\n            columnName: col.name,\r\n            value: null,\r\n            isSelected: false,\r\n            isValidationError: false\r\n          }))\r\n      }\r\n\r\n      rowsMap.value.set(newRowId, newRow)  //  O(1) per row\r\n      newRowIds.push(newRowId)\r\n    }\r\n\r\n    rowsOrder.value.splice(insertIndex, 0, ...newRowIds)  //  O(n) splice on string[]\r\n\r\n    // Reindex rows\r\n    rowsOrder.value.forEach((id, idx) => {\r\n      const row = rowsMap.value.get(id)\r\n      if (row) {\r\n        row.rowIndex = idx\r\n      }\r\n    })\r\n\r\n    console.log('[dataGridStore] insertMultipleRows complete:', {\r\n      rowsAfter: rowsOrder.value.length,\r\n      newRowIds\r\n    })\r\n  }\r\n\r\n  function toggleCheckbox(rowId: string, checked: boolean) {\r\n    console.log('[toggleCheckbox] Called:', { rowId, checked, currentCount: checkedRows.value.length })\r\n    if (checked) {\r\n      if (!checkedRows.value.includes(rowId)) {\r\n        checkedRows.value.push(rowId)\r\n      }\r\n    } else {\r\n      const index = checkedRows.value.indexOf(rowId)\r\n      if (index > -1) {\r\n        checkedRows.value.splice(index, 1)\r\n      }\r\n    }\r\n    console.log('[toggleCheckbox] After:', { count: checkedRows.value.length, checkboxState: checkboxState.value })\r\n  }\r\n\r\n  function isRowChecked(rowId: string): boolean {\r\n    return checkedRows.value.includes(rowId)\r\n  }\r\n\r\n  function toggleAllCheckboxes() {\r\n    const currentCount = checkedRows.value.length\r\n    const totalCount = rows.value.length\r\n    console.log('[toggleAllCheckboxes] BEFORE:', { currentCount, totalCount, checkboxState: checkboxState.value })\r\n\r\n    if (checkedRows.value.length === rows.value.length) {\r\n      // All checked -> uncheck all\r\n      console.log('[toggleAllCheckboxes] ACTION: Unchecking all (was all checked)')\r\n      checkedRows.value = []\r\n    } else {\r\n      // Not all checked -> check all\r\n      console.log('[toggleAllCheckboxes] ACTION: Checking all (was not all checked)')\r\n      checkedRows.value = rows.value.map(r => r.rowId)\r\n    }\r\n\r\n    const newCount = checkedRows.value.length\r\n    const newState = checkboxState.value\r\n    console.log('[toggleAllCheckboxes] AFTER:', { newCount, totalCount, newState })\r\n  }\r\n\r\n  // Computed for better reactivity tracking\r\n  const checkboxState = computed(() => {\r\n    const checkedCount = checkedRows.value.length\r\n    if (checkedCount === 0) return 'none'\r\n    if (checkedCount === rows.value.length) return 'all'\r\n    return 'some'\r\n  })\r\n\r\n  function setConfig(newConfig: Partial<GridConfig>) {\r\n    console.log('[dataGridStore] setConfig:', {\r\n      newConfig,\r\n      oldAutoValidate: config.value.autoValidate,\r\n      newAutoValidate: newConfig.autoValidate\r\n    })\r\n\r\n    config.value = { ...config.value, ...newConfig }\r\n    if (newConfig.pageSize) {\r\n      pageSize.value = newConfig.pageSize\r\n    }\r\n\r\n    console.log('[dataGridStore] setConfig complete:', {\r\n      autoValidate: config.value.autoValidate,\r\n      enableValidation: config.value.enableValidation\r\n    })\r\n  }\r\n\r\n  function initializeEmptyRows(count?: number) {\r\n    const rowCount = count || pageSize.value\r\n    console.log('[dataGridStore] initializeEmptyRows:', {\r\n      requestedCount: count,\r\n      rowCount,\r\n      currentRowsLength: rows.value.length,\r\n      columnsLength: columns.value.length\r\n    })\r\n\r\n    //  Use Map-based storage like loadRows()\r\n    const newMap = new Map<string, GridRow>()\r\n    const newOrder: string[] = []\r\n\r\n    for (let i = 0; i < rowCount; i++) {\r\n      const rowId = generateULID()\r\n      const row: GridRow = {\r\n        rowId,\r\n        rowIndex: i,\r\n        height: 32,\r\n        cells: columns.value\r\n          .filter(col => !col.specialType) // Don't create cells for special columns\r\n          .map(col => ({\r\n            rowId,\r\n            columnName: col.name,\r\n            value: null,\r\n            isSelected: false,\r\n            isValidationError: false\r\n          }))\r\n      }\r\n\r\n      newMap.set(rowId, row)\r\n      newOrder.push(rowId)\r\n    }\r\n\r\n    //  CORRECT: Update rowsMap and rowsOrder (not the computed property 'rows')\r\n    rowsMap.value = newMap\r\n    rowsOrder.value = newOrder\r\n\r\n    console.log('[dataGridStore] initializeEmptyRows complete:', {\r\n      newRowsLength: rows.value.length,\r\n      firstRowCellsCount: rows.value[0]?.cells?.length\r\n    })\r\n  }\r\n\r\n  function setFilter(filter: FilterExpression | null) {\r\n    console.log('[dataGridStore] setFilter:', { filter })\r\n    filterExpression.value = filter\r\n  }\r\n\r\n  function clearFilter() {\r\n    console.log('[dataGridStore] clearFilter')\r\n    filterExpression.value = null\r\n  }\r\n\r\n  function setSearchQuery(query: string) {\r\n    searchQuery.value = query\r\n  }\r\n\r\n  function clearSearch() {\r\n    searchQuery.value = ''\r\n  }\r\n\r\n  // Selection methods (based on WinUI3 patterns)\r\n  function selectCell(rowId: string, columnName: string, isCtrlPressed: boolean) {\r\n    const cellKey = `${rowId}:${columnName}`\r\n\r\n    console.log('[dataGridStore] selectCell:', {\r\n      rowId,\r\n      columnName,\r\n      isCtrlPressed,\r\n      wasSelected: selectedCells.value.has(cellKey),\r\n      currentSelectionCount: selectedCells.value.size\r\n    })\r\n\r\n    if (isCtrlPressed) {\r\n      // Ctrl+Click: Toggle selection\r\n      wasCtrlPressed.value = true\r\n      pressedCell.value = null // Disable drag for Ctrl+Click\r\n      isDragging.value = false\r\n\r\n      if (selectedCells.value.has(cellKey)) {\r\n        selectedCells.value.delete(cellKey)\r\n        console.log('[dataGridStore] selectCell: toggled OFF', { cellKey })\r\n      } else {\r\n        selectedCells.value.add(cellKey)\r\n        console.log('[dataGridStore] selectCell: toggled ON', { cellKey })\r\n      }\r\n    } else {\r\n      // Normal Click: Clear previous selection and select this cell\r\n      wasCtrlPressed.value = false\r\n      pressedCell.value = { rowId, columnName } // Enable drag selection\r\n      isDragging.value = false\r\n\r\n      selectedCells.value.clear()\r\n      selectedCells.value.add(cellKey)\r\n      console.log('[dataGridStore] selectCell: single select', { cellKey })\r\n    }\r\n\r\n    console.log('[dataGridStore] selectCell complete:', {\r\n      newSelectionCount: selectedCells.value.size\r\n    })\r\n  }\r\n\r\n  function startDragSelection(rowId: string, columnName: string) {\r\n    if (!pressedCell.value) return\r\n\r\n    isDragging.value = true\r\n\r\n    // Clear previous selection and select range from pressedCell to current cell\r\n    selectedCells.value.clear()\r\n    expandDragSelection(rowId, columnName)\r\n  }\r\n\r\n  function expandDragSelection(currentRowId: string, currentColumnName: string) {\r\n    if (!pressedCell.value || !isDragging.value) return\r\n\r\n    console.log('[dataGridStore] expandDragSelection:', {\r\n      pressedCell: pressedCell.value,\r\n      currentRowId,\r\n      currentColumnName\r\n    })\r\n\r\n    const pressedRowIndex = rows.value.findIndex(r => r.rowId === pressedCell.value!.rowId)\r\n    const currentRowIndex = rows.value.findIndex(r => r.rowId === currentRowId)\r\n\r\n    if (pressedRowIndex === -1 || currentRowIndex === -1) return\r\n\r\n    // Get selectable column names (data columns + validation, excluding insert/delete/checkbox/rownumber)\r\n    const selectableColumns = columns.value.filter(col =>\r\n      !col.specialType || col.specialType === 'ValidationAlerts'\r\n    ).map(col => col.name)\r\n\r\n    console.log('[dataGridStore] expandDragSelection: selectableColumns', {\r\n      total: selectableColumns.length,\r\n      columns: selectableColumns\r\n    })\r\n\r\n    const pressedColIndex = selectableColumns.indexOf(pressedCell.value.columnName)\r\n    const currentColIndex = selectableColumns.indexOf(currentColumnName)\r\n\r\n    if (pressedColIndex === -1 || currentColIndex === -1) {\r\n      console.warn('[dataGridStore] expandDragSelection: column not found in selectableColumns', {\r\n        pressedColumn: pressedCell.value.columnName,\r\n        currentColumn: currentColumnName,\r\n        pressedColIndex,\r\n        currentColIndex\r\n      })\r\n      return\r\n    }\r\n\r\n    // Calculate rectangular selection bounds\r\n    const startRowIndex = Math.min(pressedRowIndex, currentRowIndex)\r\n    const endRowIndex = Math.max(pressedRowIndex, currentRowIndex)\r\n    const startColIndex = Math.min(pressedColIndex, currentColIndex)\r\n    const endColIndex = Math.max(pressedColIndex, currentColIndex)\r\n\r\n    console.log('[dataGridStore] expandDragSelection: bounds', {\r\n      rowRange: [startRowIndex, endRowIndex],\r\n      colRange: [startColIndex, endColIndex],\r\n      cellsToSelect: (endRowIndex - startRowIndex + 1) * (endColIndex - startColIndex + 1)\r\n    })\r\n\r\n    // Clear and select all cells in the rectangular range\r\n    selectedCells.value.clear()\r\n    for (let rowIdx = startRowIndex; rowIdx <= endRowIndex; rowIdx++) {\r\n      const rowId = rows.value[rowIdx].rowId\r\n      for (let colIdx = startColIndex; colIdx <= endColIndex; colIdx++) {\r\n        const columnName = selectableColumns[colIdx]\r\n        const cellKey = `${rowId}:${columnName}`\r\n        selectedCells.value.add(cellKey)\r\n      }\r\n    }\r\n\r\n    console.log('[dataGridStore] expandDragSelection complete:', {\r\n      selectedCellsCount: selectedCells.value.size\r\n    })\r\n  }\r\n\r\n  function endDragSelection() {\r\n    pressedCell.value = null\r\n    isDragging.value = false\r\n  }\r\n\r\n  function isCellSelected(rowId: string, columnName: string): boolean {\r\n    const cellKey = `${rowId}:${columnName}`\r\n    return selectedCells.value.has(cellKey)\r\n  }\r\n\r\n  /**\r\n   * Reserved special column names that cannot be used for data columns\r\n   */\r\n  const SPECIAL_COLUMN_NAMES = [\r\n    '__rowNumber',\r\n    '__checkbox',\r\n    '__validationAlerts',\r\n    '__deleteRow',\r\n    '__insertRow'\r\n  ]\r\n\r\n  /**\r\n   * Sets columns with validation and duplicate name handling\r\n   * @throws Error if any column name conflicts with special column names\r\n   */\r\n  function setColumns(inputColumns: GridColumn[]) {\r\n    // Check for conflicts with special column names\r\n    const conflicts = inputColumns\r\n      .filter(col => !col.specialType) // Only check data columns\r\n      .filter(col => SPECIAL_COLUMN_NAMES.includes(col.name))\r\n      .map(col => col.name)\r\n\r\n    if (conflicts.length > 0) {\r\n      throw new Error(\r\n        `Column name conflict: The following column names are reserved for special columns and cannot be used: ${conflicts.join(', ')}. ` +\r\n        `Reserved names: ${SPECIAL_COLUMN_NAMES.join(', ')}`\r\n      )\r\n    }\r\n\r\n    // Ensure unique column names (rename duplicates)\r\n    const uniqueColumns = ensureUniqueColumnNames(inputColumns)\r\n    columns.value = uniqueColumns\r\n\r\n    console.log('[dataGridStore] setColumns:', {\r\n      originalCount: inputColumns.length,\r\n      uniqueCount: uniqueColumns.length,\r\n      columnNames: uniqueColumns.map(c => c.name)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Ensures all column names are unique by appending _1, _2, _3 etc. to duplicates\r\n   * Example: [priezvisko, meno, priezvisko, mesto, priezvisko]\r\n   *       -> [priezvisko_1, meno, priezvisko_2, mesto, priezvisko_3]\r\n   */\r\n  function ensureUniqueColumnNames(inputColumns: GridColumn[]): GridColumn[] {\r\n    const nameCounts = new Map<string, number>()\r\n\r\n    return inputColumns.map(col => {\r\n      const originalName = col.name\r\n      const count = nameCounts.get(originalName) || 0\r\n      nameCounts.set(originalName, count + 1)\r\n\r\n      if (count > 0) {\r\n        // This is a duplicate - append _N\r\n        return {\r\n          ...col,\r\n          name: `${originalName}_${count + 1}`\r\n        }\r\n      }\r\n\r\n      // First occurrence - keep original name but mark it as _1 if there will be duplicates\r\n      return col\r\n    }).map((col, index, arr) => {\r\n      const originalName = col.name.replace(/_\\d+$/, '') // Remove any _N suffix\r\n      const duplicateCount = arr.filter(c =>\r\n        c.name === originalName || c.name.startsWith(`${originalName}_`)\r\n      ).length\r\n\r\n      if (duplicateCount > 1 && col.name === originalName) {\r\n        // First occurrence of a duplicate - rename to _1\r\n        return { ...col, name: `${originalName}_1` }\r\n      }\r\n\r\n      return col\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Checks if all non-empty rows have valid cells (no validation errors)\r\n   * A row is considered empty if ALL its cells are null/empty\r\n   * Returns true if all non-empty rows are valid\r\n   */\r\n  function areNonEmptyRowsValid(): boolean {\r\n    for (const row of rows.value) {\r\n      // Check if row is empty (all cells null/empty)\r\n      const isEmpty = row.cells.every(cell =>\r\n        cell.value === null ||\r\n        cell.value === undefined ||\r\n        cell.value === ''\r\n      )\r\n\r\n      if (isEmpty) {\r\n        continue // Skip empty rows\r\n      }\r\n\r\n      // Row is not empty - check if any cell has validation error\r\n      const hasError = row.cells.some(cell => cell.isValidationError)\r\n\r\n      if (hasError) {\r\n        return false // Found a non-empty row with validation error\r\n      }\r\n    }\r\n\r\n    return true // All non-empty rows are valid\r\n  }\r\n\r\n  /**\r\n   * Marks a cell as validated\r\n   */\r\n  function markCellValidated(rowId: string, columnName: string) {\r\n    const cellKey = `${rowId}:${columnName}`\r\n    console.log('[dataGridStore] markCellValidated:', {\r\n      rowId,\r\n      columnName,\r\n      cellKey,\r\n      validatedCount: validatedCells.value.size\r\n    })\r\n    validatedCells.value.add(cellKey)\r\n    changedCellsSinceValidation.value.delete(cellKey)\r\n  }\r\n\r\n  /**\r\n   * Clears all validation tracking (e.g., when loading new data)\r\n   */\r\n  function clearValidationTracking() {\r\n    console.log('[dataGridStore] clearValidationTracking:', {\r\n      clearedValidatedCount: validatedCells.value.size,\r\n      clearedChangedCount: changedCellsSinceValidation.value.size\r\n    })\r\n    validatedCells.value.clear()\r\n    changedCellsSinceValidation.value.clear()\r\n  }\r\n\r\n  /**\r\n   * Gets cells that need validation (unvalidated or changed since last validation)\r\n   * SOLUTION 2: Enhanced logging to debug validation tracking\r\n   */\r\n  function getCellsNeedingValidation(): { rowId: string; columnName: string }[] {\r\n    console.log('[getCellsNeedingValidation]  START', {\r\n      totalRows: rows.value.length,\r\n      validatedCellsCount: validatedCells.value.size,\r\n      changedCellsCount: changedCellsSinceValidation.value.size\r\n    })\r\n\r\n    // Get columns that should be validated (visibleForGrid !== false)\r\n    const columnsToValidate = new Set(\r\n      columns.value\r\n        .filter(col => col.visibleForGrid !== false)\r\n        .map(col => col.name)\r\n    )\r\n\r\n    const cellsToValidate: { rowId: string; columnName: string }[] = []\r\n    let emptyRowsSkipped = 0\r\n    let alreadyValidatedCells = 0\r\n    let changedCells = 0\r\n    let neverValidatedCells = 0\r\n    let skippedInvisibleCells = 0\r\n\r\n    for (const row of rows.value) {\r\n      // Skip empty rows\r\n      const isEmpty = row.cells.every(cell =>\r\n        cell.value === null ||\r\n        cell.value === undefined ||\r\n        cell.value === ''\r\n      )\r\n\r\n      if (isEmpty) {\r\n        emptyRowsSkipped++\r\n        continue\r\n      }\r\n\r\n      for (const cell of row.cells) {\r\n        // Skip cells for columns with visibleForGrid=false\r\n        if (!columnsToValidate.has(cell.columnName)) {\r\n          skippedInvisibleCells++\r\n          continue\r\n        }\r\n\r\n        const cellKey = `${cell.rowId}:${cell.columnName}`\r\n        const isValidated = validatedCells.value.has(cellKey)\r\n        const isChanged = changedCellsSinceValidation.value.has(cellKey)\r\n\r\n        // Need validation if: not validated yet OR changed since last validation\r\n        if (!isValidated || isChanged) {\r\n          cellsToValidate.push({\r\n            rowId: cell.rowId,\r\n            columnName: cell.columnName\r\n          })\r\n\r\n          // Track reason for validation\r\n          if (!isValidated) {\r\n            neverValidatedCells++\r\n          } else if (isChanged) {\r\n            changedCells++\r\n          }\r\n        } else {\r\n          alreadyValidatedCells++\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('[getCellsNeedingValidation]  RESULT:', {\r\n      cellsToValidate: cellsToValidate.length,\r\n      neverValidated: neverValidatedCells,\r\n      changedSinceValidation: changedCells,\r\n      alreadyValidated: alreadyValidatedCells,\r\n      emptyRowsSkipped: emptyRowsSkipped,\r\n      sampleCells: cellsToValidate.slice(0, 3).map(c => `${c.rowId}:${c.columnName}`)\r\n    })\r\n\r\n    return cellsToValidate\r\n  }\r\n\r\n  return {\r\n    // State\r\n    rows,\r\n    columns,\r\n    selectedCells,\r\n    checkedRows,\r\n    pageSize,\r\n    currentPage,\r\n    sortColumns,\r\n    filterExpression,\r\n    searchQuery,\r\n    searchResults,\r\n    config,\r\n    pressedCell,\r\n    isDragging,\r\n    wasCtrlPressed,\r\n    isAutoRowHeightEnabled,\r\n\r\n    // Computed\r\n    visibleRows,\r\n    totalRows,\r\n    totalPages,\r\n    checkboxState,\r\n\r\n    // Actions\r\n    loadRows,\r\n    updateCell,\r\n    updateRowHeight,\r\n    setAutoRowHeightEnabled,\r\n    addSort,\r\n    clearSort,\r\n    setPageSize,\r\n    goToPage,\r\n    deleteRow,\r\n    insertRow,\r\n    insertMultipleRows,\r\n    toggleCheckbox,\r\n    isRowChecked,\r\n    toggleAllCheckboxes,\r\n    setConfig,\r\n    initializeEmptyRows,\r\n    setFilter,\r\n    clearFilter,\r\n    setSearchQuery,\r\n    clearSearch,\r\n    selectCell,\r\n    startDragSelection,\r\n    expandDragSelection,\r\n    endDragSelection,\r\n    isCellSelected,\r\n    setColumns,\r\n    ensureUniqueColumnNames,\r\n    areNonEmptyRowsValid,\r\n    markCellValidated,\r\n    clearValidationTracking,\r\n    getCellsNeedingValidation\r\n  }\r\n})\r\n}\r\n","import { shallowRef, watchEffect, readonly, ref, watch, customRef, getCurrentScope, onScopeDispose, effectScope, getCurrentInstance, provide, inject, isVue3, version, isRef, unref, computed, reactive, toRefs as toRefs$1, toRef as toRef$1, isVue2, set as set$1, onBeforeMount, nextTick, onBeforeUnmount, onMounted, onUnmounted, isReactive } from 'vue-demi';\n\nfunction computedEager(fn, options) {\n  var _a;\n  const result = shallowRef();\n  watchEffect(() => {\n    result.value = fn();\n  }, {\n    ...options,\n    flush: (_a = options == null ? void 0 : options.flush) != null ? _a : \"sync\"\n  });\n  return readonly(result);\n}\n\nfunction computedWithControl(source, fn) {\n  let v = void 0;\n  let track;\n  let trigger;\n  const dirty = ref(true);\n  const update = () => {\n    dirty.value = true;\n    trigger();\n  };\n  watch(source, update, { flush: \"sync\" });\n  const get = typeof fn === \"function\" ? fn : fn.get;\n  const set = typeof fn === \"function\" ? void 0 : fn.set;\n  const result = customRef((_track, _trigger) => {\n    track = _track;\n    trigger = _trigger;\n    return {\n      get() {\n        if (dirty.value) {\n          v = get();\n          dirty.value = false;\n        }\n        track();\n        return v;\n      },\n      set(v2) {\n        set == null ? void 0 : set(v2);\n      }\n    };\n  });\n  if (Object.isExtensible(result))\n    result.trigger = update;\n  return result;\n}\n\nfunction tryOnScopeDispose(fn) {\n  if (getCurrentScope()) {\n    onScopeDispose(fn);\n    return true;\n  }\n  return false;\n}\n\nfunction createEventHook() {\n  const fns = /* @__PURE__ */ new Set();\n  const off = (fn) => {\n    fns.delete(fn);\n  };\n  const on = (fn) => {\n    fns.add(fn);\n    const offFn = () => off(fn);\n    tryOnScopeDispose(offFn);\n    return {\n      off: offFn\n    };\n  };\n  const trigger = (...args) => {\n    return Promise.all(Array.from(fns).map((fn) => fn(...args)));\n  };\n  return {\n    on,\n    off,\n    trigger\n  };\n}\n\nfunction createGlobalState(stateFactory) {\n  let initialized = false;\n  let state;\n  const scope = effectScope(true);\n  return (...args) => {\n    if (!initialized) {\n      state = scope.run(() => stateFactory(...args));\n      initialized = true;\n    }\n    return state;\n  };\n}\n\nconst localProvidedStateMap = /* @__PURE__ */ new WeakMap();\n\nconst provideLocal = (key, value) => {\n  var _a;\n  const instance = (_a = getCurrentInstance()) == null ? void 0 : _a.proxy;\n  if (instance == null)\n    throw new Error(\"provideLocal must be called in setup\");\n  if (!localProvidedStateMap.has(instance))\n    localProvidedStateMap.set(instance, /* @__PURE__ */ Object.create(null));\n  const localProvidedState = localProvidedStateMap.get(instance);\n  localProvidedState[key] = value;\n  provide(key, value);\n};\n\nconst injectLocal = (...args) => {\n  var _a;\n  const key = args[0];\n  const instance = (_a = getCurrentInstance()) == null ? void 0 : _a.proxy;\n  if (instance == null)\n    throw new Error(\"injectLocal must be called in setup\");\n  if (localProvidedStateMap.has(instance) && key in localProvidedStateMap.get(instance))\n    return localProvidedStateMap.get(instance)[key];\n  return inject(...args);\n};\n\nfunction createInjectionState(composable, options) {\n  const key = (options == null ? void 0 : options.injectionKey) || Symbol(composable.name || \"InjectionState\");\n  const defaultValue = options == null ? void 0 : options.defaultValue;\n  const useProvidingState = (...args) => {\n    const state = composable(...args);\n    provideLocal(key, state);\n    return state;\n  };\n  const useInjectedState = () => injectLocal(key, defaultValue);\n  return [useProvidingState, useInjectedState];\n}\n\nfunction createSharedComposable(composable) {\n  let subscribers = 0;\n  let state;\n  let scope;\n  const dispose = () => {\n    subscribers -= 1;\n    if (scope && subscribers <= 0) {\n      scope.stop();\n      state = void 0;\n      scope = void 0;\n    }\n  };\n  return (...args) => {\n    subscribers += 1;\n    if (!state) {\n      scope = effectScope(true);\n      state = scope.run(() => composable(...args));\n    }\n    tryOnScopeDispose(dispose);\n    return state;\n  };\n}\n\nfunction extendRef(ref, extend, { enumerable = false, unwrap = true } = {}) {\n  if (!isVue3 && !version.startsWith(\"2.7.\")) {\n    if (process.env.NODE_ENV !== \"production\")\n      throw new Error(\"[VueUse] extendRef only works in Vue 2.7 or above.\");\n    return;\n  }\n  for (const [key, value] of Object.entries(extend)) {\n    if (key === \"value\")\n      continue;\n    if (isRef(value) && unwrap) {\n      Object.defineProperty(ref, key, {\n        get() {\n          return value.value;\n        },\n        set(v) {\n          value.value = v;\n        },\n        enumerable\n      });\n    } else {\n      Object.defineProperty(ref, key, { value, enumerable });\n    }\n  }\n  return ref;\n}\n\nfunction get(obj, key) {\n  if (key == null)\n    return unref(obj);\n  return unref(obj)[key];\n}\n\nfunction isDefined(v) {\n  return unref(v) != null;\n}\n\nfunction makeDestructurable(obj, arr) {\n  if (typeof Symbol !== \"undefined\") {\n    const clone = { ...obj };\n    Object.defineProperty(clone, Symbol.iterator, {\n      enumerable: false,\n      value() {\n        let index = 0;\n        return {\n          next: () => ({\n            value: arr[index++],\n            done: index > arr.length\n          })\n        };\n      }\n    });\n    return clone;\n  } else {\n    return Object.assign([...arr], obj);\n  }\n}\n\nfunction toValue(r) {\n  return typeof r === \"function\" ? r() : unref(r);\n}\nconst resolveUnref = toValue;\n\nfunction reactify(fn, options) {\n  const unrefFn = (options == null ? void 0 : options.computedGetter) === false ? unref : toValue;\n  return function(...args) {\n    return computed(() => fn.apply(this, args.map((i) => unrefFn(i))));\n  };\n}\n\nfunction reactifyObject(obj, optionsOrKeys = {}) {\n  let keys = [];\n  let options;\n  if (Array.isArray(optionsOrKeys)) {\n    keys = optionsOrKeys;\n  } else {\n    options = optionsOrKeys;\n    const { includeOwnProperties = true } = optionsOrKeys;\n    keys.push(...Object.keys(obj));\n    if (includeOwnProperties)\n      keys.push(...Object.getOwnPropertyNames(obj));\n  }\n  return Object.fromEntries(\n    keys.map((key) => {\n      const value = obj[key];\n      return [\n        key,\n        typeof value === \"function\" ? reactify(value.bind(obj), options) : value\n      ];\n    })\n  );\n}\n\nfunction toReactive(objectRef) {\n  if (!isRef(objectRef))\n    return reactive(objectRef);\n  const proxy = new Proxy({}, {\n    get(_, p, receiver) {\n      return unref(Reflect.get(objectRef.value, p, receiver));\n    },\n    set(_, p, value) {\n      if (isRef(objectRef.value[p]) && !isRef(value))\n        objectRef.value[p].value = value;\n      else\n        objectRef.value[p] = value;\n      return true;\n    },\n    deleteProperty(_, p) {\n      return Reflect.deleteProperty(objectRef.value, p);\n    },\n    has(_, p) {\n      return Reflect.has(objectRef.value, p);\n    },\n    ownKeys() {\n      return Object.keys(objectRef.value);\n    },\n    getOwnPropertyDescriptor() {\n      return {\n        enumerable: true,\n        configurable: true\n      };\n    }\n  });\n  return reactive(proxy);\n}\n\nfunction reactiveComputed(fn) {\n  return toReactive(computed(fn));\n}\n\nfunction reactiveOmit(obj, ...keys) {\n  const flatKeys = keys.flat();\n  const predicate = flatKeys[0];\n  return reactiveComputed(() => typeof predicate === \"function\" ? Object.fromEntries(Object.entries(toRefs$1(obj)).filter(([k, v]) => !predicate(toValue(v), k))) : Object.fromEntries(Object.entries(toRefs$1(obj)).filter((e) => !flatKeys.includes(e[0]))));\n}\n\nconst isClient = typeof window !== \"undefined\" && typeof document !== \"undefined\";\nconst isWorker = typeof WorkerGlobalScope !== \"undefined\" && globalThis instanceof WorkerGlobalScope;\nconst isDef = (val) => typeof val !== \"undefined\";\nconst notNullish = (val) => val != null;\nconst assert = (condition, ...infos) => {\n  if (!condition)\n    console.warn(...infos);\n};\nconst toString = Object.prototype.toString;\nconst isObject = (val) => toString.call(val) === \"[object Object]\";\nconst now = () => Date.now();\nconst timestamp = () => +Date.now();\nconst clamp = (n, min, max) => Math.min(max, Math.max(min, n));\nconst noop = () => {\n};\nconst rand = (min, max) => {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\nconst hasOwn = (val, key) => Object.prototype.hasOwnProperty.call(val, key);\nconst isIOS = /* @__PURE__ */ getIsIOS();\nfunction getIsIOS() {\n  var _a, _b;\n  return isClient && ((_a = window == null ? void 0 : window.navigator) == null ? void 0 : _a.userAgent) && (/iP(?:ad|hone|od)/.test(window.navigator.userAgent) || ((_b = window == null ? void 0 : window.navigator) == null ? void 0 : _b.maxTouchPoints) > 2 && /iPad|Macintosh/.test(window == null ? void 0 : window.navigator.userAgent));\n}\n\nfunction createFilterWrapper(filter, fn) {\n  function wrapper(...args) {\n    return new Promise((resolve, reject) => {\n      Promise.resolve(filter(() => fn.apply(this, args), { fn, thisArg: this, args })).then(resolve).catch(reject);\n    });\n  }\n  return wrapper;\n}\nconst bypassFilter = (invoke) => {\n  return invoke();\n};\nfunction debounceFilter(ms, options = {}) {\n  let timer;\n  let maxTimer;\n  let lastRejector = noop;\n  const _clearTimeout = (timer2) => {\n    clearTimeout(timer2);\n    lastRejector();\n    lastRejector = noop;\n  };\n  const filter = (invoke) => {\n    const duration = toValue(ms);\n    const maxDuration = toValue(options.maxWait);\n    if (timer)\n      _clearTimeout(timer);\n    if (duration <= 0 || maxDuration !== void 0 && maxDuration <= 0) {\n      if (maxTimer) {\n        _clearTimeout(maxTimer);\n        maxTimer = null;\n      }\n      return Promise.resolve(invoke());\n    }\n    return new Promise((resolve, reject) => {\n      lastRejector = options.rejectOnCancel ? reject : resolve;\n      if (maxDuration && !maxTimer) {\n        maxTimer = setTimeout(() => {\n          if (timer)\n            _clearTimeout(timer);\n          maxTimer = null;\n          resolve(invoke());\n        }, maxDuration);\n      }\n      timer = setTimeout(() => {\n        if (maxTimer)\n          _clearTimeout(maxTimer);\n        maxTimer = null;\n        resolve(invoke());\n      }, duration);\n    });\n  };\n  return filter;\n}\nfunction throttleFilter(...args) {\n  let lastExec = 0;\n  let timer;\n  let isLeading = true;\n  let lastRejector = noop;\n  let lastValue;\n  let ms;\n  let trailing;\n  let leading;\n  let rejectOnCancel;\n  if (!isRef(args[0]) && typeof args[0] === \"object\")\n    ({ delay: ms, trailing = true, leading = true, rejectOnCancel = false } = args[0]);\n  else\n    [ms, trailing = true, leading = true, rejectOnCancel = false] = args;\n  const clear = () => {\n    if (timer) {\n      clearTimeout(timer);\n      timer = void 0;\n      lastRejector();\n      lastRejector = noop;\n    }\n  };\n  const filter = (_invoke) => {\n    const duration = toValue(ms);\n    const elapsed = Date.now() - lastExec;\n    const invoke = () => {\n      return lastValue = _invoke();\n    };\n    clear();\n    if (duration <= 0) {\n      lastExec = Date.now();\n      return invoke();\n    }\n    if (elapsed > duration && (leading || !isLeading)) {\n      lastExec = Date.now();\n      invoke();\n    } else if (trailing) {\n      lastValue = new Promise((resolve, reject) => {\n        lastRejector = rejectOnCancel ? reject : resolve;\n        timer = setTimeout(() => {\n          lastExec = Date.now();\n          isLeading = true;\n          resolve(invoke());\n          clear();\n        }, Math.max(0, duration - elapsed));\n      });\n    }\n    if (!leading && !timer)\n      timer = setTimeout(() => isLeading = true, duration);\n    isLeading = false;\n    return lastValue;\n  };\n  return filter;\n}\nfunction pausableFilter(extendFilter = bypassFilter) {\n  const isActive = ref(true);\n  function pause() {\n    isActive.value = false;\n  }\n  function resume() {\n    isActive.value = true;\n  }\n  const eventFilter = (...args) => {\n    if (isActive.value)\n      extendFilter(...args);\n  };\n  return { isActive: readonly(isActive), pause, resume, eventFilter };\n}\n\nconst directiveHooks = {\n  mounted: isVue3 ? \"mounted\" : \"inserted\",\n  updated: isVue3 ? \"updated\" : \"componentUpdated\",\n  unmounted: isVue3 ? \"unmounted\" : \"unbind\"\n};\n\nfunction cacheStringFunction(fn) {\n  const cache = /* @__PURE__ */ Object.create(null);\n  return (str) => {\n    const hit = cache[str];\n    return hit || (cache[str] = fn(str));\n  };\n}\nconst hyphenateRE = /\\B([A-Z])/g;\nconst hyphenate = cacheStringFunction((str) => str.replace(hyphenateRE, \"-$1\").toLowerCase());\nconst camelizeRE = /-(\\w)/g;\nconst camelize = cacheStringFunction((str) => {\n  return str.replace(camelizeRE, (_, c) => c ? c.toUpperCase() : \"\");\n});\n\nfunction promiseTimeout(ms, throwOnTimeout = false, reason = \"Timeout\") {\n  return new Promise((resolve, reject) => {\n    if (throwOnTimeout)\n      setTimeout(() => reject(reason), ms);\n    else\n      setTimeout(resolve, ms);\n  });\n}\nfunction identity(arg) {\n  return arg;\n}\nfunction createSingletonPromise(fn) {\n  let _promise;\n  function wrapper() {\n    if (!_promise)\n      _promise = fn();\n    return _promise;\n  }\n  wrapper.reset = async () => {\n    const _prev = _promise;\n    _promise = void 0;\n    if (_prev)\n      await _prev;\n  };\n  return wrapper;\n}\nfunction invoke(fn) {\n  return fn();\n}\nfunction containsProp(obj, ...props) {\n  return props.some((k) => k in obj);\n}\nfunction increaseWithUnit(target, delta) {\n  var _a;\n  if (typeof target === \"number\")\n    return target + delta;\n  const value = ((_a = target.match(/^-?\\d+\\.?\\d*/)) == null ? void 0 : _a[0]) || \"\";\n  const unit = target.slice(value.length);\n  const result = Number.parseFloat(value) + delta;\n  if (Number.isNaN(result))\n    return target;\n  return result + unit;\n}\nfunction objectPick(obj, keys, omitUndefined = false) {\n  return keys.reduce((n, k) => {\n    if (k in obj) {\n      if (!omitUndefined || obj[k] !== void 0)\n        n[k] = obj[k];\n    }\n    return n;\n  }, {});\n}\nfunction objectOmit(obj, keys, omitUndefined = false) {\n  return Object.fromEntries(Object.entries(obj).filter(([key, value]) => {\n    return (!omitUndefined || value !== void 0) && !keys.includes(key);\n  }));\n}\nfunction objectEntries(obj) {\n  return Object.entries(obj);\n}\nfunction getLifeCycleTarget(target) {\n  return target || getCurrentInstance();\n}\n\nfunction toRef(...args) {\n  if (args.length !== 1)\n    return toRef$1(...args);\n  const r = args[0];\n  return typeof r === \"function\" ? readonly(customRef(() => ({ get: r, set: noop }))) : ref(r);\n}\nconst resolveRef = toRef;\n\nfunction reactivePick(obj, ...keys) {\n  const flatKeys = keys.flat();\n  const predicate = flatKeys[0];\n  return reactiveComputed(() => typeof predicate === \"function\" ? Object.fromEntries(Object.entries(toRefs$1(obj)).filter(([k, v]) => predicate(toValue(v), k))) : Object.fromEntries(flatKeys.map((k) => [k, toRef(obj, k)])));\n}\n\nfunction refAutoReset(defaultValue, afterMs = 1e4) {\n  return customRef((track, trigger) => {\n    let value = toValue(defaultValue);\n    let timer;\n    const resetAfter = () => setTimeout(() => {\n      value = toValue(defaultValue);\n      trigger();\n    }, toValue(afterMs));\n    tryOnScopeDispose(() => {\n      clearTimeout(timer);\n    });\n    return {\n      get() {\n        track();\n        return value;\n      },\n      set(newValue) {\n        value = newValue;\n        trigger();\n        clearTimeout(timer);\n        timer = resetAfter();\n      }\n    };\n  });\n}\n\nfunction useDebounceFn(fn, ms = 200, options = {}) {\n  return createFilterWrapper(\n    debounceFilter(ms, options),\n    fn\n  );\n}\n\nfunction refDebounced(value, ms = 200, options = {}) {\n  const debounced = ref(value.value);\n  const updater = useDebounceFn(() => {\n    debounced.value = value.value;\n  }, ms, options);\n  watch(value, () => updater());\n  return debounced;\n}\n\nfunction refDefault(source, defaultValue) {\n  return computed({\n    get() {\n      var _a;\n      return (_a = source.value) != null ? _a : defaultValue;\n    },\n    set(value) {\n      source.value = value;\n    }\n  });\n}\n\nfunction useThrottleFn(fn, ms = 200, trailing = false, leading = true, rejectOnCancel = false) {\n  return createFilterWrapper(\n    throttleFilter(ms, trailing, leading, rejectOnCancel),\n    fn\n  );\n}\n\nfunction refThrottled(value, delay = 200, trailing = true, leading = true) {\n  if (delay <= 0)\n    return value;\n  const throttled = ref(value.value);\n  const updater = useThrottleFn(() => {\n    throttled.value = value.value;\n  }, delay, trailing, leading);\n  watch(value, () => updater());\n  return throttled;\n}\n\nfunction refWithControl(initial, options = {}) {\n  let source = initial;\n  let track;\n  let trigger;\n  const ref = customRef((_track, _trigger) => {\n    track = _track;\n    trigger = _trigger;\n    return {\n      get() {\n        return get();\n      },\n      set(v) {\n        set(v);\n      }\n    };\n  });\n  function get(tracking = true) {\n    if (tracking)\n      track();\n    return source;\n  }\n  function set(value, triggering = true) {\n    var _a, _b;\n    if (value === source)\n      return;\n    const old = source;\n    if (((_a = options.onBeforeChange) == null ? void 0 : _a.call(options, value, old)) === false)\n      return;\n    source = value;\n    (_b = options.onChanged) == null ? void 0 : _b.call(options, value, old);\n    if (triggering)\n      trigger();\n  }\n  const untrackedGet = () => get(false);\n  const silentSet = (v) => set(v, false);\n  const peek = () => get(false);\n  const lay = (v) => set(v, false);\n  return extendRef(\n    ref,\n    {\n      get,\n      set,\n      untrackedGet,\n      silentSet,\n      peek,\n      lay\n    },\n    { enumerable: true }\n  );\n}\nconst controlledRef = refWithControl;\n\nfunction set(...args) {\n  if (args.length === 2) {\n    const [ref, value] = args;\n    ref.value = value;\n  }\n  if (args.length === 3) {\n    if (isVue2) {\n      set$1(...args);\n    } else {\n      const [target, key, value] = args;\n      target[key] = value;\n    }\n  }\n}\n\nfunction watchWithFilter(source, cb, options = {}) {\n  const {\n    eventFilter = bypassFilter,\n    ...watchOptions\n  } = options;\n  return watch(\n    source,\n    createFilterWrapper(\n      eventFilter,\n      cb\n    ),\n    watchOptions\n  );\n}\n\nfunction watchPausable(source, cb, options = {}) {\n  const {\n    eventFilter: filter,\n    ...watchOptions\n  } = options;\n  const { eventFilter, pause, resume, isActive } = pausableFilter(filter);\n  const stop = watchWithFilter(\n    source,\n    cb,\n    {\n      ...watchOptions,\n      eventFilter\n    }\n  );\n  return { stop, pause, resume, isActive };\n}\n\nfunction syncRef(left, right, ...[options]) {\n  const {\n    flush = \"sync\",\n    deep = false,\n    immediate = true,\n    direction = \"both\",\n    transform = {}\n  } = options || {};\n  const watchers = [];\n  const transformLTR = \"ltr\" in transform && transform.ltr || ((v) => v);\n  const transformRTL = \"rtl\" in transform && transform.rtl || ((v) => v);\n  if (direction === \"both\" || direction === \"ltr\") {\n    watchers.push(watchPausable(\n      left,\n      (newValue) => {\n        watchers.forEach((w) => w.pause());\n        right.value = transformLTR(newValue);\n        watchers.forEach((w) => w.resume());\n      },\n      { flush, deep, immediate }\n    ));\n  }\n  if (direction === \"both\" || direction === \"rtl\") {\n    watchers.push(watchPausable(\n      right,\n      (newValue) => {\n        watchers.forEach((w) => w.pause());\n        left.value = transformRTL(newValue);\n        watchers.forEach((w) => w.resume());\n      },\n      { flush, deep, immediate }\n    ));\n  }\n  const stop = () => {\n    watchers.forEach((w) => w.stop());\n  };\n  return stop;\n}\n\nfunction syncRefs(source, targets, options = {}) {\n  const {\n    flush = \"sync\",\n    deep = false,\n    immediate = true\n  } = options;\n  if (!Array.isArray(targets))\n    targets = [targets];\n  return watch(\n    source,\n    (newValue) => targets.forEach((target) => target.value = newValue),\n    { flush, deep, immediate }\n  );\n}\n\nfunction toRefs(objectRef, options = {}) {\n  if (!isRef(objectRef))\n    return toRefs$1(objectRef);\n  const result = Array.isArray(objectRef.value) ? Array.from({ length: objectRef.value.length }) : {};\n  for (const key in objectRef.value) {\n    result[key] = customRef(() => ({\n      get() {\n        return objectRef.value[key];\n      },\n      set(v) {\n        var _a;\n        const replaceRef = (_a = toValue(options.replaceRef)) != null ? _a : true;\n        if (replaceRef) {\n          if (Array.isArray(objectRef.value)) {\n            const copy = [...objectRef.value];\n            copy[key] = v;\n            objectRef.value = copy;\n          } else {\n            const newObject = { ...objectRef.value, [key]: v };\n            Object.setPrototypeOf(newObject, Object.getPrototypeOf(objectRef.value));\n            objectRef.value = newObject;\n          }\n        } else {\n          objectRef.value[key] = v;\n        }\n      }\n    }));\n  }\n  return result;\n}\n\nfunction tryOnBeforeMount(fn, sync = true, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onBeforeMount(fn, target);\n  else if (sync)\n    fn();\n  else\n    nextTick(fn);\n}\n\nfunction tryOnBeforeUnmount(fn, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onBeforeUnmount(fn, target);\n}\n\nfunction tryOnMounted(fn, sync = true, target) {\n  const instance = getLifeCycleTarget();\n  if (instance)\n    onMounted(fn, target);\n  else if (sync)\n    fn();\n  else\n    nextTick(fn);\n}\n\nfunction tryOnUnmounted(fn, target) {\n  const instance = getLifeCycleTarget(target);\n  if (instance)\n    onUnmounted(fn, target);\n}\n\nfunction createUntil(r, isNot = false) {\n  function toMatch(condition, { flush = \"sync\", deep = false, timeout, throwOnTimeout } = {}) {\n    let stop = null;\n    const watcher = new Promise((resolve) => {\n      stop = watch(\n        r,\n        (v) => {\n          if (condition(v) !== isNot) {\n            stop == null ? void 0 : stop();\n            resolve(v);\n          }\n        },\n        {\n          flush,\n          deep,\n          immediate: true\n        }\n      );\n    });\n    const promises = [watcher];\n    if (timeout != null) {\n      promises.push(\n        promiseTimeout(timeout, throwOnTimeout).then(() => toValue(r)).finally(() => stop == null ? void 0 : stop())\n      );\n    }\n    return Promise.race(promises);\n  }\n  function toBe(value, options) {\n    if (!isRef(value))\n      return toMatch((v) => v === value, options);\n    const { flush = \"sync\", deep = false, timeout, throwOnTimeout } = options != null ? options : {};\n    let stop = null;\n    const watcher = new Promise((resolve) => {\n      stop = watch(\n        [r, value],\n        ([v1, v2]) => {\n          if (isNot !== (v1 === v2)) {\n            stop == null ? void 0 : stop();\n            resolve(v1);\n          }\n        },\n        {\n          flush,\n          deep,\n          immediate: true\n        }\n      );\n    });\n    const promises = [watcher];\n    if (timeout != null) {\n      promises.push(\n        promiseTimeout(timeout, throwOnTimeout).then(() => toValue(r)).finally(() => {\n          stop == null ? void 0 : stop();\n          return toValue(r);\n        })\n      );\n    }\n    return Promise.race(promises);\n  }\n  function toBeTruthy(options) {\n    return toMatch((v) => Boolean(v), options);\n  }\n  function toBeNull(options) {\n    return toBe(null, options);\n  }\n  function toBeUndefined(options) {\n    return toBe(void 0, options);\n  }\n  function toBeNaN(options) {\n    return toMatch(Number.isNaN, options);\n  }\n  function toContains(value, options) {\n    return toMatch((v) => {\n      const array = Array.from(v);\n      return array.includes(value) || array.includes(toValue(value));\n    }, options);\n  }\n  function changed(options) {\n    return changedTimes(1, options);\n  }\n  function changedTimes(n = 1, options) {\n    let count = -1;\n    return toMatch(() => {\n      count += 1;\n      return count >= n;\n    }, options);\n  }\n  if (Array.isArray(toValue(r))) {\n    const instance = {\n      toMatch,\n      toContains,\n      changed,\n      changedTimes,\n      get not() {\n        return createUntil(r, !isNot);\n      }\n    };\n    return instance;\n  } else {\n    const instance = {\n      toMatch,\n      toBe,\n      toBeTruthy,\n      toBeNull,\n      toBeNaN,\n      toBeUndefined,\n      changed,\n      changedTimes,\n      get not() {\n        return createUntil(r, !isNot);\n      }\n    };\n    return instance;\n  }\n}\nfunction until(r) {\n  return createUntil(r);\n}\n\nfunction defaultComparator(value, othVal) {\n  return value === othVal;\n}\nfunction useArrayDifference(...args) {\n  var _a;\n  const list = args[0];\n  const values = args[1];\n  let compareFn = (_a = args[2]) != null ? _a : defaultComparator;\n  if (typeof compareFn === \"string\") {\n    const key = compareFn;\n    compareFn = (value, othVal) => value[key] === othVal[key];\n  }\n  return computed(() => toValue(list).filter((x) => toValue(values).findIndex((y) => compareFn(x, y)) === -1));\n}\n\nfunction useArrayEvery(list, fn) {\n  return computed(() => toValue(list).every((element, index, array) => fn(toValue(element), index, array)));\n}\n\nfunction useArrayFilter(list, fn) {\n  return computed(() => toValue(list).map((i) => toValue(i)).filter(fn));\n}\n\nfunction useArrayFind(list, fn) {\n  return computed(() => toValue(\n    toValue(list).find((element, index, array) => fn(toValue(element), index, array))\n  ));\n}\n\nfunction useArrayFindIndex(list, fn) {\n  return computed(() => toValue(list).findIndex((element, index, array) => fn(toValue(element), index, array)));\n}\n\nfunction findLast(arr, cb) {\n  let index = arr.length;\n  while (index-- > 0) {\n    if (cb(arr[index], index, arr))\n      return arr[index];\n  }\n  return void 0;\n}\nfunction useArrayFindLast(list, fn) {\n  return computed(() => toValue(\n    !Array.prototype.findLast ? findLast(toValue(list), (element, index, array) => fn(toValue(element), index, array)) : toValue(list).findLast((element, index, array) => fn(toValue(element), index, array))\n  ));\n}\n\nfunction isArrayIncludesOptions(obj) {\n  return isObject(obj) && containsProp(obj, \"formIndex\", \"comparator\");\n}\nfunction useArrayIncludes(...args) {\n  var _a;\n  const list = args[0];\n  const value = args[1];\n  let comparator = args[2];\n  let formIndex = 0;\n  if (isArrayIncludesOptions(comparator)) {\n    formIndex = (_a = comparator.fromIndex) != null ? _a : 0;\n    comparator = comparator.comparator;\n  }\n  if (typeof comparator === \"string\") {\n    const key = comparator;\n    comparator = (element, value2) => element[key] === toValue(value2);\n  }\n  comparator = comparator != null ? comparator : (element, value2) => element === toValue(value2);\n  return computed(() => toValue(list).slice(formIndex).some((element, index, array) => comparator(\n    toValue(element),\n    toValue(value),\n    index,\n    toValue(array)\n  )));\n}\n\nfunction useArrayJoin(list, separator) {\n  return computed(() => toValue(list).map((i) => toValue(i)).join(toValue(separator)));\n}\n\nfunction useArrayMap(list, fn) {\n  return computed(() => toValue(list).map((i) => toValue(i)).map(fn));\n}\n\nfunction useArrayReduce(list, reducer, ...args) {\n  const reduceCallback = (sum, value, index) => reducer(toValue(sum), toValue(value), index);\n  return computed(() => {\n    const resolved = toValue(list);\n    return args.length ? resolved.reduce(reduceCallback, toValue(args[0])) : resolved.reduce(reduceCallback);\n  });\n}\n\nfunction useArraySome(list, fn) {\n  return computed(() => toValue(list).some((element, index, array) => fn(toValue(element), index, array)));\n}\n\nfunction uniq(array) {\n  return Array.from(new Set(array));\n}\nfunction uniqueElementsBy(array, fn) {\n  return array.reduce((acc, v) => {\n    if (!acc.some((x) => fn(v, x, array)))\n      acc.push(v);\n    return acc;\n  }, []);\n}\nfunction useArrayUnique(list, compareFn) {\n  return computed(() => {\n    const resolvedList = toValue(list).map((element) => toValue(element));\n    return compareFn ? uniqueElementsBy(resolvedList, compareFn) : uniq(resolvedList);\n  });\n}\n\nfunction useCounter(initialValue = 0, options = {}) {\n  let _initialValue = unref(initialValue);\n  const count = ref(initialValue);\n  const {\n    max = Number.POSITIVE_INFINITY,\n    min = Number.NEGATIVE_INFINITY\n  } = options;\n  const inc = (delta = 1) => count.value = Math.max(Math.min(max, count.value + delta), min);\n  const dec = (delta = 1) => count.value = Math.min(Math.max(min, count.value - delta), max);\n  const get = () => count.value;\n  const set = (val) => count.value = Math.max(min, Math.min(max, val));\n  const reset = (val = _initialValue) => {\n    _initialValue = val;\n    return set(val);\n  };\n  return { count, inc, dec, get, set, reset };\n}\n\nconst REGEX_PARSE = /^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[T\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/i;\nconst REGEX_FORMAT = /[YMDHhms]o|\\[([^\\]]+)\\]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a{1,2}|A{1,2}|m{1,2}|s{1,2}|Z{1,2}|SSS/g;\nfunction defaultMeridiem(hours, minutes, isLowercase, hasPeriod) {\n  let m = hours < 12 ? \"AM\" : \"PM\";\n  if (hasPeriod)\n    m = m.split(\"\").reduce((acc, curr) => acc += `${curr}.`, \"\");\n  return isLowercase ? m.toLowerCase() : m;\n}\nfunction formatOrdinal(num) {\n  const suffixes = [\"th\", \"st\", \"nd\", \"rd\"];\n  const v = num % 100;\n  return num + (suffixes[(v - 20) % 10] || suffixes[v] || suffixes[0]);\n}\nfunction formatDate(date, formatStr, options = {}) {\n  var _a;\n  const years = date.getFullYear();\n  const month = date.getMonth();\n  const days = date.getDate();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const seconds = date.getSeconds();\n  const milliseconds = date.getMilliseconds();\n  const day = date.getDay();\n  const meridiem = (_a = options.customMeridiem) != null ? _a : defaultMeridiem;\n  const matches = {\n    Yo: () => formatOrdinal(years),\n    YY: () => String(years).slice(-2),\n    YYYY: () => years,\n    M: () => month + 1,\n    Mo: () => formatOrdinal(month + 1),\n    MM: () => `${month + 1}`.padStart(2, \"0\"),\n    MMM: () => date.toLocaleDateString(options.locales, { month: \"short\" }),\n    MMMM: () => date.toLocaleDateString(options.locales, { month: \"long\" }),\n    D: () => String(days),\n    Do: () => formatOrdinal(days),\n    DD: () => `${days}`.padStart(2, \"0\"),\n    H: () => String(hours),\n    Ho: () => formatOrdinal(hours),\n    HH: () => `${hours}`.padStart(2, \"0\"),\n    h: () => `${hours % 12 || 12}`.padStart(1, \"0\"),\n    ho: () => formatOrdinal(hours % 12 || 12),\n    hh: () => `${hours % 12 || 12}`.padStart(2, \"0\"),\n    m: () => String(minutes),\n    mo: () => formatOrdinal(minutes),\n    mm: () => `${minutes}`.padStart(2, \"0\"),\n    s: () => String(seconds),\n    so: () => formatOrdinal(seconds),\n    ss: () => `${seconds}`.padStart(2, \"0\"),\n    SSS: () => `${milliseconds}`.padStart(3, \"0\"),\n    d: () => day,\n    dd: () => date.toLocaleDateString(options.locales, { weekday: \"narrow\" }),\n    ddd: () => date.toLocaleDateString(options.locales, { weekday: \"short\" }),\n    dddd: () => date.toLocaleDateString(options.locales, { weekday: \"long\" }),\n    A: () => meridiem(hours, minutes),\n    AA: () => meridiem(hours, minutes, false, true),\n    a: () => meridiem(hours, minutes, true),\n    aa: () => meridiem(hours, minutes, true, true)\n  };\n  return formatStr.replace(REGEX_FORMAT, (match, $1) => {\n    var _a2, _b;\n    return (_b = $1 != null ? $1 : (_a2 = matches[match]) == null ? void 0 : _a2.call(matches)) != null ? _b : match;\n  });\n}\nfunction normalizeDate(date) {\n  if (date === null)\n    return new Date(Number.NaN);\n  if (date === void 0)\n    return /* @__PURE__ */ new Date();\n  if (date instanceof Date)\n    return new Date(date);\n  if (typeof date === \"string\" && !/Z$/i.test(date)) {\n    const d = date.match(REGEX_PARSE);\n    if (d) {\n      const m = d[2] - 1 || 0;\n      const ms = (d[7] || \"0\").substring(0, 3);\n      return new Date(d[1], m, d[3] || 1, d[4] || 0, d[5] || 0, d[6] || 0, ms);\n    }\n  }\n  return new Date(date);\n}\nfunction useDateFormat(date, formatStr = \"HH:mm:ss\", options = {}) {\n  return computed(() => formatDate(normalizeDate(toValue(date)), toValue(formatStr), options));\n}\n\nfunction useIntervalFn(cb, interval = 1e3, options = {}) {\n  const {\n    immediate = true,\n    immediateCallback = false\n  } = options;\n  let timer = null;\n  const isActive = ref(false);\n  function clean() {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n  }\n  function pause() {\n    isActive.value = false;\n    clean();\n  }\n  function resume() {\n    const intervalValue = toValue(interval);\n    if (intervalValue <= 0)\n      return;\n    isActive.value = true;\n    if (immediateCallback)\n      cb();\n    clean();\n    timer = setInterval(cb, intervalValue);\n  }\n  if (immediate && isClient)\n    resume();\n  if (isRef(interval) || typeof interval === \"function\") {\n    const stopWatch = watch(interval, () => {\n      if (isActive.value && isClient)\n        resume();\n    });\n    tryOnScopeDispose(stopWatch);\n  }\n  tryOnScopeDispose(pause);\n  return {\n    isActive,\n    pause,\n    resume\n  };\n}\n\nfunction useInterval(interval = 1e3, options = {}) {\n  const {\n    controls: exposeControls = false,\n    immediate = true,\n    callback\n  } = options;\n  const counter = ref(0);\n  const update = () => counter.value += 1;\n  const reset = () => {\n    counter.value = 0;\n  };\n  const controls = useIntervalFn(\n    callback ? () => {\n      update();\n      callback(counter.value);\n    } : update,\n    interval,\n    { immediate }\n  );\n  if (exposeControls) {\n    return {\n      counter,\n      reset,\n      ...controls\n    };\n  } else {\n    return counter;\n  }\n}\n\nfunction useLastChanged(source, options = {}) {\n  var _a;\n  const ms = ref((_a = options.initialValue) != null ? _a : null);\n  watch(\n    source,\n    () => ms.value = timestamp(),\n    options\n  );\n  return ms;\n}\n\nfunction useTimeoutFn(cb, interval, options = {}) {\n  const {\n    immediate = true\n  } = options;\n  const isPending = ref(false);\n  let timer = null;\n  function clear() {\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n  }\n  function stop() {\n    isPending.value = false;\n    clear();\n  }\n  function start(...args) {\n    clear();\n    isPending.value = true;\n    timer = setTimeout(() => {\n      isPending.value = false;\n      timer = null;\n      cb(...args);\n    }, toValue(interval));\n  }\n  if (immediate) {\n    isPending.value = true;\n    if (isClient)\n      start();\n  }\n  tryOnScopeDispose(stop);\n  return {\n    isPending: readonly(isPending),\n    start,\n    stop\n  };\n}\n\nfunction useTimeout(interval = 1e3, options = {}) {\n  const {\n    controls: exposeControls = false,\n    callback\n  } = options;\n  const controls = useTimeoutFn(\n    callback != null ? callback : noop,\n    interval,\n    options\n  );\n  const ready = computed(() => !controls.isPending.value);\n  if (exposeControls) {\n    return {\n      ready,\n      ...controls\n    };\n  } else {\n    return ready;\n  }\n}\n\nfunction useToNumber(value, options = {}) {\n  const {\n    method = \"parseFloat\",\n    radix,\n    nanToZero\n  } = options;\n  return computed(() => {\n    let resolved = toValue(value);\n    if (typeof resolved === \"string\")\n      resolved = Number[method](resolved, radix);\n    if (nanToZero && Number.isNaN(resolved))\n      resolved = 0;\n    return resolved;\n  });\n}\n\nfunction useToString(value) {\n  return computed(() => `${toValue(value)}`);\n}\n\nfunction useToggle(initialValue = false, options = {}) {\n  const {\n    truthyValue = true,\n    falsyValue = false\n  } = options;\n  const valueIsRef = isRef(initialValue);\n  const _value = ref(initialValue);\n  function toggle(value) {\n    if (arguments.length) {\n      _value.value = value;\n      return _value.value;\n    } else {\n      const truthy = toValue(truthyValue);\n      _value.value = _value.value === truthy ? toValue(falsyValue) : truthy;\n      return _value.value;\n    }\n  }\n  if (valueIsRef)\n    return toggle;\n  else\n    return [_value, toggle];\n}\n\nfunction watchArray(source, cb, options) {\n  let oldList = (options == null ? void 0 : options.immediate) ? [] : [...source instanceof Function ? source() : Array.isArray(source) ? source : toValue(source)];\n  return watch(source, (newList, _, onCleanup) => {\n    const oldListRemains = Array.from({ length: oldList.length });\n    const added = [];\n    for (const obj of newList) {\n      let found = false;\n      for (let i = 0; i < oldList.length; i++) {\n        if (!oldListRemains[i] && obj === oldList[i]) {\n          oldListRemains[i] = true;\n          found = true;\n          break;\n        }\n      }\n      if (!found)\n        added.push(obj);\n    }\n    const removed = oldList.filter((_2, i) => !oldListRemains[i]);\n    cb(newList, oldList, added, removed, onCleanup);\n    oldList = [...newList];\n  }, options);\n}\n\nfunction watchAtMost(source, cb, options) {\n  const {\n    count,\n    ...watchOptions\n  } = options;\n  const current = ref(0);\n  const stop = watchWithFilter(\n    source,\n    (...args) => {\n      current.value += 1;\n      if (current.value >= toValue(count))\n        nextTick(() => stop());\n      cb(...args);\n    },\n    watchOptions\n  );\n  return { count: current, stop };\n}\n\nfunction watchDebounced(source, cb, options = {}) {\n  const {\n    debounce = 0,\n    maxWait = void 0,\n    ...watchOptions\n  } = options;\n  return watchWithFilter(\n    source,\n    cb,\n    {\n      ...watchOptions,\n      eventFilter: debounceFilter(debounce, { maxWait })\n    }\n  );\n}\n\nfunction watchDeep(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    {\n      ...options,\n      deep: true\n    }\n  );\n}\n\nfunction watchIgnorable(source, cb, options = {}) {\n  const {\n    eventFilter = bypassFilter,\n    ...watchOptions\n  } = options;\n  const filteredCb = createFilterWrapper(\n    eventFilter,\n    cb\n  );\n  let ignoreUpdates;\n  let ignorePrevAsyncUpdates;\n  let stop;\n  if (watchOptions.flush === \"sync\") {\n    const ignore = ref(false);\n    ignorePrevAsyncUpdates = () => {\n    };\n    ignoreUpdates = (updater) => {\n      ignore.value = true;\n      updater();\n      ignore.value = false;\n    };\n    stop = watch(\n      source,\n      (...args) => {\n        if (!ignore.value)\n          filteredCb(...args);\n      },\n      watchOptions\n    );\n  } else {\n    const disposables = [];\n    const ignoreCounter = ref(0);\n    const syncCounter = ref(0);\n    ignorePrevAsyncUpdates = () => {\n      ignoreCounter.value = syncCounter.value;\n    };\n    disposables.push(\n      watch(\n        source,\n        () => {\n          syncCounter.value++;\n        },\n        { ...watchOptions, flush: \"sync\" }\n      )\n    );\n    ignoreUpdates = (updater) => {\n      const syncCounterPrev = syncCounter.value;\n      updater();\n      ignoreCounter.value += syncCounter.value - syncCounterPrev;\n    };\n    disposables.push(\n      watch(\n        source,\n        (...args) => {\n          const ignore = ignoreCounter.value > 0 && ignoreCounter.value === syncCounter.value;\n          ignoreCounter.value = 0;\n          syncCounter.value = 0;\n          if (ignore)\n            return;\n          filteredCb(...args);\n        },\n        watchOptions\n      )\n    );\n    stop = () => {\n      disposables.forEach((fn) => fn());\n    };\n  }\n  return { stop, ignoreUpdates, ignorePrevAsyncUpdates };\n}\n\nfunction watchImmediate(source, cb, options) {\n  return watch(\n    source,\n    cb,\n    {\n      ...options,\n      immediate: true\n    }\n  );\n}\n\nfunction watchOnce(source, cb, options) {\n  const stop = watch(source, (...args) => {\n    nextTick(() => stop());\n    return cb(...args);\n  }, options);\n  return stop;\n}\n\nfunction watchThrottled(source, cb, options = {}) {\n  const {\n    throttle = 0,\n    trailing = true,\n    leading = true,\n    ...watchOptions\n  } = options;\n  return watchWithFilter(\n    source,\n    cb,\n    {\n      ...watchOptions,\n      eventFilter: throttleFilter(throttle, trailing, leading)\n    }\n  );\n}\n\nfunction watchTriggerable(source, cb, options = {}) {\n  let cleanupFn;\n  function onEffect() {\n    if (!cleanupFn)\n      return;\n    const fn = cleanupFn;\n    cleanupFn = void 0;\n    fn();\n  }\n  function onCleanup(callback) {\n    cleanupFn = callback;\n  }\n  const _cb = (value, oldValue) => {\n    onEffect();\n    return cb(value, oldValue, onCleanup);\n  };\n  const res = watchIgnorable(source, _cb, options);\n  const { ignoreUpdates } = res;\n  const trigger = () => {\n    let res2;\n    ignoreUpdates(() => {\n      res2 = _cb(getWatchSources(source), getOldValue(source));\n    });\n    return res2;\n  };\n  return {\n    ...res,\n    trigger\n  };\n}\nfunction getWatchSources(sources) {\n  if (isReactive(sources))\n    return sources;\n  if (Array.isArray(sources))\n    return sources.map((item) => toValue(item));\n  return toValue(sources);\n}\nfunction getOldValue(source) {\n  return Array.isArray(source) ? source.map(() => void 0) : void 0;\n}\n\nfunction whenever(source, cb, options) {\n  const stop = watch(\n    source,\n    (v, ov, onInvalidate) => {\n      if (v) {\n        if (options == null ? void 0 : options.once)\n          nextTick(() => stop());\n        cb(v, ov, onInvalidate);\n      }\n    },\n    {\n      ...options,\n      once: false\n    }\n  );\n  return stop;\n}\n\nexport { assert, refAutoReset as autoResetRef, bypassFilter, camelize, clamp, computedEager, computedWithControl, containsProp, computedWithControl as controlledComputed, controlledRef, createEventHook, createFilterWrapper, createGlobalState, createInjectionState, reactify as createReactiveFn, createSharedComposable, createSingletonPromise, debounceFilter, refDebounced as debouncedRef, watchDebounced as debouncedWatch, directiveHooks, computedEager as eagerComputed, extendRef, formatDate, get, getLifeCycleTarget, hasOwn, hyphenate, identity, watchIgnorable as ignorableWatch, increaseWithUnit, injectLocal, invoke, isClient, isDef, isDefined, isIOS, isObject, isWorker, makeDestructurable, noop, normalizeDate, notNullish, now, objectEntries, objectOmit, objectPick, pausableFilter, watchPausable as pausableWatch, promiseTimeout, provideLocal, rand, reactify, reactifyObject, reactiveComputed, reactiveOmit, reactivePick, refAutoReset, refDebounced, refDefault, refThrottled, refWithControl, resolveRef, resolveUnref, set, syncRef, syncRefs, throttleFilter, refThrottled as throttledRef, watchThrottled as throttledWatch, timestamp, toReactive, toRef, toRefs, toValue, tryOnBeforeMount, tryOnBeforeUnmount, tryOnMounted, tryOnScopeDispose, tryOnUnmounted, until, useArrayDifference, useArrayEvery, useArrayFilter, useArrayFind, useArrayFindIndex, useArrayFindLast, useArrayIncludes, useArrayJoin, useArrayMap, useArrayReduce, useArraySome, useArrayUnique, useCounter, useDateFormat, refDebounced as useDebounce, useDebounceFn, useInterval, useIntervalFn, useLastChanged, refThrottled as useThrottle, useThrottleFn, useTimeout, useTimeoutFn, useToNumber, useToString, useToggle, watchArray, watchAtMost, watchDebounced, watchDeep, watchIgnorable, watchImmediate, watchOnce, watchPausable, watchThrottled, watchTriggerable, watchWithFilter, whenever };\n","import { ref, reactive, nextTick } from 'vue'\r\nimport { useDebounceFn } from '@vueuse/core'\r\n\r\nexport interface ValidationRule {\r\n  columnName: string\r\n  ruleType: 'Required' | 'Regex' | 'Range' | 'Custom'\r\n  errorMessage: string\r\n  regexPattern?: string\r\n  minValue?: any\r\n  maxValue?: any\r\n  severity: 'Info' | 'Warning' | 'Error' | 'Critical'\r\n  customValidator?: (value: any) => boolean\r\n}\r\n\r\nexport interface ValidationError {\r\n  rowId: string\r\n  columnName: string\r\n  message: string\r\n  severity: string\r\n}\r\n\r\nexport interface ValidationResult {\r\n  isValid: boolean\r\n  error?: string\r\n  severity?: string\r\n}\r\n\r\nexport function useValidation() {\r\n  // Each instance has its own validation state\r\n  const validationRules = ref<Map<string, ValidationRule[]>>(new Map())\r\n  // Use reactive object instead of ref<Map> for proper Vue reactivity\r\n  const validationErrors = reactive<Record<string, ValidationError[]>>({})\r\n  // SOLUTION A: Reactive counter to trigger watch in DataGrid when validation errors change\r\n  const errorCount = ref(0)\r\n  // SOLUTION B: Reactive counter to trigger watch when validation rules change (Map.set() doesn't trigger reactivity)\r\n  const ruleCount = ref(0)\r\n\r\n  // Helper function to update errorCount whenever validationErrors changes\r\n  function updateErrorCount() {\r\n    errorCount.value = Object.keys(validationErrors).length\r\n  }\r\n\r\n  function addValidationRule(rule: ValidationRule) {\r\n    const rules = validationRules.value.get(rule.columnName) || []\r\n    rules.push(rule)\r\n    validationRules.value.set(rule.columnName, rules)\r\n\r\n    console.log('[useValidation] addValidationRule:', {\r\n      columnName: rule.columnName,\r\n      ruleType: rule.ruleType,\r\n      severity: rule.severity,\r\n      totalRulesForColumn: rules.length\r\n    })\r\n    ruleCount.value++\r\n  }\r\n\r\n  function validateCell(rowId: string, columnName: string, value: any): ValidationResult {\r\n    const rules = validationRules.value.get(columnName) || []\r\n\r\n    console.log('[useValidation] validateCell:', {\r\n      rowId,\r\n      columnName,\r\n      value,\r\n      ruleCount: rules.length,\r\n      isEmpty: value == null || value === ''\r\n    })\r\n\r\n    // Check if value is empty\r\n    const isEmpty = value == null || value === ''\r\n\r\n    for (const rule of rules) {\r\n      // Required validation\r\n      if (rule.ruleType === 'Required') {\r\n        if (isEmpty) {\r\n          console.log('[useValidation] validateCell FAILED: Required', {\r\n            rowId,\r\n            columnName,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n\r\n      // Skip other validations if value is empty (only validate non-empty values)\r\n      if (isEmpty) continue\r\n\r\n      // Regex validation\r\n      if (rule.ruleType === 'Regex' && rule.regexPattern) {\r\n        const regex = new RegExp(rule.regexPattern)\r\n        if (!regex.test(String(value))) {\r\n          console.log('[useValidation] validateCell FAILED: Regex', {\r\n            rowId,\r\n            columnName,\r\n            value,\r\n            pattern: rule.regexPattern,\r\n            error: rule.errorMessage\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n\r\n      // Range validation\r\n      if (rule.ruleType === 'Range') {\r\n        const numValue = Number(value)\r\n        if (isNaN(numValue)) {\r\n          console.log('[useValidation] validateCell FAILED: Range (not a number)', {\r\n            rowId,\r\n            columnName,\r\n            value\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: 'Value must be a number',\r\n            severity: rule.severity\r\n          }\r\n        }\r\n\r\n        if (rule.minValue != null && numValue < rule.minValue) {\r\n          console.log('[useValidation] validateCell FAILED: Range (below min)', {\r\n            rowId,\r\n            columnName,\r\n            value: numValue,\r\n            minValue: rule.minValue\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n\r\n        if (rule.maxValue != null && numValue > rule.maxValue) {\r\n          console.log('[useValidation] validateCell FAILED: Range (above max)', {\r\n            rowId,\r\n            columnName,\r\n            value: numValue,\r\n            maxValue: rule.maxValue\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n\r\n      // Custom validation\r\n      if (rule.ruleType === 'Custom' && rule.customValidator) {\r\n        if (!rule.customValidator(value)) {\r\n          console.log('[useValidation] validateCell FAILED: Custom', {\r\n            rowId,\r\n            columnName,\r\n            value,\r\n            error: rule.errorMessage\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('[useValidation] validateCell PASSED', {\r\n      rowId,\r\n      columnName,\r\n      value\r\n    })\r\n    return { isValid: true }\r\n  }\r\n\r\n  // Helper: Check if entire row is empty (all data columns have no value)\r\n  function isRowCompletelyEmpty(rowCells: Array<{ columnName: string; value: any }>): boolean {\r\n    return rowCells.every(cell => cell.value == null || cell.value === '')\r\n  }\r\n\r\n  // Throttled validation (300ms) with row-empty check\r\n  const validateCellThrottled = useDebounceFn(\r\n    (rowId: string, columnName: string, value: any, rowCells?: Array<{ columnName: string; value: any }>) => {\r\n      console.log('[useValidation] validateCellThrottled:', {\r\n        rowId,\r\n        columnName,\r\n        value,\r\n        hasRowCells: !!rowCells,\r\n        rowCellsCount: rowCells?.length\r\n      })\r\n\r\n      // If row cells provided, check if entire row is empty\r\n      if (rowCells && isRowCompletelyEmpty(rowCells)) {\r\n        console.log('[useValidation] validateCellThrottled: Row is completely empty, clearing errors', {\r\n          rowId\r\n        })\r\n        // Entire row is empty - clear ALL validation errors for this row\r\n        delete validationErrors[rowId]\r\n        updateErrorCount()\r\n        return\r\n      }\r\n\r\n      const result = validateCell(rowId, columnName, value)\r\n\r\n      // Update errors map\r\n      const rowErrors = validationErrors[rowId] || []\r\n\r\n      if (!result.isValid) {\r\n        // Add/update error\r\n        const existingErrorIdx = rowErrors.findIndex(e => e.columnName === columnName)\r\n        const error: ValidationError = {\r\n          rowId,\r\n          columnName,\r\n          message: result.error!,\r\n          severity: result.severity!\r\n        }\r\n\r\n        if (existingErrorIdx >= 0) {\r\n          rowErrors[existingErrorIdx] = error\r\n          console.log('[useValidation] validateCellThrottled: Updated existing error', {\r\n            rowId,\r\n            columnName,\r\n            error: error.message\r\n          })\r\n        } else {\r\n          rowErrors.push(error)\r\n          console.log('[useValidation] validateCellThrottled: Added new error', {\r\n            rowId,\r\n            columnName,\r\n            error: error.message\r\n          })\r\n        }\r\n\r\n        validationErrors[rowId] = rowErrors\r\n      } else {\r\n        updateErrorCount()\r\n        // Clear error for this column\r\n        const filteredErrors = rowErrors.filter(e => e.columnName !== columnName)\r\n        if (filteredErrors.length > 0) {\r\n          validationErrors[rowId] = filteredErrors\r\n          console.log('[useValidation] validateCellThrottled: Cleared error for column, other errors remain', {\r\n            rowId,\r\n            columnName,\r\n            remainingErrors: filteredErrors.length\r\n          })\r\n        } else {\r\n          updateErrorCount()\r\n          delete validationErrors[rowId]\r\n          console.log('[useValidation] validateCellThrottled: Cleared all errors for row', {\r\n            rowId\r\n          })\r\n        }\r\n      }\r\n          updateErrorCount()\r\n    },\r\n    300\r\n  )\r\n\r\n  async function validateAll(rows: any[]) {\r\n    console.log('[useValidation] validateAll START:', {\r\n      rowCount: rows.length\r\n    })\r\n\r\n    // Clear all errors\r\n    Object.keys(validationErrors).forEach(key => delete validationErrors[key])\r\n    let totalErrors = 0\r\n    let rowIndex = 0\r\n\r\n    //  FIX: Batch processing with UI yielding\r\n    const BATCH_SIZE = 50  // Process 50 rows at a time\r\n    const totalBatches = Math.ceil(rows.length / BATCH_SIZE)\r\n\r\n    for (let batchIndex = 0; batchIndex < totalBatches; batchIndex++) {\r\n      const batchStart = batchIndex * BATCH_SIZE\r\n      const batchEnd = Math.min(batchStart + BATCH_SIZE, rows.length)\r\n      const batch = rows.slice(batchStart, batchEnd)\r\n\r\n      console.log(`[useValidation] Processing batch ${batchIndex + 1}/${totalBatches} (rows ${batchStart}-${batchEnd - 1})`)\r\n\r\n      for (const row of batch) {\r\n        // DEBUG: Log first 3 rows to see what data we have (use counter instead of indexOf)\r\n        if (rowIndex < 3) {\r\n          console.log('[useValidation] validateAll: Examining row', {\r\n            rowId: row.rowId,\r\n            rowIndex,\r\n            cellCount: row.cells?.length || 0\r\n          })\r\n        }\r\n        rowIndex++\r\n\r\n        // Skip rows without cells array\r\n        if (!row.cells || !Array.isArray(row.cells)) {\r\n          console.log('[useValidation] validateAll: Skipping row without cells', {\r\n            rowId: row.rowId,\r\n            hasCells: !!row.cells,\r\n            isArray: Array.isArray(row.cells)\r\n          })\r\n          continue\r\n        }\r\n\r\n        // Skip empty rows - only validate rows with at least one non-empty cell\r\n        if (isRowCompletelyEmpty(row.cells)) {\r\n          console.log('[useValidation] validateAll: Skipping empty row', {\r\n            rowId: row.rowId,\r\n            cellCount: row.cells?.length || 0\r\n          })\r\n          continue\r\n        }\r\n\r\n        for (const cell of row.cells) {\r\n          const result = validateCell(row.rowId, cell.columnName, cell.value)\r\n          if (!result.isValid) {\r\n            const rowErrors = validationErrors[row.rowId] || []\r\n            rowErrors.push({\r\n              rowId: row.rowId,\r\n              columnName: cell.columnName,\r\n              message: result.error!,\r\n              severity: result.severity!\r\n            })\r\n            validationErrors[row.rowId] = rowErrors\r\n            totalErrors++\r\n          }\r\n        }\r\n      }\r\n\r\n      //  K: Yield UI po kadom batchi\r\n      await nextTick()\r\n    }\r\n\r\n    console.log('[useValidation] validateAll - loop FINISHED, processed', rowIndex, 'rows')\r\n    console.log('[useValidation] validateAll - totalErrors:', totalErrors)\r\n\r\n    // SIMPLIFIED: Avoid complex operations on reactive validationErrors object\r\n    const rowsWithErrorsCount = Object.keys(validationErrors).length\r\n    console.log('[useValidation] validateAll - rowsWithErrors:', rowsWithErrorsCount)\r\n\r\n    console.log('[useValidation] validateAll complete - SUCCESS')\r\n\r\n    console.log('[useValidation] validateAll - calling updateErrorCount...')\r\n    updateErrorCount()\r\n    console.log('[useValidation] validateAll - updateErrorCount DONE')\r\n\r\n    // SIMPLIFIED: Build errors array without Object.values().flat() on reactive object\r\n    console.log('[useValidation] validateAll - building errors array...')\r\n    const allErrors: ValidationError[] = []\r\n    for (const rowId in validationErrors) {\r\n      const rowErrors = validationErrors[rowId]\r\n      if (rowErrors && Array.isArray(rowErrors)) {\r\n        allErrors.push(...rowErrors)\r\n      }\r\n    }\r\n    console.log('[useValidation] validateAll - errors array built, count:', allErrors.length)\r\n\r\n    console.log('[useValidation] validateAll - returning result...')\r\n    return {\r\n      isValid: totalErrors === 0,\r\n      totalErrors,\r\n      errors: allErrors\r\n    }\r\n  }\r\n\r\n  function getValidationErrors(rowId: string): ValidationError[] {\r\n    return validationErrors[rowId] || []\r\n  }\r\n\r\n  function clearValidationErrors() {\r\n    const clearedCount = Object.keys(validationErrors).length\r\n    console.log('[useValidation] clearValidationErrors:', {\r\n      clearedCount\r\n    })\r\n    Object.keys(validationErrors).forEach(key => delete validationErrors[key])\r\n    updateErrorCount()\r\n  }\r\n\r\n  return {\r\n    validationRules,\r\n    validationErrors,\r\n    errorCount,\r\n    ruleCount,\r\n    addValidationRule,\r\n    validateCell,\r\n    validateCellThrottled,\r\n    validateAll,\r\n    getValidationErrors,\r\n    clearValidationErrors\r\n  }\r\n}\r\n","/**\r\n * Copy/Paste Composable with Excel-like TSV Format\r\n *\r\n * EXCEL TSV FORMAT:\r\n * - Normal cells: separated by \\t (no quotes)\r\n * - Multiline cells: wrapped in quotes \"Multi\\nLine\\nCell\"\r\n * - Cells with tabs: wrapped in quotes \"Cell\\tWith\\tTabs\"\r\n * - Cells with quotes: quotes doubled AND wrapped \"Cell with \"\"quote\"\"\"\r\n *\r\n * CRITICAL: Before copying, values are ESCAPED (quotes added if needed)\r\n * CRITICAL: After pasting, values are UNESCAPED (quotes removed)\r\n */\r\n\r\nimport { ref } from 'vue'\r\nimport type { GridRow } from '@/types/grid'\r\n\r\nexport interface CopyPasteOptions {\r\n  includeHeaders?: boolean\r\n}\r\n\r\nexport interface CopyPasteResult {\r\n  success: boolean\r\n  message?: string\r\n  processedRows?: number\r\n}\r\n\r\nexport function useCopyPaste() {\r\n  const clipboardData = ref<string>('')\r\n\r\n  /**\r\n   * Escapes TSV value for Excel compatibility\r\n   *\r\n   * ESCAPING RULES:\r\n   * 1. If value contains tab, newline, carriage return, or quote  wrap in quotes\r\n   * 2. If wrapping in quotes, double any existing quotes (\"  \"\")\r\n   * 3. Otherwise, return value as-is (no quotes needed)\r\n   *\r\n   * EXAMPLES:\r\n   * - \"NormalText\"  NormalText (no special chars, no quotes)\r\n   * - \"Multi\\nLine\"  \"Multi\\nLine\" (newline  quoted)\r\n   * - \"Cell\\tWith\\tTab\"  \"Cell\\tWith\\tTab\" (tabs  quoted)\r\n   * - 'Cell with \"quote\"'  \"Cell with \"\"quote\"\"\" (quote  doubled AND quoted)\r\n   * - \"\"  \"\" (empty string stays empty)\r\n   */\r\n  function escapeTsvValue(value: string): string {\r\n    if (!value) return value\r\n\r\n    // Check if quoting is needed\r\n    const needsQuoting = value.includes('\\t') ||\r\n                        value.includes('\\n') ||\r\n                        value.includes('\\r') ||\r\n                        value.includes('\"')\r\n\r\n    if (!needsQuoting) {\r\n      // Normal value - no escaping needed\r\n      return value\r\n    }\r\n\r\n    // Escape quotes by doubling them, then wrap entire value in quotes\r\n    // Example: Cell with \"quote\"  Cell with \"\"quote\"\"  \"Cell with \"\"quote\"\"\"\r\n    const escaped = value.replace(/\"/g, '\"\"')\r\n    return `\"${escaped}\"`\r\n  }\r\n\r\n  /**\r\n   * Formats rows as Tab-Separated Values with Excel escaping\r\n   *\r\n   * EXAMPLE OUTPUT:\r\n   * Column1\\tColumn2\\tColumn3\\n\r\n   * Cell1\\t\"Multi\\nLine\\nCell\"\\tCell3\\n\r\n   * Cell1\\t\"Cell\\tWith\\tTabs\"\\tCell3\\n\r\n   * Cell1\\t\"Cell with \"\"quote\"\"\"\\tCell3\\n\r\n   */\r\n  function formatAsTabSeparated(\r\n    rows: GridRow[],\r\n    columnNames: string[],\r\n    options: CopyPasteOptions = {}\r\n  ): string {\r\n    const lines: string[] = []\r\n\r\n    // Add headers if requested\r\n    if (options.includeHeaders) {\r\n      // Escape header values too (in case column names contain special chars)\r\n      lines.push(columnNames.map(escapeTsvValue).join('\\t'))\r\n    }\r\n\r\n    // Add data rows\r\n    for (const row of rows) {\r\n      // Escape all cell values before joining with tabs\r\n      // This ensures multiline/tab content is properly quoted for Excel\r\n      const values = columnNames.map(col => {\r\n        const cell = row.cells.find(c => c.columnName === col)\r\n        const value = cell?.value\r\n        return escapeTsvValue(value?.toString() ?? '')\r\n      })\r\n      lines.push(values.join('\\t'))\r\n    }\r\n\r\n    return lines.join('\\n')\r\n  }\r\n\r\n  /**\r\n   * Parses Tab-Separated Values with Excel multiline/tab support\r\n   *\r\n   * EXCEL TSV FORMAT:\r\n   * - Normal cells: separated by \\t\r\n   * - Multiline cells: wrapped in quotes \"Multi\\nLine\\nCell\"\r\n   * - Cells with tabs: wrapped in quotes \"Cell\\tWith\\tTabs\"\r\n   * - Escaped quotes: doubled \"\" inside quoted values \"Cell with \"\"quote\"\"\"\r\n   *\r\n   * CRITICAL: Uses character-by-character parsing instead of Split() to handle embedded delimiters\r\n   *\r\n   * EXAMPLE INPUT:\r\n   * Column1\\tColumn2\\tColumn3\\n\r\n   * Cell1\\t\"Multi\\nLine\\nCell\"\\tCell3\\n\r\n   * Cell1\\t\"Cell\\tWith\\tTabs\"\\tCell3\\n\r\n   * Cell1\\t\"Cell with \"\"quote\"\"\"\\tCell3\\n\r\n   *\r\n   * EXAMPLE OUTPUT (unescaped):\r\n   * Column2 value: \"Multi\\nLine\\nCell\" (3 lines, NO quotes in final value)\r\n   */\r\n  function parseTabSeparated(clipboardText: string): { headers: string[], rows: Record<string, any>[] } {\r\n    const result: Record<string, any>[] = []\r\n    const currentRow: string[] = []\r\n    let currentCell = ''\r\n    let inQuotes = false\r\n    let isFirstRow = true\r\n    let headers: string[] = []\r\n\r\n    for (let i = 0; i < clipboardText.length; i++) {\r\n      const c = clipboardText[i]\r\n      const next = i + 1 < clipboardText.length ? clipboardText[i + 1] : null\r\n\r\n      if (c === '\"') {\r\n        if (inQuotes && next === '\"') {\r\n          // Escaped quote (\"\")  append single quote to cell content\r\n          // Example: \"Cell with \"\"quote\"\"\"  Cell with \"quote\"\r\n          currentCell += '\"'\r\n          i++ // Skip next quote\r\n        } else {\r\n          // Toggle quote mode (start or end of quoted value)\r\n          // CRITICAL: Quotes themselves are NOT added to cell content\r\n          inQuotes = !inQuotes\r\n        }\r\n      } else if (c === '\\t' && !inQuotes) {\r\n        // Tab outside quotes = end of cell\r\n        currentRow.push(currentCell)\r\n        currentCell = ''\r\n      } else if ((c === '\\n' || c === '\\r') && !inQuotes) {\r\n        // Newline outside quotes = end of row\r\n        if (c === '\\r' && next === '\\n') {\r\n          i++ // Skip \\n after \\r (handle Windows CRLF)\r\n        }\r\n\r\n        if (currentCell.length > 0 || currentRow.length > 0) {\r\n          currentRow.push(currentCell)\r\n          currentCell = ''\r\n\r\n          if (isFirstRow) {\r\n            // First row = headers (or auto-generate if not header-like)\r\n            if (isHeaderRow(currentRow)) {\r\n              headers = [...currentRow]\r\n            } else {\r\n              // First row is data - generate column names\r\n              headers = currentRow.map((_, idx) => `Column${idx + 1}`)\r\n\r\n              // Add first row as data\r\n              const firstDataRow: Record<string, any> = {}\r\n              for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n                firstDataRow[headers[j]] = currentRow[j] || null\r\n              }\r\n              result.push(firstDataRow)\r\n            }\r\n\r\n            isFirstRow = false\r\n          } else {\r\n            // Build data row dictionary\r\n            const dataRow: Record<string, any> = {}\r\n            for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n              // CRITICAL: Values are UNESCAPED (quotes removed, \"\"  \")\r\n              dataRow[headers[j]] = currentRow[j] || null\r\n            }\r\n            result.push(dataRow)\r\n          }\r\n\r\n          currentRow.length = 0\r\n        }\r\n      } else {\r\n        // Regular character - add to current cell\r\n        // Tabs and newlines inside quotes are preserved as-is\r\n        currentCell += c\r\n      }\r\n    }\r\n\r\n    // Handle last row if no trailing newline\r\n    if (currentCell.length > 0 || currentRow.length > 0) {\r\n      currentRow.push(currentCell)\r\n\r\n      if (isFirstRow && headers.length === 0) {\r\n        // Only one row total - treat as headers or generate column names\r\n        if (isHeaderRow(currentRow)) {\r\n          headers = [...currentRow]\r\n        } else {\r\n          headers = currentRow.map((_, idx) => `Column${idx + 1}`)\r\n          const dataRow: Record<string, any> = {}\r\n          for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n            dataRow[headers[j]] = currentRow[j] || null\r\n          }\r\n          result.push(dataRow)\r\n        }\r\n      } else if (headers.length > 0) {\r\n        // Last data row\r\n        const dataRow: Record<string, any> = {}\r\n        for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n          dataRow[headers[j]] = currentRow[j] || null\r\n        }\r\n        result.push(dataRow)\r\n      }\r\n    }\r\n\r\n    return { headers, rows: result }\r\n  }\r\n\r\n  /**\r\n   * Checks if row contains headers (non-numeric values)\r\n   */\r\n  function isHeaderRow(values: string[]): boolean {\r\n    return values.some(v => v && isNaN(Number(v)))\r\n  }\r\n\r\n  /**\r\n   * Copies selected CELLS (not full rows) to clipboard with position preservation\r\n   *\r\n   * POSITION PRESERVATION:\r\n   * - Calculates min/max row and column indices from selected cells\r\n   * - Creates rectangular range including EMPTY cells to preserve positions\r\n   * - Example: If cells (2,3) and (4,5) are selected, copies a 3x3 grid:\r\n   *   Row 2: empty, empty, Cell(2,3), empty, empty\r\n   *   Row 3: empty, empty, empty,     empty, empty\r\n   *   Row 4: empty, empty, empty,     empty, Cell(4,5)\r\n   */\r\n  async function copySelectedCells(\r\n    selectedCells: Set<string>,\r\n    allRows: GridRow[],\r\n    allColumns: { name: string }[]\r\n  ): Promise<CopyPasteResult> {\r\n    try {\r\n      if (selectedCells.size === 0) {\r\n        return {\r\n          success: false,\r\n          message: 'No cells selected for copy'\r\n        }\r\n      }\r\n\r\n      console.log('[useCopyPaste] copySelectedCells:', {\r\n        selectedCount: selectedCells.size,\r\n        selectedCells: Array.from(selectedCells)\r\n      })\r\n\r\n      // Parse selected cells to get row/column indices\r\n      const cellPositions: Array<{ rowId: string; rowIndex: number; columnName: string; columnIndex: number; value: any }> = []\r\n\r\n      selectedCells.forEach(cellKey => {\r\n        const [rowId, columnName] = cellKey.split(':')\r\n        const row = allRows.find(r => r.rowId === rowId)\r\n        if (!row) return\r\n\r\n        const columnIndex = allColumns.findIndex(c => c.name === columnName)\r\n        if (columnIndex === -1) return\r\n\r\n        const cell = row.cells.find(c => c.columnName === columnName)\r\n        cellPositions.push({\r\n          rowId,\r\n          rowIndex: row.rowIndex,\r\n          columnName,\r\n          columnIndex,\r\n          value: cell?.value\r\n        })\r\n      })\r\n\r\n      if (cellPositions.length === 0) {\r\n        return {\r\n          success: false,\r\n          message: 'No valid cells to copy'\r\n        }\r\n      }\r\n\r\n      // Calculate rectangular bounds\r\n      const minRowIndex = Math.min(...cellPositions.map(c => c.rowIndex))\r\n      const maxRowIndex = Math.max(...cellPositions.map(c => c.rowIndex))\r\n      const minColIndex = Math.min(...cellPositions.map(c => c.columnIndex))\r\n      const maxColIndex = Math.max(...cellPositions.map(c => c.columnIndex))\r\n\r\n      console.log('[useCopyPaste] copySelectedCells bounds:', {\r\n        minRowIndex,\r\n        maxRowIndex,\r\n        minColIndex,\r\n        maxColIndex,\r\n        rows: maxRowIndex - minRowIndex + 1,\r\n        cols: maxColIndex - minColIndex + 1\r\n      })\r\n\r\n      // Build TSV with position preservation (include empty cells)\r\n      const lines: string[] = []\r\n\r\n      for (let rowIdx = minRowIndex; rowIdx <= maxRowIndex; rowIdx++) {\r\n        const rowCells: string[] = []\r\n\r\n        for (let colIdx = minColIndex; colIdx <= maxColIndex; colIdx++) {\r\n          // Find if this cell is selected\r\n          const cellPos = cellPositions.find(c => c.rowIndex === rowIdx && c.columnIndex === colIdx)\r\n\r\n          if (cellPos) {\r\n            // Cell is selected - add its value\r\n            const value = cellPos.value?.toString() ?? ''\r\n            rowCells.push(escapeTsvValue(value))\r\n          } else {\r\n            // Cell is not selected - add empty placeholder to preserve position\r\n            rowCells.push('')\r\n          }\r\n        }\r\n\r\n        lines.push(rowCells.join('\\t'))\r\n      }\r\n\r\n      const tsvData = lines.join('\\n')\r\n\r\n      console.log('[useCopyPaste] copySelectedCells TSV:', {\r\n        lineCount: lines.length,\r\n        preview: tsvData.substring(0, 200)\r\n      })\r\n\r\n      // Copy to system clipboard\r\n      await navigator.clipboard.writeText(tsvData)\r\n\r\n      // Store internally for fallback\r\n      clipboardData.value = tsvData\r\n\r\n      return {\r\n        success: true,\r\n        message: `Copied ${cellPositions.length} cells to clipboard`,\r\n        processedRows: cellPositions.length\r\n      }\r\n    } catch (error) {\r\n      console.error('[useCopyPaste] Copy failed:', error)\r\n      return {\r\n        success: false,\r\n        message: `Copy failed: ${error}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Copies selected rows to clipboard (legacy method for full row copy)\r\n   */\r\n  async function copyToClipboard(\r\n    rows: GridRow[],\r\n    columnNames: string[],\r\n    options: CopyPasteOptions = {}\r\n  ): Promise<CopyPasteResult> {\r\n    try {\r\n      if (rows.length === 0) {\r\n        return {\r\n          success: false,\r\n          message: 'No data selected for copy'\r\n        }\r\n      }\r\n\r\n      // Format data as TSV with Excel escaping\r\n      const tsvData = formatAsTabSeparated(rows, columnNames, options)\r\n\r\n      // Copy to system clipboard\r\n      await navigator.clipboard.writeText(tsvData)\r\n\r\n      // Store internally for fallback\r\n      clipboardData.value = tsvData\r\n\r\n      return {\r\n        success: true,\r\n        message: `Copied ${rows.length} rows to clipboard`,\r\n        processedRows: rows.length\r\n      }\r\n    } catch (error) {\r\n      console.error('Copy failed:', error)\r\n      return {\r\n        success: false,\r\n        message: `Copy failed: ${error}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Pastes from clipboard and returns parsed rows\r\n   */\r\n  async function pasteFromClipboard(): Promise<CopyPasteResult & { rows?: Record<string, any>[], headers?: string[] }> {\r\n    try {\r\n      // Try to read from system clipboard\r\n      let tsvData = ''\r\n      try {\r\n        tsvData = await navigator.clipboard.readText()\r\n      } catch {\r\n        // Fallback to internal clipboard if system clipboard fails\r\n        tsvData = clipboardData.value\r\n      }\r\n\r\n      if (!tsvData) {\r\n        return {\r\n          success: false,\r\n          message: 'No data available in clipboard'\r\n        }\r\n      }\r\n\r\n      // Parse TSV data with Excel multiline support\r\n      const { headers, rows } = parseTabSeparated(tsvData)\r\n\r\n      return {\r\n        success: true,\r\n        message: `Pasted ${rows.length} rows from clipboard`,\r\n        processedRows: rows.length,\r\n        rows,\r\n        headers\r\n      }\r\n    } catch (error) {\r\n      console.error('Paste failed:', error)\r\n      return {\r\n        success: false,\r\n        message: `Paste failed: ${error}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checks if paste is possible\r\n   */\r\n  function canPaste(): boolean {\r\n    return !!clipboardData.value\r\n  }\r\n\r\n  /**\r\n   * Clears internal clipboard\r\n   */\r\n  function clearClipboard(): void {\r\n    clipboardData.value = ''\r\n  }\r\n\r\n  return {\r\n    copyToClipboard,\r\n    copySelectedCells,\r\n    pasteFromClipboard,\r\n    canPaste,\r\n    clearClipboard\r\n  }\r\n}\r\n","/**\r\n * Import/Export Composable\r\n *\r\n * Provides JSON import/export functionality for grid data\r\n */\r\n\r\nexport enum ImportMode {\r\n  Append = 'append',    // Add to existing data\r\n  Replace = 'replace',  // Clear and replace all data\r\n  Merge = 'merge'       // Merge with existing data (by rowId)\r\n}\r\n\r\nexport interface ImportOptions {\r\n  mode: ImportMode\r\n  validateSchema?: boolean\r\n}\r\n\r\nexport interface ExportOptions {\r\n  includeHiddenColumns?: boolean\r\n  includeSpecialColumns?: boolean\r\n  onlySelectedRows?: boolean\r\n  prettify?: boolean\r\n}\r\n\r\nexport interface ImportResult {\r\n  success: boolean\r\n  rowsImported: number\r\n  rowsSkipped: number\r\n  errors: string[]\r\n  message: string\r\n  rows?: Record<string, any>[]  // The processed rows ready to load\r\n}\r\n\r\nexport interface ExportResult {\r\n  success: boolean\r\n  rowsExported: number\r\n  message: string\r\n}\r\n\r\nexport function useImportExport() {\r\n  /**\r\n   * Exports grid data to JSON format\r\n   */\r\n  function exportToJson(\r\n    rows: Record<string, any>[],\r\n    columns: string[],\r\n    options: ExportOptions = {}\r\n  ): ExportResult {\r\n    try {\r\n      const {\r\n        includeHiddenColumns = false,\r\n        includeSpecialColumns = false,\r\n        onlySelectedRows = false,\r\n        prettify = true\r\n      } = options\r\n\r\n      // Filter rows if needed\r\n      let dataToExport = rows\r\n\r\n      if (onlySelectedRows) {\r\n        // Filter would be done by caller passing selected rows\r\n        dataToExport = rows\r\n      }\r\n\r\n      // Filter columns if needed\r\n      const filteredData = dataToExport.map(row => {\r\n        const filteredRow: Record<string, any> = {}\r\n\r\n        for (const key of Object.keys(row)) {\r\n          // Skip internal properties\r\n          if (key.startsWith('__')) {\r\n            continue\r\n          }\r\n\r\n          // Include all data columns by default\r\n          if (columns.includes(key)) {\r\n            filteredRow[key] = row[key]\r\n          }\r\n        }\r\n\r\n        return filteredRow\r\n      })\r\n\r\n      // Create JSON string\r\n      const jsonString = prettify\r\n        ? JSON.stringify(filteredData, null, 2)\r\n        : JSON.stringify(filteredData)\r\n\r\n      // Create blob and download\r\n      const blob = new Blob([jsonString], { type: 'application/json' })\r\n      const url = URL.createObjectURL(blob)\r\n      const link = document.createElement('a')\r\n      link.href = url\r\n      link.download = `grid-export-${Date.now()}.json`\r\n      document.body.appendChild(link)\r\n      link.click()\r\n      document.body.removeChild(link)\r\n      URL.revokeObjectURL(url)\r\n\r\n      return {\r\n        success: true,\r\n        rowsExported: filteredData.length,\r\n        message: `Successfully exported ${filteredData.length} rows to JSON`\r\n      }\r\n    } catch (error) {\r\n      console.error('Export to JSON failed:', error)\r\n      return {\r\n        success: false,\r\n        rowsExported: 0,\r\n        message: `Export failed: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Imports grid data from JSON file\r\n   */\r\n  async function importFromJson(\r\n    file: File,\r\n    existingRows: Record<string, any>[],\r\n    columns: string[],\r\n    options: ImportOptions = { mode: ImportMode.Append }\r\n  ): Promise<ImportResult> {\r\n    try {\r\n      // Read file\r\n      const text = await file.text()\r\n\r\n      // Parse JSON\r\n      let parsedData: any\r\n      try {\r\n        parsedData = JSON.parse(text)\r\n      } catch (parseError) {\r\n        return {\r\n          success: false,\r\n          rowsImported: 0,\r\n          rowsSkipped: 0,\r\n          errors: ['Invalid JSON format'],\r\n          message: 'Failed to parse JSON file'\r\n        }\r\n      }\r\n\r\n      // Validate structure\r\n      if (!Array.isArray(parsedData)) {\r\n        return {\r\n          success: false,\r\n          rowsImported: 0,\r\n          rowsSkipped: 0,\r\n          errors: ['JSON must be an array of objects'],\r\n          message: 'Invalid JSON structure'\r\n        }\r\n      }\r\n\r\n      // Validate schema if requested\r\n      const errors: string[] = []\r\n      let rowsSkipped = 0\r\n\r\n      if (options.validateSchema && parsedData.length > 0) {\r\n        const firstRow = parsedData[0]\r\n        const importKeys = Object.keys(firstRow)\r\n        const missingColumns = columns.filter(col => !importKeys.includes(col))\r\n\r\n        if (missingColumns.length > 0) {\r\n          errors.push(`Missing columns in import data: ${missingColumns.join(', ')}`)\r\n        }\r\n      }\r\n\r\n      // Process rows based on mode\r\n      let resultRows: Record<string, any>[] = []\r\n\r\n      switch (options.mode) {\r\n        case ImportMode.Replace:\r\n          // Clear existing and use imported data\r\n          resultRows = parsedData.map((row, index) => ({\r\n            ...row,\r\n            __rowId: row.__rowId || `imported-${Date.now()}-${index}`,\r\n            __rowIndex: index\r\n          }))\r\n          break\r\n\r\n        case ImportMode.Append:\r\n          // Add to end of existing data\r\n          resultRows = [\r\n            ...existingRows,\r\n            ...parsedData.map((row, index) => ({\r\n              ...row,\r\n              __rowId: row.__rowId || `imported-${Date.now()}-${index}`,\r\n              __rowIndex: existingRows.length + index\r\n            }))\r\n          ]\r\n          break\r\n\r\n        case ImportMode.Merge:\r\n          // Merge by rowId\r\n          const existingRowsMap = new Map(\r\n            existingRows.map(row => [row.__rowId, row])\r\n          )\r\n\r\n          parsedData.forEach((importRow, index) => {\r\n            const rowId = importRow.__rowId || `imported-${Date.now()}-${index}`\r\n\r\n            if (existingRowsMap.has(rowId)) {\r\n              // Update existing row\r\n              const existingRow = existingRowsMap.get(rowId)!\r\n              Object.assign(existingRow, importRow, { __rowId: rowId })\r\n            } else {\r\n              // Add new row\r\n              existingRowsMap.set(rowId, {\r\n                ...importRow,\r\n                __rowId: rowId,\r\n                __rowIndex: existingRowsMap.size\r\n              })\r\n            }\r\n          })\r\n\r\n          resultRows = Array.from(existingRowsMap.values())\r\n          break\r\n      }\r\n\r\n      // Reindex rows\r\n      resultRows.forEach((row, index) => {\r\n        row.__rowIndex = index\r\n      })\r\n\r\n      return {\r\n        success: true,\r\n        rowsImported: parsedData.length,\r\n        rowsSkipped,\r\n        errors,\r\n        message: `Successfully imported ${parsedData.length} rows using ${options.mode} mode`,\r\n        rows: resultRows\r\n      }\r\n    } catch (error) {\r\n      console.error('Import from JSON failed:', error)\r\n      return {\r\n        success: false,\r\n        rowsImported: 0,\r\n        rowsSkipped: 0,\r\n        errors: [error instanceof Error ? error.message : 'Unknown error'],\r\n        message: 'Import failed'\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Opens file picker and imports JSON\r\n   */\r\n  function openImportDialog(\r\n    existingRows: Record<string, any>[],\r\n    columns: string[],\r\n    options: ImportOptions = { mode: ImportMode.Append }\r\n  ): Promise<ImportResult> {\r\n    return new Promise((resolve) => {\r\n      const input = document.createElement('input')\r\n      input.type = 'file'\r\n      input.accept = '.json,application/json'\r\n\r\n      input.onchange = async (event) => {\r\n        const file = (event.target as HTMLInputElement).files?.[0]\r\n        if (!file) {\r\n          resolve({\r\n            success: false,\r\n            rowsImported: 0,\r\n            rowsSkipped: 0,\r\n            errors: ['No file selected'],\r\n            message: 'Import cancelled'\r\n          })\r\n          return\r\n        }\r\n\r\n        const result = await importFromJson(file, existingRows, columns, options)\r\n        resolve(result)\r\n      }\r\n\r\n      input.oncancel = () => {\r\n        resolve({\r\n          success: false,\r\n          rowsImported: 0,\r\n          rowsSkipped: 0,\r\n          errors: ['User cancelled'],\r\n          message: 'Import cancelled'\r\n        })\r\n      }\r\n\r\n      input.click()\r\n    })\r\n  }\r\n\r\n  return {\r\n    exportToJson,\r\n    importFromJson,\r\n    openImportDialog,\r\n    ImportMode\r\n  }\r\n}\r\n","/**\r\n * Auto Row Height Composable\r\n *\r\n * Calculates row heights based on cell content and text wrapping\r\n */\r\n\r\nexport interface AutoRowHeightConfig {\r\n  minHeight: number\r\n  maxHeight: number\r\n  fontFamily: string\r\n  fontSize: number\r\n  enableWrapping: boolean\r\n  padding: number\r\n}\r\n\r\nexport interface RowHeightResult {\r\n  rowId: string\r\n  calculatedHeight: number\r\n  isSuccess: boolean\r\n}\r\n\r\nexport const defaultAutoRowHeightConfig: AutoRowHeightConfig = {\r\n  minHeight: 32, // 32px default row height (matches default in store)\r\n  maxHeight: 400, // Default fallback (will be overridden by 70% of container height)\r\n  fontFamily: 'system-ui, -apple-system, sans-serif',\r\n  fontSize: 14,  // MUST match CSS font-size in .grid-cell\r\n  enableWrapping: true,\r\n  padding: 16 // 8px left + 8px right (horizontal padding for width calculation)\r\n}\r\n\r\nexport function useAutoRowHeight(config: AutoRowHeightConfig = defaultAutoRowHeightConfig) {\r\n  // Create a canvas for text measurement (reused for all calculations)\r\n  let canvas: HTMLCanvasElement | null = null\r\n  let context: CanvasRenderingContext2D | null = null\r\n\r\n  /**\r\n   * Gets the canvas context for text measurement\r\n   */\r\n  function getContext(): CanvasRenderingContext2D {\r\n    if (!canvas) {\r\n      canvas = document.createElement('canvas')\r\n      context = canvas.getContext('2d')\r\n    }\r\n\r\n    if (!context) {\r\n      throw new Error('Failed to get canvas context')\r\n    }\r\n\r\n    // Set font for measurement\r\n    context.font = `${config.fontSize}px ${config.fontFamily}`\r\n\r\n    return context\r\n  }\r\n\r\n  /**\r\n   * Measures the height required for text in a given width\r\n   * IMPORTANT: Handles explicit newlines (\\n) from Shift+Enter\r\n   */\r\n  function measureTextHeight(text: string, width: number): number {\r\n    if (!text) return config.minHeight\r\n\r\n    const ctx = getContext()\r\n\r\n    if (!config.enableWrapping) {\r\n      // Single line - just return min height\r\n      return config.minHeight\r\n    }\r\n\r\n    // Split by newline characters FIRST to respect explicit line breaks (Shift+Enter)\r\n    const explicitLines = text.toString().split('\\n')\r\n\r\n    let lineHeight = config.fontSize * 1.5 // Line height is typically 1.5x font size\r\n    let totalLines = 0\r\n\r\n    // For each explicit line, calculate how many visual lines it needs (accounting for wrapping)\r\n    for (const line of explicitLines) {\r\n      if (!line || line.trim() === '') {\r\n        // Empty line still counts as one line\r\n        totalLines++\r\n        continue\r\n      }\r\n\r\n      // Split this line into words and calculate wrapping\r\n      const words = line.split(' ')\r\n      let currentLine = ''\r\n      let linesInThisSegment = 1\r\n\r\n      for (const word of words) {\r\n        const testLine = currentLine ? `${currentLine} ${word}` : word\r\n        const metrics = ctx.measureText(testLine)\r\n\r\n        if (metrics.width > width - config.padding) {\r\n          // Line is too long, wrap to next line\r\n          if (currentLine) {\r\n            linesInThisSegment++\r\n            currentLine = word\r\n          } else {\r\n            // Single word is too long, force it on one line\r\n            currentLine = word\r\n          }\r\n        } else {\r\n          currentLine = testLine\r\n        }\r\n      }\r\n\r\n      totalLines += linesInThisSegment\r\n    }\r\n\r\n    // Calculate total height\r\n    // Add vertical padding (10px from CSS: 5px top + 5px bottom = 10px total)\r\n    const verticalPadding = 10  // Must match CSS padding in .grid-cell (5px + 5px)\r\n    const totalHeight = totalLines * lineHeight + verticalPadding\r\n\r\n    // Apply min/max constraints\r\n    return Math.max(config.minHeight, Math.min(config.maxHeight, Math.ceil(totalHeight)))\r\n  }\r\n\r\n  /**\r\n   * Calculates the height for a single row based on all cell contents\r\n   */\r\n  function calculateRowHeight(\r\n    row: Record<string, any>,\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): RowHeightResult {\r\n    try {\r\n      let maxHeight = config.minHeight\r\n\r\n      // Measure each cell in the row\r\n      for (const column of columns) {\r\n        // Skip special columns EXCEPT ValidationAlerts\r\n        // ValidationAlerts should be measured because it contains important validation messages\r\n        // that need proper row height calculation for wrapping\r\n        if (column.specialType && column.specialType !== 'ValidationAlerts') {\r\n          continue\r\n        }\r\n\r\n        // Access cell value from cells array structure\r\n        let cellValue = null\r\n        if (row.cells && Array.isArray(row.cells)) {\r\n          // GridRow structure with cells array\r\n          const cell = row.cells.find((c: any) => c.columnName === column.name)\r\n          cellValue = cell?.value\r\n        } else {\r\n          // Fallback to direct property access for backwards compatibility\r\n          cellValue = row[column.name]\r\n        }\r\n\r\n        if (cellValue == null) continue\r\n\r\n        const textValue = String(cellValue)\r\n        const cellHeight = measureTextHeight(textValue, column.width)\r\n\r\n        maxHeight = Math.max(maxHeight, cellHeight)\r\n      }\r\n\r\n      return {\r\n        rowId: row.__rowId || row.rowId,\r\n        calculatedHeight: maxHeight,\r\n        isSuccess: true\r\n      }\r\n    } catch (error) {\r\n      console.error('Row height calculation failed:', error)\r\n      return {\r\n        rowId: row.__rowId || row.rowId,\r\n        calculatedHeight: config.minHeight,\r\n        isSuccess: false\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calculates heights for multiple rows (batch operation)\r\n   */\r\n  function calculateRowHeights(\r\n    rows: Record<string, any>[],\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): RowHeightResult[] {\r\n    return rows.map(row => calculateRowHeight(row, columns))\r\n  }\r\n\r\n  /**\r\n   * Calculates heights for all rows and updates them in place\r\n   *  FIX: Async with batching to prevent UI freeze\r\n   */\r\n  async function applyAutoRowHeight(\r\n    rows: Array<{ rowId: string; height: number; [key: string]: any }>,\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): Promise<{ totalRowsUpdated: number; averageHeight: number }> {\r\n    let totalHeight = 0\r\n    let updatedCount = 0\r\n\r\n    //  FIX: Batch processing with UI yielding\r\n    const BATCH_SIZE = 50  // Process 50 rows at a time\r\n    const totalBatches = Math.ceil(rows.length / BATCH_SIZE)\r\n\r\n    for (let batchIndex = 0; batchIndex < totalBatches; batchIndex++) {\r\n      const batchStart = batchIndex * BATCH_SIZE\r\n      const batchEnd = Math.min(batchStart + BATCH_SIZE, rows.length)\r\n      const batch = rows.slice(batchStart, batchEnd)\r\n\r\n      console.log(`[AutoRowHeight] Processing batch ${batchIndex + 1}/${totalBatches} (rows ${batchStart}-${batchEnd - 1})`)\r\n\r\n      for (const row of batch) {\r\n        const result = calculateRowHeight(row, columns)\r\n\r\n        if (result.isSuccess) {\r\n          row.height = result.calculatedHeight\r\n          totalHeight += result.calculatedHeight\r\n          updatedCount++\r\n        }\r\n      }\r\n\r\n      //  K: Yield UI po kadom batchi\r\n      await new Promise(resolve => setTimeout(resolve, 0))\r\n    }\r\n\r\n    return {\r\n      totalRowsUpdated: updatedCount,\r\n      averageHeight: updatedCount > 0 ? totalHeight / updatedCount : config.minHeight\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Recalculates heights for specific rows (e.g., after editing)\r\n   */\r\n  function recalculateRows(\r\n    rows: Array<{ rowId: string; height: number; [key: string]: any }>,\r\n    rowIds: string[],\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): number {\r\n    let updatedCount = 0\r\n\r\n    for (const row of rows) {\r\n      if (rowIds.includes(row.rowId)) {\r\n        const result = calculateRowHeight(row, columns)\r\n\r\n        if (result.isSuccess) {\r\n          row.height = result.calculatedHeight\r\n          updatedCount++\r\n        }\r\n      }\r\n    }\r\n\r\n    return updatedCount\r\n  }\r\n\r\n  /**\r\n   * Updates the maxHeight config value dynamically\r\n   * Used when container height changes\r\n   */\r\n  function updateMaxHeight(newMaxHeight: number) {\r\n    config.maxHeight = newMaxHeight\r\n    console.log(`[useAutoRowHeight] maxHeight updated to: ${newMaxHeight}px`)\r\n  }\r\n\r\n  return {\r\n    calculateRowHeight,\r\n    calculateRowHeights,\r\n    applyAutoRowHeight,\r\n    recalculateRows,\r\n    measureTextHeight,\r\n    updateMaxHeight  // NEW: Allow dynamic maxHeight updates\r\n  }\r\n}\r\n","/**\r\n * Keyboard Shortcuts Composable\r\n *\r\n * Provides keyboard shortcut registration and handling with context support\r\n */\r\n\r\nimport { onMounted, onUnmounted } from 'vue'\r\n\r\nexport enum ShortcutContext {\r\n  Normal = 'normal',\r\n  Editing = 'editing',\r\n  Selection = 'selection',\r\n  Any = 'any'\r\n}\r\n\r\nexport interface KeyCombination {\r\n  key: string\r\n  ctrl?: boolean\r\n  shift?: boolean\r\n  alt?: boolean\r\n  meta?: boolean\r\n}\r\n\r\nexport interface ShortcutDefinition {\r\n  name: string\r\n  key: KeyCombination\r\n  handler: (event: KeyboardEvent) => void | Promise<void>\r\n  context?: ShortcutContext\r\n  enabled?: boolean\r\n  priority?: number\r\n  description?: string\r\n}\r\n\r\nexport interface ShortcutOptions {\r\n  enabled?: boolean\r\n  context?: ShortcutContext\r\n}\r\n\r\nexport function useShortcuts(options: ShortcutOptions = {}) {\r\n  const shortcuts = new Map<string, ShortcutDefinition>()\r\n  const currentContext = options.context || ShortcutContext.Normal\r\n\r\n  /**\r\n   * Converts KeyCombination to string key for map\r\n   */\r\n  function keyCombinationToString(key: KeyCombination): string {\r\n    const parts: string[] = []\r\n    if (key.ctrl) parts.push('Ctrl')\r\n    if (key.shift) parts.push('Shift')\r\n    if (key.alt) parts.push('Alt')\r\n    if (key.meta) parts.push('Meta')\r\n    parts.push(key.key.toUpperCase())\r\n    return parts.join('+')\r\n  }\r\n\r\n  /**\r\n   * Checks if keyboard event matches key combination\r\n   */\r\n  function matchesKeyCombination(event: KeyboardEvent, key: KeyCombination): boolean {\r\n    return (\r\n      event.key.toUpperCase() === key.key.toUpperCase() &&\r\n      !!event.ctrlKey === !!key.ctrl &&\r\n      !!event.shiftKey === !!key.shift &&\r\n      !!event.altKey === !!key.alt &&\r\n      !!event.metaKey === !!key.meta\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Checks if shortcut should execute in current context\r\n   */\r\n  function isContextMatch(shortcutContext: ShortcutContext, current: ShortcutContext): boolean {\r\n    return shortcutContext === ShortcutContext.Any ||\r\n           shortcutContext === current ||\r\n           current === ShortcutContext.Any\r\n  }\r\n\r\n  /**\r\n   * Handles keyboard events\r\n   */\r\n  async function handleKeyDown(event: KeyboardEvent): Promise<void> {\r\n    if (!options.enabled && options.enabled !== undefined) {\r\n      return\r\n    }\r\n\r\n    // Find matching shortcuts\r\n    const matchingShortcuts = Array.from(shortcuts.values()).filter(shortcut => {\r\n      return (\r\n        shortcut.enabled !== false &&\r\n        matchesKeyCombination(event, shortcut.key) &&\r\n        isContextMatch(shortcut.context || ShortcutContext.Normal, currentContext)\r\n      )\r\n    })\r\n\r\n    if (matchingShortcuts.length === 0) {\r\n      return\r\n    }\r\n\r\n    // Sort by priority (higher priority first)\r\n    matchingShortcuts.sort((a, b) => (b.priority || 0) - (a.priority || 0))\r\n\r\n    // Execute highest priority shortcut\r\n    const shortcut = matchingShortcuts[0]\r\n    event.preventDefault()\r\n    event.stopPropagation()\r\n\r\n    try {\r\n      await shortcut.handler(event)\r\n    } catch (error) {\r\n      console.error(`Shortcut execution failed for ${shortcut.name}:`, error)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Registers a keyboard shortcut\r\n   */\r\n  function registerShortcut(definition: ShortcutDefinition): void {\r\n    const keyString = keyCombinationToString(definition.key)\r\n\r\n    if (shortcuts.has(keyString)) {\r\n      console.warn(`Shortcut ${keyString} is already registered. Overwriting.`)\r\n    }\r\n\r\n    shortcuts.set(keyString, {\r\n      ...definition,\r\n      enabled: definition.enabled !== false,\r\n      context: definition.context || ShortcutContext.Normal,\r\n      priority: definition.priority || 0\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Registers multiple shortcuts\r\n   */\r\n  function registerShortcuts(definitions: ShortcutDefinition[]): void {\r\n    definitions.forEach(registerShortcut)\r\n  }\r\n\r\n  /**\r\n   * Unregisters a shortcut by key combination\r\n   */\r\n  function unregisterShortcut(key: KeyCombination): boolean {\r\n    const keyString = keyCombinationToString(key)\r\n    return shortcuts.delete(keyString)\r\n  }\r\n\r\n  /**\r\n   * Unregisters a shortcut by name\r\n   */\r\n  function unregisterShortcutByName(name: string): boolean {\r\n    const entry = Array.from(shortcuts.entries()).find(([_, def]) => def.name === name)\r\n    if (entry) {\r\n      shortcuts.delete(entry[0])\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  /**\r\n   * Enables or disables a shortcut\r\n   */\r\n  function setShortcutEnabled(name: string, enabled: boolean): void {\r\n    const entry = Array.from(shortcuts.entries()).find(([_, def]) => def.name === name)\r\n    if (entry) {\r\n      entry[1].enabled = enabled\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets all registered shortcuts\r\n   */\r\n  function getShortcuts(): ShortcutDefinition[] {\r\n    return Array.from(shortcuts.values())\r\n  }\r\n\r\n  /**\r\n   * Gets shortcuts for specific context\r\n   */\r\n  function getShortcutsByContext(context: ShortcutContext): ShortcutDefinition[] {\r\n    return Array.from(shortcuts.values()).filter(\r\n      s => s.context === context || s.context === ShortcutContext.Any\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Clears all shortcuts\r\n   */\r\n  function clearShortcuts(): void {\r\n    shortcuts.clear()\r\n  }\r\n\r\n  // Setup keyboard event listener\r\n  onMounted(() => {\r\n    if (options.enabled !== false) {\r\n      document.addEventListener('keydown', handleKeyDown as unknown as EventListener)\r\n    }\r\n  })\r\n\r\n  // Cleanup\r\n  onUnmounted(() => {\r\n    document.removeEventListener('keydown', handleKeyDown as unknown as EventListener)\r\n  })\r\n\r\n  return {\r\n    registerShortcut,\r\n    registerShortcuts,\r\n    unregisterShortcut,\r\n    unregisterShortcutByName,\r\n    setShortcutEnabled,\r\n    getShortcuts,\r\n    getShortcutsByContext,\r\n    clearShortcuts,\r\n    handleKeyDown\r\n  }\r\n}\r\n\r\n/**\r\n * Helper functions to create common key combinations\r\n */\r\nexport const Keys = {\r\n  ctrl: (key: string): KeyCombination => ({ key, ctrl: true }),\r\n  shift: (key: string): KeyCombination => ({ key, shift: true }),\r\n  alt: (key: string): KeyCombination => ({ key, alt: true }),\r\n  ctrlShift: (key: string): KeyCombination => ({ key, ctrl: true, shift: true }),\r\n  ctrlAlt: (key: string): KeyCombination => ({ key, ctrl: true, alt: true }),\r\n  single: (key: string): KeyCombination => ({ key })\r\n}\r\n\r\n/**\r\n * Pre-defined shortcut definitions for common operations\r\n */\r\nexport function createDefaultShortcuts(handlers: {\r\n  onCopy?: () => void | Promise<void>\r\n  onPaste?: () => void | Promise<void>\r\n  onCut?: () => void | Promise<void>\r\n  onDelete?: () => void | Promise<void>\r\n  onSelectAll?: () => void | Promise<void>\r\n  onFind?: () => void | Promise<void>\r\n  onUndo?: () => void | Promise<void>\r\n  onRedo?: () => void | Promise<void>\r\n  onEscape?: () => void | Promise<void>\r\n  onEnter?: () => void | Promise<void>\r\n  onTab?: () => void | Promise<void>\r\n  onArrowUp?: () => void | Promise<void>\r\n  onArrowDown?: () => void | Promise<void>\r\n  onArrowLeft?: () => void | Promise<void>\r\n  onArrowRight?: () => void | Promise<void>\r\n}): ShortcutDefinition[] {\r\n  const shortcuts: ShortcutDefinition[] = []\r\n\r\n  if (handlers.onCopy) {\r\n    shortcuts.push({\r\n      name: 'Copy',\r\n      key: Keys.ctrl('c'),\r\n      handler: handlers.onCopy,\r\n      description: 'Copy selected cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onPaste) {\r\n    shortcuts.push({\r\n      name: 'Paste',\r\n      key: Keys.ctrl('v'),\r\n      handler: handlers.onPaste,\r\n      description: 'Paste from clipboard',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onCut) {\r\n    shortcuts.push({\r\n      name: 'Cut',\r\n      key: Keys.ctrl('x'),\r\n      handler: handlers.onCut,\r\n      description: 'Cut selected cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onDelete) {\r\n    shortcuts.push({\r\n      name: 'Delete',\r\n      key: Keys.single('Delete'),\r\n      handler: handlers.onDelete,\r\n      description: 'Delete selected cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onSelectAll) {\r\n    shortcuts.push({\r\n      name: 'SelectAll',\r\n      key: Keys.ctrl('a'),\r\n      handler: handlers.onSelectAll,\r\n      description: 'Select all cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onFind) {\r\n    shortcuts.push({\r\n      name: 'Find',\r\n      key: Keys.ctrl('f'),\r\n      handler: handlers.onFind,\r\n      description: 'Open find dialog',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onUndo) {\r\n    shortcuts.push({\r\n      name: 'Undo',\r\n      key: Keys.ctrl('z'),\r\n      handler: handlers.onUndo,\r\n      description: 'Undo last action',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onRedo) {\r\n    shortcuts.push({\r\n      name: 'Redo',\r\n      key: Keys.ctrlShift('z'),\r\n      handler: handlers.onRedo,\r\n      description: 'Redo last undone action',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onEscape) {\r\n    shortcuts.push({\r\n      name: 'Escape',\r\n      key: Keys.single('Escape'),\r\n      handler: handlers.onEscape,\r\n      description: 'Cancel current operation',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onEnter) {\r\n    shortcuts.push({\r\n      name: 'Enter',\r\n      key: Keys.single('Enter'),\r\n      handler: handlers.onEnter,\r\n      description: 'Confirm edit and move to next row',\r\n      context: ShortcutContext.Editing,\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onTab) {\r\n    shortcuts.push({\r\n      name: 'Tab',\r\n      key: Keys.single('Tab'),\r\n      handler: handlers.onTab,\r\n      description: 'Move to next cell',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowUp) {\r\n    shortcuts.push({\r\n      name: 'ArrowUp',\r\n      key: Keys.single('ArrowUp'),\r\n      handler: handlers.onArrowUp,\r\n      description: 'Move selection up',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowDown) {\r\n    shortcuts.push({\r\n      name: 'ArrowDown',\r\n      key: Keys.single('ArrowDown'),\r\n      handler: handlers.onArrowDown,\r\n      description: 'Move selection down',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowLeft) {\r\n    shortcuts.push({\r\n      name: 'ArrowLeft',\r\n      key: Keys.single('ArrowLeft'),\r\n      handler: handlers.onArrowLeft,\r\n      description: 'Move selection left',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowRight) {\r\n    shortcuts.push({\r\n      name: 'ArrowRight',\r\n      key: Keys.single('ArrowRight'),\r\n      handler: handlers.onArrowRight,\r\n      description: 'Move selection right',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  return shortcuts\r\n}\r\n","/**\r\n * Asynchronous Logger with Queue\r\n *\r\n * FEATURES:\r\n * - Non-blocking: logs are queued and written asynchronously\r\n * - FIFO queue: oldest logs are written first\r\n * - Batch processing: multiple logs written in one operation\r\n * - Error tracking: captures unhandled errors automatically\r\n */\r\n\r\nimport { ref } from 'vue'\r\n\r\nexport type LogLevel = 'DEBUG' | 'INFO' | 'WARN' | 'ERROR' | 'FATAL'\r\n\r\nexport interface LogEntry {\r\n  timestamp: string\r\n  level: LogLevel\r\n  category: string\r\n  message: string\r\n  data?: any\r\n}\r\n\r\n// Global log queue (FIFO - First In, First Out)\r\nconst logQueue = ref<LogEntry[]>([])\r\nconst isProcessing = ref(false)\r\nconst BATCH_SIZE = 50 // Process 50 logs at once\r\nconst PROCESSING_INTERVAL = 100 // Process every 100ms\r\n\r\nlet processingTimer: number | null = null\r\n\r\n/**\r\n * Formats timestamp to ISO string with milliseconds\r\n */\r\nfunction getTimestamp(): string {\r\n  const now = new Date()\r\n  return now.toISOString()\r\n}\r\n\r\n/**\r\n * Adds log entry to queue (non-blocking)\r\n */\r\nfunction enqueueLog(level: LogLevel, category: string, message: string, data?: any) {\r\n  const entry: LogEntry = {\r\n    timestamp: getTimestamp(),\r\n    level,\r\n    category,\r\n    message,\r\n    data: data !== undefined ? JSON.parse(JSON.stringify(data)) : undefined\r\n  }\r\n\r\n  logQueue.value.push(entry)\r\n\r\n  // Start processing if not already running\r\n  if (!isProcessing.value) {\r\n    startProcessing()\r\n  }\r\n}\r\n\r\n/**\r\n * Starts asynchronous log processing\r\n */\r\nfunction startProcessing() {\r\n  if (processingTimer !== null) return\r\n\r\n  isProcessing.value = true\r\n\r\n  processingTimer = window.setInterval(() => {\r\n    processLogBatch()\r\n  }, PROCESSING_INTERVAL)\r\n}\r\n\r\n/**\r\n * Stops log processing (when queue is empty)\r\n */\r\nfunction stopProcessing() {\r\n  if (processingTimer !== null) {\r\n    window.clearInterval(processingTimer)\r\n    processingTimer = null\r\n  }\r\n  isProcessing.value = false\r\n}\r\n\r\n/**\r\n * Processes a batch of logs from the queue\r\n * Uses FIFO - oldest logs are processed first\r\n */\r\nfunction processLogBatch() {\r\n  if (logQueue.value.length === 0) {\r\n    stopProcessing()\r\n    return\r\n  }\r\n\r\n  // Take oldest logs (FIFO)\r\n  const batch = logQueue.value.splice(0, BATCH_SIZE)\r\n\r\n  // Write batch to console\r\n  for (const entry of batch) {\r\n    writeLogToConsole(entry)\r\n  }\r\n}\r\n\r\n/**\r\n * Writes a single log entry to console\r\n */\r\nfunction writeLogToConsole(entry: LogEntry) {\r\n  const prefix = `[${entry.timestamp}] [${entry.level}] [${entry.category}]`\r\n  const message = `${prefix} ${entry.message}`\r\n\r\n  switch (entry.level) {\r\n    case 'DEBUG':\r\n      if (entry.data !== undefined) {\r\n        console.debug(message, entry.data)\r\n      } else {\r\n        console.debug(message)\r\n      }\r\n      break\r\n    case 'INFO':\r\n      if (entry.data !== undefined) {\r\n        console.log(message, entry.data)\r\n      } else {\r\n        console.log(message)\r\n      }\r\n      break\r\n    case 'WARN':\r\n      if (entry.data !== undefined) {\r\n        console.warn(message, entry.data)\r\n      } else {\r\n        console.warn(message)\r\n      }\r\n      break\r\n    case 'ERROR':\r\n    case 'FATAL':\r\n      if (entry.data !== undefined) {\r\n        console.error(message, entry.data)\r\n      } else {\r\n        console.error(message)\r\n      }\r\n      break\r\n  }\r\n}\r\n\r\n/**\r\n * Public Logger Interface\r\n */\r\nexport function useLogger(category: string = 'App') {\r\n  return {\r\n    debug(message: string, data?: any) {\r\n      enqueueLog('DEBUG', category, message, data)\r\n    },\r\n\r\n    info(message: string, data?: any) {\r\n      enqueueLog('INFO', category, message, data)\r\n    },\r\n\r\n    warn(message: string, data?: any) {\r\n      enqueueLog('WARN', category, message, data)\r\n    },\r\n\r\n    error(message: string, data?: any) {\r\n      enqueueLog('ERROR', category, message, data)\r\n    },\r\n\r\n    fatal(message: string, data?: any) {\r\n      enqueueLog('FATAL', category, message, data)\r\n    },\r\n\r\n    /**\r\n     * Flushes all pending logs immediately (synchronously)\r\n     */\r\n    flush() {\r\n      while (logQueue.value.length > 0) {\r\n        const entry = logQueue.value.shift()!\r\n        writeLogToConsole(entry)\r\n      }\r\n      stopProcessing()\r\n    },\r\n\r\n    /**\r\n     * Gets current queue size\r\n     */\r\n    getQueueSize(): number {\r\n      return logQueue.value.length\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Global Error Handlers\r\n * Captures unhandled errors and promise rejections\r\n */\r\nexport function setupGlobalErrorHandlers() {\r\n  const logger = useLogger('GlobalError')\r\n\r\n  // Capture unhandled JavaScript errors\r\n  window.addEventListener('error', (event: ErrorEvent) => {\r\n    logger.error('Unhandled Error', {\r\n      message: event.message,\r\n      filename: event.filename,\r\n      lineno: event.lineno,\r\n      colno: event.colno,\r\n      error: event.error?.stack || event.error?.toString() || 'No stack trace'\r\n    })\r\n  })\r\n\r\n  // Capture unhandled promise rejections\r\n  window.addEventListener('unhandledrejection', (event: PromiseRejectionEvent) => {\r\n    logger.error('Unhandled Promise Rejection', {\r\n      reason: event.reason?.toString() || 'Unknown reason',\r\n      stack: event.reason?.stack || 'No stack trace'\r\n    })\r\n  })\r\n\r\n  logger.info('Global error handlers initialized')\r\n}\r\n\r\n/**\r\n * Vue Error Handler\r\n * Install this in main.ts: app.config.errorHandler = vueErrorHandler\r\n */\r\nexport function vueErrorHandler(err: any, instance: any, info: string) {\r\n  const logger = useLogger('VueError')\r\n\r\n  logger.error('Vue Error', {\r\n    error: err?.toString() || 'Unknown error',\r\n    stack: err?.stack || 'No stack trace',\r\n    component: instance?.$options?.name || instance?.$options?.__name || 'Unknown component',\r\n    info\r\n  })\r\n}\r\n","/**\r\n * Grid API Service\r\n *\r\n * Supports both HTTP mode (development) and WebView2 Host Objects mode (production)\r\n */\r\n\r\nimport type { GridColumn } from '../stores/dataGridStore'\r\n\r\n// Extend Window interface for WebView2 gridApi\r\ndeclare global {\r\n  interface Window {\r\n    gridApi?: {\r\n      GetData(): Promise<string>\r\n      ImportData(jsonData: string): Promise<string>\r\n      ExportData(options: string): Promise<string>\r\n      GetConfig(): Promise<string>\r\n      SetValidationRules(jsonRules: string): Promise<string>\r\n      GetValidationRules(): Promise<string>\r\n      GetColumnNames(): Promise<string>\r\n      GetColumns(): Promise<string>\r\n      GetCurrentData(): Promise<string>\r\n      HealthCheck(): Promise<string>\r\n    }\r\n  }\r\n}\r\n\r\nconst BASE_URL = 'http://localhost:5000/api/grid'\r\n\r\nexport interface GridRow {\r\n  [key: string]: any\r\n  Checkbox?: boolean\r\n}\r\n\r\nexport interface ValidationRule {\r\n  columnName: string\r\n  ruleType: string\r\n  parameters: Record<string, any>\r\n  errorMessage: string\r\n}\r\n\r\nexport interface GridConfig {\r\n  pageSize: number\r\n  enableSort: boolean\r\n  enableFilter: boolean\r\n  enableSearch: boolean\r\n  enableValidation: boolean\r\n  showRowNumber: boolean\r\n  showCheckbox: boolean\r\n  showValidationAlerts: boolean\r\n  minRowHeight: number\r\n  maxRowHeight: number\r\n}\r\n\r\nexport interface ApiResponse<T> {\r\n  success: boolean\r\n  data?: T\r\n  error?: string\r\n  message?: string\r\n  rowCount?: number\r\n}\r\n\r\nclass GridApiService {\r\n  private isHostMode = false\r\n\r\n  constructor() {\r\n    // Detect if running in WebView2 with Host Objects\r\n    this.isHostMode = this.detectHostMode()\r\n    console.log(`Grid API Mode: ${this.isHostMode ? 'Host Objects' : 'HTTP'}`)\r\n  }\r\n\r\n  /**\r\n   * Detect if running in WebView2 with gridApi bridge\r\n   */\r\n  private detectHostMode(): boolean {\r\n    return !!window.gridApi\r\n  }\r\n\r\n  /**\r\n   * Call gridApi method (WebView2 mode with postMessage bridge)\r\n   */\r\n  private async callHostApi<T>(method: string, ...args: string[]): Promise<ApiResponse<T>> {\r\n    try {\r\n      if (!window.gridApi) {\r\n        throw new Error('Grid API not available')\r\n      }\r\n\r\n      const hostApi = window.gridApi\r\n      const resultJson = await (hostApi as any)[method](...args)\r\n\r\n      // Parse JSON response from C#\r\n      const result = JSON.parse(resultJson)\r\n      return result as ApiResponse<T>\r\n    } catch (error) {\r\n      console.error('Grid API call failed:', error)\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Unknown error'\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * HTTP request (development mode)\r\n   */\r\n  private async request<T>(endpoint: string, options?: RequestInit): Promise<ApiResponse<T>> {\r\n    try {\r\n      const response = await fetch(`${BASE_URL}${endpoint}`, {\r\n        ...options,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          ...options?.headers\r\n        },\r\n        credentials: 'include'\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({ error: response.statusText }))\r\n        return {\r\n          success: false,\r\n          error: errorData.error || `HTTP ${response.status}: ${response.statusText}`\r\n        }\r\n      }\r\n\r\n      const data = await response.json()\r\n      return data\r\n    } catch (error) {\r\n      console.error('API request failed:', error)\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Unknown error'\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get grid data from backend\r\n   */\r\n  async getData(): Promise<ApiResponse<GridRow[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<GridRow[]>('GetData')\r\n    } else {\r\n      return this.request<GridRow[]>('/data')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Import data to backend (replaces existing data)\r\n   */\r\n  async importData(data: GridRow[]): Promise<ApiResponse<void>> {\r\n    if (this.isHostMode) {\r\n      const jsonData = JSON.stringify({ data })\r\n      return this.callHostApi<void>('ImportData', jsonData)\r\n    } else {\r\n      return this.request<void>('/import', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ data })\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Export data from backend\r\n   */\r\n  async exportData(options?: {\r\n    onlyFiltered?: boolean\r\n    filteredRowIds?: string[]\r\n    columnNames?: string[]\r\n  }): Promise<ApiResponse<GridRow[]>> {\r\n    if (this.isHostMode) {\r\n      const optionsJson = JSON.stringify({\r\n        OnlyFiltered: options?.onlyFiltered ?? false,\r\n        FilteredRowIds: options?.filteredRowIds ?? null,\r\n        ColumnNames: options?.columnNames ?? null\r\n      })\r\n      return this.callHostApi<GridRow[]>('ExportData', optionsJson)\r\n    } else {\r\n      const params = new URLSearchParams()\r\n      if (options?.onlyFiltered) params.append('onlyFiltered', 'true')\r\n      if (options?.filteredRowIds) params.append('filteredRowIds', JSON.stringify(options.filteredRowIds))\r\n      if (options?.columnNames) params.append('columnNames', JSON.stringify(options.columnNames))\r\n\r\n      const query = params.toString() ? `?${params.toString()}` : ''\r\n      return this.request<GridRow[]>(`/export${query}`)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get grid configuration\r\n   */\r\n  async getConfig(): Promise<ApiResponse<GridConfig>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<GridConfig>('GetConfig')\r\n    } else {\r\n      return this.request<GridConfig>('/config')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set validation rules\r\n   */\r\n  async setValidationRules(rules: ValidationRule[]): Promise<ApiResponse<void>> {\r\n    if (this.isHostMode) {\r\n      const jsonRules = JSON.stringify({ rules })\r\n      return this.callHostApi<void>('SetValidationRules', jsonRules)\r\n    } else {\r\n      return this.request<void>('/validation-rules', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ rules })\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get validation rules\r\n   */\r\n  async getValidationRules(): Promise<ApiResponse<ValidationRule[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<ValidationRule[]>('GetValidationRules')\r\n    } else {\r\n      return this.request<ValidationRule[]>('/validation-rules')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get column definitions with full metadata\r\n   */\r\n  async getColumns(): Promise<ApiResponse<GridColumn[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<GridColumn[]>('GetColumns')\r\n    } else {\r\n      return this.request<GridColumn[]>('/columns/definitions')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current data (alias for getData)\r\n   */\r\n  async getCurrentData(): Promise<ApiResponse<GridRow[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<GridRow[]>('GetCurrentData')\r\n    } else {\r\n      return this.getData()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all column names (data columns + checkbox special column)\r\n   */\r\n  async getColumnNames(): Promise<ApiResponse<string[]>> {\r\n    if (this.isHostMode) {\r\n      const result = await this.callHostApi<{ columnNames: string[] }>('GetColumnNames')\r\n      return {\r\n        success: result.success,\r\n        data: result.data?.columnNames,\r\n        error: result.error\r\n      }\r\n    } else {\r\n      return this.request<string[]>('/columns')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Health check\r\n   */\r\n  async healthCheck(): Promise<boolean> {\r\n    try {\r\n      if (this.isHostMode) {\r\n        const result = await this.callHostApi<any>('HealthCheck')\r\n        return result.success\r\n      } else {\r\n        const response = await fetch('http://localhost:5000/health')\r\n        return response.ok\r\n      }\r\n    } catch {\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\nexport const gridApi = new GridApiService()\r\n","import { computed, inject, provide, ref, type Ref } from 'vue'\r\nimport type {\r\n  DataGridTheme,\r\n  ListBoxTheme,\r\n  ThemeConfig,\r\n  ComprehensiveDataGridTheme,\r\n  ComprehensiveListBoxTheme\r\n} from '@/types/theme'\r\n\r\n// ============================================================================\r\n// Default Theme: Light\r\n// ============================================================================\r\n\r\nexport const defaultDataGridTheme: DataGridTheme = {\r\n  cellColors: {\r\n    defaultBackground: '#ffffff',\r\n    defaultForeground: '#212529',\r\n    hoverBackground: '#f8f9fa',\r\n    hoverForeground: '#212529',\r\n    focusedBackground: '#e3f2fd',\r\n    focusedForeground: '#0d6efd',\r\n    disabledBackground: '#e9ecef',\r\n    disabledForeground: '#6c757d',\r\n    readOnlyBackground: '#f8f9fa',\r\n    readOnlyForeground: '#495057'\r\n  },\r\n  rowColors: {\r\n    evenRowBackground: '#ffffff',\r\n    oddRowBackground: '#f8f9fa',\r\n    hoverBackground: '#e3f2fd',\r\n    selectedBackground: '#0d6efd',\r\n    selectedForeground: '#ffffff',\r\n    selectedInactiveBackground: '#e9ecef',\r\n    selectedInactiveForeground: '#495057'\r\n  },\r\n  headerColors: {\r\n    background: '#f1f3f5',\r\n    foreground: '#212529',\r\n    hoverBackground: '#e9ecef',\r\n    pressedBackground: '#dee2e6',\r\n    sortIndicatorColor: '#0d6efd'\r\n  },\r\n  validationColors: {\r\n    errorBackground: '#ffebee',\r\n    errorForeground: '#c62828',\r\n    errorBorder: '#ef5350',\r\n    warningBackground: '#fff3e0',\r\n    warningForeground: '#e65100',\r\n    warningBorder: '#ff9800',\r\n    infoBackground: '#e3f2fd',\r\n    infoForeground: '#1565c0',\r\n    infoBorder: '#2196f3'\r\n  },\r\n  selectionColors: {\r\n    selectionBorder: '#0d6efd',\r\n    selectionFill: 'rgba(13, 110, 253, 0.1)',\r\n    multiSelectionBackground: '#bbdefb',\r\n    multiSelectionForeground: '#0d6efd'\r\n  },\r\n  borderColors: {\r\n    cellBorder: '#e0e0e0',\r\n    rowBorder: '#e0e0e0',\r\n    columnBorder: '#dee2e6',\r\n    gridBorder: '#ced4da',\r\n    focusedCellBorder: '#0d6efd'\r\n  },\r\n  specialColumnColors: {\r\n    rowNumberBackground: '#f5f5f5',\r\n    rowNumberForeground: '#666666',\r\n    checkboxBorder: '#ced4da',\r\n    checkboxBackground: '#ffffff',\r\n    checkboxForeground: '#212529',\r\n    deleteRowBackground: 'transparent',\r\n    deleteRowForeground: '#dc3545',\r\n    deleteRowHoverBackground: '#ffebee',\r\n    insertRowBackground: 'transparent',\r\n    insertRowForeground: '#28a745',\r\n    insertRowBorder: 'transparent',\r\n    insertRowHoverBackground: '#e8f5e9',\r\n    insertRowHoverForeground: '#1b5e20',\r\n    validationAlertsErrorBackground: '#ffebee',\r\n    validationAlertsErrorForeground: '#c62828'\r\n  },\r\n  uiControlColors: {\r\n    resizeGripColor: '#adb5bd',\r\n    menuBackground: '#ffffff',\r\n    menuForeground: '#212529',\r\n    menuHoverBackground: '#f8f9fa',\r\n    dialogBackground: '#ffffff',\r\n    dialogForeground: '#212529',\r\n    dialogBorder: '#dee2e6',\r\n    placeholderColor: '#6c757d',\r\n    searchPanelBackground: '#f8f9fa',\r\n    searchPanelForeground: '#212529',\r\n    searchPanelBorder: '#ced4da',\r\n    filterRowBackground: '#f8f9fa',\r\n    filterRowForeground: '#212529',\r\n    filterRowBorder: '#dee2e6',\r\n    paginationBackground: '#ffffff',\r\n    paginationForeground: '#212529',\r\n    paginationBorder: '#dee2e6',\r\n    paginationButtonHoverBackground: '#e9ecef'\r\n  }\r\n}\r\n\r\nexport const defaultListBoxTheme: ListBoxTheme = {\r\n  itemColors: {\r\n    defaultBackground: '#ffffff',\r\n    defaultForeground: '#212529',\r\n    hoverBackground: '#f8f9fa',\r\n    hoverForeground: '#212529',\r\n    selectedBackground: '#e3f2fd',\r\n    selectedForeground: '#0d6efd',\r\n    selectedHoverBackground: '#bbdefb',\r\n    selectedHoverForeground: '#0d6efd',\r\n    disabledBackground: '#e9ecef',\r\n    disabledForeground: '#6c757d'\r\n  },\r\n  containerColors: {\r\n    background: '#ffffff',\r\n    border: '#ced4da',\r\n    focusedBorder: '#0d6efd',\r\n    titleForeground: '#212529'\r\n  },\r\n  checkboxColors: {\r\n    border: '#ced4da',\r\n    background: '#ffffff',\r\n    checkedBackground: '#0d6efd',\r\n    checkedBorder: '#0d6efd',\r\n    hoverBorder: '#adb5bd'\r\n  },\r\n  scrollbarColors: {\r\n    trackBackground: '#f1f1f1',\r\n    thumbBackground: '#c1c1c1',\r\n    thumbHoverBackground: '#a8a8a8'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Dark Theme\r\n// ============================================================================\r\n\r\nexport const darkDataGridTheme: DataGridTheme = {\r\n  cellColors: {\r\n    defaultBackground: '#1e1e1e',\r\n    defaultForeground: '#e0e0e0',\r\n    hoverBackground: '#2d2d2d',\r\n    hoverForeground: '#e0e0e0',\r\n    focusedBackground: '#1e3a5f',\r\n    focusedForeground: '#64b5f6',\r\n    disabledBackground: '#2a2a2a',\r\n    disabledForeground: '#808080',\r\n    readOnlyBackground: '#252525',\r\n    readOnlyForeground: '#b0b0b0'\r\n  },\r\n  rowColors: {\r\n    evenRowBackground: '#1e1e1e',\r\n    oddRowBackground: '#252525',\r\n    hoverBackground: '#2d2d2d',\r\n    selectedBackground: '#1976d2',\r\n    selectedForeground: '#ffffff',\r\n    selectedInactiveBackground: '#3a3a3a',\r\n    selectedInactiveForeground: '#b0b0b0'\r\n  },\r\n  headerColors: {\r\n    background: '#2a2a2a',\r\n    foreground: '#e0e0e0',\r\n    hoverBackground: '#333333',\r\n    pressedBackground: '#3a3a3a',\r\n    sortIndicatorColor: '#64b5f6'\r\n  },\r\n  validationColors: {\r\n    errorBackground: '#3d1a1a',\r\n    errorForeground: '#ef5350',\r\n    errorBorder: '#c62828',\r\n    warningBackground: '#3d2e1a',\r\n    warningForeground: '#ffb74d',\r\n    warningBorder: '#f57c00',\r\n    infoBackground: '#1a2a3d',\r\n    infoForeground: '#64b5f6',\r\n    infoBorder: '#1976d2'\r\n  },\r\n  selectionColors: {\r\n    selectionBorder: '#1976d2',\r\n    selectionFill: 'rgba(25, 118, 210, 0.2)',\r\n    multiSelectionBackground: '#1e3a5f',\r\n    multiSelectionForeground: '#64b5f6'\r\n  },\r\n  borderColors: {\r\n    cellBorder: '#3a3a3a',\r\n    rowBorder: '#3a3a3a',\r\n    columnBorder: '#3a3a3a',\r\n    gridBorder: '#4a4a4a',\r\n    focusedCellBorder: '#1976d2'\r\n  },\r\n  specialColumnColors: {\r\n    rowNumberBackground: '#252525',\r\n    rowNumberForeground: '#b0b0b0',\r\n    checkboxBorder: '#4a4a4a',\r\n    checkboxBackground: '#2a2a2a',\r\n    checkboxForeground: '#e0e0e0',\r\n    deleteRowBackground: 'transparent',\r\n    deleteRowForeground: '#ef5350',\r\n    deleteRowHoverBackground: '#3d1a1a',\r\n    insertRowBackground: 'transparent',\r\n    insertRowForeground: '#66bb6a',\r\n    insertRowBorder: 'transparent',\r\n    insertRowHoverBackground: '#1a3d1a',\r\n    insertRowHoverForeground: '#81c784',\r\n    validationAlertsErrorBackground: '#3d1a1a',\r\n    validationAlertsErrorForeground: '#ef5350'\r\n  },\r\n  uiControlColors: {\r\n    resizeGripColor: '#5a5a5a',\r\n    menuBackground: '#2a2a2a',\r\n    menuForeground: '#e0e0e0',\r\n    menuHoverBackground: '#333333',\r\n    dialogBackground: '#2a2a2a',\r\n    dialogForeground: '#e0e0e0',\r\n    dialogBorder: '#4a4a4a',\r\n    placeholderColor: '#808080',\r\n    searchPanelBackground: '#252525',\r\n    searchPanelForeground: '#e0e0e0',\r\n    searchPanelBorder: '#4a4a4a',\r\n    filterRowBackground: '#252525',\r\n    filterRowForeground: '#e0e0e0',\r\n    filterRowBorder: '#4a4a4a',\r\n    paginationBackground: '#2a2a2a',\r\n    paginationForeground: '#e0e0e0',\r\n    paginationBorder: '#4a4a4a',\r\n    paginationButtonHoverBackground: '#333333'\r\n  }\r\n}\r\n\r\nexport const darkListBoxTheme: ListBoxTheme = {\r\n  itemColors: {\r\n    defaultBackground: '#1e1e1e',\r\n    defaultForeground: '#e0e0e0',\r\n    hoverBackground: '#2d2d2d',\r\n    hoverForeground: '#e0e0e0',\r\n    selectedBackground: '#1e3a5f',\r\n    selectedForeground: '#64b5f6',\r\n    selectedHoverBackground: '#2d4a6f',\r\n    selectedHoverForeground: '#64b5f6',\r\n    disabledBackground: '#2a2a2a',\r\n    disabledForeground: '#808080'\r\n  },\r\n  containerColors: {\r\n    background: '#1e1e1e',\r\n    border: '#4a4a4a',\r\n    focusedBorder: '#1976d2',\r\n    titleForeground: '#e0e0e0'\r\n  },\r\n  checkboxColors: {\r\n    border: '#4a4a4a',\r\n    background: '#2a2a2a',\r\n    checkedBackground: '#1976d2',\r\n    checkedBorder: '#1976d2',\r\n    hoverBorder: '#5a5a5a'\r\n  },\r\n  scrollbarColors: {\r\n    trackBackground: '#2a2a2a',\r\n    thumbBackground: '#4a4a4a',\r\n    thumbHoverBackground: '#5a5a5a'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// High Contrast Theme\r\n// ============================================================================\r\n\r\nexport const highContrastDataGridTheme: DataGridTheme = {\r\n  cellColors: {\r\n    defaultBackground: '#000000',\r\n    defaultForeground: '#ffffff',\r\n    hoverBackground: '#1a1a1a',\r\n    hoverForeground: '#ffff00',\r\n    focusedBackground: '#000080',\r\n    focusedForeground: '#ffffff',\r\n    disabledBackground: '#333333',\r\n    disabledForeground: '#808080',\r\n    readOnlyBackground: '#1a1a1a',\r\n    readOnlyForeground: '#c0c0c0'\r\n  },\r\n  rowColors: {\r\n    evenRowBackground: '#000000',\r\n    oddRowBackground: '#0d0d0d',\r\n    hoverBackground: '#1a1a1a',\r\n    selectedBackground: '#000080',\r\n    selectedForeground: '#ffffff',\r\n    selectedInactiveBackground: '#333333',\r\n    selectedInactiveForeground: '#c0c0c0'\r\n  },\r\n  headerColors: {\r\n    background: '#1a1a1a',\r\n    foreground: '#ffffff',\r\n    hoverBackground: '#333333',\r\n    pressedBackground: '#4d4d4d',\r\n    sortIndicatorColor: '#00ff00'\r\n  },\r\n  validationColors: {\r\n    errorBackground: '#330000',\r\n    errorForeground: '#ff0000',\r\n    errorBorder: '#ff0000',\r\n    warningBackground: '#332200',\r\n    warningForeground: '#ffff00',\r\n    warningBorder: '#ffff00',\r\n    infoBackground: '#003333',\r\n    infoForeground: '#00ffff',\r\n    infoBorder: '#00ffff'\r\n  },\r\n  selectionColors: {\r\n    selectionBorder: '#00ff00',\r\n    selectionFill: 'rgba(0, 255, 0, 0.2)',\r\n    multiSelectionBackground: '#000080',\r\n    multiSelectionForeground: '#ffffff'\r\n  },\r\n  borderColors: {\r\n    cellBorder: '#808080',\r\n    rowBorder: '#808080',\r\n    columnBorder: '#808080',\r\n    gridBorder: '#ffffff',\r\n    focusedCellBorder: '#00ff00'\r\n  },\r\n  specialColumnColors: {\r\n    rowNumberBackground: '#1a1a1a',\r\n    rowNumberForeground: '#ffffff',\r\n    checkboxBorder: '#ffffff',\r\n    checkboxBackground: '#000000',\r\n    checkboxForeground: '#ffffff',\r\n    deleteRowBackground: 'transparent',\r\n    deleteRowForeground: '#ff0000',\r\n    deleteRowHoverBackground: '#330000',\r\n    insertRowBackground: 'transparent',\r\n    insertRowForeground: '#00ff00',\r\n    insertRowBorder: 'transparent',\r\n    insertRowHoverBackground: '#003300',\r\n    insertRowHoverForeground: '#00ff00',\r\n    validationAlertsErrorBackground: '#330000',\r\n    validationAlertsErrorForeground: '#ff0000'\r\n  },\r\n  uiControlColors: {\r\n    resizeGripColor: '#ffffff',\r\n    menuBackground: '#000000',\r\n    menuForeground: '#ffffff',\r\n    menuHoverBackground: '#1a1a1a',\r\n    dialogBackground: '#000000',\r\n    dialogForeground: '#ffffff',\r\n    dialogBorder: '#ffffff',\r\n    placeholderColor: '#808080',\r\n    searchPanelBackground: '#1a1a1a',\r\n    searchPanelForeground: '#ffffff',\r\n    searchPanelBorder: '#ffffff',\r\n    filterRowBackground: '#1a1a1a',\r\n    filterRowForeground: '#ffffff',\r\n    filterRowBorder: '#ffffff',\r\n    paginationBackground: '#000000',\r\n    paginationForeground: '#ffffff',\r\n    paginationBorder: '#ffffff',\r\n    paginationButtonHoverBackground: '#333333'\r\n  }\r\n}\r\n\r\nexport const highContrastListBoxTheme: ListBoxTheme = {\r\n  itemColors: {\r\n    defaultBackground: '#000000',\r\n    defaultForeground: '#ffffff',\r\n    hoverBackground: '#1a1a1a',\r\n    hoverForeground: '#ffff00',\r\n    selectedBackground: '#000080',\r\n    selectedForeground: '#ffffff',\r\n    selectedHoverBackground: '#0000b0',\r\n    selectedHoverForeground: '#ffffff',\r\n    disabledBackground: '#333333',\r\n    disabledForeground: '#808080'\r\n  },\r\n  containerColors: {\r\n    background: '#000000',\r\n    border: '#ffffff',\r\n    focusedBorder: '#00ff00',\r\n    titleForeground: '#ffffff'\r\n  },\r\n  checkboxColors: {\r\n    border: '#ffffff',\r\n    background: '#000000',\r\n    checkedBackground: '#000080',\r\n    checkedBorder: '#ffffff',\r\n    hoverBorder: '#ffff00'\r\n  },\r\n  scrollbarColors: {\r\n    trackBackground: '#1a1a1a',\r\n    thumbBackground: '#808080',\r\n    thumbHoverBackground: '#c0c0c0'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Theme Provider\r\n// ============================================================================\r\n\r\nconst THEME_KEY = Symbol('theme')\r\n\r\nexport function useThemeProvider(theme: ThemeConfig = {}) {\r\n  const dataGridTheme = ref<DataGridTheme>(\r\n    mergeDeep(defaultDataGridTheme, theme.dataGrid || {}) as DataGridTheme\r\n  )\r\n  const listBoxTheme = ref<ListBoxTheme>(\r\n    mergeDeep(defaultListBoxTheme, theme.listBox || {}) as ListBoxTheme\r\n  )\r\n\r\n  provide(THEME_KEY, {\r\n    dataGridTheme,\r\n    listBoxTheme\r\n  })\r\n\r\n  return {\r\n    dataGridTheme,\r\n    listBoxTheme\r\n  }\r\n}\r\n\r\nexport function useTheme() {\r\n  const theme = inject<{\r\n    dataGridTheme: Ref<DataGridTheme>\r\n    listBoxTheme: Ref<ListBoxTheme>\r\n  }>(THEME_KEY, {\r\n    dataGridTheme: ref(defaultDataGridTheme),\r\n    listBoxTheme: ref(defaultListBoxTheme)\r\n  })\r\n\r\n  return theme\r\n}\r\n\r\n// ============================================================================\r\n// Utility Functions\r\n// ============================================================================\r\n\r\nfunction mergeDeep(target: any, source: any): any {\r\n  const output = { ...target }\r\n\r\n  if (isObject(target) && isObject(source)) {\r\n    Object.keys(source).forEach(key => {\r\n      if (isObject(source[key])) {\r\n        if (!(key in target)) {\r\n          Object.assign(output, { [key]: source[key] })\r\n        } else {\r\n          output[key] = mergeDeep(target[key], source[key])\r\n        }\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] })\r\n      }\r\n    })\r\n  }\r\n\r\n  return output\r\n}\r\n\r\nfunction isObject(item: any): boolean {\r\n  return item && typeof item === 'object' && !Array.isArray(item)\r\n}\r\n\r\n// ============================================================================\r\n// CSS Variable Generation\r\n// ============================================================================\r\n\r\nexport function generateDataGridCSSVariables(theme: DataGridTheme): Record<string, string> {\r\n  return {\r\n    // Cell Colors\r\n    '--dg-cell-bg': theme.cellColors.defaultBackground,\r\n    '--dg-cell-fg': theme.cellColors.defaultForeground,\r\n    '--dg-cell-hover-bg': theme.cellColors.hoverBackground,\r\n    '--dg-cell-hover-fg': theme.cellColors.hoverForeground,\r\n    '--dg-cell-focused-bg': theme.cellColors.focusedBackground,\r\n    '--dg-cell-focused-fg': theme.cellColors.focusedForeground,\r\n    '--dg-cell-disabled-bg': theme.cellColors.disabledBackground,\r\n    '--dg-cell-disabled-fg': theme.cellColors.disabledForeground,\r\n    '--dg-cell-readonly-bg': theme.cellColors.readOnlyBackground,\r\n    '--dg-cell-readonly-fg': theme.cellColors.readOnlyForeground,\r\n\r\n    // Row Colors\r\n    '--dg-row-even-bg': theme.rowColors.evenRowBackground,\r\n    '--dg-row-odd-bg': theme.rowColors.oddRowBackground,\r\n    '--dg-row-hover-bg': theme.rowColors.hoverBackground,\r\n    '--dg-row-selected-bg': theme.rowColors.selectedBackground,\r\n    '--dg-row-selected-fg': theme.rowColors.selectedForeground,\r\n    '--dg-row-selected-inactive-bg': theme.rowColors.selectedInactiveBackground,\r\n    '--dg-row-selected-inactive-fg': theme.rowColors.selectedInactiveForeground,\r\n\r\n    // Header Colors\r\n    '--dg-header-bg': theme.headerColors.background,\r\n    '--dg-header-fg': theme.headerColors.foreground,\r\n    '--dg-header-hover-bg': theme.headerColors.hoverBackground,\r\n    '--dg-header-pressed-bg': theme.headerColors.pressedBackground,\r\n    '--dg-header-sort-indicator': theme.headerColors.sortIndicatorColor,\r\n\r\n    // Validation Colors\r\n    '--dg-validation-error-bg': theme.validationColors.errorBackground,\r\n    '--dg-validation-error-fg': theme.validationColors.errorForeground,\r\n    '--dg-validation-error-border': theme.validationColors.errorBorder,\r\n    '--dg-validation-warning-bg': theme.validationColors.warningBackground,\r\n    '--dg-validation-warning-fg': theme.validationColors.warningForeground,\r\n    '--dg-validation-warning-border': theme.validationColors.warningBorder,\r\n    '--dg-validation-info-bg': theme.validationColors.infoBackground,\r\n    '--dg-validation-info-fg': theme.validationColors.infoForeground,\r\n    '--dg-validation-info-border': theme.validationColors.infoBorder,\r\n\r\n    // Selection Colors\r\n    '--dg-selection-border': theme.selectionColors.selectionBorder,\r\n    '--dg-selection-fill': theme.selectionColors.selectionFill,\r\n    '--dg-multi-selection-bg': theme.selectionColors.multiSelectionBackground,\r\n    '--dg-multi-selection-fg': theme.selectionColors.multiSelectionForeground,\r\n\r\n    // Border Colors\r\n    '--dg-border-cell': theme.borderColors.cellBorder,\r\n    '--dg-border-row': theme.borderColors.rowBorder,\r\n    '--dg-border-column': theme.borderColors.columnBorder,\r\n    '--dg-border-grid': theme.borderColors.gridBorder,\r\n    '--dg-border-focused-cell': theme.borderColors.focusedCellBorder,\r\n\r\n    // Special Column Colors\r\n    '--dg-special-rownumber-bg': theme.specialColumnColors.rowNumberBackground,\r\n    '--dg-special-rownumber-fg': theme.specialColumnColors.rowNumberForeground,\r\n    '--dg-special-checkbox-border': theme.specialColumnColors.checkboxBorder,\r\n    '--dg-special-checkbox-bg': theme.specialColumnColors.checkboxBackground,\r\n    '--dg-special-checkbox-fg': theme.specialColumnColors.checkboxForeground,\r\n    '--dg-special-delete-bg': theme.specialColumnColors.deleteRowBackground,\r\n    '--dg-special-delete-fg': theme.specialColumnColors.deleteRowForeground,\r\n    '--dg-special-delete-hover-bg': theme.specialColumnColors.deleteRowHoverBackground,\r\n    '--dg-special-insert-bg': theme.specialColumnColors.insertRowBackground,\r\n    '--dg-special-insert-fg': theme.specialColumnColors.insertRowForeground,\r\n    '--dg-special-insert-border': theme.specialColumnColors.insertRowBorder,\r\n    '--dg-special-insert-hover-bg': theme.specialColumnColors.insertRowHoverBackground,\r\n    '--dg-special-insert-hover-fg': theme.specialColumnColors.insertRowHoverForeground,\r\n    '--dg-special-validation-error-bg': theme.specialColumnColors.validationAlertsErrorBackground,\r\n    '--dg-special-validation-error-fg': theme.specialColumnColors.validationAlertsErrorForeground,\r\n\r\n    // UI Control Colors\r\n    '--dg-ui-resize-grip': theme.uiControlColors.resizeGripColor,\r\n    '--dg-ui-menu-bg': theme.uiControlColors.menuBackground,\r\n    '--dg-ui-menu-fg': theme.uiControlColors.menuForeground,\r\n    '--dg-ui-menu-hover-bg': theme.uiControlColors.menuHoverBackground,\r\n    '--dg-ui-dialog-bg': theme.uiControlColors.dialogBackground,\r\n    '--dg-ui-dialog-fg': theme.uiControlColors.dialogForeground,\r\n    '--dg-ui-dialog-border': theme.uiControlColors.dialogBorder,\r\n    '--dg-ui-placeholder': theme.uiControlColors.placeholderColor,\r\n    '--dg-ui-search-bg': theme.uiControlColors.searchPanelBackground,\r\n    '--dg-ui-search-fg': theme.uiControlColors.searchPanelForeground,\r\n    '--dg-ui-search-border': theme.uiControlColors.searchPanelBorder,\r\n    '--dg-ui-filter-bg': theme.uiControlColors.filterRowBackground,\r\n    '--dg-ui-filter-fg': theme.uiControlColors.filterRowForeground,\r\n    '--dg-ui-filter-border': theme.uiControlColors.filterRowBorder,\r\n    '--dg-ui-pagination-bg': theme.uiControlColors.paginationBackground,\r\n    '--dg-ui-pagination-fg': theme.uiControlColors.paginationForeground,\r\n    '--dg-ui-pagination-border': theme.uiControlColors.paginationBorder,\r\n    '--dg-ui-pagination-button-hover-bg': theme.uiControlColors.paginationButtonHoverBackground\r\n  }\r\n}\r\n\r\nexport function generateListBoxCSSVariables(theme: ListBoxTheme): Record<string, string> {\r\n  return {\r\n    // Item Colors\r\n    '--lb-item-bg': theme.itemColors.defaultBackground,\r\n    '--lb-item-fg': theme.itemColors.defaultForeground,\r\n    '--lb-item-hover-bg': theme.itemColors.hoverBackground,\r\n    '--lb-item-hover-fg': theme.itemColors.hoverForeground,\r\n    '--lb-item-selected-bg': theme.itemColors.selectedBackground,\r\n    '--lb-item-selected-fg': theme.itemColors.selectedForeground,\r\n    '--lb-item-selected-hover-bg': theme.itemColors.selectedHoverBackground,\r\n    '--lb-item-selected-hover-fg': theme.itemColors.selectedHoverForeground,\r\n    '--lb-item-disabled-bg': theme.itemColors.disabledBackground,\r\n    '--lb-item-disabled-fg': theme.itemColors.disabledForeground,\r\n\r\n    // Container Colors\r\n    '--lb-container-bg': theme.containerColors.background,\r\n    '--lb-container-border': theme.containerColors.border,\r\n    '--lb-container-focused-border': theme.containerColors.focusedBorder,\r\n    '--lb-title-fg': theme.containerColors.titleForeground,\r\n\r\n    // Checkbox Colors\r\n    '--lb-checkbox-border': theme.checkboxColors.border,\r\n    '--lb-checkbox-bg': theme.checkboxColors.background,\r\n    '--lb-checkbox-checked-bg': theme.checkboxColors.checkedBackground,\r\n    '--lb-checkbox-checked-border': theme.checkboxColors.checkedBorder,\r\n    '--lb-checkbox-hover-border': theme.checkboxColors.hoverBorder,\r\n\r\n    // Scrollbar Colors\r\n    '--lb-scrollbar-track-bg': theme.scrollbarColors.trackBackground,\r\n    '--lb-scrollbar-thumb-bg': theme.scrollbarColors.thumbBackground,\r\n    '--lb-scrollbar-thumb-hover-bg': theme.scrollbarColors.thumbHoverBackground\r\n  }\r\n}\r\n","import { defineComponent as te, toRefs as re, ref as W, computed as _e, reactive as De, onMounted as be, nextTick as ae, onBeforeUnmount as Me, openBlock as b, createElementBlock as P, normalizeClass as oe, normalizeStyle as ye, createElementVNode as z, renderSlot as E, unref as l, createCommentVNode as D, inject as T, provide as J, createBlock as F, mergeProps as He, createVNode as ie, toDisplayString as Re, resolveComponent as qe, watch as Be, Teleport as et, Transition as dt, withCtx as pe, Fragment as Oe, renderList as Pe, createSlots as tt, useSlots as nt, h as xe, normalizeProps as ft, guardReactiveProps as vt, render as Ne } from \"vue\";\nlet le = null;\nfunction ht() {\n  return le !== null;\n}\nfunction mt(e) {\n  le && ot(), le = e;\n}\nfunction Ke(e) {\n  e === le && (le = null);\n}\nfunction ot() {\n  le && (le.closeMenu(), le = null);\n}\nconst ee = {\n  defaultDirection: \"br\",\n  defaultMinWidth: 100,\n  defaultMaxWidth: 600,\n  defaultZindex: 100,\n  defaultZoom: 1,\n  defaultAdjustPadding: {\n    x: 0,\n    y: 10\n  }\n};\nfunction se(e, o) {\n  let s = e.offsetTop;\n  return e.offsetParent != null && e.offsetParent != o && (s -= e.offsetParent.scrollTop, s += se(e.offsetParent, o)), s;\n}\nfunction ue(e, o) {\n  let s = e.offsetLeft;\n  return e.offsetParent != null && e.offsetParent != o && (s -= e.offsetParent.scrollLeft, s += ue(e.offsetParent, o)), s;\n}\nfunction pt(e, o, s, u) {\n  return {\n    x: ue(e, u) + o,\n    y: se(e, u) + s\n  };\n}\nconst We = \"mx-menu-default-container\", gt = \"mx-menu-container-\";\nlet bt = 0;\nfunction lt(e) {\n  const { getContainer: o, zIndex: s } = e;\n  if (o) {\n    const v = typeof o == \"function\" ? o() : o;\n    if (v) {\n      let n = v.getAttribute(\"id\");\n      return n || (n = gt + bt++, v.setAttribute(\"id\", n)), {\n        eleId: n,\n        container: v,\n        isNew: !1\n      };\n    }\n  }\n  let u = document.getElementById(We);\n  return u || (u = document.createElement(\"div\"), u.setAttribute(\"id\", We), u.setAttribute(\"class\", \"mx-menu-ghost-host fullscreen\"), document.body.appendChild(u)), u.style.zIndex = (s == null ? void 0 : s.toString()) || ee.defaultZindex.toString(), {\n    eleId: We,\n    container: u,\n    isNew: !0\n  };\n}\nfunction Ct(e) {\n  let o = 0;\n  for (let s = 0; s < e.length; s++) {\n    const u = e.charCodeAt(s);\n    o = (o << 5) - o + u, o |= 0;\n  }\n  return o;\n}\nfunction Ye(e) {\n  return typeof e == \"number\" ? `${e}px` : e;\n}\nconst q = te({\n  props: {\n    /**\n     * Can be VNode or (data: unknown) => VNode\n     */\n    vnode: {\n      type: null\n    },\n    /**\n     * If vnode is a callback, this data will be passed to the callback first parameter.\n     * @default null\n     */\n    data: {\n      type: null,\n      default: null\n    }\n  },\n  setup(e) {\n    const { vnode: o, data: s } = re(e);\n    return () => typeof o.value == \"function\" ? o.value(s.value) : o.value;\n  }\n});\nfunction yt(e, o) {\n  const s = { ...e };\n  return delete s[o], s;\n}\nvar xt = Object.defineProperty, Mt = (e, o, s) => o in e ? xt(e, o, { enumerable: !0, configurable: !0, writable: !0, value: s }) : e[o] = s, Ve = (e, o, s) => Mt(e, typeof o != \"symbol\" ? o + \"\" : o, s);\nclass Ue {\n  constructor(o, s) {\n    Ve(this, \"x\", 0), Ve(this, \"y\", 0), this.x = o || 0, this.y = s || 0;\n  }\n  set(o, s) {\n    this.x = o, this.y = s;\n  }\n  substract(o) {\n    this.x -= o.x, this.y -= o.y;\n  }\n}\nfunction Xe(e) {\n  const { onDown: o, onMove: s, onUp: u } = e, v = new Ue(), n = new Ue();\n  let _;\n  function d(h) {\n    h.stopPropagation(), n.set(h.x, h.y), n.substract(v), s(v, n, h, _);\n  }\n  function p(h) {\n    u(h, _), v.set(0, 0), document.removeEventListener(\"mousemove\", d), document.removeEventListener(\"mouseup\", p);\n  }\n  return (h, x) => o(h, x) ? (_ = x, v.set(h.x, h.y), document.addEventListener(\"mousemove\", d), document.addEventListener(\"mouseup\", p), h.stopPropagation(), !0) : !1;\n}\nfunction kt(e, o) {\n  let s = 0;\n  return {\n    start() {\n      s > 0 && clearInterval(s), s = setInterval(() => {\n        s = 0, o();\n      }, e);\n    },\n    stop() {\n      s > 0 && (clearInterval(s), s = 0);\n    }\n  };\n}\nconst me = [], Ze = kt(100, () => {\n  for (const e of me)\n    e();\n});\nfunction St(e, o, s, u) {\n  let v = 0, n = 0;\n  function _() {\n    e.value && (o && v !== e.value.offsetWidth && o(e.value.offsetWidth), s && n !== e.value.offsetHeight && s(e.value.offsetHeight), u && (v !== e.value.offsetWidth || n !== e.value.offsetHeight) && u(e.value.offsetWidth, e.value.offsetHeight), v = e.value.offsetWidth, n = e.value.offsetHeight);\n  }\n  return {\n    startResizeChecker() {\n      Ze.start(), me.push(_);\n    },\n    stopResizeChecker() {\n      const d = me.indexOf(_);\n      d >= 0 && me.splice(d, 1), me.length === 0 && Ze.stop();\n    }\n  };\n}\nconst Ge = 140, wt = 70, It = /* @__PURE__ */ te({\n  __name: \"ScrollRect\",\n  props: {\n    /**\n     * Scroll direction\n     * \n     * * both : Scroll in both directions\n     * * vertical : Scroll only in vertical direction\n     * * horizontal : Scroll only in horizontal direction\n     * * none : Disable scroll\n     * \n     * @default both\n     */\n    scroll: {\n      type: String,\n      default: \"both\"\n    },\n    /**\n     * Show scroll bar always, otherwise show scroll bar when mouse over\n     * @default false\n     */\n    scrollBarAlwaysShow: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Is able to click scroll bar background to set scroll position? (When `scrollBarAlwaysShow` is true)\n     * @default true\n     */\n    scrollBarBackgroundClickable: {\n      type: Boolean,\n      default: !1\n    },\n    height: {\n      type: Number,\n      default: void 0\n    },\n    width: {\n      type: Number,\n      default: void 0\n    },\n    /**\n     * \n     */\n    maxHeight: {\n      type: Number,\n      default: void 0\n    },\n    maxWidth: {\n      type: Number,\n      default: void 0\n    },\n    /**\n     * CSS class of inner container\n     */\n    containerClass: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * Container style\n     */\n    containerStyle: {\n      type: null\n    }\n  },\n  emits: [\"scroll\", \"resized\"],\n  setup(e, { expose: o, emit: s }) {\n    const u = e, v = s, n = W(), _ = W(), d = W(), p = W(), h = W(), x = W(), B = W(!1), L = _e(() => u.scroll === \"horizontal\" || u.scroll === \"both\"), S = _e(() => u.scroll === \"vertical\" || u.scroll === \"both\"), M = De({\n      show: !1,\n      size: 0,\n      sizeRaw: 0,\n      pos: 0\n    }), k = De({\n      show: !1,\n      size: 0,\n      sizeRaw: 0,\n      pos: 0\n    });\n    let H = 0, r = 0, f = 0, C = 0, y = null;\n    const I = { attributes: !0, childList: !0 };\n    function i() {\n      if (n.value) {\n        if (M.show) {\n          const t = n.value.offsetWidth / n.value.scrollWidth;\n          M.sizeRaw = t * n.value.offsetWidth, M.size = t * 100, M.pos = n.value.scrollLeft / (n.value.scrollWidth - n.value.offsetWidth) * (100 - M.size), t >= 1 && (M.show = !1);\n        }\n        if (k.show) {\n          const t = n.value.offsetHeight / n.value.scrollHeight;\n          k.sizeRaw = t * n.value.offsetHeight, k.size = t * 100, k.pos = n.value.scrollTop / (n.value.scrollHeight - n.value.offsetHeight) * (100 - k.size), t >= 1 && (k.show = !1);\n        }\n        v(\"scroll\", n.value.scrollLeft, n.value.scrollTop);\n      }\n    }\n    function g(t = !1) {\n      if (!n.value)\n        return;\n      let c = L.value, m = S.value;\n      const a = c && (H !== n.value.scrollWidth || f !== n.value.offsetWidth), de = S && (r !== n.value.scrollHeight || C !== n.value.offsetHeight);\n      if (!t && !a && !de)\n        return;\n      const j = window.getComputedStyle(n.value);\n      (j.overflow === \"hidden\" || j.overflowX === \"hidden\") && (c = !1), (j.overflow === \"hidden\" || j.overflowY === \"hidden\") && (m = !1), M.show = c, k.show = m, i(), f = n.value.offsetWidth, C = n.value.offsetHeight, H = n.value.scrollWidth, r = n.value.scrollHeight, v(\"resized\", H, r);\n    }\n    function K(t) {\n      var c;\n      u.scroll == \"horizontal\" && (t.deltaMode == 0 && ((c = n.value) == null || c.scrollTo({\n        left: n.value.scrollLeft + (t.deltaY > 0 ? Ge : -140),\n        behavior: \"smooth\"\n      })), t.preventDefault(), t.stopPropagation());\n    }\n    function R(t) {\n      var c;\n      t.deltaMode == 0 && ((c = n.value) == null || c.scrollTo({\n        left: n.value.scrollLeft + (t.deltaY > 0 ? Ge : -140),\n        behavior: \"smooth\"\n      }), t.preventDefault(), t.stopPropagation());\n    }\n    function N(t) {\n      var c;\n      t.deltaMode == 0 && ((c = n.value) == null || c.scrollTo({\n        top: n.value.scrollTop + (t.deltaY > 0 ? wt : -70),\n        behavior: \"smooth\"\n      }), t.preventDefault(), t.stopPropagation());\n    }\n    let V = 0, U = 0, A = 0, w = 0;\n    const $ = Xe({\n      onDown(t) {\n        return !d.value || !h.value ? !1 : (V = t.offsetX, U = t.x - t.offsetX - h.value.offsetLeft, t.preventDefault(), B.value = !0, !0);\n      },\n      onMove(t, c, m) {\n        n.value && d.value && (Q(m.x - V - U), m.preventDefault(), m.stopPropagation());\n      },\n      onUp() {\n        B.value = !1;\n      }\n    }), Z = Xe({\n      onDown(t) {\n        return !p.value || !x.value ? !1 : (A = t.offsetY, w = t.y - t.offsetY - x.value.offsetTop, t.preventDefault(), B.value = !0, !0);\n      },\n      onMove(t, c, m) {\n        n.value && p.value && (ne(m.y - A - w), m.preventDefault(), m.stopPropagation());\n      },\n      onUp() {\n        B.value = !1;\n      }\n    });\n    function Y(t) {\n      n.value && (n.value.scrollLeft = t / 100 * (n.value.scrollWidth - n.value.offsetWidth));\n    }\n    function G(t) {\n      n.value && (n.value.scrollLeft = t / 100 * (n.value.scrollHeight - n.value.offsetHeight));\n    }\n    function Q(t) {\n      n.value && (n.value.scrollLeft = t / (n.value.offsetWidth - M.sizeRaw) * (n.value.scrollWidth - n.value.offsetWidth));\n    }\n    function ne(t) {\n      n.value && (n.value.scrollTop = t / (n.value.offsetHeight - k.sizeRaw) * (n.value.scrollHeight - n.value.offsetHeight));\n    }\n    function O(t) {\n      u.scrollBarBackgroundClickable && Q(t.offsetX - M.sizeRaw / 2);\n    }\n    function ce(t) {\n      u.scrollBarBackgroundClickable && ne(t.offsetY - k.sizeRaw / 2);\n    }\n    const {\n      startResizeChecker: Fe,\n      stopResizeChecker: Ce\n    } = St(\n      n,\n      () => g(),\n      () => g()\n    );\n    return be(() => {\n      ae(() => {\n        setTimeout(() => g(!0), 200), g(!0), Fe(), y = new MutationObserver(() => g()), y.observe(n.value, I);\n      });\n    }), Me(() => {\n      Ce(), y && (y.disconnect(), y = null);\n    }), o({\n      refreshScrollState() {\n        g(!0);\n      },\n      getScrollContainer() {\n        return n.value;\n      },\n      scrollTo(t, c) {\n        var m;\n        (m = n.value) == null || m.scrollTo(t, c);\n      },\n      scrollToTop() {\n        var t;\n        (t = n.value) == null || t.scrollTo(0, 0);\n      },\n      scrollToBottom() {\n        var t;\n        (t = n.value) == null || t.scrollTo(n.value.scrollWidth, n.value.scrollHeight);\n      }\n    }), (t, c) => (b(), P(\"div\", {\n      ref_key: \"scrollrect\",\n      ref: _,\n      class: oe([\n        \"vue-scroll-rect\",\n        e.scrollBarAlwaysShow ? \"always-show-scrollbar\" : \"\",\n        e.scrollBarBackgroundClickable ? \"background-clickable\" : \"\",\n        B.value ? \"dragging\" : \"\"\n      ]),\n      style: ye({\n        width: e.width ? `${e.width}px` : void 0,\n        height: e.height ? `${e.height}px` : void 0\n      }),\n      onWheel: K\n    }, [\n      z(\"div\", {\n        ref_key: \"container\",\n        ref: n,\n        class: oe([\"scroll-content\", e.scroll, e.containerClass]),\n        style: ye({\n          maxWidth: e.maxWidth ? `${e.maxWidth}px` : void 0,\n          maxHeight: e.maxHeight ? `${e.maxHeight}px` : void 0,\n          ...e.containerStyle\n        }),\n        onScroll: i\n      }, [\n        E(t.$slots, \"default\")\n      ], 38),\n      M.show ? E(t.$slots, \"scrollBarX\", {\n        key: 0,\n        scrollBarValue: M,\n        onScroll: Y\n      }, () => [\n        z(\"div\", {\n          ref_key: \"scrollBarRefX\",\n          ref: d,\n          class: \"scrollbar horizontal\",\n          onClick: O,\n          onWheel: R\n        }, [\n          z(\"div\", {\n            class: \"thumb\",\n            ref_key: \"scrollBarThumbRefX\",\n            ref: h,\n            style: ye({ left: `${M.pos}%`, width: `${M.size}%` }),\n            onMousedown: c[0] || (c[0] = //@ts-ignore\n            (...m) => l($) && l($)(...m)),\n            onWheel: R\n          }, null, 36)\n        ], 544)\n      ]) : D(\"\", !0),\n      k.show ? E(t.$slots, \"scrollBarY\", {\n        key: 1,\n        scrollBarValue: k,\n        onScroll: G\n      }, () => [\n        k.show ? (b(), P(\"div\", {\n          key: 0,\n          ref_key: \"scrollBarRefY\",\n          ref: p,\n          class: \"scrollbar vertical\",\n          onClick: ce,\n          onWheel: N\n        }, [\n          z(\"div\", {\n            class: \"thumb\",\n            ref_key: \"scrollBarThumbRefY\",\n            ref: x,\n            style: ye({ top: `${k.pos}%`, height: `${k.size}%` }),\n            onMousedown: c[1] || (c[1] = //@ts-ignore\n            (...m) => l(Z) && l(Z)(...m)),\n            onWheel: N\n          }, null, 36)\n        ], 544)) : D(\"\", !0)\n      ]) : D(\"\", !0)\n    ], 38));\n  }\n}), ke = (e, o) => {\n  const s = e.__vccOpts || e;\n  for (const [u, v] of o)\n    s[u] = v;\n  return s;\n}, Wt = {}, _t = {\n  class: \"mx-checked-mark\",\n  \"aria-hidden\": \"true\",\n  viewBox: \"0 0 1024 1024\"\n}, Ht = /* @__PURE__ */ z(\"path\", { d: \"M129.3,428.6L52,512l345,372.5l575-620.8l-69.5-75L400.4,718.2L129.3,428.6z\" }, null, -1), Rt = [\n  Ht\n];\nfunction Ot(e, o) {\n  return b(), P(\"svg\", _t, Rt);\n}\nconst Bt = /* @__PURE__ */ ke(Wt, [[\"render\", Ot]]), Pt = {}, $t = {\n  class: \"mx-right-arrow\",\n  \"aria-hidden\": \"true\",\n  viewBox: \"0 0 1024 1024\"\n}, At = /* @__PURE__ */ z(\"path\", { d: \"M307.018 49.445c11.517 0 23.032 4.394 31.819 13.18L756.404 480.18c8.439 8.438 13.181 19.885 13.181 31.82s-4.741 23.38-13.181 31.82L338.838 961.376c-17.574 17.573-46.065 17.573-63.64-0.001-17.573-17.573-17.573-46.065 0.001-63.64L660.944 512 275.198 126.265c-17.574-17.573-17.574-46.066-0.001-63.64C283.985 53.839 295.501 49.445 307.018 49.445z\" }, null, -1), Ft = [\n  At\n];\nfunction Lt(e, o) {\n  return b(), P(\"svg\", $t, Ft);\n}\nconst Tt = /* @__PURE__ */ ke(Pt, [[\"render\", Lt]]), Et = { class: \"mx-item-row\" }, zt = [\"xlink:href\"], jt = {\n  key: 1,\n  class: \"label\"\n}, Dt = { class: \"mx-item-row\" }, Nt = { class: \"mx-shortcut\" }, $e = /* @__PURE__ */ te({\n  __name: \"ContextMenuItem\",\n  props: {\n    /**\n     * Is this menu disabled? \n     */\n    disabled: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Is this menu hidden? \n     */\n    hidden: {\n      type: Boolean,\n      default: !1\n    },\n    customRender: {\n      type: Function,\n      default: null\n    },\n    /**\n     * Custom css class for submenu\n     */\n    customClass: {\n      type: String,\n      default: \"\"\n    },\n    clickHandler: {\n      type: Function,\n      default: null\n    },\n    /**\n     * Menu label\n     */\n    label: {\n      type: [String, Object, Function],\n      default: \"\"\n    },\n    /**\n     * Menu icon (for icon class)\n     */\n    icon: {\n      type: [String, Object, Function],\n      default: \"\"\n    },\n    /**\n     * Custom icon library font class name.\n     * \n     * Only for css font icon, If you use the svg icon, you do not need to use this.\n     */\n    iconFontClass: {\n      type: String,\n      default: \"iconfont\"\n    },\n    /**\n     * Is this menu item checked?\n     * \n     * The check mark are displayed on the left side of the icon, so it is not recommended to display the icon at the same time.\n     */\n    checked: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Shortcut key text display on the right.\n     * \n     * The shortcut keys here are only for display. You need to handle the key events by yourself.\n     */\n    shortcut: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * Display icons use svg symbol (`<use xlink:href=\"#icon-symbol-name\">`)  only valid when icon attribute is empty.\n     */\n    svgIcon: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * The user-defined attribute of the svg tag, which is valid when using `svgIcon`.\n     */\n    svgProps: {\n      type: Object,\n      default: null\n    },\n    /**\n     * Should a fixed-width icon area be reserved for menu items without icon. (this item)\n     * \n     * Default is true .\n     * \n     * The width of icon area can be override with css var `--mx-menu-placeholder-width`.\n     */\n    preserveIconWidth: {\n      type: Boolean,\n      default: !0\n    },\n    /**\n     * Show right arrow on this menu?\n     */\n    showRightArrow: {\n      type: Boolean,\n      default: !1\n    },\n    hasChildren: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Should close menu when Click this menu item ?\n     */\n    clickClose: {\n      type: Boolean,\n      default: !0\n    },\n    /**\n     * When there are subitems in this item, is it allowed to trigger its own click event? Default is false\n     */\n    clickableWhenHasChildren: {\n      type: Boolean,\n      default: !1\n    },\n    rawMenuItem: {\n      type: Object,\n      default: void 0\n    }\n  },\n  emits: [\n    \"click\",\n    \"subMenuOpen\",\n    \"subMenuClose\"\n  ],\n  setup(e, { expose: o, emit: s }) {\n    const u = e, v = s, {\n      clickHandler: n,\n      clickClose: _,\n      clickableWhenHasChildren: d,\n      disabled: p,\n      hidden: h,\n      label: x,\n      icon: B,\n      iconFontClass: L,\n      showRightArrow: S,\n      shortcut: M,\n      hasChildren: k\n    } = re(u), H = W(!1), r = W(!1), f = W(), C = T(\"globalOptions\"), y = T(\"globalHasSlot\"), I = T(\"globalRenderSlot\"), i = T(\"globalCloseMenu\"), g = T(\"menuContext\"), K = _e(() => typeof x.value == \"string\" ? x.value : typeof x.value == \"function\" ? Ct(x.value.toString()) : \"MenuItem[unknow]\");\n    J(\"MenuItemName\", K);\n    const R = {\n      getSubMenuInstance: () => {\n      },\n      showSubMenu: () => H.value ? (g.markActiveMenuItem(R, !0), !0) : k.value ? (V(), !0) : !1,\n      hideSubMenu: () => {\n        g.closeOtherSubMenu();\n      },\n      isDisabledOrHidden: () => p.value || h.value,\n      getElement: () => f.value,\n      focus: () => r.value = !0,\n      blur: () => r.value = !1,\n      click: N\n    };\n    J(\"menuItemInstance\", R), be(() => {\n      g.isMenuItemDataCollectedFlag() ? ae(() => {\n        let w = 0;\n        const $ = g.getElement();\n        if ($) {\n          let Z = 0;\n          for (let Y = 0; Y < $.children.length; Y++) {\n            const G = $.children[Y];\n            if (G.getAttribute(\"data-type\") === \"ContextMenuItem\") {\n              if (G === f.value) {\n                w = Z;\n                break;\n              }\n              Z++;\n            }\n          }\n        }\n        g.addChildMenuItem(R, w);\n      }) : g.addChildMenuItem(R);\n    }), Me(() => {\n      g.removeChildMenuItem(R);\n    });\n    function N(w) {\n      if (!p.value) {\n        if (w) {\n          const $ = w.target;\n          if ($.classList.contains(\"mx-context-no-clickable\") || C.value.ignoreClickClassName && $.classList.contains(C.value.ignoreClickClassName))\n            return;\n          if (C.value.clickCloseClassName && $.classList.contains(C.value.clickCloseClassName)) {\n            w.stopPropagation(), i(u.rawMenuItem);\n            return;\n          }\n        }\n        k.value ? d.value ? (typeof n.value == \"function\" && n.value(w), v(\"click\", w)) : H.value || V() : (typeof n.value == \"function\" && n.value(w), v(\"click\", w), _.value && i(u.rawMenuItem));\n      }\n    }\n    function V(w) {\n      r.value = !1, g.checkCloseOtherSubMenuTimeOut() || g.closeOtherSubMenu(), p.value || (g.markActiveMenuItem(R), k.value && (w || g.markThisOpenedByKeyBoard(), g.addOpenedSubMenu(U), H.value = !0, ae(() => v(\"subMenuOpen\", R))));\n    }\n    function U() {\n      r.value = !1, H.value = !1, v(\"subMenuClose\", R);\n    }\n    function A() {\n      return {\n        disabled: p.value,\n        label: x.value,\n        icon: B.value,\n        iconFontClass: L.value,\n        showRightArrow: S.value,\n        clickClose: _.value,\n        clickableWhenHasChildren: d.value,\n        shortcut: M.value,\n        theme: C.value.theme,\n        isOpen: H,\n        hasChildren: k,\n        onClick: N,\n        onMouseEnter: V,\n        closeMenu: i\n      };\n    }\n    return o(R), (w, $) => l(h) ? D(\"\", !0) : (b(), P(\"div\", {\n      key: 0,\n      class: \"mx-context-menu-item-wrapper\",\n      ref_key: \"menuItemRef\",\n      ref: f,\n      \"data-type\": \"ContextMenuItem\"\n    }, [\n      l(y)(\"itemRender\") ? (b(), F(l(q), {\n        key: 0,\n        vnode: () => l(I)(\"itemRender\", A())\n      }, null, 8, [\"vnode\"])) : e.customRender ? (b(), F(l(q), {\n        key: 1,\n        vnode: e.customRender,\n        data: A()\n      }, null, 8, [\"vnode\", \"data\"])) : (b(), P(\"div\", {\n        key: 2,\n        class: oe([\n          \"mx-context-menu-item\",\n          l(p) ? \"disabled\" : \"\",\n          r.value ? \"keyboard-focus\" : \"\",\n          e.customClass ? \" \" + e.customClass : \"\",\n          H.value ? \"open\" : \"\"\n        ]),\n        onClick: N,\n        onMouseenter: V\n      }, [\n        E(w.$slots, \"default\", {}, () => [\n          z(\"div\", Et, [\n            z(\"div\", {\n              class: oe([\n                \"mx-icon-placeholder\",\n                e.preserveIconWidth ? \"preserve-width\" : \"\"\n              ])\n            }, [\n              E(w.$slots, \"icon\", {}, () => [\n                l(y)(\"itemIconRender\") ? (b(), F(l(q), {\n                  key: 0,\n                  vnode: () => l(I)(\"itemIconRender\", A())\n                }, null, 8, [\"vnode\"])) : typeof e.svgIcon == \"string\" && e.svgIcon ? (b(), P(\"svg\", He({\n                  key: 1,\n                  class: \"icon svg\"\n                }, e.svgProps), [\n                  z(\"use\", { \"xlink:href\": e.svgIcon }, null, 8, zt)\n                ], 16)) : typeof l(B) != \"string\" ? (b(), F(l(q), {\n                  key: 2,\n                  vnode: l(B),\n                  data: l(B)\n                }, null, 8, [\"vnode\", \"data\"])) : typeof l(B) == \"string\" && l(B) !== \"\" ? (b(), P(\"i\", {\n                  key: 3,\n                  class: oe(l(B) + \" icon \" + l(L) + \" \" + l(C).iconFontClass)\n                }, null, 2)) : D(\"\", !0)\n              ]),\n              e.checked ? E(w.$slots, \"check\", { key: 0 }, () => [\n                l(y)(\"itemCheckRender\") ? (b(), F(l(q), {\n                  key: 0,\n                  vnode: () => l(I)(\"itemCheckRender\", A())\n                }, null, 8, [\"vnode\"])) : D(\"\", !0),\n                ie(Bt)\n              ]) : D(\"\", !0)\n            ], 2),\n            E(w.$slots, \"label\", {}, () => [\n              l(y)(\"itemLabelRender\") ? (b(), F(l(q), {\n                key: 0,\n                vnode: () => l(I)(\"itemLabelRender\", A())\n              }, null, 8, [\"vnode\"])) : typeof l(x) == \"string\" ? (b(), P(\"span\", jt, Re(l(x)), 1)) : (b(), F(l(q), {\n                key: 2,\n                vnode: l(x),\n                data: l(x)\n              }, null, 8, [\"vnode\", \"data\"]))\n            ])\n          ]),\n          z(\"div\", Dt, [\n            l(M) || w.$slots.shortcut ? E(w.$slots, \"shortcut\", { key: 0 }, () => [\n              l(y)(\"itemShortcutRender\") ? (b(), F(l(q), {\n                key: 0,\n                vnode: () => l(I)(\"itemShortcutRender\", A())\n              }, null, 8, [\"vnode\"])) : D(\"\", !0),\n              z(\"span\", Nt, Re(l(M)), 1)\n            ]) : D(\"\", !0),\n            l(S) ? E(w.$slots, \"rightArrow\", { key: 1 }, () => [\n              l(y)(\"itemRightArrowRender\") ? (b(), F(l(q), {\n                key: 0,\n                vnode: () => l(I)(\"itemRightArrowRender\", A())\n              }, null, 8, [\"vnode\"])) : D(\"\", !0),\n              ie(Tt)\n            ]) : D(\"\", !0)\n          ])\n        ])\n      ], 34)),\n      E(w.$slots, \"submenu\", {\n        context: R,\n        show: H.value\n      })\n    ], 512));\n  }\n}), Kt = te({\n  name: \"ContextMenuSperator\",\n  components: {\n    VNodeRender: q\n  },\n  setup() {\n    const e = T(\"globalHasSlot\"), o = T(\"globalRenderSlot\");\n    return {\n      globalHasSlot: e,\n      globalRenderSlot: o\n    };\n  }\n}), Yt = {\n  key: 1,\n  class: \"mx-context-menu-item-sperator mx-context-no-clickable\"\n};\nfunction Vt(e, o, s, u, v, n) {\n  const _ = qe(\"VNodeRender\");\n  return e.globalHasSlot(\"separatorRender\") ? (b(), F(_, {\n    key: 0,\n    vnode: () => e.globalRenderSlot(\"separatorRender\", {})\n  }, null, 8, [\"vnode\"])) : (b(), P(\"div\", Yt));\n}\nconst ge = /* @__PURE__ */ ke(Kt, [[\"render\", Vt]]), Ae = /* @__PURE__ */ te({\n  __name: \"ContextSubMenu\",\n  props: {\n    /**\n     * Items from options\n     */\n    items: {\n      type: Object,\n      default: null\n    },\n    /**\n     * Show\n     */\n    show: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Max height for this submenu\n     */\n    maxHeight: {\n      type: Number,\n      default: 0\n    },\n    /**\n     * Max width for this submenu\n     */\n    maxWidth: {\n      type: [String, Number],\n      default: 0\n    },\n    /**\n     * Min width for this submenu\n     */\n    minWidth: {\n      type: [String, Number],\n      default: 0\n    },\n    /**\n     * Specifies should submenu adjust it position\n     * when the menu exceeds the screen. The default is true\n     */\n    adjustPosition: {\n      type: Boolean,\n      default: !0\n    },\n    /**\n     * Menu direction\n     */\n    direction: {\n      type: String,\n      default: \"br\"\n    },\n    parentMenuItemContext: {\n      type: Object,\n      default: null\n    }\n  },\n  emits: [\"closeAnimFinished\"],\n  setup(e, { expose: o, emit: s }) {\n    const u = e, v = s, n = W(!1), _ = T(\"globalGetMenuHostId\", \"\"), d = T(\"menuContext\"), p = T(\"globalOptions\");\n    T(\"globalHasSlot\"), T(\"globalRenderSlot\");\n    const h = W(\"UnknowOrRoot\"), x = T(\"MenuItemName\", h), { zIndex: B, getParentWidth: L, getParentHeight: S, getZoom: M } = d, { adjustPosition: k } = re(u), H = W(), r = W(), f = W(), C = [], y = T(\"globalSetCurrentSubMenu\"), I = [];\n    let i = null, g = 0;\n    function K() {\n      i && i.blur();\n    }\n    function R(t, c) {\n      if (t) {\n        for (let m = c !== void 0 ? c : 0; m < I.length; m++)\n          if (!I[m].isDisabledOrHidden()) {\n            N(m);\n            break;\n          }\n      } else\n        for (let m = c !== void 0 ? c : I.length - 1; m >= 0; m--)\n          if (!I[m].isDisabledOrHidden()) {\n            N(m);\n            break;\n          }\n    }\n    function N(t) {\n      if (i && K(), t !== void 0 && (i = I[Math.max(0, Math.min(t, I.length - 1))]), !i)\n        return;\n      i.focus();\n      const c = i.getElement();\n      c && c.scrollIntoView({\n        behavior: \"auto\",\n        block: \"nearest\",\n        inline: \"nearest\"\n      });\n    }\n    function V() {\n      y(U);\n    }\n    const U = {\n      el: f,\n      name: x,\n      isTopLevel: () => d.getParentContext() === null,\n      closeSelfAndActiveParent: () => {\n        const t = $.getParentContext();\n        if (t) {\n          t.closeOtherSubMenu();\n          const c = t.getSubMenuInstanceContext();\n          if (c)\n            return c.focusCurrentItem(), !0;\n        }\n        return !1;\n      },\n      closeCurrentSubMenu: () => {\n        var t;\n        return (t = $.getParentContext()) == null ? void 0 : t.closeOtherSubMenu();\n      },\n      moveCurrentItemFirst: () => R(!0),\n      moveCurrentItemLast: () => R(!1),\n      moveCurrentItemDown: () => R(!0, i ? I.indexOf(i) + 1 : 0),\n      moveCurrentItemUp: () => R(!1, i ? I.indexOf(i) - 1 : 0),\n      focusCurrentItem: () => N(),\n      openCurrentItemSubMenu: () => i ? i == null ? void 0 : i.showSubMenu() : !1,\n      triggerCurrentItemClick: (t) => i == null ? void 0 : i.click(t)\n    };\n    let A = !1, w = !1;\n    const $ = {\n      zIndex: B + 1,\n      container: d.container,\n      adjustPadding: p.value.adjustPadding || ee.defaultAdjustPadding,\n      getParentWidth: () => {\n        var t;\n        return ((t = f.value) == null ? void 0 : t.offsetWidth) || 0;\n      },\n      getParentHeight: () => {\n        var t;\n        return ((t = f.value) == null ? void 0 : t.offsetHeight) || 0;\n      },\n      getPositon: () => [O.value.x, O.value.y],\n      getZoom: () => p.value.zoom || ee.defaultZoom,\n      addOpenedSubMenu(t) {\n        C.push(t);\n      },\n      closeOtherSubMenu() {\n        C.forEach((t) => t()), C.splice(0, C.length), y(U);\n      },\n      checkCloseOtherSubMenuTimeOut() {\n        return g ? (clearTimeout(g), g = 0, !0) : !1;\n      },\n      closeOtherSubMenuWithTimeOut() {\n        g = setTimeout(() => {\n          g = 0, this.closeOtherSubMenu();\n        }, 200);\n      },\n      addChildMenuItem: (t, c) => {\n        c === void 0 ? I.push(t) : I.splice(c, 0, t);\n      },\n      removeChildMenuItem: (t) => {\n        I.splice(I.indexOf(t), 1), t.getSubMenuInstance = () => {\n        };\n      },\n      markActiveMenuItem: (t, c = !1) => {\n        K(), i = t, c && N();\n      },\n      markThisOpenedByKeyBoard: () => {\n        A = !0;\n      },\n      isOpenedByKeyBoardFlag: () => A ? (A = !1, !0) : !1,\n      isMenuItemDataCollectedFlag: () => w,\n      getElement: () => f.value || null,\n      getParentContext: () => d,\n      getSubMenuInstanceContext: () => U\n    };\n    J(\"menuContext\", $);\n    const Z = {\n      getChildItem: (t) => I[t],\n      getMenuDimensions: () => r.value ? {\n        width: r.value.offsetWidth,\n        height: r.value.offsetHeight\n      } : { width: 0, height: 0 },\n      getSubmenuRoot: () => r.value,\n      getMenu: () => f.value,\n      getScrollValue: () => {\n        var t, c;\n        return ((c = (t = H.value) == null ? void 0 : t.getScrollContainer()) == null ? void 0 : c.scrollTop) || 0;\n      },\n      setScrollValue: (t) => {\n        var c;\n        return (c = H.value) == null ? void 0 : c.scrollTo(0, t);\n      },\n      getScrollHeight: () => G.value,\n      adjustPosition: () => {\n        ce();\n      },\n      getMaxHeight: () => Q.value,\n      getPosition: () => O.value,\n      setPosition: (t, c) => {\n        O.value.x = t, O.value.y = c;\n      }\n    }, Y = T(\"menuItemInstance\", void 0);\n    Y && (Y.getSubMenuInstance = () => Z);\n    const G = W(0), Q = W(0), ne = W(!1), O = W({ x: 0, y: 0 });\n    function ce() {\n      ae(() => {\n        const t = f.value, c = r.value;\n        if (t && c && H.value) {\n          const { container: m } = d, a = (L == null ? void 0 : L()) ?? 0, de = (S == null ? void 0 : S()) ?? 0, j = getComputedStyle(c), X = parseFloat(j.paddingLeft), fe = parseFloat(j.paddingTop), Se = de > 0 ? fe : 0, ut = document.documentElement.scrollHeight / M(), at = document.documentElement.scrollWidth / M(), it = Math.min(at, m.offsetWidth), Le = Math.min(ut, m.offsetHeight);\n          let we = ue(t, m), Ie = se(t, m);\n          u.direction.includes(\"l\") ? O.value.x -= t.offsetWidth + X : u.direction.includes(\"r\") ? O.value.x += a + X : (O.value.x += a / 2, O.value.x -= (t.offsetWidth + X) / 2), u.direction.includes(\"t\") ? O.value.y -= (t.offsetHeight + fe * 2) / M() : u.direction.includes(\"b\") ? O.value.y -= fe / M() : O.value.y -= (t.offsetHeight + fe) / 2 / M(), ae(() => {\n            var ze, je;\n            we = ue(t, m), Ie = se(t, m);\n            const Te = ((je = (ze = H.value) == null ? void 0 : ze.getScrollContainer()) == null ? void 0 : je.scrollHeight) || 0, rt = u.maxHeight;\n            G.value = u.maxHeight ? Math.min(Te, u.maxHeight) : Te;\n            const ct = we + t.offsetWidth - it, Ee = Ie + G.value + Se * 2 - Le;\n            if (ne.value = Ee > 0, k.value && ct > 0) {\n              const ve = a + t.offsetWidth - X, he = we;\n              ve > he ? O.value.x -= he : O.value.x -= ve;\n            }\n            if (ne.value) {\n              if (k.value) {\n                const ve = Ee, he = Ie;\n                ve > he ? O.value.y -= he - Se : O.value.y -= ve - Se;\n              }\n              Q.value = Le - (O.value.y + fe);\n            } else\n              Q.value = rt || 0;\n          });\n        }\n      });\n    }\n    function Fe() {\n    }\n    function Ce() {\n      var c;\n      const t = (c = u.parentMenuItemContext) == null ? void 0 : c.getElement();\n      if (t) {\n        const m = ue(t, d.container), a = se(t, d.container);\n        O.value.x = m, O.value.y = a;\n      } else {\n        const [m, a] = d.getPositon();\n        O.value.x = m, O.value.y = a;\n      }\n      ae(() => {\n        var m;\n        y(U), (m = f.value) == null || m.focus({ preventScroll: !0 }), d.isOpenedByKeyBoardFlag() && ae(() => R(!0)), w = !0;\n      }), ce();\n    }\n    return Be(() => u.show, (t) => {\n      t ? Ce() : void 0;\n    }), be(() => {\n      n.value = !0, u.show ? Ce() : ce();\n    }), Me(() => {\n      n.value = !1, Y && (Y.getSubMenuInstance = () => {\n      });\n    }), o(Z), (t, c) => {\n      const m = qe(\"ContextSubMenu\", !0);\n      return n.value ? (b(), F(et, {\n        key: 0,\n        to: `#${l(_)}`\n      }, [\n        ie(dt, He({ appear: \"\" }, l(p).menuTransitionProps || {\n          duration: 10\n        }, {\n          onAfterLeave: c[0] || (c[0] = (a) => v(\"closeAnimFinished\"))\n        }), {\n          default: pe(() => [\n            e.show ? (b(), P(\"div\", He({\n              key: 0,\n              ref_key: \"submenuRoot\",\n              ref: r\n            }, t.$attrs, {\n              class: [\n                \"mx-context-menu\",\n                l(p).customClass ? l(p).customClass : \"\",\n                l(p).theme ?? \"\"\n              ],\n              style: {\n                maxWidth: e.maxWidth ? l(Ye)(e.maxWidth) : `${l(ee).defaultMaxWidth}px`,\n                minWidth: e.minWidth ? l(Ye)(e.minWidth) : `${l(ee).defaultMinWidth}px`,\n                zIndex: l(B),\n                left: `${O.value.x}px`,\n                top: `${O.value.y}px`\n              },\n              \"data-type\": \"ContextSubMenu\",\n              onClick: V\n            }), [\n              ie(l(It), {\n                ref_key: \"scrollRectRef\",\n                ref: H,\n                scroll: \"vertical\",\n                maxHeight: Q.value,\n                containerClass: \"mx-context-menu-scroll\"\n              }, {\n                default: pe(() => [\n                  z(\"div\", {\n                    class: oe([\"mx-context-menu-items\"]),\n                    ref_key: \"menu\",\n                    ref: f\n                  }, [\n                    E(t.$slots, \"default\", {}, () => [\n                      (b(!0), P(Oe, null, Pe(e.items, (a, de) => (b(), P(Oe, { key: de }, [\n                        a.hidden !== !0 && a.divided === \"up\" ? (b(), F(ge, { key: 0 })) : D(\"\", !0),\n                        a.hidden !== !0 && a.divided === \"self\" ? (b(), F(ge, { key: 1 })) : (b(), F($e, {\n                          key: 2,\n                          clickHandler: a.onClick ? (j) => a.onClick(j) : void 0,\n                          disabled: typeof a.disabled == \"object\" ? a.disabled.value : a.disabled,\n                          hidden: typeof a.hidden == \"object\" ? a.hidden.value : a.hidden,\n                          icon: a.icon,\n                          iconFontClass: a.iconFontClass,\n                          svgIcon: a.svgIcon,\n                          svgProps: a.svgProps,\n                          label: a.label,\n                          customRender: a.customRender,\n                          customClass: a.customClass,\n                          checked: typeof a.checked == \"object\" ? a.checked.value : a.checked,\n                          shortcut: a.shortcut,\n                          clickClose: a.clickClose,\n                          clickableWhenHasChildren: a.clickableWhenHasChildren,\n                          preserveIconWidth: a.preserveIconWidth !== void 0 ? a.preserveIconWidth : l(p).preserveIconWidth,\n                          showRightArrow: a.children && a.children.length > 0,\n                          hasChildren: a.children && a.children.length > 0,\n                          rawMenuItem: a,\n                          onSubMenuOpen: (j) => {\n                            var X;\n                            return (X = a.onSubMenuOpen) == null ? void 0 : X.call(a, j);\n                          },\n                          onSubMenuClose: (j) => {\n                            var X;\n                            return (X = a.onSubMenuClose) == null ? void 0 : X.call(a, j);\n                          }\n                        }, tt({ _: 2 }, [\n                          a.children && a.children.length > 0 ? {\n                            name: \"submenu\",\n                            fn: pe(({ context: j, show: X }) => [\n                              ie(m, {\n                                show: X,\n                                parentMenuItemContext: j,\n                                items: a.children,\n                                maxWidth: a.maxWidth,\n                                minWidth: a.minWidth,\n                                maxHeight: a.maxHeight,\n                                adjustPosition: a.adjustSubMenuPosition !== void 0 ? a.adjustSubMenuPosition : l(p).adjustPosition,\n                                direction: a.direction !== void 0 ? a.direction : l(p).direction\n                              }, null, 8, [\"show\", \"parentMenuItemContext\", \"items\", \"maxWidth\", \"minWidth\", \"maxHeight\", \"adjustPosition\", \"direction\"])\n                            ]),\n                            key: \"0\"\n                          } : void 0\n                        ]), 1032, [\"clickHandler\", \"disabled\", \"hidden\", \"icon\", \"iconFontClass\", \"svgIcon\", \"svgProps\", \"label\", \"customRender\", \"customClass\", \"checked\", \"shortcut\", \"clickClose\", \"clickableWhenHasChildren\", \"preserveIconWidth\", \"showRightArrow\", \"hasChildren\", \"rawMenuItem\", \"onSubMenuOpen\", \"onSubMenuClose\"])),\n                        a.hidden !== !0 && (a.divided === \"down\" || a.divided === !0) ? (b(), F(ge, { key: 3 })) : D(\"\", !0)\n                      ], 64))), 128))\n                    ])\n                  ], 512)\n                ]),\n                _: 3\n              }, 8, [\"maxHeight\"])\n            ], 16)) : D(\"\", !0)\n          ]),\n          _: 3\n        }, 16)\n      ], 8, [\"to\"])) : D(\"\", !0);\n    };\n  }\n});\nconst st = /* @__PURE__ */ te({\n  __name: \"ContextSubMenuWrapper\",\n  props: {\n    /**\n     * Menu options\n     */\n    options: {\n      type: Object,\n      default: null\n    },\n    /**\n     * Show menu?\n     */\n    show: {\n      type: null,\n      default: null\n    },\n    /**\n     * Current container, For calculation only\n     */\n    container: {\n      type: Object,\n      default: null\n    },\n    /**\n     * Make sure is user set the custom container.\n     */\n    isFullScreenContainer: {\n      type: Boolean,\n      default: !0\n    }\n  },\n  emits: [\"close\", \"closeAnimFinished\"],\n  setup(e, { expose: o, emit: s }) {\n    const u = e, v = s, n = nt(), _ = W(), {\n      options: d,\n      show: p,\n      container: h\n    } = re(u);\n    be(() => {\n      p.value && L();\n    }), Me(() => {\n      H();\n    }), Be(p, (i) => {\n      i ? L() : (Ke(x), H());\n    });\n    const x = {\n      closeMenu: S,\n      isClosed: M,\n      getMenuRef: () => _.value,\n      getMenuDimensions: () => {\n        var i;\n        return ((i = _.value) == null ? void 0 : i.getMenuDimensions()) ?? { width: 0, height: 0 };\n      }\n    };\n    let B = !1;\n    function L() {\n      k(), mt(x);\n    }\n    function S(i) {\n      B = !0, v(\"close\", i), d.value.menuTransitionProps || v(\"closeAnimFinished\"), Ke(x);\n    }\n    function M() {\n      return B;\n    }\n    function k() {\n      setTimeout(() => {\n        document.addEventListener(\"click\", y, !0), document.addEventListener(\"contextmenu\", y, !0), document.addEventListener(\"scroll\", C, !0), !u.isFullScreenContainer && h.value && h.value.addEventListener(\"scroll\", C, !0), d.value.keyboardControl !== !1 && document.addEventListener(\"keydown\", f, !0);\n      }, 50);\n    }\n    function H() {\n      document.removeEventListener(\"contextmenu\", y, !0), document.removeEventListener(\"click\", y, !0), document.removeEventListener(\"scroll\", C, !0), !u.isFullScreenContainer && h.value && h.value.removeEventListener(\"scroll\", C, !0), d.value.keyboardControl !== !1 && document.removeEventListener(\"keydown\", f, !0);\n    }\n    const r = W();\n    J(\"globalSetCurrentSubMenu\", (i) => r.value = i), J(\"globalGetMenuHostId\", h.value.id);\n    function f(i) {\n      var K, R, N, V, U, A, w, $, Z, Y, G, Q, ne;\n      let g = !0;\n      switch (i.key) {\n        case \"Escape\": {\n          ((K = r.value) == null ? void 0 : K.isTopLevel()) === !1 ? (R = r.value) == null || R.closeCurrentSubMenu() : S();\n          break;\n        }\n        case \"ArrowDown\":\n          (N = r.value) == null || N.moveCurrentItemDown();\n          break;\n        case \"ArrowUp\":\n          (V = r.value) == null || V.moveCurrentItemUp();\n          break;\n        case \"Home\":\n          (U = r.value) == null || U.moveCurrentItemFirst();\n          break;\n        case \"End\":\n          (A = r.value) == null || A.moveCurrentItemLast();\n          break;\n        case \"ArrowLeft\": {\n          (w = r.value) != null && w.closeSelfAndActiveParent() || (Z = ($ = d.value).onKeyFocusMoveLeft) == null || Z.call($);\n          break;\n        }\n        case \"ArrowRight\":\n          (Y = r.value) != null && Y.openCurrentItemSubMenu() || (Q = (G = d.value).onKeyFocusMoveRight) == null || Q.call(G);\n          break;\n        case \"Enter\":\n          (ne = r.value) == null || ne.triggerCurrentItemClick(i);\n          break;\n        default:\n          g = !1;\n          break;\n      }\n      g && r.value && (i.stopPropagation(), i.preventDefault());\n    }\n    function C(i) {\n      d.value.closeWhenScroll !== !1 && I(i.target, null);\n    }\n    function y(i) {\n      I(i.target, i);\n    }\n    function I(i, g) {\n      var K, R;\n      for (; i; ) {\n        if (i.classList && i.classList.contains(\"mx-context-menu\"))\n          return;\n        i = i.parentNode;\n      }\n      g ? d.value.clickCloseOnOutside !== !1 ? (H(), S()) : (R = (K = d.value).onClickOnOutside) == null || R.call(K, g) : (H(), S());\n    }\n    return J(\"globalOptions\", d), J(\"globalCloseMenu\", S), J(\"globalIsFullScreenContainer\", u.isFullScreenContainer), J(\"globalHasSlot\", (i) => n[i] !== void 0), J(\"globalRenderSlot\", (i, g) => E(n, i, { ...g }, () => [xe(\"span\", \"Render slot failed\")], !1)), J(\"menuContext\", {\n      zIndex: d.value.zIndex || ee.defaultZindex,\n      container: h.value,\n      adjustPadding: { x: 0, y: 0 },\n      getZoom: () => d.value.zoom || ee.defaultZoom,\n      getParentWidth: () => 0,\n      getParentHeight: () => 0,\n      getPositon: () => [d.value.x, d.value.y],\n      closeOtherSubMenuWithTimeOut: () => {\n      },\n      checkCloseOtherSubMenuTimeOut: () => !1,\n      addOpenedSubMenu: () => {\n      },\n      closeOtherSubMenu: () => {\n      },\n      getParentContext: () => null,\n      getSubMenuInstanceContext: () => null,\n      getElement: () => null,\n      addChildMenuItem: () => {\n      },\n      removeChildMenuItem: () => {\n      },\n      markActiveMenuItem: () => {\n      },\n      markThisOpenedByKeyBoard: () => {\n      },\n      isOpenedByKeyBoardFlag: () => !1,\n      isMenuItemDataCollectedFlag: () => !1\n    }), o(x), (i, g) => (b(), F(Ae, {\n      ref_key: \"submenuInstance\",\n      ref: _,\n      show: l(p),\n      items: l(d).items,\n      adjustPosition: l(d).adjustPosition,\n      maxWidth: l(d).maxWidth || l(ee).defaultMaxWidth,\n      minWidth: l(d).minWidth || l(ee).defaultMinWidth,\n      maxHeight: l(d).maxHeight,\n      direction: l(d).direction || l(ee).defaultDirection,\n      onCloseAnimFinished: g[0] || (g[0] = (K) => v(\"closeAnimFinished\"))\n    }, {\n      default: pe(() => [\n        E(i.$slots, \"default\")\n      ]),\n      _: 3\n    }, 8, [\"show\", \"items\", \"adjustPosition\", \"maxWidth\", \"minWidth\", \"maxHeight\", \"direction\"]));\n  }\n});\nconst Ut = /* @__PURE__ */ te({\n  __name: \"ContextMenu\",\n  props: {\n    /**\n     * Menu options\n     */\n    options: {\n      type: Object,\n      default: null\n    },\n    /**\n     * Show menu?\n     */\n    show: {\n      type: Boolean,\n      default: !1\n    }\n  },\n  emits: [\"update:show\", \"close\"],\n  setup(e, { expose: o, emit: s }) {\n    const u = s, v = e, { options: n, show: _ } = re(v), { isNew: d, container: p, eleId: h } = lt(n.value), x = W(null), B = nt();\n    function L(S) {\n      var M, k;\n      u(\"update:show\", !1), u(\"close\"), (k = (M = n.value).onClose) == null || k.call(M, S);\n    }\n    return o({\n      closeMenu: () => u(\"update:show\", !1),\n      isClosed: () => !_.value,\n      getMenuRef: () => {\n        var S;\n        return (S = x.value) == null ? void 0 : S.getMenuRef();\n      },\n      getMenuDimensions: () => {\n        var S;\n        return ((S = x.value) == null ? void 0 : S.getMenuDimensions()) ?? { width: 0, height: 0 };\n      }\n    }), (S, M) => (b(), F(et, {\n      to: `#${l(h)}`\n    }, [\n      ie(st, {\n        ref_key: \"menuRef\",\n        ref: x,\n        options: l(n),\n        show: l(_),\n        container: l(p),\n        isFullScreenContainer: !l(d),\n        onClose: L\n      }, tt({ _: 2 }, [\n        Pe(l(B), (k, H) => ({\n          name: H,\n          fn: pe((r) => [\n            E(S.$slots, H, ft(vt(r)))\n          ])\n        }))\n      ]), 1032, [\"options\", \"show\", \"container\", \"isFullScreenContainer\"])\n    ], 8, [\"to\"]));\n  }\n}), Xt = te({\n  name: \"ContextMenuGroup\",\n  props: {\n    /**\n    * Is this menu disabled? \n    */\n    disabled: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n    * Is this menu hidden? \n    */\n    hidden: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Is this menu disabled? \n     */\n    clickHandler: {\n      type: Function,\n      default: null\n    },\n    /**\n     * Menu label\n     */\n    label: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * Menu icon (for icon class)\n     */\n    icon: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * Custom icon library font class name.\n     * \n     * Only for css font icon, If you use the svg icon, you do not need to use this.\n     */\n    iconFontClass: {\n      type: String,\n      default: \"iconfont\"\n    },\n    /**\n     * Is this menu item checked?\n     * \n     * The check mark are displayed on the left side of the icon, so it is not recommended to display the icon at the same time.\n     */\n    checked: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Shortcut key text display on the right.\n     * \n     * The shortcut keys here are only for display. You need to handle the key events by yourself.\n     */\n    shortcut: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * Display icons use svg symbol (`<use xlink:href=\"#icon-symbol-name\">`)  only valid when icon attribute is empty.\n     */\n    svgIcon: {\n      type: String,\n      default: \"\"\n    },\n    /**\n     * The user-defined attribute of the svg tag, which is valid when using `svgIcon`.\n     */\n    svgProps: {\n      type: Object,\n      default: null\n    },\n    /**\n     * Should a fixed-width icon area be reserved for menu items without icon. (this item)\n     * \n     * Default is true .\n     * \n     * The width of icon area can be override with css var `--mx-menu-placeholder-width`.\n     */\n    preserveIconWidth: {\n      type: Boolean,\n      default: !0\n    },\n    /**\n     * Show right arrow on this menu?\n     */\n    showRightArrow: {\n      type: Boolean,\n      default: !1\n    },\n    /**\n     * Should close menu when Click this menu item ?\n     */\n    clickClose: {\n      type: Boolean,\n      default: !0\n    },\n    /**\n     * By default, the submenu will automatically adjust its position to prevent it overflow the container.\n     * \n     * If you allow menu overflow containers, you can set this to false.\n     * \n     * Default is inherit from `MenuOptions.adjustPosition`  .\n     */\n    adjustSubMenuPosition: {\n      type: Boolean,\n      default: void 0\n    },\n    /**\n     * Max height of submenu\n     */\n    maxHeight: {\n      type: [String, Number],\n      default: 0\n    },\n    /**\n     * Max width of submenu\n     */\n    maxWidth: {\n      type: [String, Number],\n      default: 0\n    },\n    /**\n     * Min width of submenu\n     */\n    minWidth: {\n      type: [String, Number],\n      default: 0\n    }\n  },\n  setup(e, o) {\n    const s = T(\"globalOptions\"), { adjustSubMenuPosition: u, maxWidth: v, minWidth: n, maxHeight: _ } = re(e), d = typeof u.value < \"u\" ? u.value : s.value.adjustPosition, p = W(), h = W();\n    return o.expose({\n      getSubMenuRef: () => p.value,\n      getMenuItemRef: () => h.value\n    }), () => xe($e, {\n      ...e,\n      ref: h,\n      showRightArrow: !0,\n      maxWidth: void 0,\n      minWidth: void 0,\n      maxHeight: void 0,\n      adjustSubMenuPosition: void 0,\n      hasChildren: typeof o.slots.default !== void 0\n    }, o.slots.default ? {\n      //Create SubMenu\n      submenu: (x) => xe(Ae, {\n        ref: p,\n        show: x.show,\n        maxWidth: v.value,\n        minWidth: n.value,\n        maxHeight: _.value,\n        adjustPosition: d,\n        parentMenuItemContext: x.context\n      }, {\n        default: o.slots.default\n      }),\n      //Add other slots\n      ...yt(o.slots, \"default\")\n    } : o.slots);\n  }\n});\nfunction Zt(e, o, s, u) {\n  const v = W(!0), n = xe(st, {\n    options: e,\n    show: v,\n    container: o,\n    isFullScreenContainer: !s,\n    onCloseAnimFinished: () => {\n      Ne(null, o);\n    },\n    onClose: (_) => {\n      var d;\n      (d = e.onClose) == null || d.call(e, _), v.value = !1;\n    }\n  }, u);\n  return Ne(n, o), n.component;\n}\nfunction Je(e, o) {\n  const s = lt(e);\n  return Zt(e, s.container, s.isNew, o).exposed;\n}\nconst Qe = {\n  /**\n   * For Vue install\n   * @param app \n   */\n  install(e) {\n    e.config.globalProperties.$contextmenu = Je, e.component(\"ContextMenu\", Ut), e.component(\"ContextMenuItem\", $e), e.component(\"ContextMenuGroup\", Xt), e.component(\"ContextMenuSperator\", ge), e.component(\"ContextMenuSeparator\", ge), e.component(\"ContextSubMenu\", Ae);\n  },\n  /**\n   * Show a ContextMenu in page, same as `this.$contextmenu`\n   * \n   * For example:\n   * \n   * ```ts\n   * onContextMenu(e : MouseEvent) {\n   *   //prevent the browser's default menu\n   *   e.preventDefault();\n   *   //show your menu\n   *   ContextMenu.showContextMenu({\n   *     x: e.x,\n   *     y: e.y,\n   *     items: [\n   *       { \n   *         label: \"A menu item\", \n   *         onClick: () => {\n   *           alert(\"You click a menu item\");\n   *         }\n   *       },\n   *       { \n   *         label: \"A submenu\", \n   *         children: [\n   *           { label: \"Item1\" },\n   *           { label: \"Item2\" },\n   *           { label: \"Item3\" },\n   *         ]\n   *       },\n   *     ]\n   *   }); \n   * }\n   * ```\n   * \n   * You can pass customSlots to custom rendering this menu.\n   * \n   * For example, custom rendering #itemRender and #separatorRender:\n   * ```ts\n   *   ContextMenu.showContextMenu({\n   *     ...\n   *   } as MenuOptions, {\n   *     //Use slot in function mode\n   *     itemRender: ({ disabled, label, icon, showRightArrow, onClick, onMouseEnter }) => [  h('div', { \n   *       class: 'my-menu-item'+(disabled?' disabled':''),\n   *       onMouseenter: onMouseEnter,\n   *       onClick: onClick,\n   *     }, [\n   *       icon ? h('img', { src: icon }) : h('div', { class: 'icon-place-holder' }),\n   *       h('span', label),\n   *       showRightArrow ? h('span', { class: 'right-arraw' }, '>>') : h('div'),\n   *     ]) ],\n   *     separatorRender: () => [ h('div', { class: 'my-menu-sperator' }) ]\n   *   })\n   * ```\n   * \n   * @param options The options of ContextMenu\n   * @param customSlots You can provide some custom slots to customize the rendering style of the menu. These slots are the same as the slots of component ContextMenu.\n   * @returns Menu instance \n   */\n  showContextMenu(e, o) {\n    return Je(e, o);\n  },\n  /**\n   * Get if there is a menu open now.\n   */\n  isAnyContextMenuOpen() {\n    return ht();\n  },\n  /**\n   * Close the currently open menu\n   */\n  closeContextMenu: ot,\n  //Tools\n  transformMenuPosition: pt\n}, Gt = {}, Jt = {\n  class: \"mx-menu-bar-icon-menu\",\n  viewBox: \"0 0 1024 1024\",\n  version: \"1.1\",\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"200\",\n  height: \"200\"\n}, Qt = /* @__PURE__ */ z(\"path\", { d: \"M133.310936 296.552327l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949 0-19.781623-15.997312-35.950949-35.950949-35.950949L133.310936 224.650428c-19.781623 0-35.950949 16.169326-35.950949 35.950949C97.359987 280.383 113.529313 296.552327 133.310936 296.552327z\" }, null, -1), qt = /* @__PURE__ */ z(\"path\", { d: \"M890.51705 476.135058 133.310936 476.135058c-19.781623 0-35.950949 16.169326-35.950949 35.950949 0 19.781623 16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-16.169326 35.950949-35.950949C926.467999 492.304384 910.298673 476.135058 890.51705 476.135058z\" }, null, -1), en = /* @__PURE__ */ z(\"path\", { d: \"M890.51705 727.447673 133.310936 727.447673c-19.781623 0-35.950949 15.997312-35.950949 35.950949s16.169326 35.950949 35.950949 35.950949l757.206115 0c19.781623 0 35.950949-15.997312 35.950949-35.950949S910.298673 727.447673 890.51705 727.447673z\" }, null, -1), tn = [\n  Qt,\n  qt,\n  en\n];\nfunction nn(e, o) {\n  return b(), P(\"svg\", Jt, tn);\n}\nconst on = /* @__PURE__ */ ke(Gt, [[\"render\", nn]]), ln = [\"onClick\", \"onMouseenter\"], un = /* @__PURE__ */ te({\n  __name: \"MenuBar\",\n  props: {\n    /**\n     * Menu options\n     */\n    options: {\n      type: Object,\n      default: null\n    }\n  },\n  setup(e) {\n    const o = e, s = W(), u = W(!1), v = W([]), n = W(null);\n    function _() {\n      u.value = !0;\n    }\n    function d() {\n      u.value = !1;\n    }\n    be(() => {\n      v.value = o.options.items || [];\n    }), Be(() => o.options, () => {\n      v.value = o.options.items || [];\n    });\n    let p = null, h = -1;\n    function x() {\n      h < v.value.length - 1 ? h++ : h = 0, S(h, v.value[h]);\n    }\n    function B() {\n      h > 0 ? h-- : h = v.value.length - 1, S(h, v.value[h]);\n    }\n    function L(r) {\n      const f = o.options.barPopDirection ?? \"bl\";\n      let C = 0, y = 0;\n      return f.startsWith(\"b\") ? y = se(r) + r.offsetHeight : f.startsWith(\"t\") ? y = se(r) : y = se(r) + r.offsetHeight / 2, f.endsWith(\"l\") ? C = ue(r) : f.startsWith(\"r\") ? C = ue(r) + r.offsetWidth : C = ue(r) + r.offsetWidth / 2, { x: C, y: y + 5 };\n    }\n    function S(r, f) {\n      var y;\n      if (h = r, !f.children)\n        return;\n      p && (p.closeMenu(), p = null, u.value = !0), n.value = f;\n      const C = (y = s.value) == null ? void 0 : y.children[r];\n      if (C) {\n        const { x: I, y: i } = L(C);\n        p = Qe.showContextMenu({\n          ...o.options,\n          items: f.children,\n          x: I,\n          y: i,\n          onKeyFocusMoveLeft() {\n            B();\n          },\n          onKeyFocusMoveRight() {\n            x();\n          },\n          onClose() {\n            n.value == f && (u.value = !1, n.value = null), typeof f.onSubMenuClose == \"function\" && f.onSubMenuClose(void 0);\n          }\n        }), p && typeof f.onSubMenuOpen == \"function\" && f.onSubMenuOpen(void 0);\n      }\n    }\n    function M() {\n      h = 0;\n      const r = s.value;\n      if (r) {\n        const { x: f, y: C } = L(r);\n        p = Qe.showContextMenu({\n          ...o.options,\n          x: f,\n          y: C\n        });\n      }\n    }\n    function k(r, f) {\n      f ? (u.value = !0, S(r, f), f.onClick && (f.clickableWhenHasChildren === !0 && f.children && f.children.length > 0 || !f.children || f.children.length === 0) && f.onClick()) : M();\n    }\n    function H(r, f) {\n      u.value && S(r, f);\n    }\n    return (r, f) => (b(), P(\"div\", {\n      class: oe([\n        \"mx-menu-bar\",\n        e.options.theme ?? \"\",\n        e.options.mini ? \"mini\" : \"\"\n      ]),\n      onFocus: _,\n      onBlur: d\n    }, [\n      E(r.$slots, \"prefix\"),\n      e.options.mini ? (b(), P(\"div\", {\n        key: 0,\n        ref_key: \"menuBarContent\",\n        ref: s,\n        class: \"mx-menu-bar-content\"\n      }, [\n        z(\"div\", {\n          class: \"mx-menu-bar-item\",\n          onClick: f[0] || (f[0] = (C) => k(0, null))\n        }, [\n          ie(on)\n        ])\n      ], 512)) : (b(), P(\"div\", {\n        key: 1,\n        ref_key: \"menuBarContent\",\n        ref: s,\n        class: \"mx-menu-bar-content\"\n      }, [\n        (b(!0), P(Oe, null, Pe(v.value, (C, y) => (b(), P(\"div\", {\n          key: y,\n          class: oe([\n            \"mx-menu-bar-item\",\n            C == n.value ? \"active\" : \"\"\n          ]),\n          onClick: (I) => k(y, C),\n          onMouseenter: (I) => H(y, C)\n        }, Re(C.label), 43, ln))), 128))\n      ], 512)),\n      E(r.$slots, \"suffix\")\n    ], 34));\n  }\n});\nexport {\n  Ut as ContextMenu,\n  Xt as ContextMenuGroup,\n  $e as ContextMenuItem,\n  ge as ContextMenuSeparator,\n  un as MenuBar,\n  Qe as default\n};\n//# sourceMappingURL=vue3-context-menu.es.js.map\n","<template>\r\n  <div class=\"grid-header\" :style=\"{ gridTemplateColumns }\">\r\n    <div\r\n      v-for=\"column in columns\"\r\n      :key=\"column.name\"\r\n      class=\"header-cell\"\r\n      :class=\"{ 'header-cell--auto-width': column.autoWidth }\"\r\n      @click=\"handleHeaderClick($event, column)\"\r\n      @contextmenu.prevent=\"showHeaderContextMenu($event, column)\"\r\n    >\r\n      <!-- Custom tri-state checkbox (not native input) -->\r\n      <div\r\n        v-if=\"column.specialType === 'Checkbox'\"\r\n        class=\"custom-checkbox\"\r\n        :class=\"{\r\n          'checkbox-none': store.checkboxState === 'none',\r\n          'checkbox-some': store.checkboxState === 'some',\r\n          'checkbox-all': store.checkboxState === 'all'\r\n        }\"\r\n        @click.stop=\"handleCheckboxHeaderClick\"\r\n        title=\"Toggle all checkboxes\"\r\n      >\r\n        <!-- Checkmark for 'all' state -->\r\n        <span v-if=\"store.checkboxState === 'all'\" class=\"checkbox-icon\"></span>\r\n        <!-- Dash for 'some' state -->\r\n        <span v-else-if=\"store.checkboxState === 'some'\" class=\"checkbox-icon\"></span>\r\n      </div>\r\n\r\n      <span v-else class=\"header-text\">{{ column.header }}</span>\r\n\r\n      <!-- Multi-column sort indicator -->\r\n      <span\r\n        v-if=\"column.isSortable && getSortInfo(column.name)\"\r\n        class=\"sort-icon\"\r\n        :class=\"getSortInfo(column.name)?.isPrimary ? 'sort-icon--primary' : 'sort-icon--secondary'\"\r\n      >\r\n        {{ getSortInfo(column.name)?.direction === 'asc' ? '' : '' }}\r\n        <span v-if=\"getSortInfo(column.name)?.order && getSortInfo(column.name)!.order > 1\" class=\"sort-order\">\r\n          {{ getSortInfo(column.name)?.order }}\r\n        </span>\r\n      </span>\r\n\r\n      <!-- Resize grip -->\r\n      <div\r\n        class=\"resize-grip\"\r\n        @mousedown.stop=\"startResize(column, $event)\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed } from 'vue'\r\nimport { useDataGridStore, type GridColumn } from '@/stores/dataGridStore'\r\nimport ContextMenu from '@imengyu/vue3-context-menu'\r\n\r\nconst props = defineProps<{\r\n  columns: GridColumn[]\r\n  gridTemplateColumns: string\r\n  gridId?: string\r\n  isGridReady?: boolean\r\n  isProcessing?: boolean  //  RIEENIE A: Processing flag\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  sort: [columnName: string, direction: 'asc' | 'desc']\r\n  resize: [columnName: string, newWidth: number]\r\n  hideColumn: [columnName: string]\r\n  autoFitColumn: [columnName: string]\r\n  showFilter: [columnName: string]\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId)\r\n\r\n// No longer need ref or watch - custom checkbox is controlled by Vue reactivity\r\n\r\nconst resizingColumn = ref<GridColumn | null>(null)\r\nconst resizeStartX = ref(0)\r\nconst resizeStartWidth = ref(0)\r\n\r\n/**\r\n *  RIEENIE B: Computed sortInfoMap - cache sort info for all columns\r\n * Only recalculates when store.sortColumns changes (1 access instead of 6 per column)\r\n */\r\nconst sortInfoMap = computed(() => {\r\n  const map = new Map<string, { direction: 'asc' | 'desc'; order: number; isPrimary: boolean }>()\r\n\r\n  store.sortColumns.forEach((sortCol, index) => {\r\n    map.set(sortCol.columnName, {\r\n      direction: sortCol.direction,\r\n      order: index + 1,\r\n      isPrimary: index === 0\r\n    })\r\n  })\r\n\r\n  return map\r\n})\r\n\r\n/**\r\n *  RIEENIE E + B: Gets sort information using computed Map (O(1) lookup)\r\n * Returns null if column is not sorted\r\n */\r\nfunction getSortInfo(columnName: string): { direction: 'asc' | 'desc'; order: number; isPrimary: boolean } | null {\r\n  return sortInfoMap.value.get(columnName) ?? null\r\n}\r\n\r\nfunction handleHeaderClick(event: MouseEvent, column: GridColumn) {\r\n  // For checkbox column, do nothing (checkbox handles its own click)\r\n  if (column.specialType === 'Checkbox') {\r\n    return\r\n  }\r\n\r\n  // For sortable columns with Shift key, toggle sort\r\n  if (column.isSortable && event.shiftKey) {\r\n    handleSort(column, true) // multi-sort mode\r\n    return\r\n  }\r\n\r\n  // For other columns, show context menu\r\n  showHeaderContextMenu(event, column)\r\n}\r\n\r\nfunction handleCheckboxHeaderClick() {\r\n  store.toggleAllCheckboxes()\r\n}\r\n\r\nfunction handleSort(column: GridColumn, multiSort = false) {\r\n  if (!column.isSortable) return\r\n\r\n  const currentSort = getSortInfo(column.name)\r\n\r\n  if (currentSort) {\r\n    // Column is already sorted - toggle direction\r\n    const newDirection = currentSort.direction === 'asc' ? 'desc' : 'asc'\r\n    store.addSort(column.name, newDirection, multiSort)\r\n  } else {\r\n    // Column is not sorted - add ascending sort\r\n    store.addSort(column.name, 'asc', multiSort)\r\n  }\r\n\r\n  // Emit for compatibility (even though store handles it)\r\n  const sortInfo = getSortInfo(column.name)\r\n  if (sortInfo) {\r\n    emit('sort', column.name, sortInfo.direction)\r\n  }\r\n}\r\n\r\nfunction startResize(column: GridColumn, event: MouseEvent) {\r\n  resizingColumn.value = column\r\n  resizeStartX.value = event.clientX\r\n  resizeStartWidth.value = column.width\r\n\r\n  window.addEventListener('mousemove', onResizeMove)\r\n  window.addEventListener('mouseup', onResizeEnd)\r\n}\r\n\r\nfunction onResizeMove(event: MouseEvent) {\r\n  if (!resizingColumn.value) return\r\n\r\n  const delta = event.clientX - resizeStartX.value\r\n  const newWidth = Math.max(\r\n    resizingColumn.value.minWidth,\r\n    Math.min(resizingColumn.value.maxWidth, resizeStartWidth.value + delta)\r\n  )\r\n\r\n  emit('resize', resizingColumn.value.name, newWidth)\r\n}\r\n\r\nfunction onResizeEnd() {\r\n  resizingColumn.value = null\r\n  window.removeEventListener('mousemove', onResizeMove)\r\n  window.removeEventListener('mouseup', onResizeEnd)\r\n}\r\n\r\nfunction showHeaderContextMenu(event: MouseEvent, column: GridColumn) {\r\n  //  FIX: Early return if grid is not ready\r\n  if (props.isGridReady === false) {\r\n    console.error('[showHeaderContextMenu] Grid not ready yet')\r\n    return\r\n  }\r\n\r\n  //  FIX: Early return if store is not initialized\r\n  if (!store) {\r\n    console.error('[showHeaderContextMenu] Store not initialized yet')\r\n    return\r\n  }\r\n\r\n  //  RIEENIE A: Check processing flag\r\n  if (props.isProcessing) {\r\n    console.error('[showHeaderContextMenu] Grid is currently processing data')\r\n    return  // Silent return - no alert needed\r\n  }\r\n\r\n  //  RIEENIE D: Defensive copy of reactive data\r\n  const sortColumnsCopy = [...store.sortColumns]\r\n  const filterExpressionCopy = store.filterExpression\r\n\r\n  const menuItems = []\r\n\r\n  // Sort options\r\n  if (column.isSortable) {\r\n    const currentSort = getSortInfo(column.name)\r\n    const hasOtherSorts = sortColumnsCopy.length > 0  //  Use copy\r\n\r\n    menuItems.push(\r\n      {\r\n        label: 'Sort Ascending',\r\n        icon: '',\r\n        onClick: () => {\r\n          store.addSort(column.name, 'asc', false)\r\n          emit('sort', column.name, 'asc')\r\n        }\r\n      },\r\n      {\r\n        label: 'Sort Descending',\r\n        icon: '',\r\n        onClick: () => {\r\n          store.addSort(column.name, 'desc', false)\r\n          emit('sort', column.name, 'desc')\r\n        }\r\n      }\r\n    )\r\n\r\n    // Multi-sort options\r\n    if (hasOtherSorts) {\r\n      menuItems.push(\r\n        { divided: true },\r\n        {\r\n          label: 'Add to Sort (Asc)',\r\n          icon: '+',\r\n          onClick: () => {\r\n            store.addSort(column.name, 'asc', true)\r\n          }\r\n        },\r\n        {\r\n          label: 'Add to Sort (Desc)',\r\n          icon: '+',\r\n          onClick: () => {\r\n            store.addSort(column.name, 'desc', true)\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    // Remove from sort if already sorted\r\n    if (currentSort) {\r\n      menuItems.push(\r\n        { divided: true },\r\n        {\r\n          label: `Remove from Sort (Order ${currentSort.order})`,\r\n          icon: '',\r\n          onClick: () => {\r\n            const newSorts = sortColumnsCopy.filter(s => s.columnName !== column.name)  //  Use copy\r\n            store.sortColumns = newSorts\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    // Clear all sorts\r\n    if (hasOtherSorts) {\r\n      menuItems.push(\r\n        {\r\n          label: 'Clear All Sorts',\r\n          icon: '',\r\n          onClick: () => {\r\n            store.clearSort()\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    menuItems.push({ divided: true })\r\n  }\r\n\r\n  // Filter option\r\n  if (column.isFilterable) {\r\n    menuItems.push(\r\n      {\r\n        label: 'Filter...',\r\n        icon: '',\r\n        onClick: () => emit('showFilter', column.name)\r\n      }\r\n    )\r\n\r\n    // Clear all filters option (show only if filters exist)\r\n    if (filterExpressionCopy !== null) {  //  Use copy\r\n      menuItems.push(\r\n        {\r\n          label: 'Clear All Filters',\r\n          icon: '',\r\n          onClick: () => {\r\n            store.clearFilter()\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    menuItems.push({ divided: true })\r\n  }\r\n\r\n  // Column management options (only for non-special columns)\r\n  if (!column.specialType) {\r\n    menuItems.push(\r\n      {\r\n        label: 'Auto-fit Column',\r\n        icon: '',\r\n        onClick: () => emit('autoFitColumn', column.name)\r\n      },\r\n      {\r\n        label: 'Hide Column',\r\n        icon: '',\r\n        onClick: () => emit('hideColumn', column.name)\r\n      }\r\n    )\r\n  }\r\n\r\n  ContextMenu.showContextMenu({\r\n    x: event.x,\r\n    y: event.y,\r\n    items: menuItems\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grid-header {\r\n  display: grid; /* Changed from flex to grid for perfect column alignment */\r\n  /* grid-template-columns applied via inline style from parent */\r\n  background-color: var(--dg-header-bg, #f5f5f5);\r\n  color: var(--dg-header-fg, #212529);\r\n  border-bottom: 2px solid var(--dg-border-column, #ccc);\r\n  font-weight: bold;\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  width: 100%; /* CRITICAL: Always fill container width */\r\n  max-width: 100%; /* CRITICAL: Never exceed container width */\r\n  /* CRITICAL: Compensate for vertical scrollbar width to align columns with rows */\r\n  /* Reduced to 8px for narrower spacing (user requested), can be customized via CSS variable */\r\n  padding-right: var(--dg-scrollbar-width, 8px);\r\n  box-sizing: border-box;\r\n  /* REMOVED min-width: fit-content - this was causing header to have different width than rows! */\r\n  /* Header MUST have identical width to rows for 1fr to resolve to same pixels */\r\n}\r\n\r\n.header-cell {\r\n  position: relative;\r\n  padding: 8px;\r\n  border-right: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  cursor: pointer;\r\n  user-select: none;\r\n  display: flex; /* Keep flex for internal layout (icon + text alignment) */\r\n  align-items: center;\r\n  gap: 4px;\r\n  overflow: hidden; /* Prevent content from breaking grid layout */\r\n}\r\n\r\n.header-cell:hover {\r\n  background-color: var(--dg-header-hover-bg, #eeeeee);\r\n}\r\n\r\n.header-cell:active {\r\n  background-color: var(--dg-header-pressed-bg, #dee2e6);\r\n}\r\n\r\n.header-text {\r\n  flex: 1;\r\n}\r\n\r\n.header-cell--auto-width {\r\n  /* Auto-width columns use Star sizing (flex-grow) to fill remaining space */\r\n  flex-shrink: 0;\r\n}\r\n\r\n.sort-icon {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2px;\r\n  font-size: 10px;\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n  font-weight: bold;\r\n}\r\n\r\n.sort-icon--primary {\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.sort-icon--secondary {\r\n  color: var(--dg-header-sort-secondary, #90caf9);\r\n  font-size: 9px;\r\n}\r\n\r\n.sort-order {\r\n  font-size: 9px;\r\n  font-weight: bold;\r\n  color: inherit;\r\n  padding-left: 1px;\r\n}\r\n\r\n.resize-grip {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  width: 4px;\r\n  cursor: col-resize;\r\n  background-color: transparent;\r\n}\r\n\r\n.resize-grip:hover {\r\n  background-color: var(--dg-ui-resize-grip, #2196f3);\r\n}\r\n\r\n/* Custom tri-state checkbox (not native input) */\r\n.custom-checkbox {\r\n  width: 18px;\r\n  height: 18px;\r\n  border: 2px solid var(--dg-header-checkbox-border, var(--dg-header-fg, #212529));\r\n  border-radius: 3px;\r\n  cursor: pointer;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: var(--dg-header-checkbox-bg, white);\r\n  transition: all 0.15s ease;\r\n  user-select: none;\r\n}\r\n\r\n.custom-checkbox:hover {\r\n  border-color: var(--dg-header-checkbox-border-hover, var(--dg-header-fg, #212529));\r\n}\r\n\r\n/* State: none (empty checkbox) */\r\n.custom-checkbox.checkbox-none {\r\n  background-color: var(--dg-header-checkbox-bg, white) !important;\r\n}\r\n\r\n/* State: some (indeterminate - dash) */\r\n.custom-checkbox.checkbox-some {\r\n  background-color: var(--dg-header-checkbox-bg, white) !important;\r\n  border-color: var(--dg-header-checkbox-border-checked, var(--dg-header-fg, #212529));\r\n}\r\n\r\n/* State: all (checked - checkmark) */\r\n.custom-checkbox.checkbox-all {\r\n  background-color: var(--dg-header-checkbox-bg, white) !important;\r\n  border-color: var(--dg-header-checkbox-border-checked, var(--dg-header-fg, #212529));\r\n}\r\n\r\n/* Icon inside checkbox (checkmark or dash) */\r\n.checkbox-icon {\r\n  color: var(--dg-header-checkbox-icon, var(--dg-header-fg, #212529));\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  line-height: 1;\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    ref=\"cellRef\"\r\n    class=\"grid-cell\"\r\n    :class=\"cellClasses\"\r\n    :style=\"cellStyle\"\r\n    @mousedown=\"handleMouseDown\"\r\n    @mouseenter=\"handleMouseEnter\"\r\n    @mouseleave=\"handleMouseLeave\"\r\n    @dblclick=\"handleDoubleClick\"\r\n    @keydown=\"handleCellKeyDown\"\r\n    @contextmenu=\"handleContextMenu\"\r\n    tabindex=\"0\"\r\n  >\r\n    <!-- Display mode -->\r\n    <div v-if=\"!isEditing\" class=\"cell-text\" v-html=\"highlightedValue\"></div>\r\n\r\n    <!-- Edit mode -->\r\n    <textarea\r\n      v-else\r\n      ref=\"inputRef\"\r\n      v-model=\"editValue\"\r\n      class=\"cell-input\"\r\n      @input=\"handleInput\"\r\n      @blur=\"handleBlur\"\r\n      @keydown=\"handleKeyDown\"\r\n    ></textarea>\r\n\r\n    <!-- Validation error tooltip - Teleported to body to avoid overflow:hidden issues -->\r\n    <Teleport to=\"body\">\r\n      <div\r\n        v-if=\"validationError && (isHovered || isSelected) && tooltipPosition\"\r\n        class=\"validation-tooltip\"\r\n        :class=\"{\r\n          'validation-tooltip--error': validationError.severity === 'Error' || validationError.severity === 'Critical',\r\n          'validation-tooltip--warning': validationError.severity === 'Warning' || validationError.severity === 'Info'\r\n        }\"\r\n        :style=\"{\r\n          position: 'fixed',\r\n          left: tooltipPosition.left + 'px',\r\n          top: tooltipPosition.top + 'px'\r\n        }\"\r\n      >\r\n        {{ validationError.message }}\r\n      </div>\r\n    </Teleport>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, nextTick, inject } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport { useDataGridStore, type GridCell, type GridColumn } from '@/stores/dataGridStore'\r\nimport ContextMenu from '@imengyu/vue3-context-menu'\r\n\r\nconst props = defineProps<{\r\n  cell: GridCell\r\n  column: GridColumn\r\n  isSelected: boolean\r\n  gridId?: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  editComplete: [rowId: string, columnName: string, value: any]\r\n  cellInput: [rowId: string, columnName: string, value: any]\r\n  copy: []\r\n  cut: []\r\n  paste: []\r\n  delete: []\r\n  insertAbove: [rowId: string, count: number]\r\n  insertBelow: [rowId: string, count: number]\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId)\r\nconst { isAutoRowHeightEnabled } = storeToRefs(store)\r\n\r\n// Inject validation from parent DataGrid component\r\nconst validation = inject('validation', null) as ReturnType<typeof import('@/composables/useValidation').useValidation> | null\r\n// FIXED: Don't destructure getValidationErrors - access validationErrors directly to preserve reactivity\r\nconst validateCellThrottled = validation?.validateCellThrottled || (() => {})\r\nconst validationErrors = validation?.validationErrors || {}\r\n\r\nconst cellRef = ref<HTMLElement>()\r\nconst inputRef = ref<HTMLTextAreaElement>()\r\nconst isEditing = ref(false)\r\nconst editValue = ref(props.cell.value)\r\nconst originalValue = ref<any>(null)  // Store original value before editing for cancel support\r\nconst isHovered = ref(false)  // Track hover state for validation tooltip\r\nconst tooltipPosition = ref<{ left: number; top: number } | null>(null)  // Tooltip position for Teleport\r\nconst isConfirming = ref(false)  // Track if we're in the process of confirming edit (prevents handleBlur race condition)\r\n\r\nconst displayValue = computed(() => {\r\n  if (props.cell.value == null) return ''\r\n  return String(props.cell.value)\r\n})\r\n\r\n// Check if cell value contains newlines (from Shift+Enter)\r\nconst hasNewlines = computed(() => {\r\n  return displayValue.value.includes('\\n')\r\n})\r\n\r\n// Highlighted value with search matches\r\nconst highlightedValue = computed(() => {\r\n  const text = displayValue.value\r\n  const searchQuery = store.searchQuery\r\n\r\n  if (!searchQuery || !text) {\r\n    return escapeHtml(text)\r\n  }\r\n\r\n  try {\r\n    // Escape special regex characters from search query for safety\r\n    const escapedQuery = searchQuery.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\r\n    const regex = new RegExp(`(${escapedQuery})`, 'gi')\r\n\r\n    return escapeHtml(text).replace(\r\n      regex,\r\n      '<mark class=\"search-highlight\">$1</mark>'\r\n    )\r\n  } catch (error) {\r\n    // If regex fails, return plain text\r\n    return escapeHtml(text)\r\n  }\r\n})\r\n\r\n// Escape HTML to prevent XSS\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div')\r\n  div.textContent = text\r\n  return div.innerHTML\r\n}\r\n\r\n// Check for validation errors - access validationErrors directly for reactivity\r\nconst validationError = computed(() => {\r\n  const errors = validationErrors[props.cell.rowId] || []\r\n  return errors.find((e: any) => e.columnName === props.cell.columnName)\r\n})\r\n\r\nconst cellClasses = computed(() => {\r\n  return {\r\n    'cell--selected': props.isSelected,\r\n    'cell--editing': isEditing.value,\r\n    'cell--validation-error': validationError.value?.severity === 'Error' || validationError.value?.severity === 'Critical',\r\n    'cell--validation-warning': validationError.value?.severity === 'Warning' || validationError.value?.severity === 'Info',\r\n    'cell--readonly': props.column.isReadOnly,\r\n    'cell--auto-height': isAutoRowHeightEnabled.value,\r\n    // Special case: has newlines but AutoRowHeight is OFF - still wrap by newlines only\r\n    'cell--has-newlines': hasNewlines.value && !isAutoRowHeightEnabled.value\r\n  }\r\n})\r\n\r\nconst cellStyle = computed(() => {\r\n  // CSS Grid handles column widths via grid-template-columns\r\n  // No need for flexbox properties (flexGrow, flexShrink, flexBasis)\r\n  return {}\r\n})\r\n\r\nfunction handleMouseDown(event: MouseEvent) {\r\n  // Only handle left mouse button\r\n  if (event.button !== 0) return\r\n\r\n  const isCtrlPressed = event.ctrlKey\r\n\r\n  console.log('[DataGridCell] MouseDown:', { rowId: props.cell.rowId, columnName: props.cell.columnName, isEditing: isEditing.value })\r\n\r\n  // Call store's selectCell method\r\n  store.selectCell(props.cell.rowId, props.cell.columnName, isCtrlPressed)\r\n}\r\n\r\nfunction handleMouseEnter(event: MouseEvent) {\r\n  // Track hover state for validation tooltip\r\n  isHovered.value = true\r\n\r\n  // Calculate tooltip position (above the cell)\r\n  if (cellRef.value) {\r\n    const rect = cellRef.value.getBoundingClientRect()\r\n    tooltipPosition.value = {\r\n      left: rect.left,\r\n      top: rect.top - 4  // 4px above the cell\r\n    }\r\n  }\r\n\r\n  // Block drag selection if Ctrl is currently pressed (real-time check)\r\n  // This matches the original WinUI component behavior\r\n  if (event.ctrlKey || store.wasCtrlPressed) {\r\n    return\r\n  }\r\n\r\n  // Check if left button is still pressed (dragging)\r\n  const isLeftButtonPressed = event.buttons === 1\r\n\r\n  // If we have a pressed cell and left button is still pressed\r\n  if (store.pressedCell && !store.isDragging && isLeftButtonPressed) {\r\n    // Check if entering the SAME cell - ignore to prevent premature drag\r\n    if (\r\n      props.cell.rowId === store.pressedCell.rowId &&\r\n      props.cell.columnName === store.pressedCell.columnName\r\n    ) {\r\n      return\r\n    }\r\n\r\n    // Different cell - start drag selection\r\n    store.startDragSelection(props.cell.rowId, props.cell.columnName)\r\n  } else if (store.isDragging && isLeftButtonPressed) {\r\n    // Already dragging - expand selection\r\n    store.expandDragSelection(props.cell.rowId, props.cell.columnName)\r\n  }\r\n}\r\n\r\nfunction handleMouseLeave() {\r\n  // Clear hover state for validation tooltip\r\n  isHovered.value = false\r\n  tooltipPosition.value = null\r\n}\r\n\r\nfunction handleCellKeyDown(event: KeyboardEvent) {\r\n  // When cell is selected but NOT editing, Enter key enters edit mode\r\n  if (!isEditing.value && props.isSelected && event.key === 'Enter' && !props.column.isReadOnly) {\r\n    event.preventDefault()\r\n    enterEditMode()\r\n  }\r\n}\r\n\r\nasync function enterEditMode() {\r\n  if (props.column.isReadOnly) return\r\n\r\n  console.log('[DataGridCell] enterEditMode:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    currentCellValue: props.cell.value,\r\n    storingAsOriginal: props.cell.value\r\n  })\r\n\r\n  // CRITICAL FIX: Store original value BEFORE editing starts\r\n  originalValue.value = props.cell.value\r\n\r\n  isEditing.value = true\r\n  editValue.value = props.cell.value\r\n\r\n  await nextTick()\r\n  inputRef.value?.focus()\r\n  inputRef.value?.select()\r\n}\r\n\r\nasync function handleDoubleClick() {\r\n  console.log('[DataGridCell] handleDoubleClick:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    currentValue: props.cell.value\r\n  })\r\n  enterEditMode()\r\n}\r\n\r\n// Get all cells from the current row (for empty row check)\r\nfunction getRowCells() {\r\n  const row = store.rows.find(r => r.rowId === props.cell.rowId)\r\n  if (!row) return undefined\r\n\r\n  // Return array of { columnName, value } for all cells\r\n  return row.cells.map(c => ({ columnName: c.columnName, value: c.value }))\r\n}\r\n\r\nfunction handleInput() {\r\n  console.log('[DataGridCell] handleInput:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    newValue: editValue.value,\r\n    autoValidate: store.config.autoValidate\r\n  })\r\n\r\n  // Throttled validation (300ms) with row cells for empty check - only if autoValidate is enabled\r\n  if (store.config.autoValidate && store.config.enableValidation) {\r\n    const rowCells = getRowCells()\r\n    validateCellThrottled(props.cell.rowId, props.cell.columnName, editValue.value, rowCells)\r\n  }\r\n\r\n  // Emit input event for AutoRowHeight real-time adjustment\r\n  emit('cellInput', props.cell.rowId, props.cell.columnName, editValue.value)\r\n}\r\n\r\nfunction confirmEdit() {\r\n  console.log('[DataGridCell] confirmEdit:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    confirmedValue: editValue.value,\r\n    originalWas: originalValue.value\r\n  })\r\n\r\n  // CRITICAL FIX: Set flag to prevent handleBlur from canceling during confirm\r\n  isConfirming.value = true\r\n\r\n  // Re-validate immediately before confirming (ensures empty values are properly validated) - only if autoValidate is enabled\r\n  if (store.config.autoValidate && store.config.enableValidation) {\r\n    const rowCells = getRowCells()\r\n    validateCellThrottled(props.cell.rowId, props.cell.columnName, editValue.value, rowCells)\r\n  }\r\n\r\n  // Always commit edit, even if there's a validation error\r\n  // Validation errors will be shown but won't block input\r\n  emit('editComplete', props.cell.rowId, props.cell.columnName, editValue.value)\r\n  isEditing.value = false\r\n\r\n  // Clear stored original value after successful commit\r\n  originalValue.value = null\r\n\r\n  // Restore focus to the cell so pressing Enter again will re-enter edit mode\r\n  nextTick(() => {\r\n    try {\r\n      console.log(`[DataGridCell] confirmEdit - Attempting to restore focus to cell: rowId=${props.cell.rowId}, column=${props.cell.columnName}`)\r\n      if (cellRef.value) {\r\n        cellRef.value.focus()\r\n        console.log('[DataGridCell] confirmEdit - Focus restored successfully')\r\n      } else {\r\n        console.log('[DataGridCell] confirmEdit - WARNING: cellRef.value is null/undefined')\r\n      }\r\n    } catch (error) {\r\n      console.log(`[DataGridCell] confirmEdit - ERROR restoring focus: ${error}`)\r\n    }\r\n  })\r\n\r\n  // Reset confirming flag after a delay to ensure blur doesn't cancel\r\n  setTimeout(() => {\r\n    isConfirming.value = false\r\n  }, 100)\r\n}\r\n\r\nfunction handleKeyDown(event: KeyboardEvent) {\r\n  console.log('[DataGridCell] handleKeyDown:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    key: event.key,\r\n    shift: event.shiftKey,\r\n    ctrl: event.ctrlKey\r\n  })\r\n\r\n  // ESC = cancel edit and restore original value\r\n  if (event.key === 'Escape') {\r\n    event.preventDefault()\r\n    event.stopPropagation()  // CRITICAL FIX: Prevent event from bubbling to parent div\r\n    cancelEdit()\r\n    return\r\n  }\r\n\r\n  // Enter without Shift = confirm edit\r\n  if (event.key === 'Enter' && !event.shiftKey) {\r\n    event.preventDefault()\r\n    event.stopPropagation()  // CRITICAL FIX: Prevent event from bubbling to parent div handleCellKeyDown\r\n    confirmEdit()\r\n    return\r\n  }\r\n\r\n  // Shift+Enter = new line (default textarea behavior, just allow it)\r\n  // Tab = insert tab character (prevent default tab navigation)\r\n  if (event.key === 'Tab') {\r\n    event.preventDefault()\r\n    const target = event.target as HTMLTextAreaElement\r\n    const start = target.selectionStart\r\n    const end = target.selectionEnd\r\n\r\n    // Insert tab character at cursor position\r\n    editValue.value = editValue.value.substring(0, start) + '\\t' + editValue.value.substring(end)\r\n\r\n    // Move cursor after the tab\r\n    nextTick(() => {\r\n      target.selectionStart = target.selectionEnd = start + 1\r\n    })\r\n  }\r\n}\r\n\r\nfunction cancelEdit() {\r\n  console.log('[DataGridCell] cancelEdit:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    originalValue: originalValue.value,\r\n    currentEditValue: editValue.value\r\n  })\r\n\r\n  // CRITICAL FIX: Restore original value from BEFORE editing started\r\n  editValue.value = originalValue.value\r\n  isEditing.value = false\r\n\r\n  // CRITICAL FIX: Emit editComplete with original value to restore it in the store\r\n  emit('editComplete', props.cell.rowId, props.cell.columnName, originalValue.value)\r\n\r\n  // Re-validate with original value - only if autoValidate is enabled\r\n  if (store.config.autoValidate && store.config.enableValidation) {\r\n    const rowCells = getRowCells()\r\n    validateCellThrottled(props.cell.rowId, props.cell.columnName, originalValue.value, rowCells)\r\n  }\r\n\r\n  // Clear stored original value\r\n  originalValue.value = null\r\n\r\n  // Restore focus to the cell so pressing Enter again will re-enter edit mode\r\n  nextTick(() => {\r\n    try {\r\n      console.log(`[DataGridCell] cancelEdit - Attempting to restore focus to cell: rowId=${props.cell.rowId}, column=${props.cell.columnName}`)\r\n      if (cellRef.value) {\r\n        cellRef.value.focus()\r\n        console.log('[DataGridCell] cancelEdit - Focus restored successfully')\r\n      } else {\r\n        console.log('[DataGridCell] cancelEdit - WARNING: cellRef.value is null/undefined')\r\n      }\r\n    } catch (error) {\r\n      console.log(`[DataGridCell] cancelEdit - ERROR restoring focus: ${error}`)\r\n    }\r\n  })\r\n}\r\n\r\nfunction handleBlur() {\r\n  console.log('[DataGridCell] handleBlur:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    isEditing: isEditing.value,\r\n    isConfirming: isConfirming.value\r\n  })\r\n\r\n  // CRITICAL FIX: Don't cancel if we're in the process of confirming (prevents race condition)\r\n  // Cancel edit immediately on blur (clicking away or focus loss) ONLY if not confirming\r\n  if (isEditing.value && !isConfirming.value) {\r\n    cancelEdit()\r\n  }\r\n}\r\n\r\nfunction handleContextMenu(event: MouseEvent) {\r\n  // Only show context menu with Ctrl key pressed\r\n  if (!event.ctrlKey) {\r\n    return\r\n  }\r\n\r\n  event.preventDefault()\r\n\r\n  // Calculate selected row IDs and indices (like original component)\r\n  const selectedRowData = new Map<string, number>() // rowId -> rowIndex\r\n  store.selectedCells.forEach(cellKey => {\r\n    const [rowId] = cellKey.split(':')\r\n    const row = store.rows.find(r => r.rowId === rowId)\r\n    if (row) {\r\n      selectedRowData.set(rowId, row.rowIndex)\r\n    }\r\n  })\r\n\r\n  const selectedRowCount = selectedRowData.size\r\n  const selectedRowIndices = Array.from(selectedRowData.values())\r\n\r\n  // Find min/max row indices (like original WinUI component)\r\n  const minRowIndex = selectedRowIndices.length > 0 ? Math.min(...selectedRowIndices) : 0\r\n  const maxRowIndex = selectedRowIndices.length > 0 ? Math.max(...selectedRowIndices) : 0\r\n\r\n  // Get rowId for min/max indices\r\n  const minRow = store.rows.find(r => r.rowIndex === minRowIndex)\r\n  const maxRow = store.rows.find(r => r.rowIndex === maxRowIndex)\r\n\r\n  ContextMenu.showContextMenu({\r\n    x: event.x,\r\n    y: event.y,\r\n    items: [\r\n      {\r\n        label: 'Copy',\r\n        icon: '',\r\n        onClick: () => emit('copy'),\r\n        disabled: !props.isSelected\r\n      },\r\n      {\r\n        label: 'Cut',\r\n        icon: '',\r\n        onClick: () => emit('cut'),\r\n        disabled: !props.isSelected || props.column.isReadOnly\r\n      },\r\n      {\r\n        label: 'Paste',\r\n        icon: '',\r\n        onClick: () => emit('paste'),\r\n        disabled: props.column.isReadOnly\r\n      },\r\n      { divided: true },\r\n      {\r\n        label: 'Delete',\r\n        icon: '',\r\n        onClick: () => emit('delete'),\r\n        disabled: !props.isSelected || props.column.isReadOnly\r\n      },\r\n      { divided: true },\r\n      {\r\n        label: `Insert ${selectedRowCount} row(s) above`,\r\n        icon: '',\r\n        // Insert above the MINIMUM selected row index\r\n        onClick: () => emit('insertAbove', minRow?.rowId || props.cell.rowId, selectedRowCount || 1),\r\n        disabled: props.column.isReadOnly\r\n      },\r\n      {\r\n        label: `Insert ${selectedRowCount} row(s) below`,\r\n        icon: '',\r\n        // Insert below the MAXIMUM selected row index\r\n        onClick: () => emit('insertBelow', maxRow?.rowId || props.cell.rowId, selectedRowCount || 1),\r\n        disabled: props.column.isReadOnly\r\n      }\r\n    ]\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grid-cell {\r\n  position: relative;\r\n  padding: 5px 8px;  /* Increased from 4px to 5px for better spacing */\r\n  border-right: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  display: flex; /* Flex for internal content layout only */\r\n  align-items: flex-start;\r\n  background-color: var(--dg-cell-bg, #ffffff);\r\n  color: var(--dg-cell-fg, #212529);\r\n  font-size: 14px;  /* CRITICAL: Must match useAutoRowHeight config.fontSize */\r\n  height: 100%;\r\n  min-height: 100%;\r\n  box-sizing: border-box;\r\n  overflow: hidden; /* Prevent content from breaking grid layout */\r\n  /* Prevent browser text selection during drag selection */\r\n  user-select: none;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n}\r\n\r\n.grid-cell:hover {\r\n  background-color: var(--dg-cell-hover-bg, #f8f9fa);\r\n  color: var(--dg-cell-hover-fg, #212529);\r\n}\r\n\r\n.cell--selected {\r\n  /* Selection only changes background, not border - border is preserved from validation/other states */\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb);  /* More prominent blue (was #e3f2fd) */\r\n  color: var(--dg-cell-focused-fg, #0d6efd);\r\n  /* No border - let other states (validation, etc.) control border/outline */\r\n}\r\n\r\n/* Prevent hover from removing selection background */\r\n.cell--selected:hover {\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb);  /* Keep selection background on hover */\r\n  color: var(--dg-cell-focused-fg, #0d6efd);\r\n}\r\n\r\n.cell--editing {\r\n  padding: 0;\r\n}\r\n\r\n.cell--validation-error {\r\n  /* Use OUTLINE instead of BORDER to prevent layout shift (outline doesn't affect box model) */\r\n  outline: 2px solid var(--dg-validation-error-border, #ff4444);\r\n  outline-offset: -2px; /* Draw outline inside the cell */\r\n  background-color: var(--dg-validation-error-bg, #ffebee);\r\n  color: var(--dg-validation-error-fg, #c62828);\r\n  border: none;\r\n}\r\n\r\n.cell--validation-warning {\r\n  /* Use OUTLINE instead of BORDER to prevent layout shift (outline doesn't affect box model) */\r\n  /* DEFAULT: Red border same as error (user requested unified color) */\r\n  outline: 2px solid var(--dg-validation-warning-border, #ff4444);\r\n  outline-offset: -2px; /* Draw outline inside the cell */\r\n  /* DEFAULT: Red background same as error (user requested unified color) */\r\n  background-color: var(--dg-validation-warning-bg, #ffebee);\r\n  color: var(--dg-validation-warning-fg, #c62828);\r\n  border: none;\r\n}\r\n\r\n/* CRITICAL: When cell is BOTH selected AND has validation error, selection background overrides validation background */\r\n/* This makes selection visible on validation cells while keeping the red outline */\r\n.cell--selected.cell--validation-error,\r\n.cell--selected.cell--validation-warning {\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb) !important;  /* More prominent blue */\r\n  /* Keep validation outline and color */\r\n}\r\n\r\n/* Prevent hover from removing selection background on validation cells */\r\n.cell--selected.cell--validation-error:hover,\r\n.cell--selected.cell--validation-warning:hover {\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb) !important;  /* Keep selection background on hover */\r\n}\r\n\r\n.cell--readonly {\r\n  background-color: var(--dg-cell-readonly-bg, #f5f5f5);\r\n  color: var(--dg-cell-readonly-fg, #495057);\r\n  cursor: not-allowed;\r\n}\r\n\r\n.cell-text {\r\n  flex: 1;\r\n  min-width: 0; /* CRITICAL: Allow flex item to shrink below content size for text wrapping */\r\n  line-height: 1.5;\r\n  /* Default: no wrapping, overflow hidden (when AutoRowHeight is OFF) */\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  /* Prevent browser text selection */\r\n  user-select: none;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n}\r\n\r\n/* When AutoRowHeight is enabled, allow text wrapping */\r\n.cell--auto-height .cell-text {\r\n  white-space: pre-wrap !important;\r\n  word-wrap: break-word !important;\r\n  overflow-wrap: break-word !important;\r\n  overflow: visible !important;\r\n  text-overflow: clip !important;\r\n}\r\n\r\n/* When cell has newlines but AutoRowHeight is OFF - wrap ONLY at \\n, not at spaces */\r\n.cell--has-newlines .cell-text {\r\n  white-space: pre !important;\r\n  overflow: visible !important;\r\n  text-overflow: clip !important;\r\n}\r\n\r\n.cell-input {\r\n  width: 100%;\r\n  height: 100%;\r\n  border: none;\r\n  outline: none;\r\n  padding: 4px 8px;\r\n  font-family: inherit;\r\n  font-size: inherit;\r\n  background-color: var(--dg-cell-focused-bg, #e3f2fd);\r\n  color: var(--dg-cell-focused-fg, #0d6efd);\r\n  resize: none;\r\n  /* Hide overflow so row expands instead of showing scrollbars */\r\n  overflow: hidden;\r\n  overflow-x: hidden;\r\n  overflow-y: hidden;\r\n  /* CRITICAL: Enable text wrapping */\r\n  white-space: pre-wrap;\r\n  word-wrap: break-word;\r\n  overflow-wrap: break-word;\r\n  /* Remove scrollbars completely - all browsers */\r\n  scrollbar-width: none; /* Firefox */\r\n  -ms-overflow-style: none; /* IE/Edge */\r\n  /* Remove native appearance */\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n  appearance: none;\r\n}\r\n\r\n/* Hide scrollbars for webkit browsers */\r\n.cell-input::-webkit-scrollbar {\r\n  display: none !important;\r\n  width: 0 !important;\r\n  height: 0 !important;\r\n}\r\n\r\n/* Remove any browser-specific controls */\r\n.cell-input::-webkit-resizer,\r\n.cell-input::-webkit-scrollbar-corner,\r\n.cell-input::-webkit-scrollbar-track,\r\n.cell-input::-webkit-scrollbar-thumb,\r\n.cell-input::-webkit-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n/* Remove Mozilla scrollbar buttons */\r\n.cell-input::-moz-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n.validation-tooltip {\r\n  /* position: fixed is set inline via :style */\r\n  color: white;\r\n  padding: 4px 8px;\r\n  border-radius: 4px;\r\n  font-size: 12px;\r\n  white-space: nowrap;\r\n  z-index: 10000;  /* Very high z-index since it's in body */\r\n  pointer-events: none;\r\n  max-width: 300px;\r\n  white-space: normal;\r\n  transform: translateY(-100%);  /* Position above the calculated point */\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);  /* Add shadow for visibility */\r\n}\r\n\r\n.validation-tooltip--error {\r\n  background: var(--dg-validation-error-fg, #ff4444);\r\n}\r\n\r\n.validation-tooltip--warning {\r\n  background: var(--dg-validation-warning-fg, #ff9800);\r\n}\r\n\r\n/* Search highlighting */\r\n:deep(.search-highlight) {\r\n  background-color: var(--dg-search-highlight-bg, #ffeb3b);\r\n  color: var(--dg-search-highlight-fg, #000);\r\n  font-weight: 500;\r\n  padding: 0 2px;\r\n  border-radius: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    class=\"special-cell\"\r\n    :class=\"specialCellClasses\"\r\n    :style=\"cellStyle\"\r\n    @mousedown.stop\r\n    @mouseenter.stop\r\n  >\r\n    <!-- Row Number Column -->\r\n    <span v-if=\"specialType === 'RowNumber'\" class=\"row-number\">\r\n      {{ rowNumber }}\r\n    </span>\r\n\r\n    <!-- Checkbox Column -->\r\n    <input\r\n      v-else-if=\"specialType === 'Checkbox'\"\r\n      type=\"checkbox\"\r\n      class=\"checkbox-input\"\r\n      :checked=\"isChecked\"\r\n      @change=\"handleCheckboxChange\"\r\n    />\r\n\r\n    <!-- Validation Alerts Column -->\r\n    <div\r\n      v-else-if=\"specialType === 'ValidationAlerts'\"\r\n      class=\"validation-alerts\"\r\n      :class=\"{ 'has-errors': hasValidationErrors || hasValidationWarnings }\"\r\n      :title=\"validationMessage\"\r\n    >\r\n      <span class=\"validation-message\">\r\n        {{ validationMessage }}\r\n      </span>\r\n    </div>\r\n\r\n    <!-- Delete Row Button -->\r\n    <button\r\n      v-else-if=\"specialType === 'DeleteRow'\"\r\n      class=\"delete-button\"\r\n      :disabled=\"isDeleting\"\r\n      @click=\"handleDelete\"\r\n      title=\"Delete row\"\r\n    >\r\n      \r\n    </button>\r\n\r\n    <!-- Insert Row Button -->\r\n    <button\r\n      v-else-if=\"specialType === 'InsertRow'\"\r\n      class=\"insert-button\"\r\n      @click=\"handleInsert\"\r\n      title=\"Insert new row\"\r\n    >\r\n      \r\n    </button>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, inject, watch } from 'vue'\r\nimport type { GridColumn } from '@/stores/dataGridStore'\r\n\r\nexport type SpecialColumnType = 'RowNumber' | 'Checkbox' | 'ValidationAlerts' | 'DeleteRow' | 'InsertRow'\r\n\r\nconst props = defineProps<{\r\n  specialType: SpecialColumnType\r\n  rowId: string\r\n  rowIndex: number\r\n  column: GridColumn\r\n  isChecked?: boolean\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  checkboxChange: [rowId: string, checked: boolean]\r\n  deleteRow: [rowId: string]\r\n  insertRow: [afterRowId: string]\r\n}>()\r\n\r\n// Debug: Watch isChecked prop changes\r\nwatch(() => props.isChecked, (newVal, oldVal) => {\r\n  if (props.specialType === 'Checkbox') {\r\n    console.log('[SpecialColumnCell] isChecked prop changed:', { rowId: props.rowId, newVal, oldVal })\r\n  }\r\n}, { immediate: true })\r\n\r\n// Inject validation from parent DataGrid component\r\nconst validation = inject('validation', null) as ReturnType<typeof import('@/composables/useValidation').useValidation> | null\r\n// validationErrors is now reactive<Record<>> instead of ref<Map<>>\r\nconst validationErrors = validation?.validationErrors || {}\r\n\r\nconst isDeleting = ref(false)\r\nconst lastDeleteClick = ref(0)\r\nconst DELETE_DEBOUNCE_MS = 300\r\n\r\nconst rowNumber = computed(() => props.rowIndex + 1)\r\n\r\nconst validationErrorsForRow = computed(() => {\r\n  return validationErrors[props.rowId] || []\r\n})\r\n\r\nconst hasValidationErrors = computed(() => {\r\n  return validationErrorsForRow.value.some((e: any) => e.severity === 'Error' || e.severity === 'Critical')\r\n})\r\n\r\nconst hasValidationWarnings = computed(() => {\r\n  return validationErrorsForRow.value.some((e: any) => e.severity === 'Warning')\r\n})\r\n\r\n// Format validation messages like in original component: \"columnName: message; columnName2: message2\"\r\nconst validationMessage = computed(() => {\r\n  const allErrors = validationErrorsForRow.value\r\n  if (allErrors.length === 0) return ''\r\n\r\n  // Join all errors with semicolon (like original component)\r\n  return allErrors\r\n    .map((e: any) => `${e.columnName}: ${e.message}`)\r\n    .join('; ')\r\n})\r\n\r\nconst specialCellClasses = computed(() => ({\r\n  'special-cell--row-number': props.specialType === 'RowNumber',\r\n  'special-cell--checkbox': props.specialType === 'Checkbox',\r\n  'special-cell--validation': props.specialType === 'ValidationAlerts',\r\n  'special-cell--delete': props.specialType === 'DeleteRow',\r\n  'special-cell--insert': props.specialType === 'InsertRow',\r\n}))\r\n\r\nconst cellStyle = computed(() => {\r\n  // CSS Grid handles column widths via grid-template-columns\r\n  // No need for flexbox properties\r\n  return {}\r\n})\r\n\r\nfunction handleCheckboxChange(event: Event) {\r\n  const target = event.target as HTMLInputElement\r\n  console.log('[SpecialColumnCell] Checkbox change:', { rowId: props.rowId, checked: target.checked, currentProp: props.isChecked })\r\n  emit('checkboxChange', props.rowId, target.checked)\r\n}\r\n\r\nfunction handleDelete() {\r\n  // Debounce protection - prevent rapid clicks\r\n  const now = Date.now()\r\n  if (now - lastDeleteClick.value < DELETE_DEBOUNCE_MS) {\r\n    return\r\n  }\r\n  lastDeleteClick.value = now\r\n\r\n  if (confirm('Are you sure you want to delete this row?')) {\r\n    isDeleting.value = true\r\n    emit('deleteRow', props.rowId)\r\n\r\n    // Reset deleting state after 1 second\r\n    setTimeout(() => {\r\n      isDeleting.value = false\r\n    }, 1000)\r\n  }\r\n}\r\n\r\nfunction handleInsert() {\r\n  emit('insertRow', props.rowId)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.special-cell {\r\n  position: relative;\r\n  padding: 4px 8px;\r\n  border-right: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  display: flex;\r\n  align-items: flex-start; /* Changed from center to flex-start for multi-line content */\r\n  justify-content: center;\r\n  background-color: var(--dg-special-rownumber-bg, #f5f5f5);\r\n  height: 100%;\r\n  min-height: 100%;\r\n  width: 100%; /* CRITICAL: Fill grid track width */\r\n  max-width: 100%; /* CRITICAL: Never exceed grid track width */\r\n  box-sizing: border-box;\r\n  overflow: hidden; /* CRITICAL: Hide all overflow */\r\n  overflow-x: hidden !important; /* Prevent horizontal overflow */\r\n  overflow-y: hidden !important; /* Hide scrollbars */\r\n  /* Remove all scrollbars - all browsers */\r\n  scrollbar-width: none; /* Firefox */\r\n  -ms-overflow-style: none; /* IE/Edge */\r\n}\r\n\r\n/* Hide scrollbars for webkit browsers */\r\n.special-cell::-webkit-scrollbar {\r\n  display: none !important;\r\n  width: 0 !important;\r\n  height: 0 !important;\r\n}\r\n\r\n/* Remove all webkit scrollbar parts */\r\n.special-cell::-webkit-scrollbar-button,\r\n.special-cell::-webkit-scrollbar-track,\r\n.special-cell::-webkit-scrollbar-thumb,\r\n.special-cell::-webkit-scrollbar-corner {\r\n  display: none !important;\r\n}\r\n\r\n/* Remove Mozilla scrollbar buttons */\r\n.special-cell::-moz-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n.special-cell--row-number {\r\n  color: var(--dg-special-rownumber-fg, #666);\r\n  font-weight: 500;\r\n  user-select: none;\r\n}\r\n\r\n.special-cell--checkbox {\r\n  cursor: pointer;\r\n  background-color: var(--dg-special-checkbox-bg, #ffffff);\r\n}\r\n\r\n.checkbox-input {\r\n  cursor: pointer;\r\n  width: 16px;\r\n  height: 16px;\r\n  border: 1px solid var(--dg-special-checkbox-border, #ced4da);\r\n}\r\n\r\n.special-cell--validation {\r\n  padding: 0;\r\n}\r\n\r\n.validation-alerts {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  width: 100%;\r\n  max-width: 100%; /* CRITICAL: Never exceed parent width */\r\n  height: 100%;\r\n  padding: 4px 8px;\r\n  overflow: hidden; /* CRITICAL: Clip content that exceeds bounds */\r\n  box-sizing: border-box; /* Include padding in width calculation */\r\n}\r\n\r\n.validation-alerts.has-errors {\r\n  background-color: var(--dg-special-validation-error-bg, #ffebee);\r\n}\r\n\r\n.validation-message {\r\n  font-size: 11px;\r\n  color: var(--dg-special-validation-error-fg, #c62828);\r\n  /* CHANGED: Allow text wrapping instead of ellipsis for AutoRowHeight support */\r\n  white-space: pre-wrap; /* Wrap text and preserve spaces */\r\n  word-wrap: break-word; /* Break long words */\r\n  overflow-wrap: break-word; /* Modern CSS property for word breaking */\r\n  display: block;\r\n  width: 100%;\r\n  max-width: 100%; /* CRITICAL: Never exceed parent width */\r\n  min-width: 0; /* CRITICAL: Allow flex item to shrink below content size */\r\n  line-height: 1.5; /* Match DataGridCell line-height */\r\n  box-sizing: border-box;\r\n}\r\n\r\n.validation-icon {\r\n  font-size: 18px;\r\n  cursor: help;\r\n}\r\n\r\n.validation-icon.error {\r\n  color: var(--dg-validation-error-fg, #ff4444);\r\n}\r\n\r\n.validation-icon.warning {\r\n  color: var(--dg-validation-warning-fg, #ff9800);\r\n}\r\n\r\n.delete-button,\r\n.insert-button {\r\n  border: none;\r\n  background: var(--dg-special-delete-bg, transparent);\r\n  color: var(--dg-special-delete-fg, #dc3545);\r\n  font-size: 16px;\r\n  cursor: pointer;\r\n  padding: 2px 4px;\r\n  transition: transform 0.1s, background-color 0.1s;\r\n  /* Remove browser default styling and controls */\r\n  -webkit-appearance: none !important;\r\n  -moz-appearance: none !important;\r\n  appearance: none !important;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  user-select: none;\r\n  outline: none;\r\n  /* Remove all scrollbars and arrows */\r\n  overflow: hidden !important;\r\n  scrollbar-width: none;\r\n  -ms-overflow-style: none;\r\n}\r\n\r\n/* Remove webkit scrollbar and all related controls from buttons */\r\n.delete-button::-webkit-scrollbar,\r\n.insert-button::-webkit-scrollbar {\r\n  display: none !important;\r\n  width: 0 !important;\r\n  height: 0 !important;\r\n}\r\n\r\n.delete-button::-webkit-scrollbar-button,\r\n.delete-button::-webkit-scrollbar-track,\r\n.delete-button::-webkit-scrollbar-thumb,\r\n.delete-button::-webkit-scrollbar-corner,\r\n.insert-button::-webkit-scrollbar-button,\r\n.insert-button::-webkit-scrollbar-track,\r\n.insert-button::-webkit-scrollbar-thumb,\r\n.insert-button::-webkit-scrollbar-corner {\r\n  display: none !important;\r\n}\r\n\r\n/* Remove webkit number input spinners (just in case) */\r\n.delete-button::-webkit-outer-spin-button,\r\n.delete-button::-webkit-inner-spin-button,\r\n.insert-button::-webkit-outer-spin-button,\r\n.insert-button::-webkit-inner-spin-button {\r\n  -webkit-appearance: none !important;\r\n  margin: 0 !important;\r\n  display: none !important;\r\n}\r\n\r\n/* Remove Mozilla scrollbar buttons */\r\n.delete-button::-moz-scrollbar-button,\r\n.insert-button::-moz-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n.delete-button:hover:not(:disabled) {\r\n  transform: scale(1.2);\r\n  background-color: var(--dg-special-delete-hover-bg, #ffebee);\r\n}\r\n\r\n.delete-button:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.insert-button {\r\n  background: var(--dg-special-insert-bg, transparent);\r\n  color: var(--dg-special-insert-fg, #28a745);\r\n}\r\n\r\n.insert-button:hover {\r\n  transform: scale(1.2);\r\n  background-color: var(--dg-special-insert-hover-bg, #e8f5e9);\r\n  color: var(--dg-special-insert-hover-fg, #1b5e20);\r\n}\r\n\r\n.insert-button:active,\r\n.delete-button:active {\r\n  transform: scale(0.95);\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"grid-row\" :style=\"{ height: row.height + 'px', gridTemplateColumns }\">\r\n    <template v-for=\"column in columns\" :key=\"`${row.rowId}:${column.name}`\">\r\n      <!-- Special Column Cell -->\r\n      <SpecialColumnCell\r\n        v-if=\"column.specialType\"\r\n        :special-type=\"column.specialType\"\r\n        :row-id=\"row.rowId\"\r\n        :row-index=\"row.rowIndex\"\r\n        :column=\"column\"\r\n        :is-checked=\"column.specialType === 'Checkbox' ? isRowCheckedComputed : undefined\"\r\n        @checkbox-change=\"handleCheckboxChange\"\r\n        @delete-row=\"handleDeleteRow\"\r\n        @insert-row=\"handleInsertRow\"\r\n      />\r\n\r\n      <!-- Regular Data Cell -->\r\n      <DataGridCell\r\n        v-else\r\n        :cell=\"getCellForColumn(column.name)\"\r\n        :column=\"column\"\r\n        :is-selected=\"store.isCellSelected(row.rowId, column.name)\"\r\n        :grid-id=\"gridId\"\r\n        @edit-complete=\"handleEditComplete\"\r\n        @cell-input=\"handleCellInput\"\r\n        @insert-above=\"handleInsertAbove\"\r\n        @insert-below=\"handleInsertBelow\"\r\n      />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed } from 'vue'\r\nimport DataGridCell from './DataGridCell.vue'\r\nimport SpecialColumnCell from './SpecialColumnCell.vue'\r\nimport { useDataGridStore, type GridRow, type GridColumn, type GridCell } from '@/stores/dataGridStore'\r\n\r\nconst props = defineProps<{\r\n  row: GridRow\r\n  columns: GridColumn[]\r\n  gridTemplateColumns: string\r\n  gridId?: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  cellEditComplete: [rowId: string, columnName: string, value: any]\r\n  cellInput: [rowId: string, columnName: string, value: any]\r\n  checkboxChange: [rowId: string, checked: boolean]\r\n  deleteRow: [rowId: string]\r\n  insertRow: [afterRowId: string]\r\n  insertAbove: [rowId: string, count: number]\r\n  insertBelow: [rowId: string, count: number]\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId)\r\n\r\n// Log checkbox state for debugging\r\nconst isRowCheckedComputed = computed(() => {\r\n  const checked = store.isRowChecked(props.row.rowId)\r\n  console.log('[DataGridRow] Row checked state:', { rowId: props.row.rowId, checked })\r\n  return checked\r\n})\r\n\r\nfunction getCellForColumn(columnName: string): GridCell {\r\n  const cell = props.row.cells.find(c => c.columnName === columnName)\r\n\r\n  // If cell doesn't exist for this column, return a placeholder\r\n  if (!cell) {\r\n    return {\r\n      rowId: props.row.rowId,\r\n      columnName: columnName,\r\n      value: null,\r\n      isSelected: false,\r\n      isValidationError: false\r\n    }\r\n  }\r\n\r\n  return cell\r\n}\r\n\r\nfunction handleEditComplete(rowId: string, columnName: string, value: any) {\r\n  emit('cellEditComplete', rowId, columnName, value)\r\n}\r\n\r\nfunction handleCellInput(rowId: string, columnName: string, value: any) {\r\n  emit('cellInput', rowId, columnName, value)\r\n}\r\n\r\nfunction handleCheckboxChange(rowId: string, checked: boolean) {\r\n  emit('checkboxChange', rowId, checked)\r\n}\r\n\r\nfunction handleDeleteRow(rowId: string) {\r\n  emit('deleteRow', rowId)\r\n}\r\n\r\nfunction handleInsertRow(afterRowId: string) {\r\n  emit('insertRow', afterRowId)\r\n}\r\n\r\nfunction handleInsertAbove(rowId: string, count: number) {\r\n  emit('insertAbove', rowId, count)\r\n}\r\n\r\nfunction handleInsertBelow(rowId: string, count: number) {\r\n  emit('insertBelow', rowId, count)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grid-row {\r\n  display: grid; /* Changed from flex to grid for perfect column alignment */\r\n  /* grid-template-columns applied via inline style from parent */\r\n  border-bottom: 1px solid #e0e0e0;\r\n  width: 100%; /* CRITICAL: Always fill container width */\r\n  max-width: 100%; /* CRITICAL: Never exceed container width */\r\n  /* REMOVED min-width: fit-content - this was causing each row to calculate 1fr differently! */\r\n  /* All rows MUST have identical width for 1fr to resolve to same pixels */\r\n}\r\n\r\n.grid-row:hover {\r\n  background-color: #fafafa;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"pagination\">\r\n    <button @click=\"emit('pageChange', 1)\" :disabled=\"currentPage === 1\">\r\n      First\r\n    </button>\r\n    <button @click=\"emit('pageChange', currentPage - 1)\" :disabled=\"currentPage === 1\">\r\n      Previous\r\n    </button>\r\n\r\n    <!-- Individual page number buttons -->\r\n    <div class=\"page-numbers\">\r\n      <button\r\n        v-for=\"page in visiblePages\"\r\n        :key=\"page\"\r\n        :class=\"{ 'page-number': true, 'active': page === currentPage }\"\r\n        @click=\"emit('pageChange', page)\"\r\n      >\r\n        {{ page }}\r\n      </button>\r\n    </div>\r\n\r\n    <button @click=\"emit('pageChange', currentPage + 1)\" :disabled=\"currentPage === totalPages\">\r\n      Next\r\n    </button>\r\n    <button @click=\"emit('pageChange', totalPages)\" :disabled=\"currentPage === totalPages\">\r\n      Last\r\n    </button>\r\n\r\n    <span class=\"page-info\">\r\n      ({{ totalRows }} rows)\r\n    </span>\r\n\r\n    <select :value=\"pageSize\" @change=\"handlePageSizeChange\">\r\n      <option v-for=\"size in sortedPageSizeOptions\" :key=\"size\" :value=\"size\">{{ size }}</option>\r\n    </select>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed } from 'vue'\r\n\r\nconst props = withDefaults(defineProps<{\r\n  currentPage: number\r\n  pageSize: number\r\n  totalRows: number\r\n  pageSizeOptions?: number[]\r\n}>(), {\r\n  pageSizeOptions: () => [50, 100, 200, 500]\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  pageChange: [page: number]\r\n  pageSizeChange: [size: number]\r\n}>()\r\n\r\n// Sort options from smallest to largest for display\r\n// If current pageSize is not in the options, include it (but only while it's the current value)\r\nconst sortedPageSizeOptions = computed(() => {\r\n  const options = [...props.pageSizeOptions]\r\n\r\n  // Add current pageSize if not in options (will be removed from list once user changes to another value)\r\n  if (!options.includes(props.pageSize)) {\r\n    options.push(props.pageSize)\r\n  }\r\n\r\n  return options.sort((a, b) => a - b)\r\n})\r\n\r\nconst totalPages = computed(() => Math.ceil(props.totalRows / props.pageSize))\r\n\r\n// Generate visible page numbers - intelligently distribute max 20 pages across range\r\n// If total <= 20: show all pages (1 2 3 4 ... 20)\r\n// If total > 20: distribute evenly (1 6 11 16 21 26 ... 96)\r\n// Always include: first, last, and current page\r\nconst visiblePages = computed(() => {\r\n  const total = totalPages.value\r\n  const current = props.currentPage\r\n  const maxVisible = 20\r\n\r\n  if (total <= maxVisible) {\r\n    // Show all pages if 20 or fewer\r\n    const pages: number[] = []\r\n    for (let i = 1; i <= total; i++) {\r\n      pages.push(i)\r\n    }\r\n    return pages\r\n  }\r\n\r\n  // Calculate step size to show ~20 pages distributed across range\r\n  const step = Math.ceil(total / maxVisible)\r\n  const pages = new Set<number>()\r\n\r\n  // Always add first and last page\r\n  pages.add(1)\r\n  pages.add(total)\r\n\r\n  // Always add current page and neighbors\r\n  pages.add(current)\r\n  if (current > 1) pages.add(current - 1)\r\n  if (current < total) pages.add(current + 1)\r\n\r\n  // Add evenly distributed pages\r\n  for (let i = 1; i <= total; i += step) {\r\n    pages.add(i)\r\n  }\r\n\r\n  // Convert to sorted array\r\n  return Array.from(pages).sort((a, b) => a - b)\r\n})\r\n\r\nfunction handlePageSizeChange(event: Event) {\r\n  const target = event.target as HTMLSelectElement\r\n  emit('pageSizeChange', Number(target.value))\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.pagination {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 12px;\r\n  background-color: var(--dg-ui-pagination-bg, #f5f5f5);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n  border-top: 1px solid var(--dg-ui-pagination-border, #ccc);\r\n}\r\n\r\nbutton {\r\n  padding: 6px 12px;\r\n  background-color: var(--dg-header-sort-indicator, #2196f3);\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\nbutton:hover:not(:disabled) {\r\n  background-color: var(--dg-ui-pagination-button-hover-bg, #1976d2);\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: var(--dg-cell-disabled-bg, #ccc);\r\n  color: var(--dg-cell-disabled-fg, #6c757d);\r\n  cursor: not-allowed;\r\n}\r\n\r\n.page-numbers {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  overflow-x: auto; /* Allow horizontal scroll if many pages */\r\n  max-width: 600px; /* Limit width, will scroll if more pages */\r\n  padding: 2px 0; /* Padding for scrollbar */\r\n}\r\n\r\n.page-number {\r\n  min-width: 36px;\r\n  padding: 6px 8px;\r\n  background-color: var(--dg-ui-pagination-bg, #ffffff);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n  border: 1px solid var(--dg-ui-pagination-border, #ccc);\r\n  border-radius: 4px;\r\n}\r\n\r\n.page-number:hover:not(:disabled):not(.active) {\r\n  background-color: var(--dg-ui-pagination-button-hover-bg, #e3f2fd);\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.page-number.active {\r\n  background-color: var(--dg-header-sort-indicator, #2196f3);\r\n  color: white;\r\n  font-weight: bold;\r\n  border-color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.page-info {\r\n  margin: 0 8px;\r\n  font-size: 14px;\r\n  color: var(--dg-ui-pagination-fg, #666);\r\n}\r\n\r\nselect {\r\n  padding: 6px 8px;\r\n  border: 1px solid var(--dg-ui-pagination-border, #ccc);\r\n  background-color: var(--dg-ui-pagination-bg, #ffffff);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n}\r\n</style>\r\n","<template>\r\n  <teleport to=\"body\">\r\n    <div v-if=\"visible\" class=\"filter-flyout-overlay\" @click.self=\"handleClose\">\r\n      <div class=\"filter-flyout\" :style=\"{ top: position.y + 'px', left: position.x + 'px' }\">\r\n        <!-- Header -->\r\n        <div class=\"filter-header\">\r\n          <h3 class=\"filter-title\">Filter: {{ columnName }}</h3>\r\n          <button class=\"close-button\" @click=\"handleClose\"></button>\r\n        </div>\r\n\r\n        <!-- Mode selector -->\r\n        <div class=\"filter-mode\">\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              :value=\"'checkbox'\"\r\n              v-model=\"filterMode\"\r\n              name=\"filterMode\"\r\n            />\r\n            <span>Checkbox</span>\r\n          </label>\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              :value=\"'regex'\"\r\n              v-model=\"filterMode\"\r\n              name=\"filterMode\"\r\n            />\r\n            <span>Regex</span>\r\n          </label>\r\n        </div>\r\n\r\n        <!-- Checkbox mode content -->\r\n        <div v-if=\"filterMode === 'checkbox'\" class=\"filter-content\">\r\n          <!-- Search box for filtering values -->\r\n          <input\r\n            v-model=\"searchText\"\r\n            type=\"text\"\r\n            class=\"filter-search\"\r\n            placeholder=\"Search values...\"\r\n          />\r\n\r\n          <!-- Select All / Deselect All buttons -->\r\n          <div class=\"filter-actions\">\r\n            <button class=\"action-button\" @click=\"selectAll\">Select All</button>\r\n            <button class=\"action-button\" @click=\"deselectAll\">Deselect All</button>\r\n          </div>\r\n\r\n          <!-- Values list with checkboxes -->\r\n          <div class=\"filter-values\">\r\n            <label\r\n              v-for=\"item in filteredValues\"\r\n              :key=\"item.value\"\r\n              class=\"value-item\"\r\n              :class=\"{ 'value-item--selected': item.isSelected }\"\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                v-model=\"item.isSelected\"\r\n                class=\"value-checkbox\"\r\n              />\r\n              <span class=\"value-text\">{{ item.displayText || displayText(item) }}</span>\r\n            </label>\r\n\r\n            <div v-if=\"filteredValues.length === 0\" class=\"no-values\">\r\n              No values found\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Regex mode content -->\r\n        <div v-else class=\"filter-content\">\r\n          <label class=\"regex-label\">\r\n            <span>Regex Pattern:</span>\r\n            <input\r\n              v-model=\"regexPattern\"\r\n              type=\"text\"\r\n              class=\"regex-input\"\r\n              placeholder=\"^test.*|.*example$\"\r\n            />\r\n          </label>\r\n\r\n          <div class=\"regex-help\">\r\n            <details>\r\n              <summary>Regex Examples</summary>\r\n              <ul>\r\n                <li><code>^test</code> - Starts with \"test\"</li>\r\n                <li><code>example$</code> - Ends with \"example\"</li>\r\n                <li><code>^test.*example$</code> - Starts with \"test\" and ends with \"example\"</li>\r\n                <li><code>test|example</code> - Contains \"test\" OR \"example\"</li>\r\n                <li><code>\\d{3}</code> - Contains exactly 3 digits</li>\r\n              </ul>\r\n            </details>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Footer buttons -->\r\n        <div class=\"filter-footer\">\r\n          <button class=\"footer-button footer-button--apply\" @click=\"handleApply\">\r\n            Apply Filter\r\n          </button>\r\n          <button class=\"footer-button footer-button--clear\" @click=\"handleClear\">\r\n            Clear Filter\r\n          </button>\r\n          <button class=\"footer-button footer-button--cancel\" @click=\"handleClose\">\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </teleport>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch } from 'vue'\r\n\r\nexport interface FilterValue {\r\n  value: string\r\n  isSelected: boolean\r\n  count: number\r\n  displayText?: string\r\n}\r\n\r\nconst props = defineProps<{\r\n  visible: boolean\r\n  columnName: string\r\n  position: { x: number; y: number }\r\n  uniqueValues: FilterValue[]\r\n  currentMode?: 'checkbox' | 'regex'\r\n  currentPattern?: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  close: []\r\n  applyCheckbox: [selectedValues: string[]]\r\n  applyRegex: [pattern: string]\r\n  clearFilter: []\r\n}>()\r\n\r\n// Local state\r\nconst filterMode = ref<'checkbox' | 'regex'>(props.currentMode || 'checkbox')\r\nconst searchText = ref('')\r\nconst regexPattern = ref(props.currentPattern || '')\r\nconst values = ref<FilterValue[]>([])\r\n\r\n// Watch for prop changes\r\nwatch(() => props.uniqueValues, (newValues) => {\r\n  values.value = newValues.map(v => ({ ...v }))\r\n}, { immediate: true, deep: true })\r\n\r\nwatch(() => props.currentPattern, (newPattern) => {\r\n  if (newPattern) {\r\n    regexPattern.value = newPattern\r\n  }\r\n}, { immediate: true })\r\n\r\n// Computed: filtered values based on search text\r\nconst filteredValues = computed(() => {\r\n  if (!searchText.value) {\r\n    return values.value\r\n  }\r\n\r\n  const search = searchText.value.toLowerCase()\r\n  return values.value.filter(item =>\r\n    item.value.toLowerCase().includes(search)\r\n  )\r\n})\r\n\r\n// Computed: display text with count\r\nconst displayText = (item: FilterValue) => {\r\n  return item.count > 0 ? `${item.value} (${item.count})` : item.value\r\n}\r\n\r\n// Methods\r\nfunction selectAll() {\r\n  filteredValues.value.forEach(item => {\r\n    item.isSelected = true\r\n  })\r\n}\r\n\r\nfunction deselectAll() {\r\n  filteredValues.value.forEach(item => {\r\n    item.isSelected = false\r\n  })\r\n}\r\n\r\nfunction handleApply() {\r\n  if (filterMode.value === 'checkbox') {\r\n    const selectedValues = values.value\r\n      .filter(item => item.isSelected)\r\n      .map(item => item.value)\r\n\r\n    emit('applyCheckbox', selectedValues)\r\n  } else {\r\n    emit('applyRegex', regexPattern.value)\r\n  }\r\n\r\n  handleClose()\r\n}\r\n\r\nfunction handleClear() {\r\n  emit('clearFilter')\r\n  handleClose()\r\n}\r\n\r\nfunction handleClose() {\r\n  emit('close')\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.filter-flyout-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.3);\r\n  z-index: 1000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.filter-flyout {\r\n  position: fixed;\r\n  background-color: var(--dg-ui-dialog-bg, white);\r\n  color: var(--dg-ui-dialog-fg, #212529);\r\n  border: 1px solid var(--dg-ui-dialog-border, #ccc);\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\r\n  min-width: 320px;\r\n  max-width: 480px;\r\n  max-height: 600px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 1001;\r\n}\r\n\r\n.filter-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 12px 16px;\r\n  border-bottom: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  background-color: var(--dg-header-bg, #f5f5f5);\r\n}\r\n\r\n.filter-title {\r\n  margin: 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: var(--dg-header-fg, #212529);\r\n}\r\n\r\n.close-button {\r\n  background: none;\r\n  border: none;\r\n  font-size: 20px;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  width: 24px;\r\n  height: 24px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: var(--dg-ui-dialog-fg, #666);\r\n  border-radius: 4px;\r\n}\r\n\r\n.close-button:hover {\r\n  background-color: var(--dg-cell-hover-bg, #e0e0e0);\r\n  color: var(--dg-ui-dialog-fg, #000);\r\n}\r\n\r\n.filter-mode {\r\n  display: flex;\r\n  gap: 16px;\r\n  padding: 12px 16px;\r\n  border-bottom: 1px solid var(--dg-border-cell, #e0e0e0);\r\n}\r\n\r\n.filter-mode label {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\n.filter-mode input[type=\"radio\"] {\r\n  cursor: pointer;\r\n}\r\n\r\n.filter-content {\r\n  flex: 1;\r\n  padding: 16px;\r\n  overflow-y: auto;\r\n  min-height: 200px;\r\n}\r\n\r\n.filter-search {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid var(--dg-ui-filter-border, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  background-color: var(--dg-ui-filter-bg, white);\r\n  color: var(--dg-ui-filter-fg, #212529);\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.filter-search:focus {\r\n  outline: none;\r\n  border-color: var(--dg-border-focused-cell, #2196f3);\r\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\r\n}\r\n\r\n.filter-actions {\r\n  display: flex;\r\n  gap: 8px;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.action-button {\r\n  flex: 1;\r\n  padding: 6px 12px;\r\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\r\n  border: 1px solid var(--dg-border-cell, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 13px;\r\n  cursor: pointer;\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n}\r\n\r\n.action-button:hover {\r\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\r\n}\r\n\r\n.filter-values {\r\n  max-height: 300px;\r\n  overflow-y: auto;\r\n  border: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  border-radius: 4px;\r\n  background-color: var(--dg-cell-bg, white);\r\n}\r\n\r\n.value-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 8px 12px;\r\n  cursor: pointer;\r\n  border-bottom: 1px solid var(--dg-border-cell, #f0f0f0);\r\n  font-size: 14px;\r\n}\r\n\r\n.value-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.value-item:hover {\r\n  background-color: var(--dg-cell-hover-bg, #f8f9fa);\r\n}\r\n\r\n.value-item--selected {\r\n  background-color: var(--lb-item-selected-bg, #e3f2fd);\r\n}\r\n\r\n.value-checkbox {\r\n  cursor: pointer;\r\n}\r\n\r\n.value-text {\r\n  flex: 1;\r\n}\r\n\r\n.no-values {\r\n  text-align: center;\r\n  padding: 24px;\r\n  color: var(--dg-ui-placeholder, #999);\r\n  font-size: 14px;\r\n}\r\n\r\n.regex-label {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n}\r\n\r\n.regex-input {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid var(--dg-ui-filter-border, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  font-family: 'Consolas', 'Monaco', monospace;\r\n  background-color: var(--dg-ui-filter-bg, white);\r\n  color: var(--dg-ui-filter-fg, #212529);\r\n}\r\n\r\n.regex-input:focus {\r\n  outline: none;\r\n  border-color: var(--dg-border-focused-cell, #2196f3);\r\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\r\n}\r\n\r\n.regex-help {\r\n  margin-top: 16px;\r\n  font-size: 13px;\r\n}\r\n\r\n.regex-help details {\r\n  background-color: var(--dg-ui-menu-bg, #f8f9fa);\r\n  border: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  border-radius: 4px;\r\n  padding: 8px;\r\n}\r\n\r\n.regex-help summary {\r\n  cursor: pointer;\r\n  font-weight: 500;\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.regex-help ul {\r\n  margin: 8px 0 0 0;\r\n  padding-left: 20px;\r\n}\r\n\r\n.regex-help li {\r\n  margin: 4px 0;\r\n}\r\n\r\n.regex-help code {\r\n  background-color: var(--dg-cell-bg, #e9ecef);\r\n  padding: 2px 6px;\r\n  border-radius: 3px;\r\n  font-family: 'Consolas', 'Monaco', monospace;\r\n  font-size: 12px;\r\n}\r\n\r\n.filter-footer {\r\n  display: flex;\r\n  gap: 8px;\r\n  padding: 12px 16px;\r\n  border-top: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\r\n}\r\n\r\n.footer-button {\r\n  flex: 1;\r\n  padding: 8px 16px;\r\n  border: 1px solid var(--dg-border-cell, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.footer-button--apply {\r\n  background-color: var(--dg-header-sort-indicator, #2196f3);\r\n  color: white;\r\n  border-color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.footer-button--apply:hover {\r\n  background-color: #1976d2;\r\n  border-color: #1976d2;\r\n}\r\n\r\n.footer-button--clear {\r\n  background-color: var(--dg-validation-warning-bg, #fff3cd);\r\n  color: var(--dg-validation-warning-fg, #856404);\r\n  border-color: var(--dg-validation-warning-border, #ffc107);\r\n}\r\n\r\n.footer-button--clear:hover {\r\n  background-color: #ffe69c;\r\n}\r\n\r\n.footer-button--cancel {\r\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n}\r\n\r\n.footer-button--cancel:hover {\r\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\r\n}\r\n\r\n/* Scrollbar styling */\r\n.filter-values::-webkit-scrollbar,\r\n.filter-content::-webkit-scrollbar {\r\n  width: 8px;\r\n}\r\n\r\n.filter-values::-webkit-scrollbar-track,\r\n.filter-content::-webkit-scrollbar-track {\r\n  background: var(--lb-scrollbar-track-bg, #f1f1f1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.filter-values::-webkit-scrollbar-thumb,\r\n.filter-content::-webkit-scrollbar-thumb {\r\n  background: var(--lb-scrollbar-thumb-bg, #c1c1c1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.filter-values::-webkit-scrollbar-thumb:hover,\r\n.filter-content::-webkit-scrollbar-thumb:hover {\r\n  background: var(--lb-scrollbar-thumb-hover-bg, #a8a8a8);\r\n}\r\n</style>\r\n","<template>\n  <div class=\"data-grid\" :style=\"cssVariables\">\n    <!-- Loading overlay during processing -->\n    <div v-if=\"isProcessing\" class=\"processing-overlay\">\n      <div class=\"processing-content\">\n        <div class=\"processing-spinner\"></div>\n        <div class=\"processing-text\">Processing {{ store.rows.length }} rows...</div>\n      </div>\n    </div>\n\n    <!-- Hidden columns notification -->\n    <div v-if=\"hiddenColumns.length > 0\" class=\"hidden-columns-panel\">\n      <span class=\"hidden-columns-label\">Hidden columns:</span>\n      <button\n        v-for=\"col in hiddenColumns\"\n        :key=\"col.name\"\n        class=\"show-column-button\"\n        @click=\"showColumn(col.name)\"\n        :title=\"`Show column: ${col.header}`\"\n      >\n        {{ col.header }}\n      </button>\n      <button class=\"show-all-button\" @click=\"showAllColumns\" title=\"Show all columns\">\n        Show All\n      </button>\n    </div>\n\n    <div class=\"grid-container\">\n      <DataGridHeader\n        :columns=\"allColumns\"\n        :grid-template-columns=\"gridTemplateColumns\"\n        :grid-id=\"instanceId\"\n        :is-grid-ready=\"isGridReady\"\n        :is-processing=\"isProcessing\"\n        @sort=\"handleSort\"\n        @resize=\"handleResize\"\n        @hide-column=\"handleHideColumn\"\n        @auto-fit-column=\"handleAutoFitColumn\"\n        @show-filter=\"handleShowFilter\"\n      />\n\n      <DynamicScroller\n        ref=\"scrollerRef\"\n        :items=\"visibleRows\"\n        :min-item-size=\"40\"\n        :buffer=\"200\"\n        key-field=\"rowId\"\n        class=\"scroller\"\n      >\n        <template #default=\"{ item, index, active }\">\n          <DynamicScrollerItem\n            :item=\"item\"\n            :active=\"active\"\n            :size-dependencies=\"[item.height, item.cells.length, item.validationErrorCount]\"\n            :data-index=\"index\"\n          >\n            <DataGridRow\n              :row=\"item\"\n              :columns=\"allColumns\"\n              :grid-template-columns=\"gridTemplateColumns\"\n              :grid-id=\"instanceId\"\n              @cell-edit-complete=\"handleCellEditComplete\"\n              @cell-input=\"handleCellInput\"\n              @checkbox-change=\"handleCheckboxChange\"\n              @delete-row=\"handleDeleteRow\"\n              @insert-row=\"handleInsertRow\"\n              @insert-above=\"handleInsertAbove\"\n              @insert-below=\"handleInsertBelow\"\n            />\n          </DynamicScrollerItem>\n        </template>\n      </DynamicScroller>\n    </div>\n\n    <PaginationControl\n      :page-size=\"store.pageSize\"\n      :page-size-options=\"store.config.pageSizeOptions\"\n      :total-rows=\"store.totalRows\"\n      :current-page=\"store.currentPage\"\n      @page-change=\"store.goToPage\"\n      @page-size-change=\"store.setPageSize\"\n    />\n\n    <FilterFlyout\n      :visible=\"filterFlyout.visible\"\n      :column-name=\"filterFlyout.columnName\"\n      :position=\"filterFlyout.position\"\n      :unique-values=\"filterFlyout.uniqueValues\"\n      :current-mode=\"filterFlyout.mode\"\n      :current-pattern=\"filterFlyout.pattern\"\n      @close=\"closeFilterFlyout\"\n      @apply-checkbox=\"handleApplyCheckboxFilter\"\n      @apply-regex=\"handleApplyRegexFilter\"\n      @clear-filter=\"handleClearFilter\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, onMounted, onUnmounted, onBeforeMount, onBeforeUnmount, provide, nextTick } from 'vue'\nimport { DynamicScroller, DynamicScrollerItem } from 'vue-virtual-scroller'\nimport { useDataGridStore, type GridColumn } from '@/stores/dataGridStore'\nimport { useValidation } from '@/composables/useValidation'\nimport { useCopyPaste } from '@/composables/useCopyPaste'\nimport { useImportExport, ImportMode } from '@/composables/useImportExport'\nimport { useAutoRowHeight, defaultAutoRowHeightConfig } from '@/composables/useAutoRowHeight'\nimport { useShortcuts, createDefaultShortcuts, ShortcutContext } from '@/composables/useShortcuts'\nimport { useLogger } from '@/composables/useLogger'\nimport { gridApi } from '@/services/gridApi'\nimport { generateDataGridCSSVariables, defaultDataGridTheme } from '@/composables/useTheme'\nimport type { DataGridTheme } from '@/types/theme'\nimport { useFiltering, type FilterExpression, type SimpleFilter, type CompositeFilter } from '@/composables/useFiltering'\nimport DataGridHeader from './DataGridHeader.vue'\nimport DataGridRow from './DataGridRow.vue'\nimport PaginationControl from './PaginationControl.vue'\nimport FilterFlyout from './FilterFlyout.vue'\nimport type { FilterValue } from './FilterFlyout.vue'\n\nconst props = defineProps<{\n  config?: any\n  columns?: GridColumn[]\n  gridId?: string  // Optional unique ID for this grid instance\n  theme?: Partial<DataGridTheme>  // Optional theme customization\n  minTableWidth?: number  // Minimum table width in pixels - triggers horizontal scroll when container is smaller\n  width?: string  // Table width (e.g., \"100%\", \"800px\", \"50vw\") - defaults to \"100%\"\n  height?: string  // Table height (e.g., \"600px\", \"80vh\", \"auto\") - defaults to \"600px\"\n  autoRowHeightEnabled?: boolean  // Optional: Enable AutoRowHeight on initialization (default: false)\n}>()\n\n// Generate unique store ID for this grid instance\nconst instanceId = props.gridId || `grid-${Math.random().toString(36).substr(2, 9)}`\n\n// Initialize logger for this component\nconst logger = useLogger(`DataGrid[${instanceId}]`)\nlogger.info(' Component initializing', {\n  gridId: instanceId,\n  hasConfig: !!props.config,\n  hasColumns: !!props.columns,\n  columnCount: props.columns?.length || 0\n})\n\n// Create a unique store instance for this DataGrid\nconst store = useDataGridStore(instanceId)\nlogger.debug(' Store created', { instanceId })\n\n// Set initial AutoRowHeight state from props (default: false)\nif (props.autoRowHeightEnabled !== undefined) {\n  store.setAutoRowHeightEnabled(props.autoRowHeightEnabled)\n  logger.info(` AutoRowHeight initialized to: ${props.autoRowHeightEnabled}`)\n}\n\n// Create validation instance for this DataGrid and provide it to child components\nconst validation = useValidation()\nprovide('validation', validation)\n\n// Create copy/paste instance\nconst copyPaste = useCopyPaste()\n\n// Create import/export instance\nconst importExport = useImportExport()\n\n// Create filtering instance\nconst { filterRows: filterRowsHelper, evaluateFilter } = useFiltering()\n\n//  FIX: Loading flag to prevent race conditions\nconst isGridReady = ref(false)\n\n//  FIX: Processing flag to prevent interactions during validation/AutoRowHeight\nconst isProcessing = ref(false)\n\n// Create auto row height instance with dynamic maxHeight based on container height\nconst containerHeight = ref(800)  // Default container height (will be measured dynamically)\n\n// Compute maxHeight as 70% of container height, minimum 32px\nconst computedMaxHeight = computed(() => {\n  const maxHeight = Math.max(32, Math.floor(containerHeight.value * 0.7))\n  console.log(`[AutoRowHeight] Computed maxHeight: ${maxHeight}px (container: ${containerHeight.value}px)`)\n  return maxHeight\n})\n\n// Initialize with dynamic config\nconst autoRowHeight = useAutoRowHeight({\n  minHeight: 32,\n  maxHeight: computedMaxHeight.value,\n  fontFamily: 'system-ui, -apple-system, sans-serif',\n  fontSize: 14,\n  enableWrapping: true,\n  padding: 16\n})\n\n// Watch for container height changes and update maxHeight\nwatch(computedMaxHeight, async (newMaxHeight) => {\n  console.log(`[AutoRowHeight] maxHeight changed to: ${newMaxHeight}px`)\n  autoRowHeight.updateMaxHeight(newMaxHeight)\n\n  // If AutoRowHeight is enabled, recalculate all row heights with new maxHeight\n  if (store.isAutoRowHeightEnabled && store.rows.length > 0) {\n    console.log('[AutoRowHeight] maxHeight changed - recalculating all row heights...')\n    await applyAutoRowHeightToAll()\n  }\n})\n\n// Measure container height function (defined at top level for cleanup)\nconst measureContainerHeight = () => {\n  // CRITICAL FIX: Guard against undefined $el\n  if (!scrollerRef.value) {\n    console.log('[AutoRowHeight] Cannot measure: scrollerRef is null')\n    return\n  }\n\n  if (!scrollerRef.value.$el) {\n    console.log('[AutoRowHeight] Cannot measure: scrollerRef.$el is undefined')\n    return\n  }\n\n  const height = scrollerRef.value.$el.clientHeight\n  if (height > 0) {\n    containerHeight.value = height\n    console.log(`[AutoRowHeight] Container height measured: ${height}px`)\n  } else {\n    console.log('[AutoRowHeight] Container height is 0, keeping default')\n  }\n}\n\n//  RIEENIE C: Single async onMounted - ensures proper initialization sequence\nonMounted(async () => {\n  logger.info('==========  Component mounted - START initialization ==========', {\n    gridId: props.gridId,\n    autoRowHeight: store.isAutoRowHeightEnabled,\n    rowCount: store.rows.length,\n    columnCount: store.columns.length\n  })\n\n  // 1. Register event listeners FIRST\n  document.addEventListener('mouseup', handleDocumentMouseUp)\n  document.addEventListener('keydown', handleKeyboardShortcuts)\n  logger.debug(' Event listeners registered (mouseup, keydown)')\n\n  // 2. Auto-initialize: If columns are provided but no rows exist, initialize empty rows\n  if (props.columns && props.columns.length > 0 && store.rows.length === 0) {\n    logger.info(' Auto-initializing empty rows from provided columns', {\n      columnCount: props.columns.length\n    })\n    try {\n      store.setColumns(props.columns)\n      store.initializeEmptyRows()\n      logger.info(` Auto-initialized ${store.rows.length} empty rows`)\n    } catch (error) {\n      logger.error(' Failed to set columns:', error)\n      alert(`Column configuration error: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  // 3. Check backend connection (async)\n  checkBackendConnection()\n\n  // 4. Wait for DOM to be ready\n  await nextTick()\n  logger.debug(' DOM ready after nextTick')\n\n  // 5. Measure container height\n  measureContainerHeight()\n\n  // 6. Apply AutoRowHeight if enabled (async operation)\n  if (store.isAutoRowHeightEnabled && store.rows.length > 0) {\n    logger.info(' AutoRowHeight enabled - applying heights...')\n    await nextTick()\n    try {\n      await applyAutoRowHeightToAll()\n      logger.info(' AutoRowHeight applied successfully on mount')\n    } catch (error) {\n      logger.error(' AutoRowHeight ERROR on mount:', error)\n    }\n  } else {\n    logger.debug(` Skipping AutoRowHeight: enabled=${store.isAutoRowHeightEnabled}, rowCount=${store.rows.length}`)\n  }\n\n  // 7. Register resize listener\n  window.addEventListener('resize', measureContainerHeight)\n  logger.debug(' Resize listener registered')\n\n  // 8. ONLY NOW mark grid as ready (after ALL async operations complete)\n  await nextTick()\n  isGridReady.value = true\n  logger.info('==========  Grid marked as READY for user interaction ==========')\n})\n\n// Cleanup on unmount (must be at top level, NOT inside onMounted)\nonBeforeUnmount(() => {\n  window.removeEventListener('resize', measureContainerHeight)\n  document.removeEventListener('mouseup', handleDocumentMouseUp)\n  document.removeEventListener('keydown', handleKeyboardShortcuts)\n  logger.info(' Cleanup: All event listeners removed')\n})\n\n// Use store.isAutoRowHeightEnabled instead of local ref\n\n// Backend API connection status\nconst isBackendConnected = ref(false)\nconst isLoadingFromBackend = ref(false)\nconst isSavingToBackend = ref(false)\n\n// DynamicScroller ref for force updates\nconst scrollerRef = ref<InstanceType<typeof DynamicScroller>>()\n\n// Get selected rows for copy/paste operations\nconst getSelectedRows = () => {\n  const selectedCells = Array.from(store.selectedCells)\n  if (selectedCells.length === 0) return []\n\n  // Get unique row IDs from selected cells\n  const rowIds = new Set(selectedCells.map(cellId => cellId.split(':')[0]))\n  return store.rows.filter(row => rowIds.has(row.rowId))\n}\n\n// Get column names (excluding special columns)\nconst getDataColumnNames = () => {\n  return dataColumns.value\n    .filter(col => !col.specialType)\n    .map(col => col.name)\n}\n\n// Copy handler\nconst handleCopy = async () => {\n  const rows = getSelectedRows()\n  if (rows.length === 0) {\n    console.warn('No rows selected for copy')\n    return\n  }\n\n  const columnNames = getDataColumnNames()\n  const result = await copyPaste.copyToClipboard(rows, columnNames, { includeHeaders: true })\n\n  if (result.success) {\n    console.log(result.message)\n  } else {\n    console.error(result.message)\n  }\n}\n\n// Paste handler\nconst handlePaste = async () => {\n  const result = await copyPaste.pasteFromClipboard()\n\n  if (result.success && result.rows && result.rows.length > 0) {\n    // Find the target position (first selected cell or append to end)\n    const selectedCells = Array.from(store.selectedCells)\n    let targetRowIndex = store.rows.length\n\n    if (selectedCells.length > 0) {\n      // Get first selected cell position\n      const firstCellId = selectedCells[0]\n      const rowId = firstCellId.split(':')[0]\n      const rowIndex = store.rows.findIndex(r => r.rowId === rowId)\n      if (rowIndex >= 0) {\n        targetRowIndex = rowIndex\n      }\n    }\n\n    // Add pasted rows to the store\n    result.rows.forEach((rowData, index) => {\n      if (targetRowIndex + index < store.rows.length) {\n        // Overwrite existing row\n        const targetRow = store.rows[targetRowIndex + index]\n        Object.keys(rowData).forEach(key => {\n          if (dataColumns.value.some(col => col.name === key)) {\n            store.updateCell(targetRow.rowId, key, rowData[key])\n          }\n        })\n      } else {\n        // Append new row - insert empty row at end and populate with data\n        const lastRowId = store.rows[store.rows.length - 1]?.rowId\n        if (lastRowId) {\n          store.insertRow(lastRowId)\n          // Get the newly created row and update its cells with data\n          const newRow = store.rows[store.rows.length - 1]\n          Object.keys(rowData).forEach(key => {\n            if (dataColumns.value.some(col => col.name === key)) {\n              store.updateCell(newRow.rowId, key, rowData[key])\n            }\n          })\n        }\n      }\n    })\n\n    console.log(result.message)\n  } else {\n    console.error(result.message)\n  }\n}\n\n// Cut handler (copy + delete)\nconst handleCut = async () => {\n  await handleCopy()\n\n  // Delete selected cells content\n  const selectedCells = Array.from(store.selectedCells)\n  selectedCells.forEach(cellId => {\n    const [rowId, columnName] = cellId.split(':')\n    if (!dataColumns.value.find(col => col.name === columnName)?.isReadOnly) {\n      store.updateCell(rowId, columnName, null)\n    }\n  })\n}\n\n// Delete handler\nconst handleDelete = () => {\n  const selectedCells = Array.from(store.selectedCells)\n  selectedCells.forEach(cellId => {\n    const [rowId, columnName] = cellId.split(':')\n    if (!dataColumns.value.find(col => col.name === columnName)?.isReadOnly) {\n      store.updateCell(rowId, columnName, null)\n    }\n  })\n}\n\n// Select All handler\nconst handleSelectAll = () => {\n  // Select all cells in all rows\n  store.rows.forEach(row => {\n    dataColumns.value.forEach(col => {\n      if (!col.specialType) { // Only select data columns\n        store.selectCell(row.rowId, col.name, true) // true for Ctrl to add to selection\n      }\n    })\n  })\n}\n\n// Register keyboard shortcuts\nconst shortcuts = useShortcuts({ enabled: true, context: ShortcutContext.Normal })\n\nshortcuts.registerShortcuts(createDefaultShortcuts({\n  onCopy: handleCopy,\n  onPaste: handlePaste,\n  onCut: handleCut,\n  onDelete: handleDelete,\n  onSelectAll: handleSelectAll,\n  onFind: () => console.log('Find not implemented yet')\n}))\n\nconst visibleRows = computed(() => store.visibleRows)\n\n// Use provided columns or default to store columns\nconst dataColumns = computed(() => props.columns || store.columns)\n\n// Keyboard handler for Ctrl+C / Ctrl+V\nfunction handleKeyboardShortcuts(event: KeyboardEvent) {\n  // Only handle if Ctrl (or Cmd on Mac) is pressed\n  if (!event.ctrlKey && !event.metaKey) return\n\n  // Ctrl+C - Copy selected cells\n  if (event.key === 'c' || event.key === 'C') {\n    event.preventDefault()\n    console.log('[DataGrid] Ctrl+C pressed - copying selected cells')\n    handleCopySelectedCells()\n  }\n\n  // Ctrl+V - Paste from clipboard\n  if (event.key === 'v' || event.key === 'V') {\n    event.preventDefault()\n    console.log('[DataGrid] Ctrl+V pressed - pasting from clipboard')\n    handlePasteSelectedCells()\n  }\n}\n\n// Copy selected cells (new implementation with position preservation)\nasync function handleCopySelectedCells() {\n  if (store.selectedCells.size === 0) {\n    console.warn('[DataGrid] No cells selected for copy')\n    return\n  }\n\n  console.log('[DataGrid] Copying selected cells:', {\n    selectedCount: store.selectedCells.size,\n    selectedCells: Array.from(store.selectedCells)\n  })\n\n  // Use new copySelectedCells method that preserves positions\n  const result = await copyPaste.copySelectedCells(\n    store.selectedCells,\n    store.rows,\n    allColumns.value\n  )\n\n  if (result.success) {\n    console.log('[DataGrid] Copy successful:', result.message)\n  } else {\n    console.error('[DataGrid] Copy failed:', result.message)\n  }\n}\n\n// Paste from clipboard to selected cells\nasync function handlePasteSelectedCells() {\n  const result = await copyPaste.pasteFromClipboard()\n\n  if (result.success && result.rows && result.rows.length > 0) {\n    console.log('[DataGrid] Paste successful:', {\n      rowCount: result.rows.length,\n      headers: result.headers\n    })\n\n    // Find the target position (first selected cell or top-left)\n    let targetRowIndex = 0\n    let targetColIndex = 0\n\n    if (store.selectedCells.size > 0) {\n      // Get first selected cell as paste target\n      const firstCellKey = Array.from(store.selectedCells)[0]\n      const [firstRowId, firstColName] = firstCellKey.split(':')\n      const firstRow = store.rows.find(r => r.rowId === firstRowId)\n      const firstColIdx = allColumns.value.findIndex(c => c.name === firstColName)\n\n      if (firstRow && firstColIdx !== -1) {\n        targetRowIndex = firstRow.rowIndex\n        targetColIndex = firstColIdx\n      }\n    }\n\n    console.log('[DataGrid] Pasting at position:', {\n      targetRowIndex,\n      targetColIndex\n    })\n\n    // Paste data row by row, column by column\n    result.rows.forEach((rowData, rowOffset) => {\n      const pasteRowIndex = targetRowIndex + rowOffset\n\n      if (pasteRowIndex >= store.rows.length) {\n        console.warn('[DataGrid] Paste row out of bounds:', { pasteRowIndex, maxRows: store.rows.length })\n        return\n      }\n\n      const targetRow = store.rows[pasteRowIndex]\n\n      // Paste each column value\n      Object.keys(rowData).forEach((columnKey, colOffset) => {\n        const pasteColIndex = targetColIndex + colOffset\n\n        if (pasteColIndex >= allColumns.value.length) {\n          console.warn('[DataGrid] Paste column out of bounds:', { pasteColIndex, maxCols: allColumns.value.length })\n          return\n        }\n\n        const targetColumn = allColumns.value[pasteColIndex]\n        const value = rowData[columnKey]\n\n        // Update cell value\n        store.updateCell(targetRow.rowId, targetColumn.name, value)\n\n        console.log('[DataGrid] Pasted cell:', {\n          row: pasteRowIndex,\n          col: pasteColIndex,\n          columnName: targetColumn.name,\n          value\n        })\n      })\n    })\n\n    console.log('[DataGrid] Paste complete')\n  } else {\n    console.error('[DataGrid] Paste failed:', result.message)\n  }\n}\n\n// Lifecycle: Before mount\nonBeforeMount(() => {\n  logger.info(' Component before mount')\n})\n\n//  RIEENIE C: Second onMounted REMOVED - merged into single async onMounted above\n\n// Lifecycle: Before unmount\nonBeforeUnmount(() => {\n  logger.info(' Component before unmount')\n})\n\n// Lifecycle: Unmounted - cleanup event listeners\nonUnmounted(() => {\n  logger.info(' Component unmounted - final cleanup')\n  logger.info(' Component cleanup complete')\n})\n\n// Batch validation - validates cells in batches to avoid UI freeze\n// Solution B + C: Only validate unvalidated cells, process asynchronously in batches\n// SOLUTION 2: Enhanced logging to debug validation issues\nasync function validateAllCellsInBatches() {\n  console.log('[validateAllCellsInBatches]  START', {\n    enableValidation: store.config.enableValidation,\n    hasValidation: !!validation,\n    totalRows: store.rows.length,\n    totalColumns: store.columns.length\n  })\n\n  if (!store.config.enableValidation || !validation) {\n    console.log('[validateAllCellsInBatches]  SKIPPED - validation not enabled or not available')\n    return\n  }\n\n  // Solution B: Get only cells that need validation (changed or unvalidated)\n  const cellsToValidate = store.getCellsNeedingValidation()\n\n  console.log('[validateAllCellsInBatches]  Cells needing validation:', {\n    count: cellsToValidate.length,\n    sample: cellsToValidate.slice(0, 5).map(c => `${c.rowId}:${c.columnName}`)\n  })\n\n  if (cellsToValidate.length === 0) {\n    console.log('[validateAllCellsInBatches]  NO CELLS NEED VALIDATION - all cells already validated')\n    return\n  }\n\n  const BATCH_SIZE = 20 // Process 20 cells at a time\n  let validatedCount = 0\n\n  console.log('[validateAllCellsInBatches] Starting batch validation...', {\n    totalCells: cellsToValidate.length,\n    batchSize: BATCH_SIZE,\n    estimatedBatches: Math.ceil(cellsToValidate.length / BATCH_SIZE)\n  })\n\n  // Solution C: Process in batches asynchronously\n  for (let i = 0; i < cellsToValidate.length; i += BATCH_SIZE) {\n    const batch = cellsToValidate.slice(i, i + BATCH_SIZE)\n    const batchNumber = Math.floor(i / BATCH_SIZE) + 1\n\n    console.log(`[validateAllCellsInBatches]  Processing batch ${batchNumber}:`, {\n      batchSize: batch.length,\n      from: i,\n      to: i + batch.length\n    })\n\n    // Validate each cell in the batch\n    for (const { rowId, columnName } of batch) {\n      const row = store.rows.find(r => r.rowId === rowId)\n      if (!row) {\n        console.warn('[validateAllCellsInBatches]  Row not found:', rowId)\n        continue\n      }\n\n      const cell = row.cells.find(c => c.columnName === columnName)\n      if (!cell) {\n        console.warn('[validateAllCellsInBatches]  Cell not found:', { rowId, columnName })\n        continue\n      }\n\n      const rowCells = row.cells.map(c => ({ columnName: c.columnName, value: c.value }))\n\n      // Validate cell\n      await validation.validateCellThrottled(rowId, columnName, cell.value, rowCells)\n\n      // Mark as validated in store\n      store.markCellValidated(rowId, columnName)\n\n      validatedCount++\n    }\n\n    // Yield to UI after each batch to prevent freeze\n    await nextTick()\n\n    console.log(`[validateAllCellsInBatches]  Batch ${batchNumber} complete:`, {\n      validated: validatedCount,\n      total: cellsToValidate.length,\n      progress: `${Math.round((validatedCount / cellsToValidate.length) * 100)}%`\n    })\n  }\n\n  console.log('[validateAllCellsInBatches]  COMPLETE:', {\n    totalValidated: validatedCount,\n    totalRequested: cellsToValidate.length,\n    success: validatedCount === cellsToValidate.length\n  })\n}\n\n// Watch for autoValidate toggle - validate all cells when enabled\nwatch(() => store.config.autoValidate, async (enabled, wasEnabled) => {\n  console.log('[DataGrid] autoValidate changed:', { wasEnabled, enabled })\n\n  if (enabled && !wasEnabled && store.config.enableValidation) {\n    console.log('[DataGrid] Auto-validation enabled - validating all unvalidated cells')\n    await validateAllCellsInBatches()\n  }\n})\n\nfunction handleDocumentMouseUp() {\n  if (store.isDragging || store.pressedCell) {\n    store.endDragSelection()\n  }\n}\n\n// Create special columns based on config\nconst specialColumns = computed(() => {\n  const cols: GridColumn[] = []\n  const config = store.config\n\n  if (config.showRowNumber) {\n    cols.push({\n      name: '__rowNumber',\n      header: '#',\n      width: 50,\n      minWidth: 40,\n      maxWidth: 80,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'RowNumber'\n    })\n  }\n\n  if (config.showCheckbox) {\n    cols.push({\n      name: '__checkbox',\n      header: '',\n      width: 40,\n      minWidth: 40,\n      maxWidth: 40,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: true,  //  FIX: Povoli filtrovanie pre Checkbox stpec\n      specialType: 'Checkbox'\n    })\n  }\n\n  return cols\n})\n\n// Validation column (goes after data columns, before action columns)\n// Uses autoWidth (1fr) to fill remaining space between data columns and action columns\n// NO maxWidth constraint - can expand as much as needed for long validation messages\nconst validationColumn = computed(() => {\n  const cols: GridColumn[] = []\n  const config = store.config\n\n  if (config.showValidationAlerts) {\n    cols.push({\n      name: '__validationAlerts',\n      header: ' Validation',\n      width: 200,  // Default width (only used if autoWidth is false)\n      minWidth: 150,\n      maxWidth: 9999,  // No maximum - can grow as needed\n      autoWidth: true,  // Use 1fr to fill remaining space to full width\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'ValidationAlerts'\n    })\n  }\n\n  return cols\n})\n\n// Create action columns (at the end)\n// Order: Insert first, then Delete (as per original WinUI component)\nconst actionColumns = computed(() => {\n  const cols: GridColumn[] = []\n  const config = store.config\n\n  // Insert button first\n  if (config.showInsertButton) {\n    cols.push({\n      name: '__insertRow',\n      header: 'Insert',\n      width: 60,\n      minWidth: 50,\n      maxWidth: 80,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'InsertRow'\n    })\n  }\n\n  // Delete button second\n  if (config.showDeleteButton) {\n    cols.push({\n      name: '__deleteRow',\n      header: 'Delete',\n      width: 60,\n      minWidth: 50,\n      maxWidth: 80,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'DeleteRow'\n    })\n  }\n\n  return cols\n})\n\n// Combine columns in correct order:\n// 1. RowNumber, Checkbox (specialColumns)\n// 2. Data columns (only visible ones with visibleForGrid !== false)\n// 3. ValidationAlerts (validationColumn)\n// 4. Insert, Delete (actionColumns)\nconst allColumns = computed(() => [\n  ...specialColumns.value,\n  ...dataColumns.value.filter(col => !col.specialType && col.isVisible && col.visibleForGrid !== false), // Only visible non-special columns that are shown in grid\n  ...validationColumn.value,\n  ...actionColumns.value\n])\n\n// Generate CSS Grid template columns\n// Example: \"50px 150px 200px 1fr 50px\" for fixed and auto-width columns\nconst gridTemplateColumns = computed(() => {\n  const template = allColumns.value.map(col => {\n    if (col.autoWidth) {\n      return '1fr'  // Auto-width columns use fractional unit\n    }\n    return `${col.width}px`  // Fixed-width columns use pixels\n  }).join(' ')\n\n  // Debug: Log grid template and columns\n  console.log('[GridTemplate] All Columns:', allColumns.value.map(c => ({\n    name: c.name,\n    header: c.header,\n    width: c.width,\n    autoWidth: c.autoWidth,\n    specialType: c.specialType\n  })))\n  console.log('[GridTemplate] Generated Template:', template)\n\n  return template\n})\n\n// Watch for config changes from props\nwatch(() => props.config, (newConfig) => {\n  if (newConfig) {\n    store.setConfig(newConfig)\n  }\n}, { immediate: true, deep: true })\n\n// Watch for columns changes from props\nwatch(() => props.columns, (newColumns) => {\n  console.log('[DataGrid] Columns watch triggered:', {\n    hasColumns: newColumns?.length,\n    rowsLength: store.rows.length,\n    willInitialize: newColumns && newColumns.length > 0 && store.rows.length === 0\n  })\n\n  if (newColumns && newColumns.length > 0) {\n    try {\n      store.setColumns(newColumns)\n      console.log('[DataGrid] After setColumns, rowsLength:', store.rows.length)\n\n      // Initialize empty rows if store is empty\n      if (store.rows.length === 0) {\n        console.log('[DataGrid] Calling initializeEmptyRows...')\n        store.initializeEmptyRows()\n        console.log('[DataGrid] After initializeEmptyRows, rowsLength:', store.rows.length)\n      } else {\n        console.log('[DataGrid] SKIPPED initializeEmptyRows - rows already exist!')\n      }\n    } catch (error) {\n      console.error('[DataGrid] Failed to set columns:', error)\n      alert(`Column configuration error: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n}, { immediate: true, deep: true })\n\n// Watch validation rules - trigger auto-validation when rules are added after data exists\n// FIXED: Watch ruleCount (reactive counter) instead of validationRules.value (Map.set doesn't trigger reactivity)\nwatch(() => validation?.ruleCount?.value ?? 0, async (newCount, oldCount) => {\n  const rulesSize = validation?.validationRules?.value?.size || 0\n\n  console.log('[WATCHER] Validation rules changed!', {\n    ruleCount: newCount,\n    oldCount,\n    hasRules: rulesSize > 0,\n    hasData: store.rows.length > 0,\n    autoValidateEnabled: store.config.autoValidate\n  })\n\n  // Only auto-validate if:\n  // 1. Rules exist\n  // 2. Data already exists\n  // 3. Auto-validation is enabled in config\n  if (rulesSize === 0 || store.rows.length === 0 || !store.config.autoValidate) {\n    console.log('[WATCHER] Skipping auto-validation:', {\n      noRules: rulesSize === 0,\n      noData: store.rows.length === 0,\n      autoValidateDisabled: !store.config.autoValidate\n    })\n    return\n  }\n\n  // SOLUTION 1C: Always trigger validation when rules exist and data exists\n  console.log('[WATCHER] Triggering auto-validation for all rows...')\n  try {\n    // FIXED: Double nextTick to ensure UI is stable before validation\n    await nextTick()\n    console.log('[WATCHER] First nextTick done')\n    await nextTick()\n    console.log('[WATCHER] Second nextTick done')\n\n    await validation.validateAll(store.rows)\n    console.log('[WATCHER]  Auto-validation completed after adding rules')\n  } catch (error) {\n    console.error('[WATCHER]  Error during auto-validation:', error)\n  }\n})\n\n// Watch rows - trigger auto-validation when data is loaded after rules exist\nwatch(() => store.rows.length, async (newLength, oldLength) => {\n  console.log('[WATCHER] Rows length changed!', {\n    newLength,\n    oldLength,\n    hasRules: validation?.validationRules?.value?.size || 0,\n    autoValidateEnabled: store.config.autoValidate\n  })\n\n  // Only auto-validate if:\n  // 1. Rows were added (not removed)\n  // 2. Validation rules already exist\n  // 3. Auto-validation is enabled\n  const hasRules = validation?.validationRules?.value && validation.validationRules.value.size > 0\n  if (newLength <= oldLength || !hasRules || !store.config.autoValidate) {\n    console.log('[WATCHER] Skipping auto-validation:', {\n      rowsNotAdded: newLength <= oldLength,\n      noRules: !hasRules,\n      autoValidateDisabled: !store.config.autoValidate\n    })\n    return\n  }\n\n  console.log('[WATCHER] Triggering auto-validation for newly loaded rows...')\n\n  //  FIX: Set processing flag to prevent user interactions during processing\n  isProcessing.value = true\n\n  try {\n    // FIXED: Double nextTick to ensure rows are FULLY rendered before validation\n    // First nextTick: Let Vue finish mounting row components\n    await nextTick()\n    console.log('[WATCHER] First nextTick done - rows mounted')\n\n    // Second nextTick: Let DynamicScroller finish initial height calculations\n    await nextTick()\n    console.log('[WATCHER] Second nextTick done - scroller ready')\n\n    // Small additional delay to ensure everything is stable\n    await new Promise(resolve => setTimeout(resolve, 50))\n    console.log('[WATCHER] Delay done - starting validation')\n\n    await validation.validateAll(store.rows)\n    console.log('[WATCHER]  Auto-validation completed after loading data')\n  } finally {\n    //  FIX: Always reset processing flag, even if error occurs\n    isProcessing.value = false\n  }\n}, { immediate: false })\n\n// SOLUTION A: Watch errorCount ref from useValidation (reactive counter)\nwatch(() => validation?.errorCount?.value ?? 0, async (errorCount, oldErrorCount) => {\n  const newErrors = validation?.validationErrors\n\n  console.log('[WATCHER] Validation errors changed!', {\n    errorCount,\n    oldErrorCount,\n    hasErrors: errorCount > 0,\n    isAutoRowHeightEnabled: store.isAutoRowHeightEnabled,\n    validationErrorsKeys: newErrors ? Object.keys(newErrors) : []\n  })\n\n  // FIXED: ALWAYS update validationErrorCount, even when errorCount = 0\n  // This ensures stale values are cleared when errors are resolved\n  console.log('[WATCHER] Updating validationErrorCount for all rows...')\n  store.rows.forEach(row => {\n    // If no errors object or no errors for this row, set to 0\n    const count = (newErrors && newErrors[row.rowId]) ? newErrors[row.rowId].length : 0\n    row.validationErrorCount = count\n    if (count > 0 || row.validationErrorCount !== count) {\n      console.log('[WATCHER] Updated validationErrorCount:', { rowId: row.rowId, count })\n    }\n  })\n\n  // If no errors, we're done - no need to recalculate heights\n  if (!newErrors || errorCount === 0) {\n    console.log('[WATCHER] No validation errors, heights updated, done.')\n    return\n  }\n\n  // Wait for Vue to finish current render cycle\n  await nextTick()\n\n  if (store.isAutoRowHeightEnabled) {\n    // If AutoRowHeight is ON, recalculate with validation text included\n    console.log('[WATCHER] AutoRowHeight is ON, calling applyAutoRowHeightToAll...')\n    await applyAutoRowHeightToAll()\n    console.log('[WATCHER] applyAutoRowHeightToAll completed')\n  } else {\n    // If AutoRowHeight is OFF, reset all rows to default height\n    console.log('[WATCHER] AutoRowHeight is OFF, calling resetAllRowHeights...')\n    await resetAllRowHeights()\n    console.log('[WATCHER] resetAllRowHeights completed')\n  }\n})\n\nfunction handleSort(columnName: string, direction: 'asc' | 'desc') {\n  // Check if column exists and is sortable\n  const column = store.columns.find(c => c.name === columnName)\n  if (!column) {\n    console.error(`[handleSort] Column not found: ${columnName}`)\n    return\n  }\n\n  if (!column.isSortable) {\n    console.warn(`[handleSort] Column '${columnName}' is not sortable`)\n    return\n  }\n\n  // Check if column has visibleForGrid=false (should not be sorted)\n  if (column.visibleForGrid === false) {\n    console.warn(`[handleSort] Column '${columnName}' has visibleForGrid=false, sorting not allowed`)\n    return\n  }\n\n  store.addSort(columnName, direction, false)\n}\n\nfunction handleResize(columnName: string, newWidth: number) {\n  const col = store.columns.find(c => c.name === columnName)\n  if (col) {\n    col.width = newWidth\n  }\n}\n\nasync function handleCellEditComplete(rowId: string, columnName: string, value: any) {\n  console.log(`[DataGrid] handleCellEditComplete: rowId=${rowId}, columnName=${columnName}, newValue=${value}, autoValidate=${store.config.autoValidate}, autoRowHeight=${store.isAutoRowHeightEnabled}`)\n\n  store.updateCell(rowId, columnName, value)\n\n  // CRITICAL: Validate cell immediately after edit if auto-validate is enabled\n  if (store.config.autoValidate && store.config.enableValidation && validation) {\n    const row = store.rows.find(r => r.rowId === rowId)\n    const rowCells = row?.cells.map(c => ({ columnName: c.columnName, value: c.value }))\n    await validation.validateCellThrottled(rowId, columnName, value, rowCells)\n    console.log('[DataGrid] Cell validated after edit:', { rowId, columnName, hasErrors: validation.validationErrors.value.has(rowId) })\n  }\n\n  // Recalculate row height if auto row height is enabled\n  if (store.isAutoRowHeightEnabled) {\n    console.log('[DataGrid] Recalculating row height:', { rowId })\n    await recalculateRowHeightAfterEdit(rowId)\n    await nextTick()\n  }\n  //  FIX: When AutoRowHeight is OFF, ALWAYS recalculate height based on current row values\n  // This handles both:\n  // 1. Adding newlines (Shift+Enter)  increases height\n  // 2. Cancel edit (ESC) with previous newlines  restores original height\n  else {\n    console.log('[DataGrid] Recalculating height for newlines (AutoRowHeight OFF):', { rowId })\n    await recalculateRowHeightForNewlines(rowId)\n  }\n}\n\nasync function handleCellInput(rowId: string, columnName: string, value: any) {\n  console.log('[handleCellInput] Called:', { rowId, columnName, value, autoRowHeightEnabled: store.isAutoRowHeightEnabled })\n\n  // Update cell value in store (needed for real-time validation and AutoRowHeight)\n  // cancelEdit() will restore original value if user cancels\n  store.updateCell(rowId, columnName, value)\n\n  // Recalculate row height in real-time if AutoRowHeight is enabled\n  if (store.isAutoRowHeightEnabled) {\n    await recalculateRowHeightAfterEdit(rowId)\n    await nextTick()\n  }\n  // Special case: if value contains newlines but AutoRowHeight is OFF, still recalculate\n  else if (value != null && String(value).includes('\\n')) {\n    await recalculateRowHeightForNewlines(rowId)\n  }\n}\n\nfunction handleCheckboxChange(rowId: string, checked: boolean) {\n  store.toggleCheckbox(rowId, checked)\n}\n\nfunction handleDeleteRow(rowId: string) {\n  store.deleteRow(rowId)\n}\n\nfunction handleInsertRow(afterRowId: string) {\n  store.insertRow(afterRowId)\n}\n\nfunction handleInsertAbove(rowId: string, count: number) {\n  store.insertMultipleRows(rowId, count, 'above')\n}\n\nfunction handleInsertBelow(rowId: string, count: number) {\n  store.insertMultipleRows(rowId, count, 'below')\n}\n\n// Hidden columns management\nconst hiddenColumns = computed(() => {\n  return dataColumns.value.filter(col => !col.isVisible && !col.specialType && col.visibleForGrid !== false)\n})\n\nfunction handleHideColumn(columnName: string) {\n  const col = dataColumns.value.find(c => c.name === columnName)\n  if (col && !col.specialType) {\n    col.isVisible = false\n    console.log(`Hidden column: ${columnName}`)\n  }\n}\n\nfunction showColumn(columnName: string) {\n  const col = dataColumns.value.find(c => c.name === columnName)\n  if (col) {\n    col.isVisible = true\n    console.log(`Shown column: ${columnName}`)\n  }\n}\n\nfunction showAllColumns() {\n  dataColumns.value.forEach(col => {\n    if (!col.specialType) {\n      col.isVisible = true\n    }\n  })\n  console.log('Shown all columns')\n}\n\nfunction handleAutoFitColumn(columnName: string) {\n  const col = dataColumns.value.find(c => c.name === columnName)\n  if (!col) return\n\n  // Create a temporary canvas to measure text width\n  const canvas = document.createElement('canvas')\n  const context = canvas.getContext('2d')\n  if (!context) return\n\n  // Set font to match grid cell font\n  context.font = '14px system-ui, -apple-system, sans-serif'\n\n  let maxWidth = 0\n\n  // Measure header text\n  const headerWidth = context.measureText(col.header).width\n  maxWidth = Math.max(maxWidth, headerWidth + 40) // Add padding for sort icon, etc.\n\n  // Measure all cell values in this column\n  store.rows.forEach(row => {\n    const cell = row.cells.find(c => c.columnName === columnName)\n    const value = cell?.value\n    const textValue = value?.toString() ?? ''\n    if (textValue) {\n      const textWidth = context.measureText(textValue).width\n      maxWidth = Math.max(maxWidth, textWidth + 24) // Add padding for cell content\n    }\n  })\n\n  // Apply constraints (min/max width)\n  const newWidth = Math.max(\n    col.minWidth,\n    Math.min(col.maxWidth, Math.ceil(maxWidth))\n  )\n\n  col.width = newWidth\n  console.log(`Auto-fit column ${columnName}: ${newWidth}px (measured: ${Math.ceil(maxWidth)}px)`)\n}\n\n// Filter Flyout state\nconst filterFlyout = ref<{\n  visible: boolean\n  columnName: string\n  position: { x: number; y: number }\n  uniqueValues: FilterValue[]\n  mode: 'checkbox' | 'regex'\n  pattern: string\n}>({\n  visible: false,\n  columnName: '',\n  position: { x: 0, y: 0 },\n  uniqueValues: [],\n  mode: 'checkbox',\n  pattern: ''\n})\n\n//  HELPER: Extract all filters EXCEPT filters for specific column\nfunction extractFiltersExceptColumn(filter: FilterExpression | null | undefined, excludeColumnName: string): FilterExpression | null {\n  //  FIX: Handle undefined filter expression (early initialization)\n  if (filter === null || filter === undefined) return null\n\n  if (filter.type === 'simple') {\n    const simpleFilter = filter as SimpleFilter\n    // If this filter is for the excluded column, remove it\n    return simpleFilter.columnName === excludeColumnName ? null : filter\n  }\n\n  // Composite filter - recursively process left and right\n  const compositeFilter = filter as CompositeFilter\n\n  //  FIX: Defensive check for null/undefined children\n  if (!compositeFilter.left || !compositeFilter.right) {\n    console.error('[extractFiltersExceptColumn] Invalid composite filter - missing children:', compositeFilter)\n    return null\n  }\n\n  const leftFiltered = extractFiltersExceptColumn(compositeFilter.left, excludeColumnName)\n  const rightFiltered = extractFiltersExceptColumn(compositeFilter.right, excludeColumnName)\n\n  // Rebuild composite filter\n  if (!leftFiltered && !rightFiltered) return null\n  if (!leftFiltered) return rightFiltered\n  if (!rightFiltered) return leftFiltered\n\n  return {\n    type: 'composite',\n    left: leftFiltered,\n    right: rightFiltered,\n    operator: compositeFilter.operator\n  } as CompositeFilter\n}\n\n//  HELPER: Extract currently selected values for a column from filter expression\nfunction extractSelectedValuesForColumn(filter: FilterExpression | null | undefined, columnName: string): Set<string> {\n  const selectedValues = new Set<string>()\n\n  //  FIX: Handle undefined filter expression (early initialization)\n  if (filter === null || filter === undefined) return selectedValues\n\n  function traverse(expr: FilterExpression) {\n    if (expr.type === 'simple') {\n      const simpleFilter = expr as SimpleFilter\n      if (simpleFilter.columnName === columnName && simpleFilter.operator === 'Equals') {\n        selectedValues.add(String(simpleFilter.value))\n      }\n    } else {\n      const compositeFilter = expr as CompositeFilter\n      //  FIX: Prechdzaj VETKY vetvy (AND aj OR)\n      // Pre checkbox filter: hodnoty pre jeden stpec s spojen OR\n      // Rzne stpce s spojen AND\n      // Musme prejs cez AND, aby sme nali OR vetvy pre n stpec\n      traverse(compositeFilter.left)\n      traverse(compositeFilter.right)\n    }\n  }\n\n  traverse(filter)\n  return selectedValues\n}\n\n// Get unique values for a column with counts\n//  VARIANTA 3 FIX: Shows ALL unique values (with filters applied EXCEPT filter for this column)\n// REASON: User should see all possible values, not just currently filtered ones\n// EXAMPLE: If \"Status\" filtered to [\"Active\"], flyout should show [Active, Pending, Completed], not just [Active]\nfunction getUniqueValues(columnName: string): FilterValue[] {\n  try {\n    //  FIX: Wrap in try-catch for error handling and debugging\n    console.log(`[getUniqueValues] Starting for column: ${columnName}`)\n\n    //  FIX: Early return if store or rows are not initialized\n    if (!store || !store.rows) {\n      console.warn(`[getUniqueValues] Store or rows not initialized yet, returning empty array`)\n      return []\n    }\n\n    //  FIX: Special handling for Checkbox column\n    if (columnName === '__checkbox') {\n      // Checkbox column - return true/false options\n      // Apply filters from other columns to count correctly\n      const filtersExceptThisColumn = extractFiltersExceptColumn(store.filterExpression, columnName)\n      console.log(`[getUniqueValues] Checkbox - Has filters to apply: ${!!filtersExceptThisColumn}`)\n\n      const allRows = store.rows\n      console.log(`[getUniqueValues] Checkbox - Total rows before filtering: ${allRows.length}`)\n\n      //  FIX: Pass store to filterRowsHelper so it can access checkbox state\n      const filteredRows = filtersExceptThisColumn ? filterRowsHelper(allRows, filtersExceptThisColumn, store) : allRows\n      console.log(`[getUniqueValues] Checkbox - Total rows after filtering: ${filteredRows.length}`)\n\n      //  DEBUG: Log first few rows to see checkbox values\n      const sampleSize = Math.min(3, filteredRows.length)\n      for (let i = 0; i < sampleSize; i++) {\n        const cell = filteredRows[i].cells.find(c => c.columnName === '__checkbox')\n        console.log(`[getUniqueValues] Checkbox - Row ${i}: cell=${!!cell}, value=${cell?.value}, type=${typeof cell?.value}`)\n      }\n\n      const trueCount = filteredRows.filter(row => {\n        //  FIX: Checkbox state je v store.checkedRows, NIE v row.cells\n        return store.isRowChecked(row.rowId)\n      }).length\n\n      const falseCount = filteredRows.length - trueCount\n\n      const currentlySelectedValues = extractSelectedValuesForColumn(store.filterExpression, columnName)\n\n      console.log(`[getUniqueValues] Checkbox column: true=${trueCount}, false=${falseCount}, selected=${Array.from(currentlySelectedValues)}`)\n\n      return [\n        {\n          value: 'true',\n          isSelected: currentlySelectedValues.has('true'),\n          count: trueCount,\n          displayText: ` Checked (${trueCount})`\n        },\n        {\n          value: 'false',\n          isSelected: currentlySelectedValues.has('false'),\n          count: falseCount,\n          displayText: ` Unchecked (${falseCount})`\n        }\n      ]\n    }\n\n    //  Normal columns processing\n    const valueMap = new Map<string, number>()\n\n    //  VARIANTA 3 FIX: Extract filters EXCEPT filter for this column\n    const filtersExceptThisColumn = extractFiltersExceptColumn(store.filterExpression, columnName)\n    console.log(`[getUniqueValues] Has filters to apply for '${columnName}': ${!!filtersExceptThisColumn}`)\n\n    //  VARIANTA 3 FIX: Load ALL rows (without any filtering)\n    const allRows = store.rows\n\n    //  VARIANTA 3 FIX: Apply filters manually (all EXCEPT this column's filter)\n    //  FIX: Pass store to filterRowsHelper so it can access checkbox state\n    const filteredRows = filtersExceptThisColumn ? filterRowsHelper(allRows, filtersExceptThisColumn, store) : allRows\n\n    console.log(`[getUniqueValues] Column=${columnName}, AllRows=${allRows.length}, FilteredRows=${filteredRows.length}`)\n\n    // Extract unique values from filtered rows\n    filteredRows.forEach(row => {\n      const cell = row.cells.find(c => c.columnName === columnName)\n      const value = cell?.value?.toString() ?? ''\n      valueMap.set(value, (valueMap.get(value) || 0) + 1)\n    })\n\n    // Get currently selected values for this column (to mark checkboxes as checked)\n    const currentlySelectedValues = extractSelectedValuesForColumn(store.filterExpression, columnName)\n\n    console.log(`[getUniqueValues] Column=${columnName}, UniqueValues=${valueMap.size}, SelectedValues=${currentlySelectedValues.size}`)\n\n    const result = Array.from(valueMap.entries())\n      .map(([value, count]) => {\n        // Display empty values as \"(Empty)\"\n        const displayValue = value === '' ? '(Empty)' : value\n        return {\n          value,\n          isSelected: currentlySelectedValues.has(value), //  Mark checkbox based on current filter\n          count,\n          displayText: `${displayValue} (${count})`\n        }\n      })\n      .sort((a, b) => {\n        // Sort empty values to bottom\n        if (a.value === '' && b.value !== '') return 1\n        if (a.value !== '' && b.value === '') return -1\n        return a.value.localeCompare(b.value)\n      })\n\n    console.log(`[getUniqueValues] Returning ${result.length} unique values`)\n    return result\n  } catch (error) {\n    console.error(`[getUniqueValues] ERROR for column '${columnName}':`, error)\n    console.error(`[getUniqueValues] Filter expression at time of error:`, store.filterExpression)\n    console.error(`[getUniqueValues] Stack trace:`, error instanceof Error ? error.stack : 'No stack trace')\n    // Return empty array to prevent UI crash\n    return []\n  }\n}\n\nfunction handleShowFilter(columnName: string) {\n  try {\n    console.log(`[handleShowFilter] START for column: ${columnName}`)\n\n    //  Check if grid is ready\n    if (!isGridReady.value) {\n      console.error(`[handleShowFilter] Grid not ready yet`)\n      alert('Please wait for the grid to finish loading before opening filters.')\n      return\n    }\n\n    //  Check if processing (validation/AutoRowHeight)\n    if (isProcessing.value) {\n      console.error(`[handleShowFilter] Grid is currently processing data`)\n      alert('Please wait while data is being processed...')\n      return\n    }\n\n    //  Check if column exists and is filterable\n    const column = dataColumns.value.find(c => c.name === columnName)\n    if (!column) {\n      console.error(`[handleShowFilter] Column not found: ${columnName}`)\n      return\n    }\n\n    if (!column.isFilterable) {\n      console.warn(`[handleShowFilter] Column '${columnName}' is not filterable`)\n      return\n    }\n\n    //  Check if column has visibleForGrid=false (should not be filtered)\n    if (column.visibleForGrid === false) {\n      console.warn(`[handleShowFilter] Column '${columnName}' has visibleForGrid=false, filtering not allowed`)\n      return\n    }\n\n    //  Check if store is initialized\n    if (!store || !store.rows || store.rows.length === 0) {\n      console.error(`[handleShowFilter] Store not initialized or no data`)\n      alert('Please load data before opening filters.')\n      return\n    }\n\n    // Get unique values for the column\n    const uniqueValues = getUniqueValues(columnName)\n    console.log(`[handleShowFilter] Got ${uniqueValues.length} unique values`)\n\n    // Calculate position (centered on screen for now)\n    const position = {\n      x: window.innerWidth / 2 - 200, // 200 is roughly half the flyout width\n      y: window.innerHeight / 2 - 300 // 300 is roughly half the flyout height\n    }\n\n    filterFlyout.value = {\n      visible: true,\n      columnName,\n      position,\n      uniqueValues,\n      mode: 'checkbox',\n      pattern: ''\n    }\n\n    console.log(`[handleShowFilter] Filter flyout opened successfully`)\n  } catch (error) {\n    console.error(`[handleShowFilter] CRITICAL ERROR for column '${columnName}':`, error)\n    console.error(`[handleShowFilter] Stack trace:`, error instanceof Error ? error.stack : 'No stack trace')\n    alert(`Error opening filter for column '${columnName}': ${error instanceof Error ? error.message : String(error)}`)\n  }\n}\n\nfunction closeFilterFlyout() {\n  filterFlyout.value.visible = false\n}\n\n// Helper: Extract filters grouped by column from a filter expression tree\n// Returns a Map where key is columnName and value is the filter expression for that column\nfunction extractColumnFilters(filter: FilterExpression | null): Map<string, FilterExpression> {\n  const columnFilters = new Map<string, FilterExpression>()\n\n  function traverse(expr: FilterExpression, isAndContext: boolean) {\n    if (expr.type === 'simple') {\n      const simple = expr as SimpleFilter\n      // In AND context at top level, this is a separate column filter\n      if (isAndContext) {\n        columnFilters.set(simple.columnName, expr)\n      }\n      return simple.columnName\n    } else {\n      const composite = expr as CompositeFilter\n\n      if (composite.operator === 'AND') {\n        // AND operator separates different columns\n        traverse(composite.left, true)\n        traverse(composite.right, true)\n        return null\n      } else {\n        // OR operator keeps same column together\n        const leftCol = traverse(composite.left, false)\n        const rightCol = traverse(composite.right, false)\n\n        // Both sides should be same column in OR\n        const columnName = leftCol || rightCol\n        if (columnName && isAndContext) {\n          columnFilters.set(columnName, expr)\n        }\n        return columnName\n      }\n    }\n  }\n\n  if (filter) {\n    traverse(filter, true)\n  }\n\n  return columnFilters\n}\n\n// Helper: Combine multiple filters with AND operator\nfunction combineFiltersWithAnd(filters: FilterExpression[]): FilterExpression | null {\n  //  FIX: Filter out null/undefined values to prevent corrupted filter structures\n  const validFilters = filters.filter(f => f != null)\n\n  if (validFilters.length === 0) return null\n  if (validFilters.length === 1) return validFilters[0]\n\n  let result = validFilters[0]\n  for (let i = 1; i < validFilters.length; i++) {\n    result = {\n      type: 'composite',\n      left: result,\n      right: validFilters[i],\n      operator: 'AND'\n    } as CompositeFilter\n  }\n\n  return result\n}\n\n// Helper: Combine a new filter with existing filters (per-column replacement + cumulative)\nfunction combineWithExistingFilters(newColumnFilter: FilterExpression, columnName: string): FilterExpression {\n  // Get current filter expression\n  const currentFilter = store.filterExpression\n\n  // Extract filters grouped by column\n  const columnFilters = extractColumnFilters(currentFilter)\n\n  // Replace or add the filter for this column\n  columnFilters.set(columnName, newColumnFilter)\n\n  // Combine all column filters with AND\n  const allFilters = Array.from(columnFilters.values())\n  return combineFiltersWithAnd(allFilters) || newColumnFilter\n}\n\nfunction handleApplyCheckboxFilter(selectedValues: string[]) {\n  const columnName = filterFlyout.value.columnName\n\n  if (selectedValues.length === 0) {\n    // No values selected = remove filter for this column only\n    const columnFilters = extractColumnFilters(store.filterExpression)\n    columnFilters.delete(columnName)\n\n    if (columnFilters.size === 0) {\n      store.clearFilter()\n    } else {\n      const allFilters = Array.from(columnFilters.values())\n      const combinedFilter = combineFiltersWithAnd(allFilters)\n      store.setFilter(combinedFilter)\n    }\n  } else {\n    //  FIX: Convert string values to boolean for Checkbox column\n    const filterValues = columnName === '__checkbox'\n      ? selectedValues.map(v => v === 'true')\n      : selectedValues\n\n    // Build new filter for this column\n    let newColumnFilter: FilterExpression\n\n    if (filterValues.length === 1) {\n      // Single value - use simple filter\n      newColumnFilter = {\n        type: 'simple',\n        columnName,\n        operator: 'Equals',\n        value: filterValues[0]\n      } as SimpleFilter\n    } else {\n      // Multiple values - build composite OR filter\n      newColumnFilter = {\n        type: 'simple',\n        columnName,\n        operator: 'Equals',\n        value: filterValues[0]\n      } as SimpleFilter\n\n      for (let i = 1; i < filterValues.length; i++) {\n        newColumnFilter = {\n          type: 'composite',\n          left: newColumnFilter,\n          right: {\n            type: 'simple',\n            columnName,\n            operator: 'Equals',\n            value: filterValues[i]\n          } as SimpleFilter,\n          operator: 'OR'\n        } as CompositeFilter\n      }\n    }\n\n    // Combine with existing filters from other columns\n    const combinedFilter = combineWithExistingFilters(newColumnFilter, columnName)\n    store.setFilter(combinedFilter)\n  }\n\n  console.log(`Applied checkbox filter to ${columnName}:`, selectedValues, 'Final filter:', store.filterExpression)\n}\n\nfunction handleApplyRegexFilter(pattern: string) {\n  const columnName = filterFlyout.value.columnName\n\n  if (!pattern) {\n    // Empty pattern = remove filter for this column only\n    const columnFilters = extractColumnFilters(store.filterExpression)\n    columnFilters.delete(columnName)\n\n    if (columnFilters.size === 0) {\n      store.clearFilter()\n    } else {\n      const allFilters = Array.from(columnFilters.values())\n      const combinedFilter = combineFiltersWithAnd(allFilters)\n      store.setFilter(combinedFilter)\n    }\n    return\n  }\n\n  // Note: Full regex support is not available in the declarative filter system\n  // Using 'Contains' operator as a simplified pattern match\n  // For more complex patterns, a custom filter operator would need to be added\n  const newColumnFilter: SimpleFilter = {\n    type: 'simple',\n    columnName,\n    operator: 'Contains',\n    value: pattern\n  }\n\n  // Combine with existing filters from other columns\n  const combinedFilter = combineWithExistingFilters(newColumnFilter, columnName)\n  store.setFilter(combinedFilter)\n\n  console.log(`Applied text contains filter to ${columnName}:`, pattern, 'Final filter:', store.filterExpression)\n}\n\nfunction handleClearFilter() {\n  const columnName = filterFlyout.value.columnName\n\n  // Remove filter for this column only\n  const columnFilters = extractColumnFilters(store.filterExpression)\n  columnFilters.delete(columnName)\n\n  if (columnFilters.size === 0) {\n    store.clearFilter()\n  } else {\n    const allFilters = Array.from(columnFilters.values())\n    const combinedFilter = combineFiltersWithAnd(allFilters)\n    store.setFilter(combinedFilter)\n  }\n\n  console.log(`Cleared filter for ${columnName}`, 'Final filter:', store.filterExpression)\n}\n\n// Auto Row Height handlers\nasync function toggleAutoRowHeight() {\n  try {\n    console.log('[toggleAutoRowHeight] ========== FUNCTION CALLED ==========')\n    console.log(`[toggleAutoRowHeight] Current state: ${store.isAutoRowHeightEnabled}`)\n    console.log('[toggleAutoRowHeight] Rows BEFORE:', store.rows.slice(0, 5).map(r => ({ id: r.rowId, height: r.height })))\n\n    const newValue = !store.isAutoRowHeightEnabled\n    console.log(`[toggleAutoRowHeight] New state will be: ${newValue}`)\n\n    store.setAutoRowHeightEnabled(newValue)\n    console.log('[toggleAutoRowHeight] Store updated')\n\n    if (newValue) {\n      // Apply heights immediately to all existing rows\n      console.log('[toggleAutoRowHeight] Enabled - applying heights to all rows...')\n      await applyAutoRowHeightToAll()\n      console.log('[toggleAutoRowHeight] Heights applied successfully')\n    } else {\n      // Reset all rows to default height when disabling\n      console.log('[toggleAutoRowHeight] Disabled - resetting all row heights...')\n      await resetAllRowHeights()\n      console.log('[toggleAutoRowHeight] Heights reset successfully')\n    }\n\n    console.log('[toggleAutoRowHeight] Rows AFTER:', store.rows.slice(0, 5).map(r => ({ id: r.rowId, height: r.height })))\n    console.log('[toggleAutoRowHeight] ========== FUNCTION COMPLETED ==========')\n  } catch (error) {\n    console.log(`[toggleAutoRowHeight]  ERROR: ${error}`)\n    console.log(`[toggleAutoRowHeight] Error stack: ${error instanceof Error ? error.stack : 'N/A'}`)\n  }\n}\n\nasync function applyAutoRowHeightToAll() {\n  // Pass ALL columns but skip ValidationAlerts to avoid inflated heights\n  // ValidationAlerts uses ellipsis, doesn't need measurement\n  const columnsForMeasurement = allColumns.value\n    .filter(col => !col.specialType || col.specialType !== 'ValidationAlerts')\n    .map(col => ({\n      name: col.name,\n      width: col.width,\n      specialType: col.specialType\n    }))\n\n  console.log('[applyAutoRowHeightToAll] ========== START ==========')\n  console.log('[applyAutoRowHeightToAll] AutoRowHeight is ON')\n\n  // Log ALL row heights BEFORE changes\n  const heightsBefore = store.rows.map(r => ({ rowId: r.rowId, heightBefore: r.height }))\n  console.log('[applyAutoRowHeightToAll] BEFORE - All row heights:', heightsBefore.slice(0, 10))\n\n  console.log('[applyAutoRowHeightToAll] Measuring columns:', columnsForMeasurement.map(c => `${c.name} (${c.width}px, special: ${c.specialType || 'none'})`).join(', '))\n\n  const result = await autoRowHeight.applyAutoRowHeight(store.rows, columnsForMeasurement)\n\n  // Log ALL row heights AFTER changes and compare\n  const heightsAfter = store.rows.map((r, i) => ({\n    rowId: r.rowId,\n    heightBefore: heightsBefore[i].heightBefore,\n    heightAfter: r.height,\n    changed: heightsBefore[i].heightBefore !== r.height\n  }))\n\n  console.log('[applyAutoRowHeightToAll] AFTER - All row heights (first 10):', heightsAfter.slice(0, 10))\n  console.log('[applyAutoRowHeightToAll] Changed rows:', heightsAfter.filter(h => h.changed).length)\n  console.log(`[applyAutoRowHeightToAll] Summary: ${result.totalRowsUpdated} rows updated, average height: ${result.averageHeight.toFixed(1)}px`)\n\n  // CRITICAL FIX: Force Vue reactivity by reassigning rows array\n  // This ensures DynamicScroller detects the height changes\n  console.log('[applyAutoRowHeightToAll] Forcing Vue reactivity by reassigning rows array...')\n  store.rows = [...store.rows]\n\n  // CRITICAL: Wait for Vue to update DOM before forcing scroller update\n  await nextTick()\n  console.log('[applyAutoRowHeightToAll] First nextTick complete')\n\n  // Double nextTick to ensure all reactive updates complete\n  await nextTick()\n  console.log('[applyAutoRowHeightToAll] Second nextTick complete')\n\n  // Triple nextTick for good measure\n  await nextTick()\n  console.log('[applyAutoRowHeightToAll] Third nextTick complete')\n\n  // Small delay to ensure DynamicScroller has processed all changes\n  await new Promise(resolve => setTimeout(resolve, 50))\n  console.log('[applyAutoRowHeightToAll] Delay complete, calling forceUpdate...')\n\n  // Then force DynamicScroller to recalculate sizes\n  if (scrollerRef.value) {\n    scrollerRef.value.forceUpdate()\n    console.log('[applyAutoRowHeightToAll] DynamicScroller forceUpdate() called')\n  } else {\n    console.log('[applyAutoRowHeightToAll] ERROR: scrollerRef is null, cannot forceUpdate')\n  }\n\n  console.log('[applyAutoRowHeightToAll] ========== COMPLETE ==========')\n}\n\nasync function resetAllRowHeights() {\n  console.log('[resetAllRowHeights] START - AutoRowHeight is OFF, resetting to default height')\n\n  // When AutoRowHeight is OFF, reset ALL rows to default height\n  // Do NOT calculate heights based on validation text - that only happens when AutoRowHeight is ON\n  let rowsProcessed = 0\n  const defaultHeight = 32\n\n  store.rows.forEach((row) => {\n    row.height = defaultHeight\n    rowsProcessed++\n  })\n\n  console.log('[resetAllRowHeights] Summary:', {\n    totalRows: rowsProcessed,\n    resetToHeight: defaultHeight\n  })\n\n  console.log('[resetAllRowHeights] All row heights reset to default')\n\n  // CRITICAL FIX: Force Vue reactivity by reassigning rows array\n  console.log('[resetAllRowHeights] Forcing Vue reactivity by reassigning rows array...')\n  store.rows = [...store.rows]\n\n  // CRITICAL: Wait for Vue to update DOM before forcing scroller update\n  await nextTick()\n  console.log('[resetAllRowHeights] First nextTick complete')\n\n  // Double nextTick to ensure all reactive updates complete\n  await nextTick()\n  console.log('[resetAllRowHeights] Second nextTick complete')\n\n  // Triple nextTick for good measure\n  await nextTick()\n  console.log('[resetAllRowHeights] Third nextTick complete')\n\n  // Small delay to ensure DynamicScroller has processed all changes\n  await new Promise(resolve => setTimeout(resolve, 50))\n  console.log('[resetAllRowHeights] Delay complete, calling forceUpdate...')\n\n  // Then force DynamicScroller to recalculate sizes\n  if (scrollerRef.value) {\n    scrollerRef.value.forceUpdate()\n    console.log('[resetAllRowHeights] DynamicScroller forceUpdate() called')\n  } else {\n    console.log('[resetAllRowHeights] ERROR: scrollerRef is null, cannot forceUpdate')\n  }\n\n  console.log('[resetAllRowHeights] COMPLETE')\n}\n\nasync function recalculateRowHeightAfterEdit(rowId: string) {\n  if (!store.isAutoRowHeightEnabled) return\n\n  // Skip ValidationAlerts column from measurement - validation messages use ellipsis\n  const columnsForMeasurement = allColumns.value\n    .filter(col => !col.specialType || col.specialType !== 'ValidationAlerts')\n    .map(col => ({\n      name: col.name,\n      width: col.width,\n      specialType: col.specialType\n    }))\n\n  const row = store.rows.find(r => r.rowId === rowId)\n  if (!row) return\n\n  const updatedCount = autoRowHeight.recalculateRows(store.rows, [rowId], columnsForMeasurement)\n\n  if (updatedCount > 0 && row) {\n    // CRITICAL: Force Vue reactivity by reassigning through store\n    store.updateRowHeight(rowId, row.height)\n\n    // CRITICAL: Force array reassignment to trigger Vue reactivity\n    store.rows = [...store.rows]\n\n    await nextTick()\n  }\n}\n\n/**\n * Calculates row height based on newlines when AutoRowHeight is OFF\n * Only counts explicit newlines (\\n), doesn't wrap by spaces\n */\nasync function recalculateRowHeightForNewlines(rowId: string) {\n  const row = store.rows.find(r => r.rowId === rowId)\n  if (!row) return\n\n  let maxLines = 1\n\n  // Check all data cells for newlines\n  for (const cell of row.cells) {\n    if (cell.value == null) continue\n\n    const textValue = String(cell.value)\n    if (textValue.includes('\\n')) {\n      // Count lines (split by \\n)\n      const lines = textValue.split('\\n').length\n      maxLines = Math.max(maxLines, lines)\n    }\n  }\n\n  // Calculate height: lineHeight (21px) * lines + vertical padding (10px)\n  const lineHeight = 21  // 14px font-size * 1.5 line-height\n  const verticalPadding = 10  // 5px top + 5px bottom\n  const calculatedHeight = maxLines * lineHeight + verticalPadding\n\n  // Update row height\n  store.updateRowHeight(rowId, calculatedHeight)\n  store.rows = [...store.rows]\n  await nextTick()\n}\n\n// Backend API handlers\nasync function checkBackendConnection() {\n  logger.debug(' Checking backend connection...')\n\n  try {\n    isBackendConnected.value = await gridApi.healthCheck()\n\n    if (isBackendConnected.value) {\n      logger.info(' Backend connected')\n    } else {\n      logger.warn(' Backend disconnected')\n    }\n  } catch (error: any) {\n    logger.error(' Backend connection check failed', {\n      error: error?.message || error?.toString() || 'Unknown error',\n      stack: error?.stack\n    })\n    isBackendConnected.value = false\n  }\n}\n\nasync function loadDataFromBackend() {\n  isLoadingFromBackend.value = true\n\n  try {\n    const response = await gridApi.getData()\n\n    if (response.success && response.data) {\n      // Convert backend data format to store format\n      const rows = response.data.map((row, index) => ({\n        ...row,\n        __rowId: row.__rowId || `row-${Date.now()}-${index}`,\n        __rowIndex: index\n      }))\n\n      store.loadRows(rows)\n\n      console.log(`Loaded ${rows.length} rows from backend`)\n\n      // Validate all cells after loading data if auto-validation is enabled\n      if (store.config.autoValidate && store.config.enableValidation) {\n        console.log('[DataGrid] Auto-validation enabled - validating loaded data')\n        await validateAllCellsInBatches()\n      }\n    } else {\n      console.error('Failed to load data from backend:', response.error)\n      alert(`Failed to load data: ${response.error}`)\n    }\n  } catch (error) {\n    console.error('Error loading data from backend:', error)\n    alert(`Error loading data: ${error instanceof Error ? error.message : 'Unknown error'}`)\n  } finally {\n    isLoadingFromBackend.value = false\n  }\n}\n\nasync function saveDataToBackend() {\n  isSavingToBackend.value = true\n\n  try {\n    // Extract data columns only\n    const data = store.rows.map(row => {\n      const rowData: Record<string, any> = {}\n\n      dataColumns.value.forEach(col => {\n        if (!col.specialType) {\n          const cell = row.cells.find(c => c.columnName === col.name)\n          if (cell) {\n            rowData[col.name] = cell.value\n          }\n        }\n      })\n\n      return rowData\n    })\n\n    const response = await gridApi.importData(data)\n\n    if (response.success) {\n      console.log(`Saved ${data.length} rows to backend`)\n    } else {\n      console.error('Failed to save data to backend:', response.error)\n      alert(`Failed to save data: ${response.error}`)\n    }\n  } catch (error) {\n    console.error('Error saving data to backend:', error)\n    alert(`Error saving data: ${error instanceof Error ? error.message : 'Unknown error'}`)\n  } finally {\n    isSavingToBackend.value = false\n  }\n}\n\n// Import/Export handlers\n// async function handleExportToJson() {\n//   const rows = store.rows.map(row => {\n//     const rowData: Record<string, any> = {}\n\n//     // Extract data columns only (exclude special columns)\n//     dataColumns.value.forEach(col => {\n//       if (!col.specialType) {\n//         const cell = row.cells.find(c => c.columnName === col.name)\n//         if (cell) {\n//           rowData[col.name] = cell.value\n//         }\n//       }\n//     })\n\n//     return rowData\n//   })\n\n//   const columnNames = getDataColumnNames()\n//   const result = importExport.exportToJson(rows, columnNames, {\n//     prettify: true,\n//     includeHiddenColumns: false,\n//     includeSpecialComponents: false\n//   })\n\n//   console.log(result.message)\n// }\n\nasync function handleImportFromJson(mode: ImportMode = ImportMode.Append) {\n  const currentRows = store.rows.map(row => {\n    const rowData: Record<string, any> = { __rowId: row.rowId, __rowIndex: row.rowIndex }\n\n    row.cells.forEach(cell => {\n      rowData[cell.columnName] = cell.value\n    })\n\n    return rowData\n  })\n\n  const columnNames = getDataColumnNames()\n  const result = await importExport.openImportDialog(currentRows, columnNames, {\n    mode,\n    validateSchema: true\n  })\n\n  if (result.success && result.rows) {\n    console.log(result.message)\n\n    // Load the imported rows into the store\n    store.loadRows(result.rows)\n\n    console.log(`Successfully imported ${result.rowsImported} rows into grid`)\n  } else {\n    console.error('Import failed:', result.errors)\n    alert(`Import failed: ${result.message}\\n${result.errors.join('\\n')}`)\n  }\n}\n\n// Merge theme with defaults\nconst mergedTheme = computed(() => {\n  return {\n    ...defaultDataGridTheme,\n    cellColors: { ...defaultDataGridTheme.cellColors, ...(props.theme?.cellColors || {}) },\n    rowColors: { ...defaultDataGridTheme.rowColors, ...(props.theme?.rowColors || {}) },\n    headerColors: { ...defaultDataGridTheme.headerColors, ...(props.theme?.headerColors || {}) },\n    validationColors: { ...defaultDataGridTheme.validationColors, ...(props.theme?.validationColors || {}) },\n    selectionColors: { ...defaultDataGridTheme.selectionColors, ...(props.theme?.selectionColors || {}) },\n    borderColors: { ...defaultDataGridTheme.borderColors, ...(props.theme?.borderColors || {}) },\n    specialColumnColors: { ...defaultDataGridTheme.specialColumnColors, ...(props.theme?.specialColumnColors || {}) },\n    uiControlColors: { ...defaultDataGridTheme.uiControlColors, ...(props.theme?.uiControlColors || {}) }\n  }\n})\n\n// Generate CSS variables from theme and add minTableWidth, width, height\nconst cssVariables = computed(() => {\n  const themeVars = generateDataGridCSSVariables(mergedTheme.value)\n  return {\n    ...themeVars,\n    '--dg-min-table-width': props.minTableWidth ? `${props.minTableWidth}px` : 'fit-content',\n    width: props.width || '100%',\n    height: props.height || '600px'\n  }\n})\n\n// Enhanced validation API with tracking and auto-validate support\nconst enhancedValidation = {\n  ...validation,\n\n  /**\n   * Validates only cells that need validation (changed or unvalidated)\n   * Returns true if all non-empty cells are valid\n   * Respects autoValidate config\n   */\n  async validateRequired(): Promise<boolean> {\n    if (!store.config.enableValidation) {\n      return true\n    }\n\n    const cellsToValidate = store.getCellsNeedingValidation()\n\n    if (cellsToValidate.length === 0) {\n      // Nothing to validate - return current validation state\n      return store.areNonEmptyRowsValid()\n    }\n\n    // Validate each cell that needs validation\n    for (const { rowId, columnName } of cellsToValidate) {\n      const row = store.rows.find(r => r.rowId === rowId)\n      if (!row) continue\n\n      const cell = row.cells.find(c => c.columnName === columnName)\n      if (!cell) continue\n\n      // Validate the cell using existing validation rules\n      await validation.validateCell(rowId, columnName, cell.value)\n\n      // Mark as validated\n      store.markCellValidated(rowId, columnName)\n    }\n\n    return store.areNonEmptyRowsValid()\n  },\n\n  /**\n   * Checks if all non-empty rows are valid (without running validation)\n   * Returns true if valid, false if there are errors\n   */\n  isAllValid(): boolean {\n    return store.areNonEmptyRowsValid()\n  },\n\n  /**\n   * Forces validation of all cells regardless of tracking\n   * Returns true if all non-empty cells are valid\n   */\n  async validateAll(rows?: any[]): Promise<{ isValid: boolean; totalErrors: number }> {\n    if (!store.config.enableValidation) {\n      return { isValid: true, totalErrors: 0 }\n    }\n\n    // Use original validateAll method\n    const result = await validation.validateAll(rows || store.rows)\n\n    // Clear tracking and mark all cells as validated\n    store.clearValidationTracking()\n\n    for (const row of store.rows) {\n      for (const cell of row.cells) {\n        store.markCellValidated(cell.rowId, cell.columnName)\n      }\n    }\n\n    return result\n  }\n}\n\n// Expose validation, copy/paste, shortcuts, and backend API methods to parent components\ndefineExpose({\n  validation: enhancedValidation,\n  copyPaste,\n  shortcuts,\n  handleCopy,\n  handlePaste,\n  handleCut,\n  loadDataFromBackend,\n  saveDataToBackend,\n  checkBackendConnection\n})\n</script>\n\n<style scoped>\n.data-grid {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  border: 1px solid var(--dg-border-grid, #ddd);\n  background-color: var(--dg-cell-bg, white);\n  border-radius: 4px;\n  overflow: hidden;\n  position: relative; /* For absolute positioning of overlay */\n}\n\n/* Loading overlay during processing */\n.processing-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(2px);\n}\n\n.processing-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  background-color: white;\n  padding: 32px 48px;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.processing-spinner {\n  width: 48px;\n  height: 48px;\n  border: 4px solid var(--dg-border-cell, #e0e0e0);\n  border-top-color: var(--dg-header-sort-indicator, #2196f3);\n  border-radius: 50%;\n  animation: spinner-rotate 0.8s linear infinite;\n}\n\n@keyframes spinner-rotate {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n.processing-text {\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--dg-cell-fg, #212529);\n  white-space: nowrap;\n}\n\n.hidden-columns-panel {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background-color: var(--dg-validation-warning-bg, #fff3cd);\n  border-bottom: 1px solid var(--dg-validation-warning-border, #ffc107);\n  font-size: 13px;\n}\n\n.hidden-columns-label {\n  font-weight: 500;\n  color: var(--dg-validation-warning-fg, #856404);\n}\n\n.show-column-button,\n.show-all-button {\n  padding: 4px 12px;\n  background-color: var(--dg-ui-pagination-bg, white);\n  border: 1px solid var(--dg-border-cell, #ccc);\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  color: var(--dg-ui-pagination-fg, #212529);\n  transition: all 0.2s;\n}\n\n.show-column-button:hover,\n.show-all-button:hover {\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\n  border-color: var(--dg-header-sort-indicator, #2196f3);\n}\n\n.show-all-button {\n  font-weight: 500;\n  background-color: var(--dg-header-sort-indicator, #2196f3);\n  color: white;\n  border-color: var(--dg-header-sort-indicator, #2196f3);\n  margin-left: auto;\n}\n\n.show-all-button:hover {\n  background-color: #1976d2;\n  border-color: #1976d2;\n  color: white;\n}\n\n.grid-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  width: 100%; /* CRITICAL: Fill full width of parent */\n  min-width: 100%; /* CRITICAL: Ensure table fills full width */\n}\n\n.scroller {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: auto; /* Enable horizontal scroll when table is wider than container */\n}\n\n/* Scrollbar styling - vertical */\n.scroller::-webkit-scrollbar {\n  width: 8px;\n  height: 8px; /* Height for horizontal scrollbar */\n}\n\n.scroller::-webkit-scrollbar-track {\n  background: var(--dg-ui-pagination-bg, #f1f1f1);\n}\n\n.scroller::-webkit-scrollbar-thumb {\n  background: var(--dg-border-cell, #c1c1c1);\n  border-radius: 4px;\n}\n\n.scroller::-webkit-scrollbar-thumb:hover {\n  background: var(--dg-ui-resize-grip, #a8a8a8);\n}\n</style>\n","<template>\r\n  <div class=\"listbox-container\">\r\n    <div v-if=\"title\" class=\"listbox-title\">{{ title }}</div>\r\n    <div\r\n      class=\"listbox\"\r\n      :class=\"{ 'listbox--multi': multiSelect }\"\r\n      :style=\"listboxStyle\"\r\n    >\r\n      <div\r\n        v-for=\"item in items\"\r\n        :key=\"item.value\"\r\n        class=\"listbox-item\"\r\n        :class=\"{\r\n          'listbox-item--selected': isSelected(item.value),\r\n          'listbox-item--hover': hoveredValue === item.value\r\n        }\"\r\n        @click=\"handleItemClick(item)\"\r\n        @mouseenter=\"hoveredValue = item.value\"\r\n        @mouseleave=\"hoveredValue = null\"\r\n      >\r\n        <input\r\n          v-if=\"multiSelect\"\r\n          type=\"checkbox\"\r\n          :checked=\"isSelected(item.value)\"\r\n          class=\"listbox-checkbox\"\r\n          @click.stop=\"handleItemClick(item)\"\r\n        />\r\n        <span class=\"listbox-item-text\">{{ item.name }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch } from 'vue'\r\nimport { generateListBoxCSSVariables, defaultListBoxTheme } from '@/composables/useTheme'\r\nimport type { ListBoxTheme } from '@/types/theme'\r\n\r\nexport interface ListBoxItem {\r\n  name: string\r\n  value: string\r\n}\r\n\r\nconst props = withDefaults(defineProps<{\r\n  items: ListBoxItem[]\r\n  title?: string\r\n  multiSelect?: boolean\r\n  preSelected?: string[]\r\n  height?: number\r\n  width?: number\r\n  theme?: Partial<ListBoxTheme>  // Optional theme customization\r\n}>(), {\r\n  title: '',\r\n  multiSelect: false,\r\n  preSelected: () => [],\r\n  height: 200,\r\n  width: 250\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  selectionChange: [selectedValues: string[]]\r\n}>()\r\n\r\nconst selectedValues = ref<Set<string>>(new Set())\r\nconst hoveredValue = ref<string | null>(null)\r\n\r\n// Initialize with pre-selected items\r\nwatch(() => props.preSelected, (newPreSelected) => {\r\n  selectedValues.value = new Set(newPreSelected)\r\n}, { immediate: true })\r\n\r\n// Merge theme with defaults\r\nconst mergedTheme = computed(() => {\r\n  return {\r\n    ...defaultListBoxTheme,\r\n    itemColors: { ...defaultListBoxTheme.itemColors, ...(props.theme?.itemColors || {}) },\r\n    containerColors: { ...defaultListBoxTheme.containerColors, ...(props.theme?.containerColors || {}) },\r\n    checkboxColors: { ...defaultListBoxTheme.checkboxColors, ...(props.theme?.checkboxColors || {}) },\r\n    scrollbarColors: { ...defaultListBoxTheme.scrollbarColors, ...(props.theme?.scrollbarColors || {}) }\r\n  }\r\n})\r\n\r\n// Generate CSS variables from theme\r\nconst cssVariables = computed(() => generateListBoxCSSVariables(mergedTheme.value))\r\n\r\nconst listboxStyle = computed(() => ({\r\n  height: `${props.height}px`,\r\n  width: `${props.width}px`,\r\n  ...cssVariables.value\r\n}))\r\n\r\nfunction isSelected(value: string): boolean {\r\n  return selectedValues.value.has(value)\r\n}\r\n\r\nfunction handleItemClick(item: ListBoxItem) {\r\n  if (props.multiSelect) {\r\n    // Multi-select: toggle selection\r\n    if (selectedValues.value.has(item.value)) {\r\n      selectedValues.value.delete(item.value)\r\n    } else {\r\n      selectedValues.value.add(item.value)\r\n    }\r\n  } else {\r\n    // Single-select: clear previous and select this one\r\n    selectedValues.value.clear()\r\n    selectedValues.value.add(item.value)\r\n  }\r\n\r\n  // Emit selection change\r\n  emit('selectionChange', Array.from(selectedValues.value))\r\n}\r\n\r\n// Expose selected values for programmatic access\r\ndefineExpose({\r\n  getSelectedValues: () => Array.from(selectedValues.value),\r\n  clearSelection: () => {\r\n    selectedValues.value.clear()\r\n    emit('selectionChange', [])\r\n  },\r\n  selectValue: (value: string) => {\r\n    if (props.multiSelect) {\r\n      selectedValues.value.add(value)\r\n    } else {\r\n      selectedValues.value.clear()\r\n      selectedValues.value.add(value)\r\n    }\r\n    emit('selectionChange', Array.from(selectedValues.value))\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.listbox-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.listbox-title {\r\n  font-weight: 600;\r\n  font-size: 14px;\r\n  color: var(--lb-title-fg, #212529);\r\n  padding-bottom: 4px;\r\n}\r\n\r\n.listbox {\r\n  border: 1px solid var(--lb-container-border, #ced4da);\r\n  border-radius: 4px;\r\n  overflow-y: auto;\r\n  overflow-x: auto; /* Enable horizontal scroll when content is wider than container */\r\n  background-color: var(--lb-container-bg, white);\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.listbox:focus-within {\r\n  border-color: var(--lb-container-focused-border, #0d6efd);\r\n  box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1);\r\n}\r\n\r\n.listbox-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 8px 12px;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  transition: background-color 0.15s ease;\r\n  border-bottom: 1px solid var(--lb-container-border, #f0f0f0);\r\n  background-color: var(--lb-item-bg, #ffffff);\r\n  color: var(--lb-item-fg, #212529);\r\n}\r\n\r\n.listbox-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.listbox-item--hover {\r\n  background-color: var(--lb-item-hover-bg, #f8f9fa);\r\n  color: var(--lb-item-hover-fg, #212529);\r\n}\r\n\r\n.listbox-item--selected {\r\n  background-color: var(--lb-item-selected-bg, #e3f2fd);\r\n  color: var(--lb-item-selected-fg, #0d6efd);\r\n  border-left: 3px solid var(--lb-container-focused-border, #2196f3);\r\n  padding-left: 9px;\r\n}\r\n\r\n.listbox-item--selected.listbox-item--hover {\r\n  background-color: var(--lb-item-selected-hover-bg, #bbdefb);\r\n  color: var(--lb-item-selected-hover-fg, #0d6efd);\r\n}\r\n\r\n.listbox-checkbox {\r\n  margin-right: 8px;\r\n  cursor: pointer;\r\n  width: 16px;\r\n  height: 16px;\r\n  border: 1px solid var(--lb-checkbox-border, #ced4da);\r\n  background-color: var(--lb-checkbox-bg, #ffffff);\r\n}\r\n\r\n.listbox-checkbox:checked {\r\n  background-color: var(--lb-checkbox-checked-bg, #0d6efd);\r\n  border-color: var(--lb-checkbox-checked-border, #0d6efd);\r\n}\r\n\r\n.listbox-checkbox:hover {\r\n  border-color: var(--lb-checkbox-hover-border, #adb5bd);\r\n}\r\n\r\n.listbox-item-text {\r\n  flex: 1;\r\n  font-size: 14px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n.listbox-item--selected .listbox-item-text {\r\n  font-weight: 500;\r\n}\r\n\r\n/* Scrollbar styling */\r\n.listbox::-webkit-scrollbar {\r\n  width: 8px;\r\n  height: 8px; /* Height for horizontal scrollbar */\r\n}\r\n\r\n.listbox::-webkit-scrollbar-track {\r\n  background: var(--lb-scrollbar-track-bg, #f1f1f1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.listbox::-webkit-scrollbar-thumb {\r\n  background: var(--lb-scrollbar-thumb-bg, #c1c1c1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.listbox::-webkit-scrollbar-thumb:hover {\r\n  background: var(--lb-scrollbar-thumb-hover-bg, #a8a8a8);\r\n}\r\n</style>\r\n","// composables/useSorting.ts\r\nimport { ref } from 'vue'\r\nimport type { GridRow } from '@/stores/dataGridStore'\r\n\r\nexport interface SortColumn {\r\n  columnName: string\r\n  direction: 'asc' | 'desc'\r\n}\r\n\r\nexport function useSorting() {\r\n  const sortColumns = ref<SortColumn[]>([])\r\n\r\n  function sortRows(rows: GridRow[], sorts: SortColumn[]): GridRow[] {\r\n    if (sorts.length === 0) return rows\r\n\r\n    return rows.slice().sort((a, b) => {\r\n      for (const { columnName, direction } of sorts) {\r\n        // Get cell values for comparison\r\n        const aCell = a.cells.find(c => c.columnName === columnName)\r\n        const bCell = b.cells.find(c => c.columnName === columnName)\r\n\r\n        const aVal = aCell?.value\r\n        const bVal = bCell?.value\r\n\r\n        const cmp = compareValues(aVal, bVal)\r\n        if (cmp !== 0) {\r\n          return direction === 'asc' ? cmp : -cmp\r\n        }\r\n      }\r\n      return 0\r\n    })\r\n  }\r\n\r\n  function compareValues(a: any, b: any): number {\r\n    // Null handling\r\n    if (a == null && b == null) return 0\r\n    if (a == null) return -1\r\n    if (b == null) return 1\r\n\r\n    // Number comparison\r\n    if (typeof a === 'number' && typeof b === 'number') {\r\n      return a - b\r\n    }\r\n\r\n    // Date comparison\r\n    const aDate = new Date(a)\r\n    const bDate = new Date(b)\r\n    if (!isNaN(aDate.getTime()) && !isNaN(bDate.getTime())) {\r\n      return aDate.getTime() - bDate.getTime()\r\n    }\r\n\r\n    // String comparison\r\n    const aStr = String(a).toLowerCase()\r\n    const bStr = String(b).toLowerCase()\r\n    return aStr.localeCompare(bStr)\r\n  }\r\n\r\n  function addSort(columnName: string, direction: 'asc' | 'desc', multiSort = false) {\r\n    if (!multiSort) {\r\n      // Single sort - replace all\r\n      sortColumns.value = [{ columnName, direction }]\r\n    } else {\r\n      // Multi sort - add or update\r\n      const existingIdx = sortColumns.value.findIndex(s => s.columnName === columnName)\r\n      if (existingIdx >= 0) {\r\n        // Toggle direction if same column\r\n        sortColumns.value[existingIdx].direction = direction\r\n      } else {\r\n        // Add new sort column\r\n        sortColumns.value.push({ columnName, direction })\r\n      }\r\n    }\r\n  }\r\n\r\n  function removeSort(columnName: string) {\r\n    sortColumns.value = sortColumns.value.filter(s => s.columnName !== columnName)\r\n  }\r\n\r\n  function clearSort() {\r\n    sortColumns.value = []\r\n  }\r\n\r\n  return {\r\n    sortColumns,\r\n    sortRows,\r\n    addSort,\r\n    removeSort,\r\n    clearSort\r\n  }\r\n}\r\n","// composables/useSelection.ts\r\nimport { ref } from 'vue'\r\nimport type { GridRow, GridColumn } from '@/stores/dataGridStore'\r\n\r\nexport interface CellAddress {\r\n  rowId: string\r\n  columnName: string\r\n}\r\n\r\nexport function useSelection() {\r\n  const selectedCells = ref<Set<string>>(new Set())\r\n  const anchorCell = ref<CellAddress | null>(null)\r\n\r\n  function selectCell(rowId: string, columnName: string, mode: 'replace' | 'add' | 'toggle' = 'replace') {\r\n    const cellKey = `${rowId}:${columnName}`\r\n\r\n    if (mode === 'replace') {\r\n      selectedCells.value.clear()\r\n      selectedCells.value.add(cellKey)\r\n      anchorCell.value = { rowId, columnName }\r\n    } else if (mode === 'add') {\r\n      selectedCells.value.add(cellKey)\r\n    } else if (mode === 'toggle') {\r\n      if (selectedCells.value.has(cellKey)) {\r\n        selectedCells.value.delete(cellKey)\r\n      } else {\r\n        selectedCells.value.add(cellKey)\r\n      }\r\n    }\r\n  }\r\n\r\n  function selectRange(startCell: CellAddress, endCell: CellAddress, rows: GridRow[], columns: GridColumn[]) {\r\n    selectedCells.value.clear()\r\n\r\n    const startRowIdx = rows.findIndex(r => r.rowId === startCell.rowId)\r\n    const endRowIdx = rows.findIndex(r => r.rowId === endCell.rowId)\r\n    const startColIdx = columns.findIndex(c => c.name === startCell.columnName)\r\n    const endColIdx = columns.findIndex(c => c.name === endCell.columnName)\r\n\r\n    if (startRowIdx === -1 || endRowIdx === -1 || startColIdx === -1 || endColIdx === -1) {\r\n      return\r\n    }\r\n\r\n    const minRow = Math.min(startRowIdx, endRowIdx)\r\n    const maxRow = Math.max(startRowIdx, endRowIdx)\r\n    const minCol = Math.min(startColIdx, endColIdx)\r\n    const maxCol = Math.max(startColIdx, endColIdx)\r\n\r\n    for (let r = minRow; r <= maxRow; r++) {\r\n      const row = rows[r]\r\n      for (let c = minCol; c <= maxCol; c++) {\r\n        const column = columns[c]\r\n        if (row && column) {\r\n          selectedCells.value.add(`${row.rowId}:${column.name}`)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function selectRow(rowId: string, columns: GridColumn[]) {\r\n    for (const column of columns) {\r\n      selectedCells.value.add(`${rowId}:${column.name}`)\r\n    }\r\n  }\r\n\r\n  function selectColumn(columnName: string, rows: GridRow[]) {\r\n    for (const row of rows) {\r\n      selectedCells.value.add(`${row.rowId}:${columnName}`)\r\n    }\r\n  }\r\n\r\n  function selectAll(rows: GridRow[], columns: GridColumn[]) {\r\n    selectedCells.value.clear()\r\n    for (const row of rows) {\r\n      for (const column of columns) {\r\n        selectedCells.value.add(`${row.rowId}:${column.name}`)\r\n      }\r\n    }\r\n  }\r\n\r\n  function clearSelection() {\r\n    selectedCells.value.clear()\r\n    anchorCell.value = null\r\n  }\r\n\r\n  function getSelectedCells(): CellAddress[] {\r\n    return Array.from(selectedCells.value).map(key => {\r\n      const [rowId, columnName] = key.split(':')\r\n      return { rowId, columnName }\r\n    })\r\n  }\r\n\r\n  function isCellSelected(rowId: string, columnName: string): boolean {\r\n    return selectedCells.value.has(`${rowId}:${columnName}`)\r\n  }\r\n\r\n  return {\r\n    selectedCells,\r\n    anchorCell,\r\n    selectCell,\r\n    selectRange,\r\n    selectRow,\r\n    selectColumn,\r\n    selectAll,\r\n    clearSelection,\r\n    getSelectedCells,\r\n    isCellSelected\r\n  }\r\n}\r\n","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** Error thrown when an HTTP request fails. */\r\nexport class HttpError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.HttpError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     * @param {number} statusCode The HTTP status code represented by this error.\r\n     */\r\n    constructor(errorMessage, statusCode) {\r\n        const trueProto = new.target.prototype;\r\n        super(`${errorMessage}: Status code '${statusCode}'`);\r\n        this.statusCode = statusCode;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when a timeout elapses. */\r\nexport class TimeoutError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.TimeoutError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     */\r\n    constructor(errorMessage = \"A timeout occurred.\") {\r\n        const trueProto = new.target.prototype;\r\n        super(errorMessage);\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when an action is aborted. */\r\nexport class AbortError extends Error {\r\n    /** Constructs a new instance of {@link AbortError}.\r\n     *\r\n     * @param {string} errorMessage A descriptive error message.\r\n     */\r\n    constructor(errorMessage = \"An abort occurred.\") {\r\n        const trueProto = new.target.prototype;\r\n        super(errorMessage);\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the selected transport is unsupported by the browser. */\r\n/** @private */\r\nexport class UnsupportedTransportError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.UnsupportedTransportError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n     */\r\n    constructor(message, transport) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.transport = transport;\r\n        this.errorType = 'UnsupportedTransportError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the selected transport is disabled by the browser. */\r\n/** @private */\r\nexport class DisabledTransportError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.DisabledTransportError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n     */\r\n    constructor(message, transport) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.transport = transport;\r\n        this.errorType = 'DisabledTransportError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the selected transport cannot be started. */\r\n/** @private */\r\nexport class FailedToStartTransportError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.FailedToStartTransportError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {HttpTransportType} transport The {@link @microsoft/signalr.HttpTransportType} this error occurred on.\r\n     */\r\n    constructor(message, transport) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.transport = transport;\r\n        this.errorType = 'FailedToStartTransportError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when the negotiation with the server failed to complete. */\r\n/** @private */\r\nexport class FailedToNegotiateWithServerError extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.FailedToNegotiateWithServerError}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     */\r\n    constructor(message) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.errorType = 'FailedToNegotiateWithServerError';\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n/** Error thrown when multiple errors have occurred. */\r\n/** @private */\r\nexport class AggregateErrors extends Error {\r\n    /** Constructs a new instance of {@link @microsoft/signalr.AggregateErrors}.\r\n     *\r\n     * @param {string} message A descriptive error message.\r\n     * @param {Error[]} innerErrors The collection of errors this error is aggregating.\r\n     */\r\n    constructor(message, innerErrors) {\r\n        const trueProto = new.target.prototype;\r\n        super(message);\r\n        this.innerErrors = innerErrors;\r\n        // Workaround issue in Typescript compiler\r\n        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200\r\n        this.__proto__ = trueProto;\r\n    }\r\n}\r\n//# sourceMappingURL=Errors.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** Represents an HTTP response. */\r\nexport class HttpResponse {\r\n    constructor(statusCode, statusText, content) {\r\n        this.statusCode = statusCode;\r\n        this.statusText = statusText;\r\n        this.content = content;\r\n    }\r\n}\r\n/** Abstraction over an HTTP client.\r\n *\r\n * This class provides an abstraction over an HTTP client so that a different implementation can be provided on different platforms.\r\n */\r\nexport class HttpClient {\r\n    get(url, options) {\r\n        return this.send({\r\n            ...options,\r\n            method: \"GET\",\r\n            url,\r\n        });\r\n    }\r\n    post(url, options) {\r\n        return this.send({\r\n            ...options,\r\n            method: \"POST\",\r\n            url,\r\n        });\r\n    }\r\n    delete(url, options) {\r\n        return this.send({\r\n            ...options,\r\n            method: \"DELETE\",\r\n            url,\r\n        });\r\n    }\r\n    /** Gets all cookies that apply to the specified URL.\r\n     *\r\n     * @param url The URL that the cookies are valid for.\r\n     * @returns {string} A string containing all the key-value cookie pairs for the specified URL.\r\n     */\r\n    // @ts-ignore\r\n    getCookieString(url) {\r\n        return \"\";\r\n    }\r\n}\r\n//# sourceMappingURL=HttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// These values are designed to match the ASP.NET Log Levels since that's the pattern we're emulating here.\r\n/** Indicates the severity of a log message.\r\n *\r\n * Log Levels are ordered in increasing severity. So `Debug` is more severe than `Trace`, etc.\r\n */\r\nexport var LogLevel;\r\n(function (LogLevel) {\r\n    /** Log level for very low severity diagnostic messages. */\r\n    LogLevel[LogLevel[\"Trace\"] = 0] = \"Trace\";\r\n    /** Log level for low severity diagnostic messages. */\r\n    LogLevel[LogLevel[\"Debug\"] = 1] = \"Debug\";\r\n    /** Log level for informational diagnostic messages. */\r\n    LogLevel[LogLevel[\"Information\"] = 2] = \"Information\";\r\n    /** Log level for diagnostic messages that indicate a non-fatal problem. */\r\n    LogLevel[LogLevel[\"Warning\"] = 3] = \"Warning\";\r\n    /** Log level for diagnostic messages that indicate a failure in the current operation. */\r\n    LogLevel[LogLevel[\"Error\"] = 4] = \"Error\";\r\n    /** Log level for diagnostic messages that indicate a failure that will terminate the entire application. */\r\n    LogLevel[LogLevel[\"Critical\"] = 5] = \"Critical\";\r\n    /** The highest possible log level. Used when configuring logging to indicate that no log messages should be emitted. */\r\n    LogLevel[LogLevel[\"None\"] = 6] = \"None\";\r\n})(LogLevel || (LogLevel = {}));\r\n//# sourceMappingURL=ILogger.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** A logger that does nothing when log messages are sent to it. */\r\nexport class NullLogger {\r\n    constructor() { }\r\n    /** @inheritDoc */\r\n    // eslint-disable-next-line\r\n    log(_logLevel, _message) {\r\n    }\r\n}\r\n/** The singleton instance of the {@link @microsoft/signalr.NullLogger}. */\r\nNullLogger.instance = new NullLogger();\r\n//# sourceMappingURL=Loggers.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { NullLogger } from \"./Loggers\";\r\n// Version token that will be replaced by the prepack command\r\n/** The version of the SignalR client. */\r\nexport const VERSION = \"8.0.17\";\r\n/** @private */\r\nexport class Arg {\r\n    static isRequired(val, name) {\r\n        if (val === null || val === undefined) {\r\n            throw new Error(`The '${name}' argument is required.`);\r\n        }\r\n    }\r\n    static isNotEmpty(val, name) {\r\n        if (!val || val.match(/^\\s*$/)) {\r\n            throw new Error(`The '${name}' argument should not be empty.`);\r\n        }\r\n    }\r\n    static isIn(val, values, name) {\r\n        // TypeScript enums have keys for **both** the name and the value of each enum member on the type itself.\r\n        if (!(val in values)) {\r\n            throw new Error(`Unknown ${name} value: ${val}.`);\r\n        }\r\n    }\r\n}\r\n/** @private */\r\nexport class Platform {\r\n    // react-native has a window but no document so we should check both\r\n    static get isBrowser() {\r\n        return !Platform.isNode && typeof window === \"object\" && typeof window.document === \"object\";\r\n    }\r\n    // WebWorkers don't have a window object so the isBrowser check would fail\r\n    static get isWebWorker() {\r\n        return !Platform.isNode && typeof self === \"object\" && \"importScripts\" in self;\r\n    }\r\n    // react-native has a window but no document\r\n    static get isReactNative() {\r\n        return !Platform.isNode && typeof window === \"object\" && typeof window.document === \"undefined\";\r\n    }\r\n    // Node apps shouldn't have a window object, but WebWorkers don't either\r\n    // so we need to check for both WebWorker and window\r\n    static get isNode() {\r\n        return typeof process !== \"undefined\" && process.release && process.release.name === \"node\";\r\n    }\r\n}\r\n/** @private */\r\nexport function getDataDetail(data, includeContent) {\r\n    let detail = \"\";\r\n    if (isArrayBuffer(data)) {\r\n        detail = `Binary data of length ${data.byteLength}`;\r\n        if (includeContent) {\r\n            detail += `. Content: '${formatArrayBuffer(data)}'`;\r\n        }\r\n    }\r\n    else if (typeof data === \"string\") {\r\n        detail = `String data of length ${data.length}`;\r\n        if (includeContent) {\r\n            detail += `. Content: '${data}'`;\r\n        }\r\n    }\r\n    return detail;\r\n}\r\n/** @private */\r\nexport function formatArrayBuffer(data) {\r\n    const view = new Uint8Array(data);\r\n    // Uint8Array.map only supports returning another Uint8Array?\r\n    let str = \"\";\r\n    view.forEach((num) => {\r\n        const pad = num < 16 ? \"0\" : \"\";\r\n        str += `0x${pad}${num.toString(16)} `;\r\n    });\r\n    // Trim of trailing space.\r\n    return str.substr(0, str.length - 1);\r\n}\r\n// Also in signalr-protocol-msgpack/Utils.ts\r\n/** @private */\r\nexport function isArrayBuffer(val) {\r\n    return val && typeof ArrayBuffer !== \"undefined\" &&\r\n        (val instanceof ArrayBuffer ||\r\n            // Sometimes we get an ArrayBuffer that doesn't satisfy instanceof\r\n            (val.constructor && val.constructor.name === \"ArrayBuffer\"));\r\n}\r\n/** @private */\r\nexport async function sendMessage(logger, transportName, httpClient, url, content, options) {\r\n    const headers = {};\r\n    const [name, value] = getUserAgentHeader();\r\n    headers[name] = value;\r\n    logger.log(LogLevel.Trace, `(${transportName} transport) sending data. ${getDataDetail(content, options.logMessageContent)}.`);\r\n    const responseType = isArrayBuffer(content) ? \"arraybuffer\" : \"text\";\r\n    const response = await httpClient.post(url, {\r\n        content,\r\n        headers: { ...headers, ...options.headers },\r\n        responseType,\r\n        timeout: options.timeout,\r\n        withCredentials: options.withCredentials,\r\n    });\r\n    logger.log(LogLevel.Trace, `(${transportName} transport) request complete. Response status: ${response.statusCode}.`);\r\n}\r\n/** @private */\r\nexport function createLogger(logger) {\r\n    if (logger === undefined) {\r\n        return new ConsoleLogger(LogLevel.Information);\r\n    }\r\n    if (logger === null) {\r\n        return NullLogger.instance;\r\n    }\r\n    if (logger.log !== undefined) {\r\n        return logger;\r\n    }\r\n    return new ConsoleLogger(logger);\r\n}\r\n/** @private */\r\nexport class SubjectSubscription {\r\n    constructor(subject, observer) {\r\n        this._subject = subject;\r\n        this._observer = observer;\r\n    }\r\n    dispose() {\r\n        const index = this._subject.observers.indexOf(this._observer);\r\n        if (index > -1) {\r\n            this._subject.observers.splice(index, 1);\r\n        }\r\n        if (this._subject.observers.length === 0 && this._subject.cancelCallback) {\r\n            this._subject.cancelCallback().catch((_) => { });\r\n        }\r\n    }\r\n}\r\n/** @private */\r\nexport class ConsoleLogger {\r\n    constructor(minimumLogLevel) {\r\n        this._minLevel = minimumLogLevel;\r\n        this.out = console;\r\n    }\r\n    log(logLevel, message) {\r\n        if (logLevel >= this._minLevel) {\r\n            const msg = `[${new Date().toISOString()}] ${LogLevel[logLevel]}: ${message}`;\r\n            switch (logLevel) {\r\n                case LogLevel.Critical:\r\n                case LogLevel.Error:\r\n                    this.out.error(msg);\r\n                    break;\r\n                case LogLevel.Warning:\r\n                    this.out.warn(msg);\r\n                    break;\r\n                case LogLevel.Information:\r\n                    this.out.info(msg);\r\n                    break;\r\n                default:\r\n                    // console.debug only goes to attached debuggers in Node, so we use console.log for Trace and Debug\r\n                    this.out.log(msg);\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\n/** @private */\r\nexport function getUserAgentHeader() {\r\n    let userAgentHeaderName = \"X-SignalR-User-Agent\";\r\n    if (Platform.isNode) {\r\n        userAgentHeaderName = \"User-Agent\";\r\n    }\r\n    return [userAgentHeaderName, constructUserAgent(VERSION, getOsName(), getRuntime(), getRuntimeVersion())];\r\n}\r\n/** @private */\r\nexport function constructUserAgent(version, os, runtime, runtimeVersion) {\r\n    // Microsoft SignalR/[Version] ([Detailed Version]; [Operating System]; [Runtime]; [Runtime Version])\r\n    let userAgent = \"Microsoft SignalR/\";\r\n    const majorAndMinor = version.split(\".\");\r\n    userAgent += `${majorAndMinor[0]}.${majorAndMinor[1]}`;\r\n    userAgent += ` (${version}; `;\r\n    if (os && os !== \"\") {\r\n        userAgent += `${os}; `;\r\n    }\r\n    else {\r\n        userAgent += \"Unknown OS; \";\r\n    }\r\n    userAgent += `${runtime}`;\r\n    if (runtimeVersion) {\r\n        userAgent += `; ${runtimeVersion}`;\r\n    }\r\n    else {\r\n        userAgent += \"; Unknown Runtime Version\";\r\n    }\r\n    userAgent += \")\";\r\n    return userAgent;\r\n}\r\n// eslint-disable-next-line spaced-comment\r\n/*#__PURE__*/ function getOsName() {\r\n    if (Platform.isNode) {\r\n        switch (process.platform) {\r\n            case \"win32\":\r\n                return \"Windows NT\";\r\n            case \"darwin\":\r\n                return \"macOS\";\r\n            case \"linux\":\r\n                return \"Linux\";\r\n            default:\r\n                return process.platform;\r\n        }\r\n    }\r\n    else {\r\n        return \"\";\r\n    }\r\n}\r\n// eslint-disable-next-line spaced-comment\r\n/*#__PURE__*/ function getRuntimeVersion() {\r\n    if (Platform.isNode) {\r\n        return process.versions.node;\r\n    }\r\n    return undefined;\r\n}\r\nfunction getRuntime() {\r\n    if (Platform.isNode) {\r\n        return \"NodeJS\";\r\n    }\r\n    else {\r\n        return \"Browser\";\r\n    }\r\n}\r\n/** @private */\r\nexport function getErrorString(e) {\r\n    if (e.stack) {\r\n        return e.stack;\r\n    }\r\n    else if (e.message) {\r\n        return e.message;\r\n    }\r\n    return `${e}`;\r\n}\r\n/** @private */\r\nexport function getGlobalThis() {\r\n    // globalThis is semi-new and not available in Node until v12\r\n    if (typeof globalThis !== \"undefined\") {\r\n        return globalThis;\r\n    }\r\n    if (typeof self !== \"undefined\") {\r\n        return self;\r\n    }\r\n    if (typeof window !== \"undefined\") {\r\n        return window;\r\n    }\r\n    if (typeof global !== \"undefined\") {\r\n        return global;\r\n    }\r\n    throw new Error(\"could not find global\");\r\n}\r\n//# sourceMappingURL=Utils.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\r\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { Platform, getGlobalThis, isArrayBuffer } from \"./Utils\";\r\nexport class FetchHttpClient extends HttpClient {\r\n    constructor(logger) {\r\n        super();\r\n        this._logger = logger;\r\n        // Node added a fetch implementation to the global scope starting in v18.\r\n        // We need to add a cookie jar in node to be able to share cookies with WebSocket\r\n        if (typeof fetch === \"undefined\" || Platform.isNode) {\r\n            // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n            // @ts-ignore: TS doesn't know about these names\r\n            const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n            // Cookies aren't automatically handled in Node so we need to add a CookieJar to preserve cookies across requests\r\n            this._jar = new (requireFunc(\"tough-cookie\")).CookieJar();\r\n            if (typeof fetch === \"undefined\") {\r\n                this._fetchType = requireFunc(\"node-fetch\");\r\n            }\r\n            else {\r\n                // Use fetch from Node if available\r\n                this._fetchType = fetch;\r\n            }\r\n            // node-fetch doesn't have a nice API for getting and setting cookies\r\n            // fetch-cookie will wrap a fetch implementation with a default CookieJar or a provided one\r\n            this._fetchType = requireFunc(\"fetch-cookie\")(this._fetchType, this._jar);\r\n        }\r\n        else {\r\n            this._fetchType = fetch.bind(getGlobalThis());\r\n        }\r\n        if (typeof AbortController === \"undefined\") {\r\n            // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n            // @ts-ignore: TS doesn't know about these names\r\n            const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n            // Node needs EventListener methods on AbortController which our custom polyfill doesn't provide\r\n            this._abortControllerType = requireFunc(\"abort-controller\");\r\n        }\r\n        else {\r\n            this._abortControllerType = AbortController;\r\n        }\r\n    }\r\n    /** @inheritDoc */\r\n    async send(request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            throw new AbortError();\r\n        }\r\n        if (!request.method) {\r\n            throw new Error(\"No method defined.\");\r\n        }\r\n        if (!request.url) {\r\n            throw new Error(\"No url defined.\");\r\n        }\r\n        const abortController = new this._abortControllerType();\r\n        let error;\r\n        // Hook our abortSignal into the abort controller\r\n        if (request.abortSignal) {\r\n            request.abortSignal.onabort = () => {\r\n                abortController.abort();\r\n                error = new AbortError();\r\n            };\r\n        }\r\n        // If a timeout has been passed in, setup a timeout to call abort\r\n        // Type needs to be any to fit window.setTimeout and NodeJS.setTimeout\r\n        let timeoutId = null;\r\n        if (request.timeout) {\r\n            const msTimeout = request.timeout;\r\n            timeoutId = setTimeout(() => {\r\n                abortController.abort();\r\n                this._logger.log(LogLevel.Warning, `Timeout from HTTP request.`);\r\n                error = new TimeoutError();\r\n            }, msTimeout);\r\n        }\r\n        if (request.content === \"\") {\r\n            request.content = undefined;\r\n        }\r\n        if (request.content) {\r\n            // Explicitly setting the Content-Type header for React Native on Android platform.\r\n            request.headers = request.headers || {};\r\n            if (isArrayBuffer(request.content)) {\r\n                request.headers[\"Content-Type\"] = \"application/octet-stream\";\r\n            }\r\n            else {\r\n                request.headers[\"Content-Type\"] = \"text/plain;charset=UTF-8\";\r\n            }\r\n        }\r\n        let response;\r\n        try {\r\n            response = await this._fetchType(request.url, {\r\n                body: request.content,\r\n                cache: \"no-cache\",\r\n                credentials: request.withCredentials === true ? \"include\" : \"same-origin\",\r\n                headers: {\r\n                    \"X-Requested-With\": \"XMLHttpRequest\",\r\n                    ...request.headers,\r\n                },\r\n                method: request.method,\r\n                mode: \"cors\",\r\n                redirect: \"follow\",\r\n                signal: abortController.signal,\r\n            });\r\n        }\r\n        catch (e) {\r\n            if (error) {\r\n                throw error;\r\n            }\r\n            this._logger.log(LogLevel.Warning, `Error from HTTP request. ${e}.`);\r\n            throw e;\r\n        }\r\n        finally {\r\n            if (timeoutId) {\r\n                clearTimeout(timeoutId);\r\n            }\r\n            if (request.abortSignal) {\r\n                request.abortSignal.onabort = null;\r\n            }\r\n        }\r\n        if (!response.ok) {\r\n            const errorMessage = await deserializeContent(response, \"text\");\r\n            throw new HttpError(errorMessage || response.statusText, response.status);\r\n        }\r\n        const content = deserializeContent(response, request.responseType);\r\n        const payload = await content;\r\n        return new HttpResponse(response.status, response.statusText, payload);\r\n    }\r\n    getCookieString(url) {\r\n        let cookies = \"\";\r\n        if (Platform.isNode && this._jar) {\r\n            // @ts-ignore: unused variable\r\n            this._jar.getCookies(url, (e, c) => cookies = c.join(\"; \"));\r\n        }\r\n        return cookies;\r\n    }\r\n}\r\nfunction deserializeContent(response, responseType) {\r\n    let content;\r\n    switch (responseType) {\r\n        case \"arraybuffer\":\r\n            content = response.arrayBuffer();\r\n            break;\r\n        case \"text\":\r\n            content = response.text();\r\n            break;\r\n        case \"blob\":\r\n        case \"document\":\r\n        case \"json\":\r\n            throw new Error(`${responseType} is not supported.`);\r\n        default:\r\n            content = response.text();\r\n            break;\r\n    }\r\n    return content;\r\n}\r\n//# sourceMappingURL=FetchHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortError, HttpError, TimeoutError } from \"./Errors\";\r\nimport { HttpClient, HttpResponse } from \"./HttpClient\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\nexport class XhrHttpClient extends HttpClient {\r\n    constructor(logger) {\r\n        super();\r\n        this._logger = logger;\r\n    }\r\n    /** @inheritDoc */\r\n    send(request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            return Promise.reject(new AbortError());\r\n        }\r\n        if (!request.method) {\r\n            return Promise.reject(new Error(\"No method defined.\"));\r\n        }\r\n        if (!request.url) {\r\n            return Promise.reject(new Error(\"No url defined.\"));\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            const xhr = new XMLHttpRequest();\r\n            xhr.open(request.method, request.url, true);\r\n            xhr.withCredentials = request.withCredentials === undefined ? true : request.withCredentials;\r\n            xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n            if (request.content === \"\") {\r\n                request.content = undefined;\r\n            }\r\n            if (request.content) {\r\n                // Explicitly setting the Content-Type header for React Native on Android platform.\r\n                if (isArrayBuffer(request.content)) {\r\n                    xhr.setRequestHeader(\"Content-Type\", \"application/octet-stream\");\r\n                }\r\n                else {\r\n                    xhr.setRequestHeader(\"Content-Type\", \"text/plain;charset=UTF-8\");\r\n                }\r\n            }\r\n            const headers = request.headers;\r\n            if (headers) {\r\n                Object.keys(headers)\r\n                    .forEach((header) => {\r\n                    xhr.setRequestHeader(header, headers[header]);\r\n                });\r\n            }\r\n            if (request.responseType) {\r\n                xhr.responseType = request.responseType;\r\n            }\r\n            if (request.abortSignal) {\r\n                request.abortSignal.onabort = () => {\r\n                    xhr.abort();\r\n                    reject(new AbortError());\r\n                };\r\n            }\r\n            if (request.timeout) {\r\n                xhr.timeout = request.timeout;\r\n            }\r\n            xhr.onload = () => {\r\n                if (request.abortSignal) {\r\n                    request.abortSignal.onabort = null;\r\n                }\r\n                if (xhr.status >= 200 && xhr.status < 300) {\r\n                    resolve(new HttpResponse(xhr.status, xhr.statusText, xhr.response || xhr.responseText));\r\n                }\r\n                else {\r\n                    reject(new HttpError(xhr.response || xhr.responseText || xhr.statusText, xhr.status));\r\n                }\r\n            };\r\n            xhr.onerror = () => {\r\n                this._logger.log(LogLevel.Warning, `Error from HTTP request. ${xhr.status}: ${xhr.statusText}.`);\r\n                reject(new HttpError(xhr.statusText, xhr.status));\r\n            };\r\n            xhr.ontimeout = () => {\r\n                this._logger.log(LogLevel.Warning, `Timeout from HTTP request.`);\r\n                reject(new TimeoutError());\r\n            };\r\n            xhr.send(request.content);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=XhrHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortError } from \"./Errors\";\r\nimport { FetchHttpClient } from \"./FetchHttpClient\";\r\nimport { HttpClient } from \"./HttpClient\";\r\nimport { Platform } from \"./Utils\";\r\nimport { XhrHttpClient } from \"./XhrHttpClient\";\r\n/** Default implementation of {@link @microsoft/signalr.HttpClient}. */\r\nexport class DefaultHttpClient extends HttpClient {\r\n    /** Creates a new instance of the {@link @microsoft/signalr.DefaultHttpClient}, using the provided {@link @microsoft/signalr.ILogger} to log messages. */\r\n    constructor(logger) {\r\n        super();\r\n        if (typeof fetch !== \"undefined\" || Platform.isNode) {\r\n            this._httpClient = new FetchHttpClient(logger);\r\n        }\r\n        else if (typeof XMLHttpRequest !== \"undefined\") {\r\n            this._httpClient = new XhrHttpClient(logger);\r\n        }\r\n        else {\r\n            throw new Error(\"No usable HttpClient found.\");\r\n        }\r\n    }\r\n    /** @inheritDoc */\r\n    send(request) {\r\n        // Check that abort was not signaled before calling send\r\n        if (request.abortSignal && request.abortSignal.aborted) {\r\n            return Promise.reject(new AbortError());\r\n        }\r\n        if (!request.method) {\r\n            return Promise.reject(new Error(\"No method defined.\"));\r\n        }\r\n        if (!request.url) {\r\n            return Promise.reject(new Error(\"No url defined.\"));\r\n        }\r\n        return this._httpClient.send(request);\r\n    }\r\n    getCookieString(url) {\r\n        return this._httpClient.getCookieString(url);\r\n    }\r\n}\r\n//# sourceMappingURL=DefaultHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// Not exported from index\r\n/** @private */\r\nexport class TextMessageFormat {\r\n    static write(output) {\r\n        return `${output}${TextMessageFormat.RecordSeparator}`;\r\n    }\r\n    static parse(input) {\r\n        if (input[input.length - 1] !== TextMessageFormat.RecordSeparator) {\r\n            throw new Error(\"Message is incomplete.\");\r\n        }\r\n        const messages = input.split(TextMessageFormat.RecordSeparator);\r\n        messages.pop();\r\n        return messages;\r\n    }\r\n}\r\nTextMessageFormat.RecordSeparatorCode = 0x1e;\r\nTextMessageFormat.RecordSeparator = String.fromCharCode(TextMessageFormat.RecordSeparatorCode);\r\n//# sourceMappingURL=TextMessageFormat.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { TextMessageFormat } from \"./TextMessageFormat\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\n/** @private */\r\nexport class HandshakeProtocol {\r\n    // Handshake request is always JSON\r\n    writeHandshakeRequest(handshakeRequest) {\r\n        return TextMessageFormat.write(JSON.stringify(handshakeRequest));\r\n    }\r\n    parseHandshakeResponse(data) {\r\n        let messageData;\r\n        let remainingData;\r\n        if (isArrayBuffer(data)) {\r\n            // Format is binary but still need to read JSON text from handshake response\r\n            const binaryData = new Uint8Array(data);\r\n            const separatorIndex = binaryData.indexOf(TextMessageFormat.RecordSeparatorCode);\r\n            if (separatorIndex === -1) {\r\n                throw new Error(\"Message is incomplete.\");\r\n            }\r\n            // content before separator is handshake response\r\n            // optional content after is additional messages\r\n            const responseLength = separatorIndex + 1;\r\n            messageData = String.fromCharCode.apply(null, Array.prototype.slice.call(binaryData.slice(0, responseLength)));\r\n            remainingData = (binaryData.byteLength > responseLength) ? binaryData.slice(responseLength).buffer : null;\r\n        }\r\n        else {\r\n            const textData = data;\r\n            const separatorIndex = textData.indexOf(TextMessageFormat.RecordSeparator);\r\n            if (separatorIndex === -1) {\r\n                throw new Error(\"Message is incomplete.\");\r\n            }\r\n            // content before separator is handshake response\r\n            // optional content after is additional messages\r\n            const responseLength = separatorIndex + 1;\r\n            messageData = textData.substring(0, responseLength);\r\n            remainingData = (textData.length > responseLength) ? textData.substring(responseLength) : null;\r\n        }\r\n        // At this point we should have just the single handshake message\r\n        const messages = TextMessageFormat.parse(messageData);\r\n        const response = JSON.parse(messages[0]);\r\n        if (response.type) {\r\n            throw new Error(\"Expected a handshake response from the server.\");\r\n        }\r\n        const responseMessage = response;\r\n        // multiple messages could have arrived with handshake\r\n        // return additional data to be parsed as usual, or null if all parsed\r\n        return [remainingData, responseMessage];\r\n    }\r\n}\r\n//# sourceMappingURL=HandshakeProtocol.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n/** Defines the type of a Hub Message. */\r\nexport var MessageType;\r\n(function (MessageType) {\r\n    /** Indicates the message is an Invocation message and implements the {@link @microsoft/signalr.InvocationMessage} interface. */\r\n    MessageType[MessageType[\"Invocation\"] = 1] = \"Invocation\";\r\n    /** Indicates the message is a StreamItem message and implements the {@link @microsoft/signalr.StreamItemMessage} interface. */\r\n    MessageType[MessageType[\"StreamItem\"] = 2] = \"StreamItem\";\r\n    /** Indicates the message is a Completion message and implements the {@link @microsoft/signalr.CompletionMessage} interface. */\r\n    MessageType[MessageType[\"Completion\"] = 3] = \"Completion\";\r\n    /** Indicates the message is a Stream Invocation message and implements the {@link @microsoft/signalr.StreamInvocationMessage} interface. */\r\n    MessageType[MessageType[\"StreamInvocation\"] = 4] = \"StreamInvocation\";\r\n    /** Indicates the message is a Cancel Invocation message and implements the {@link @microsoft/signalr.CancelInvocationMessage} interface. */\r\n    MessageType[MessageType[\"CancelInvocation\"] = 5] = \"CancelInvocation\";\r\n    /** Indicates the message is a Ping message and implements the {@link @microsoft/signalr.PingMessage} interface. */\r\n    MessageType[MessageType[\"Ping\"] = 6] = \"Ping\";\r\n    /** Indicates the message is a Close message and implements the {@link @microsoft/signalr.CloseMessage} interface. */\r\n    MessageType[MessageType[\"Close\"] = 7] = \"Close\";\r\n    MessageType[MessageType[\"Ack\"] = 8] = \"Ack\";\r\n    MessageType[MessageType[\"Sequence\"] = 9] = \"Sequence\";\r\n})(MessageType || (MessageType = {}));\r\n//# sourceMappingURL=IHubProtocol.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { SubjectSubscription } from \"./Utils\";\r\n/** Stream implementation to stream items to the server. */\r\nexport class Subject {\r\n    constructor() {\r\n        this.observers = [];\r\n    }\r\n    next(item) {\r\n        for (const observer of this.observers) {\r\n            observer.next(item);\r\n        }\r\n    }\r\n    error(err) {\r\n        for (const observer of this.observers) {\r\n            if (observer.error) {\r\n                observer.error(err);\r\n            }\r\n        }\r\n    }\r\n    complete() {\r\n        for (const observer of this.observers) {\r\n            if (observer.complete) {\r\n                observer.complete();\r\n            }\r\n        }\r\n    }\r\n    subscribe(observer) {\r\n        this.observers.push(observer);\r\n        return new SubjectSubscription(this, observer);\r\n    }\r\n}\r\n//# sourceMappingURL=Subject.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { isArrayBuffer } from \"./Utils\";\r\n/** @private */\r\nexport class MessageBuffer {\r\n    constructor(protocol, connection, bufferSize) {\r\n        this._bufferSize = 100000;\r\n        this._messages = [];\r\n        this._totalMessageCount = 0;\r\n        this._waitForSequenceMessage = false;\r\n        // Message IDs start at 1 and always increment by 1\r\n        this._nextReceivingSequenceId = 1;\r\n        this._latestReceivedSequenceId = 0;\r\n        this._bufferedByteCount = 0;\r\n        this._reconnectInProgress = false;\r\n        this._protocol = protocol;\r\n        this._connection = connection;\r\n        this._bufferSize = bufferSize;\r\n    }\r\n    async _send(message) {\r\n        const serializedMessage = this._protocol.writeMessage(message);\r\n        let backpressurePromise = Promise.resolve();\r\n        // Only count invocation messages. Acks, pings, etc. don't need to be resent on reconnect\r\n        if (this._isInvocationMessage(message)) {\r\n            this._totalMessageCount++;\r\n            let backpressurePromiseResolver = () => { };\r\n            let backpressurePromiseRejector = () => { };\r\n            if (isArrayBuffer(serializedMessage)) {\r\n                this._bufferedByteCount += serializedMessage.byteLength;\r\n            }\r\n            else {\r\n                this._bufferedByteCount += serializedMessage.length;\r\n            }\r\n            if (this._bufferedByteCount >= this._bufferSize) {\r\n                backpressurePromise = new Promise((resolve, reject) => {\r\n                    backpressurePromiseResolver = resolve;\r\n                    backpressurePromiseRejector = reject;\r\n                });\r\n            }\r\n            this._messages.push(new BufferedItem(serializedMessage, this._totalMessageCount, backpressurePromiseResolver, backpressurePromiseRejector));\r\n        }\r\n        try {\r\n            // If this is set it means we are reconnecting or resending\r\n            // We don't want to send on a disconnected connection\r\n            // And we don't want to send if resend is running since that would mean sending\r\n            // this message twice\r\n            if (!this._reconnectInProgress) {\r\n                await this._connection.send(serializedMessage);\r\n            }\r\n        }\r\n        catch {\r\n            this._disconnected();\r\n        }\r\n        await backpressurePromise;\r\n    }\r\n    _ack(ackMessage) {\r\n        let newestAckedMessage = -1;\r\n        // Find index of newest message being acked\r\n        for (let index = 0; index < this._messages.length; index++) {\r\n            const element = this._messages[index];\r\n            if (element._id <= ackMessage.sequenceId) {\r\n                newestAckedMessage = index;\r\n                if (isArrayBuffer(element._message)) {\r\n                    this._bufferedByteCount -= element._message.byteLength;\r\n                }\r\n                else {\r\n                    this._bufferedByteCount -= element._message.length;\r\n                }\r\n                // resolve items that have already been sent and acked\r\n                element._resolver();\r\n            }\r\n            else if (this._bufferedByteCount < this._bufferSize) {\r\n                // resolve items that now fall under the buffer limit but haven't been acked\r\n                element._resolver();\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        if (newestAckedMessage !== -1) {\r\n            // We're removing everything including the message pointed to, so add 1\r\n            this._messages = this._messages.slice(newestAckedMessage + 1);\r\n        }\r\n    }\r\n    _shouldProcessMessage(message) {\r\n        if (this._waitForSequenceMessage) {\r\n            if (message.type !== MessageType.Sequence) {\r\n                return false;\r\n            }\r\n            else {\r\n                this._waitForSequenceMessage = false;\r\n                return true;\r\n            }\r\n        }\r\n        // No special processing for acks, pings, etc.\r\n        if (!this._isInvocationMessage(message)) {\r\n            return true;\r\n        }\r\n        const currentId = this._nextReceivingSequenceId;\r\n        this._nextReceivingSequenceId++;\r\n        if (currentId <= this._latestReceivedSequenceId) {\r\n            if (currentId === this._latestReceivedSequenceId) {\r\n                // Should only hit this if we just reconnected and the server is sending\r\n                // Messages it has buffered, which would mean it hasn't seen an Ack for these messages\r\n                this._ackTimer();\r\n            }\r\n            // Ignore, this is a duplicate message\r\n            return false;\r\n        }\r\n        this._latestReceivedSequenceId = currentId;\r\n        // Only start the timer for sending an Ack message when we have a message to ack. This also conveniently solves\r\n        // timer throttling by not having a recursive timer, and by starting the timer via a network call (recv)\r\n        this._ackTimer();\r\n        return true;\r\n    }\r\n    _resetSequence(message) {\r\n        if (message.sequenceId > this._nextReceivingSequenceId) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this._connection.stop(new Error(\"Sequence ID greater than amount of messages we've received.\"));\r\n            return;\r\n        }\r\n        this._nextReceivingSequenceId = message.sequenceId;\r\n    }\r\n    _disconnected() {\r\n        this._reconnectInProgress = true;\r\n        this._waitForSequenceMessage = true;\r\n    }\r\n    async _resend() {\r\n        const sequenceId = this._messages.length !== 0\r\n            ? this._messages[0]._id\r\n            : this._totalMessageCount + 1;\r\n        await this._connection.send(this._protocol.writeMessage({ type: MessageType.Sequence, sequenceId }));\r\n        // Get a local variable to the _messages, just in case messages are acked while resending\r\n        // Which would slice the _messages array (which creates a new copy)\r\n        const messages = this._messages;\r\n        for (const element of messages) {\r\n            await this._connection.send(element._message);\r\n        }\r\n        this._reconnectInProgress = false;\r\n    }\r\n    _dispose(error) {\r\n        error !== null && error !== void 0 ? error : (error = new Error(\"Unable to reconnect to server.\"));\r\n        // Unblock backpressure if any\r\n        for (const element of this._messages) {\r\n            element._rejector(error);\r\n        }\r\n    }\r\n    _isInvocationMessage(message) {\r\n        // There is no way to check if something implements an interface.\r\n        // So we individually check the messages in a switch statement.\r\n        // To make sure we don't miss any message types we rely on the compiler\r\n        // seeing the function returns a value and it will do the\r\n        // exhaustive check for us on the switch statement, since we don't use 'case default'\r\n        switch (message.type) {\r\n            case MessageType.Invocation:\r\n            case MessageType.StreamItem:\r\n            case MessageType.Completion:\r\n            case MessageType.StreamInvocation:\r\n            case MessageType.CancelInvocation:\r\n                return true;\r\n            case MessageType.Close:\r\n            case MessageType.Sequence:\r\n            case MessageType.Ping:\r\n            case MessageType.Ack:\r\n                return false;\r\n        }\r\n    }\r\n    _ackTimer() {\r\n        if (this._ackTimerHandle === undefined) {\r\n            this._ackTimerHandle = setTimeout(async () => {\r\n                try {\r\n                    if (!this._reconnectInProgress) {\r\n                        await this._connection.send(this._protocol.writeMessage({ type: MessageType.Ack, sequenceId: this._latestReceivedSequenceId }));\r\n                    }\r\n                    // Ignore errors, that means the connection is closed and we don't care about the Ack message anymore.\r\n                }\r\n                catch { }\r\n                clearTimeout(this._ackTimerHandle);\r\n                this._ackTimerHandle = undefined;\r\n                // 1 second delay so we don't spam Ack messages if there are many messages being received at once.\r\n            }, 1000);\r\n        }\r\n    }\r\n}\r\nclass BufferedItem {\r\n    constructor(message, id, resolver, rejector) {\r\n        this._message = message;\r\n        this._id = id;\r\n        this._resolver = resolver;\r\n        this._rejector = rejector;\r\n    }\r\n}\r\n//# sourceMappingURL=MessageBuffer.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { HandshakeProtocol } from \"./HandshakeProtocol\";\r\nimport { AbortError } from \"./Errors\";\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { Subject } from \"./Subject\";\r\nimport { Arg, getErrorString, Platform } from \"./Utils\";\r\nimport { MessageBuffer } from \"./MessageBuffer\";\r\nconst DEFAULT_TIMEOUT_IN_MS = 30 * 1000;\r\nconst DEFAULT_PING_INTERVAL_IN_MS = 15 * 1000;\r\nconst DEFAULT_STATEFUL_RECONNECT_BUFFER_SIZE = 100000;\r\n/** Describes the current state of the {@link HubConnection} to the server. */\r\nexport var HubConnectionState;\r\n(function (HubConnectionState) {\r\n    /** The hub connection is disconnected. */\r\n    HubConnectionState[\"Disconnected\"] = \"Disconnected\";\r\n    /** The hub connection is connecting. */\r\n    HubConnectionState[\"Connecting\"] = \"Connecting\";\r\n    /** The hub connection is connected. */\r\n    HubConnectionState[\"Connected\"] = \"Connected\";\r\n    /** The hub connection is disconnecting. */\r\n    HubConnectionState[\"Disconnecting\"] = \"Disconnecting\";\r\n    /** The hub connection is reconnecting. */\r\n    HubConnectionState[\"Reconnecting\"] = \"Reconnecting\";\r\n})(HubConnectionState || (HubConnectionState = {}));\r\n/** Represents a connection to a SignalR Hub. */\r\nexport class HubConnection {\r\n    /** @internal */\r\n    // Using a public static factory method means we can have a private constructor and an _internal_\r\n    // create method that can be used by HubConnectionBuilder. An \"internal\" constructor would just\r\n    // be stripped away and the '.d.ts' file would have no constructor, which is interpreted as a\r\n    // public parameter-less constructor.\r\n    static create(connection, logger, protocol, reconnectPolicy, serverTimeoutInMilliseconds, keepAliveIntervalInMilliseconds, statefulReconnectBufferSize) {\r\n        return new HubConnection(connection, logger, protocol, reconnectPolicy, serverTimeoutInMilliseconds, keepAliveIntervalInMilliseconds, statefulReconnectBufferSize);\r\n    }\r\n    constructor(connection, logger, protocol, reconnectPolicy, serverTimeoutInMilliseconds, keepAliveIntervalInMilliseconds, statefulReconnectBufferSize) {\r\n        this._nextKeepAlive = 0;\r\n        this._freezeEventListener = () => {\r\n            this._logger.log(LogLevel.Warning, \"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep\");\r\n        };\r\n        Arg.isRequired(connection, \"connection\");\r\n        Arg.isRequired(logger, \"logger\");\r\n        Arg.isRequired(protocol, \"protocol\");\r\n        this.serverTimeoutInMilliseconds = serverTimeoutInMilliseconds !== null && serverTimeoutInMilliseconds !== void 0 ? serverTimeoutInMilliseconds : DEFAULT_TIMEOUT_IN_MS;\r\n        this.keepAliveIntervalInMilliseconds = keepAliveIntervalInMilliseconds !== null && keepAliveIntervalInMilliseconds !== void 0 ? keepAliveIntervalInMilliseconds : DEFAULT_PING_INTERVAL_IN_MS;\r\n        this._statefulReconnectBufferSize = statefulReconnectBufferSize !== null && statefulReconnectBufferSize !== void 0 ? statefulReconnectBufferSize : DEFAULT_STATEFUL_RECONNECT_BUFFER_SIZE;\r\n        this._logger = logger;\r\n        this._protocol = protocol;\r\n        this.connection = connection;\r\n        this._reconnectPolicy = reconnectPolicy;\r\n        this._handshakeProtocol = new HandshakeProtocol();\r\n        this.connection.onreceive = (data) => this._processIncomingData(data);\r\n        this.connection.onclose = (error) => this._connectionClosed(error);\r\n        this._callbacks = {};\r\n        this._methods = {};\r\n        this._closedCallbacks = [];\r\n        this._reconnectingCallbacks = [];\r\n        this._reconnectedCallbacks = [];\r\n        this._invocationId = 0;\r\n        this._receivedHandshakeResponse = false;\r\n        this._connectionState = HubConnectionState.Disconnected;\r\n        this._connectionStarted = false;\r\n        this._cachedPingMessage = this._protocol.writeMessage({ type: MessageType.Ping });\r\n    }\r\n    /** Indicates the state of the {@link HubConnection} to the server. */\r\n    get state() {\r\n        return this._connectionState;\r\n    }\r\n    /** Represents the connection id of the {@link HubConnection} on the server. The connection id will be null when the connection is either\r\n     *  in the disconnected state or if the negotiation step was skipped.\r\n     */\r\n    get connectionId() {\r\n        return this.connection ? (this.connection.connectionId || null) : null;\r\n    }\r\n    /** Indicates the url of the {@link HubConnection} to the server. */\r\n    get baseUrl() {\r\n        return this.connection.baseUrl || \"\";\r\n    }\r\n    /**\r\n     * Sets a new url for the HubConnection. Note that the url can only be changed when the connection is in either the Disconnected or\r\n     * Reconnecting states.\r\n     * @param {string} url The url to connect to.\r\n     */\r\n    set baseUrl(url) {\r\n        if (this._connectionState !== HubConnectionState.Disconnected && this._connectionState !== HubConnectionState.Reconnecting) {\r\n            throw new Error(\"The HubConnection must be in the Disconnected or Reconnecting state to change the url.\");\r\n        }\r\n        if (!url) {\r\n            throw new Error(\"The HubConnection url must be a valid url.\");\r\n        }\r\n        this.connection.baseUrl = url;\r\n    }\r\n    /** Starts the connection.\r\n     *\r\n     * @returns {Promise<void>} A Promise that resolves when the connection has been successfully established, or rejects with an error.\r\n     */\r\n    start() {\r\n        this._startPromise = this._startWithStateTransitions();\r\n        return this._startPromise;\r\n    }\r\n    async _startWithStateTransitions() {\r\n        if (this._connectionState !== HubConnectionState.Disconnected) {\r\n            return Promise.reject(new Error(\"Cannot start a HubConnection that is not in the 'Disconnected' state.\"));\r\n        }\r\n        this._connectionState = HubConnectionState.Connecting;\r\n        this._logger.log(LogLevel.Debug, \"Starting HubConnection.\");\r\n        try {\r\n            await this._startInternal();\r\n            if (Platform.isBrowser) {\r\n                // Log when the browser freezes the tab so users know why their connection unexpectedly stopped working\r\n                window.document.addEventListener(\"freeze\", this._freezeEventListener);\r\n            }\r\n            this._connectionState = HubConnectionState.Connected;\r\n            this._connectionStarted = true;\r\n            this._logger.log(LogLevel.Debug, \"HubConnection connected successfully.\");\r\n        }\r\n        catch (e) {\r\n            this._connectionState = HubConnectionState.Disconnected;\r\n            this._logger.log(LogLevel.Debug, `HubConnection failed to start successfully because of error '${e}'.`);\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n    async _startInternal() {\r\n        this._stopDuringStartError = undefined;\r\n        this._receivedHandshakeResponse = false;\r\n        // Set up the promise before any connection is (re)started otherwise it could race with received messages\r\n        const handshakePromise = new Promise((resolve, reject) => {\r\n            this._handshakeResolver = resolve;\r\n            this._handshakeRejecter = reject;\r\n        });\r\n        await this.connection.start(this._protocol.transferFormat);\r\n        try {\r\n            let version = this._protocol.version;\r\n            if (!this.connection.features.reconnect) {\r\n                // Stateful Reconnect starts with HubProtocol version 2, newer clients connecting to older servers will fail to connect due to\r\n                // the handshake only supporting version 1, so we will try to send version 1 during the handshake to keep old servers working.\r\n                version = 1;\r\n            }\r\n            const handshakeRequest = {\r\n                protocol: this._protocol.name,\r\n                version,\r\n            };\r\n            this._logger.log(LogLevel.Debug, \"Sending handshake request.\");\r\n            await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(handshakeRequest));\r\n            this._logger.log(LogLevel.Information, `Using HubProtocol '${this._protocol.name}'.`);\r\n            // defensively cleanup timeout in case we receive a message from the server before we finish start\r\n            this._cleanupTimeout();\r\n            this._resetTimeoutPeriod();\r\n            this._resetKeepAliveInterval();\r\n            await handshakePromise;\r\n            // It's important to check the stopDuringStartError instead of just relying on the handshakePromise\r\n            // being rejected on close, because this continuation can run after both the handshake completed successfully\r\n            // and the connection was closed.\r\n            if (this._stopDuringStartError) {\r\n                // It's important to throw instead of returning a rejected promise, because we don't want to allow any state\r\n                // transitions to occur between now and the calling code observing the exceptions. Returning a rejected promise\r\n                // will cause the calling continuation to get scheduled to run later.\r\n                // eslint-disable-next-line @typescript-eslint/no-throw-literal\r\n                throw this._stopDuringStartError;\r\n            }\r\n            const useStatefulReconnect = this.connection.features.reconnect || false;\r\n            if (useStatefulReconnect) {\r\n                this._messageBuffer = new MessageBuffer(this._protocol, this.connection, this._statefulReconnectBufferSize);\r\n                this.connection.features.disconnected = this._messageBuffer._disconnected.bind(this._messageBuffer);\r\n                this.connection.features.resend = () => {\r\n                    if (this._messageBuffer) {\r\n                        return this._messageBuffer._resend();\r\n                    }\r\n                };\r\n            }\r\n            if (!this.connection.features.inherentKeepAlive) {\r\n                await this._sendMessage(this._cachedPingMessage);\r\n            }\r\n        }\r\n        catch (e) {\r\n            this._logger.log(LogLevel.Debug, `Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`);\r\n            this._cleanupTimeout();\r\n            this._cleanupPingTimer();\r\n            // HttpConnection.stop() should not complete until after the onclose callback is invoked.\r\n            // This will transition the HubConnection to the disconnected state before HttpConnection.stop() completes.\r\n            await this.connection.stop(e);\r\n            throw e;\r\n        }\r\n    }\r\n    /** Stops the connection.\r\n     *\r\n     * @returns {Promise<void>} A Promise that resolves when the connection has been successfully terminated, or rejects with an error.\r\n     */\r\n    async stop() {\r\n        // Capture the start promise before the connection might be restarted in an onclose callback.\r\n        const startPromise = this._startPromise;\r\n        this.connection.features.reconnect = false;\r\n        this._stopPromise = this._stopInternal();\r\n        await this._stopPromise;\r\n        try {\r\n            // Awaiting undefined continues immediately\r\n            await startPromise;\r\n        }\r\n        catch (e) {\r\n            // This exception is returned to the user as a rejected Promise from the start method.\r\n        }\r\n    }\r\n    _stopInternal(error) {\r\n        if (this._connectionState === HubConnectionState.Disconnected) {\r\n            this._logger.log(LogLevel.Debug, `Call to HubConnection.stop(${error}) ignored because it is already in the disconnected state.`);\r\n            return Promise.resolve();\r\n        }\r\n        if (this._connectionState === HubConnectionState.Disconnecting) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnecting state.`);\r\n            return this._stopPromise;\r\n        }\r\n        const state = this._connectionState;\r\n        this._connectionState = HubConnectionState.Disconnecting;\r\n        this._logger.log(LogLevel.Debug, \"Stopping HubConnection.\");\r\n        if (this._reconnectDelayHandle) {\r\n            // We're in a reconnect delay which means the underlying connection is currently already stopped.\r\n            // Just clear the handle to stop the reconnect loop (which no one is waiting on thankfully) and\r\n            // fire the onclose callbacks.\r\n            this._logger.log(LogLevel.Debug, \"Connection stopped during reconnect delay. Done reconnecting.\");\r\n            clearTimeout(this._reconnectDelayHandle);\r\n            this._reconnectDelayHandle = undefined;\r\n            this._completeClose();\r\n            return Promise.resolve();\r\n        }\r\n        if (state === HubConnectionState.Connected) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this._sendCloseMessage();\r\n        }\r\n        this._cleanupTimeout();\r\n        this._cleanupPingTimer();\r\n        this._stopDuringStartError = error || new AbortError(\"The connection was stopped before the hub handshake could complete.\");\r\n        // HttpConnection.stop() should not complete until after either HttpConnection.start() fails\r\n        // or the onclose callback is invoked. The onclose callback will transition the HubConnection\r\n        // to the disconnected state if need be before HttpConnection.stop() completes.\r\n        return this.connection.stop(error);\r\n    }\r\n    async _sendCloseMessage() {\r\n        try {\r\n            await this._sendWithProtocol(this._createCloseMessage());\r\n        }\r\n        catch {\r\n            // Ignore, this is a best effort attempt to let the server know the client closed gracefully.\r\n        }\r\n    }\r\n    /** Invokes a streaming hub method on the server using the specified name and arguments.\r\n     *\r\n     * @typeparam T The type of the items returned by the server.\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {IStreamResult<T>} An object that yields results from the server as they are received.\r\n     */\r\n    stream(methodName, ...args) {\r\n        const [streams, streamIds] = this._replaceStreamingParams(args);\r\n        const invocationDescriptor = this._createStreamInvocation(methodName, args, streamIds);\r\n        // eslint-disable-next-line prefer-const\r\n        let promiseQueue;\r\n        const subject = new Subject();\r\n        subject.cancelCallback = () => {\r\n            const cancelInvocation = this._createCancelInvocation(invocationDescriptor.invocationId);\r\n            delete this._callbacks[invocationDescriptor.invocationId];\r\n            return promiseQueue.then(() => {\r\n                return this._sendWithProtocol(cancelInvocation);\r\n            });\r\n        };\r\n        this._callbacks[invocationDescriptor.invocationId] = (invocationEvent, error) => {\r\n            if (error) {\r\n                subject.error(error);\r\n                return;\r\n            }\r\n            else if (invocationEvent) {\r\n                // invocationEvent will not be null when an error is not passed to the callback\r\n                if (invocationEvent.type === MessageType.Completion) {\r\n                    if (invocationEvent.error) {\r\n                        subject.error(new Error(invocationEvent.error));\r\n                    }\r\n                    else {\r\n                        subject.complete();\r\n                    }\r\n                }\r\n                else {\r\n                    subject.next((invocationEvent.item));\r\n                }\r\n            }\r\n        };\r\n        promiseQueue = this._sendWithProtocol(invocationDescriptor)\r\n            .catch((e) => {\r\n            subject.error(e);\r\n            delete this._callbacks[invocationDescriptor.invocationId];\r\n        });\r\n        this._launchStreams(streams, promiseQueue);\r\n        return subject;\r\n    }\r\n    _sendMessage(message) {\r\n        this._resetKeepAliveInterval();\r\n        return this.connection.send(message);\r\n    }\r\n    /**\r\n     * Sends a js object to the server.\r\n     * @param message The js object to serialize and send.\r\n     */\r\n    _sendWithProtocol(message) {\r\n        if (this._messageBuffer) {\r\n            return this._messageBuffer._send(message);\r\n        }\r\n        else {\r\n            return this._sendMessage(this._protocol.writeMessage(message));\r\n        }\r\n    }\r\n    /** Invokes a hub method on the server using the specified name and arguments. Does not wait for a response from the receiver.\r\n     *\r\n     * The Promise returned by this method resolves when the client has sent the invocation to the server. The server may still\r\n     * be processing the invocation.\r\n     *\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {Promise<void>} A Promise that resolves when the invocation has been successfully sent, or rejects with an error.\r\n     */\r\n    send(methodName, ...args) {\r\n        const [streams, streamIds] = this._replaceStreamingParams(args);\r\n        const sendPromise = this._sendWithProtocol(this._createInvocation(methodName, args, true, streamIds));\r\n        this._launchStreams(streams, sendPromise);\r\n        return sendPromise;\r\n    }\r\n    /** Invokes a hub method on the server using the specified name and arguments.\r\n     *\r\n     * The Promise returned by this method resolves when the server indicates it has finished invoking the method. When the promise\r\n     * resolves, the server has finished invoking the method. If the server method returns a result, it is produced as the result of\r\n     * resolving the Promise.\r\n     *\r\n     * @typeparam T The expected return type.\r\n     * @param {string} methodName The name of the server method to invoke.\r\n     * @param {any[]} args The arguments used to invoke the server method.\r\n     * @returns {Promise<T>} A Promise that resolves with the result of the server method (if any), or rejects with an error.\r\n     */\r\n    invoke(methodName, ...args) {\r\n        const [streams, streamIds] = this._replaceStreamingParams(args);\r\n        const invocationDescriptor = this._createInvocation(methodName, args, false, streamIds);\r\n        const p = new Promise((resolve, reject) => {\r\n            // invocationId will always have a value for a non-blocking invocation\r\n            this._callbacks[invocationDescriptor.invocationId] = (invocationEvent, error) => {\r\n                if (error) {\r\n                    reject(error);\r\n                    return;\r\n                }\r\n                else if (invocationEvent) {\r\n                    // invocationEvent will not be null when an error is not passed to the callback\r\n                    if (invocationEvent.type === MessageType.Completion) {\r\n                        if (invocationEvent.error) {\r\n                            reject(new Error(invocationEvent.error));\r\n                        }\r\n                        else {\r\n                            resolve(invocationEvent.result);\r\n                        }\r\n                    }\r\n                    else {\r\n                        reject(new Error(`Unexpected message type: ${invocationEvent.type}`));\r\n                    }\r\n                }\r\n            };\r\n            const promiseQueue = this._sendWithProtocol(invocationDescriptor)\r\n                .catch((e) => {\r\n                reject(e);\r\n                // invocationId will always have a value for a non-blocking invocation\r\n                delete this._callbacks[invocationDescriptor.invocationId];\r\n            });\r\n            this._launchStreams(streams, promiseQueue);\r\n        });\r\n        return p;\r\n    }\r\n    on(methodName, newMethod) {\r\n        if (!methodName || !newMethod) {\r\n            return;\r\n        }\r\n        methodName = methodName.toLowerCase();\r\n        if (!this._methods[methodName]) {\r\n            this._methods[methodName] = [];\r\n        }\r\n        // Preventing adding the same handler multiple times.\r\n        if (this._methods[methodName].indexOf(newMethod) !== -1) {\r\n            return;\r\n        }\r\n        this._methods[methodName].push(newMethod);\r\n    }\r\n    off(methodName, method) {\r\n        if (!methodName) {\r\n            return;\r\n        }\r\n        methodName = methodName.toLowerCase();\r\n        const handlers = this._methods[methodName];\r\n        if (!handlers) {\r\n            return;\r\n        }\r\n        if (method) {\r\n            const removeIdx = handlers.indexOf(method);\r\n            if (removeIdx !== -1) {\r\n                handlers.splice(removeIdx, 1);\r\n                if (handlers.length === 0) {\r\n                    delete this._methods[methodName];\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            delete this._methods[methodName];\r\n        }\r\n    }\r\n    /** Registers a handler that will be invoked when the connection is closed.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection is closed. Optionally receives a single argument containing the error that caused the connection to close (if any).\r\n     */\r\n    onclose(callback) {\r\n        if (callback) {\r\n            this._closedCallbacks.push(callback);\r\n        }\r\n    }\r\n    /** Registers a handler that will be invoked when the connection starts reconnecting.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection starts reconnecting. Optionally receives a single argument containing the error that caused the connection to start reconnecting (if any).\r\n     */\r\n    onreconnecting(callback) {\r\n        if (callback) {\r\n            this._reconnectingCallbacks.push(callback);\r\n        }\r\n    }\r\n    /** Registers a handler that will be invoked when the connection successfully reconnects.\r\n     *\r\n     * @param {Function} callback The handler that will be invoked when the connection successfully reconnects.\r\n     */\r\n    onreconnected(callback) {\r\n        if (callback) {\r\n            this._reconnectedCallbacks.push(callback);\r\n        }\r\n    }\r\n    _processIncomingData(data) {\r\n        this._cleanupTimeout();\r\n        if (!this._receivedHandshakeResponse) {\r\n            data = this._processHandshakeResponse(data);\r\n            this._receivedHandshakeResponse = true;\r\n        }\r\n        // Data may have all been read when processing handshake response\r\n        if (data) {\r\n            // Parse the messages\r\n            const messages = this._protocol.parseMessages(data, this._logger);\r\n            for (const message of messages) {\r\n                if (this._messageBuffer && !this._messageBuffer._shouldProcessMessage(message)) {\r\n                    // Don't process the message, we are either waiting for a SequenceMessage or received a duplicate message\r\n                    continue;\r\n                }\r\n                switch (message.type) {\r\n                    case MessageType.Invocation:\r\n                        this._invokeClientMethod(message)\r\n                            .catch((e) => {\r\n                            this._logger.log(LogLevel.Error, `Invoke client method threw error: ${getErrorString(e)}`);\r\n                        });\r\n                        break;\r\n                    case MessageType.StreamItem:\r\n                    case MessageType.Completion: {\r\n                        const callback = this._callbacks[message.invocationId];\r\n                        if (callback) {\r\n                            if (message.type === MessageType.Completion) {\r\n                                delete this._callbacks[message.invocationId];\r\n                            }\r\n                            try {\r\n                                callback(message);\r\n                            }\r\n                            catch (e) {\r\n                                this._logger.log(LogLevel.Error, `Stream callback threw error: ${getErrorString(e)}`);\r\n                            }\r\n                        }\r\n                        break;\r\n                    }\r\n                    case MessageType.Ping:\r\n                        // Don't care about pings\r\n                        break;\r\n                    case MessageType.Close: {\r\n                        this._logger.log(LogLevel.Information, \"Close message received from server.\");\r\n                        const error = message.error ? new Error(\"Server returned an error on close: \" + message.error) : undefined;\r\n                        if (message.allowReconnect === true) {\r\n                            // It feels wrong not to await connection.stop() here, but processIncomingData is called as part of an onreceive callback which is not async,\r\n                            // this is already the behavior for serverTimeout(), and HttpConnection.Stop() should catch and log all possible exceptions.\r\n                            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n                            this.connection.stop(error);\r\n                        }\r\n                        else {\r\n                            // We cannot await stopInternal() here, but subsequent calls to stop() will await this if stopInternal() is still ongoing.\r\n                            this._stopPromise = this._stopInternal(error);\r\n                        }\r\n                        break;\r\n                    }\r\n                    case MessageType.Ack:\r\n                        if (this._messageBuffer) {\r\n                            this._messageBuffer._ack(message);\r\n                        }\r\n                        break;\r\n                    case MessageType.Sequence:\r\n                        if (this._messageBuffer) {\r\n                            this._messageBuffer._resetSequence(message);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        this._logger.log(LogLevel.Warning, `Invalid message type: ${message.type}.`);\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        this._resetTimeoutPeriod();\r\n    }\r\n    _processHandshakeResponse(data) {\r\n        let responseMessage;\r\n        let remainingData;\r\n        try {\r\n            [remainingData, responseMessage] = this._handshakeProtocol.parseHandshakeResponse(data);\r\n        }\r\n        catch (e) {\r\n            const message = \"Error parsing handshake response: \" + e;\r\n            this._logger.log(LogLevel.Error, message);\r\n            const error = new Error(message);\r\n            this._handshakeRejecter(error);\r\n            throw error;\r\n        }\r\n        if (responseMessage.error) {\r\n            const message = \"Server returned handshake error: \" + responseMessage.error;\r\n            this._logger.log(LogLevel.Error, message);\r\n            const error = new Error(message);\r\n            this._handshakeRejecter(error);\r\n            throw error;\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Debug, \"Server handshake complete.\");\r\n        }\r\n        this._handshakeResolver();\r\n        return remainingData;\r\n    }\r\n    _resetKeepAliveInterval() {\r\n        if (this.connection.features.inherentKeepAlive) {\r\n            return;\r\n        }\r\n        // Set the time we want the next keep alive to be sent\r\n        // Timer will be setup on next message receive\r\n        this._nextKeepAlive = new Date().getTime() + this.keepAliveIntervalInMilliseconds;\r\n        this._cleanupPingTimer();\r\n    }\r\n    _resetTimeoutPeriod() {\r\n        if (!this.connection.features || !this.connection.features.inherentKeepAlive) {\r\n            // Set the timeout timer\r\n            this._timeoutHandle = setTimeout(() => this.serverTimeout(), this.serverTimeoutInMilliseconds);\r\n            // Set keepAlive timer if there isn't one\r\n            if (this._pingServerHandle === undefined) {\r\n                let nextPing = this._nextKeepAlive - new Date().getTime();\r\n                if (nextPing < 0) {\r\n                    nextPing = 0;\r\n                }\r\n                // The timer needs to be set from a networking callback to avoid Chrome timer throttling from causing timers to run once a minute\r\n                this._pingServerHandle = setTimeout(async () => {\r\n                    if (this._connectionState === HubConnectionState.Connected) {\r\n                        try {\r\n                            await this._sendMessage(this._cachedPingMessage);\r\n                        }\r\n                        catch {\r\n                            // We don't care about the error. It should be seen elsewhere in the client.\r\n                            // The connection is probably in a bad or closed state now, cleanup the timer so it stops triggering\r\n                            this._cleanupPingTimer();\r\n                        }\r\n                    }\r\n                }, nextPing);\r\n            }\r\n        }\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    serverTimeout() {\r\n        // The server hasn't talked to us in a while. It doesn't like us anymore ... :(\r\n        // Terminate the connection, but we don't need to wait on the promise. This could trigger reconnecting.\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.connection.stop(new Error(\"Server timeout elapsed without receiving a message from the server.\"));\r\n    }\r\n    async _invokeClientMethod(invocationMessage) {\r\n        const methodName = invocationMessage.target.toLowerCase();\r\n        const methods = this._methods[methodName];\r\n        if (!methods) {\r\n            this._logger.log(LogLevel.Warning, `No client method with the name '${methodName}' found.`);\r\n            // No handlers provided by client but the server is expecting a response still, so we send an error\r\n            if (invocationMessage.invocationId) {\r\n                this._logger.log(LogLevel.Warning, `No result given for '${methodName}' method and invocation ID '${invocationMessage.invocationId}'.`);\r\n                await this._sendWithProtocol(this._createCompletionMessage(invocationMessage.invocationId, \"Client didn't provide a result.\", null));\r\n            }\r\n            return;\r\n        }\r\n        // Avoid issues with handlers removing themselves thus modifying the list while iterating through it\r\n        const methodsCopy = methods.slice();\r\n        // Server expects a response\r\n        const expectsResponse = invocationMessage.invocationId ? true : false;\r\n        // We preserve the last result or exception but still call all handlers\r\n        let res;\r\n        let exception;\r\n        let completionMessage;\r\n        for (const m of methodsCopy) {\r\n            try {\r\n                const prevRes = res;\r\n                res = await m.apply(this, invocationMessage.arguments);\r\n                if (expectsResponse && res && prevRes) {\r\n                    this._logger.log(LogLevel.Error, `Multiple results provided for '${methodName}'. Sending error to server.`);\r\n                    completionMessage = this._createCompletionMessage(invocationMessage.invocationId, `Client provided multiple results.`, null);\r\n                }\r\n                // Ignore exception if we got a result after, the exception will be logged\r\n                exception = undefined;\r\n            }\r\n            catch (e) {\r\n                exception = e;\r\n                this._logger.log(LogLevel.Error, `A callback for the method '${methodName}' threw error '${e}'.`);\r\n            }\r\n        }\r\n        if (completionMessage) {\r\n            await this._sendWithProtocol(completionMessage);\r\n        }\r\n        else if (expectsResponse) {\r\n            // If there is an exception that means either no result was given or a handler after a result threw\r\n            if (exception) {\r\n                completionMessage = this._createCompletionMessage(invocationMessage.invocationId, `${exception}`, null);\r\n            }\r\n            else if (res !== undefined) {\r\n                completionMessage = this._createCompletionMessage(invocationMessage.invocationId, null, res);\r\n            }\r\n            else {\r\n                this._logger.log(LogLevel.Warning, `No result given for '${methodName}' method and invocation ID '${invocationMessage.invocationId}'.`);\r\n                // Client didn't provide a result or throw from a handler, server expects a response so we send an error\r\n                completionMessage = this._createCompletionMessage(invocationMessage.invocationId, \"Client didn't provide a result.\", null);\r\n            }\r\n            await this._sendWithProtocol(completionMessage);\r\n        }\r\n        else {\r\n            if (res) {\r\n                this._logger.log(LogLevel.Error, `Result given for '${methodName}' method but server is not expecting a result.`);\r\n            }\r\n        }\r\n    }\r\n    _connectionClosed(error) {\r\n        this._logger.log(LogLevel.Debug, `HubConnection.connectionClosed(${error}) called while in state ${this._connectionState}.`);\r\n        // Triggering this.handshakeRejecter is insufficient because it could already be resolved without the continuation having run yet.\r\n        this._stopDuringStartError = this._stopDuringStartError || error || new AbortError(\"The underlying connection was closed before the hub handshake could complete.\");\r\n        // If the handshake is in progress, start will be waiting for the handshake promise, so we complete it.\r\n        // If it has already completed, this should just noop.\r\n        if (this._handshakeResolver) {\r\n            this._handshakeResolver();\r\n        }\r\n        this._cancelCallbacksWithError(error || new Error(\"Invocation canceled due to the underlying connection being closed.\"));\r\n        this._cleanupTimeout();\r\n        this._cleanupPingTimer();\r\n        if (this._connectionState === HubConnectionState.Disconnecting) {\r\n            this._completeClose(error);\r\n        }\r\n        else if (this._connectionState === HubConnectionState.Connected && this._reconnectPolicy) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this._reconnect(error);\r\n        }\r\n        else if (this._connectionState === HubConnectionState.Connected) {\r\n            this._completeClose(error);\r\n        }\r\n        // If none of the above if conditions were true were called the HubConnection must be in either:\r\n        // 1. The Connecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail it.\r\n        // 2. The Reconnecting state in which case the handshakeResolver will complete it and stopDuringStartError will fail the current reconnect attempt\r\n        //    and potentially continue the reconnect() loop.\r\n        // 3. The Disconnected state in which case we're already done.\r\n    }\r\n    _completeClose(error) {\r\n        if (this._connectionStarted) {\r\n            this._connectionState = HubConnectionState.Disconnected;\r\n            this._connectionStarted = false;\r\n            if (this._messageBuffer) {\r\n                this._messageBuffer._dispose(error !== null && error !== void 0 ? error : new Error(\"Connection closed.\"));\r\n                this._messageBuffer = undefined;\r\n            }\r\n            if (Platform.isBrowser) {\r\n                window.document.removeEventListener(\"freeze\", this._freezeEventListener);\r\n            }\r\n            try {\r\n                this._closedCallbacks.forEach((c) => c.apply(this, [error]));\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `An onclose callback called with error '${error}' threw error '${e}'.`);\r\n            }\r\n        }\r\n    }\r\n    async _reconnect(error) {\r\n        const reconnectStartTime = Date.now();\r\n        let previousReconnectAttempts = 0;\r\n        let retryError = error !== undefined ? error : new Error(\"Attempting to reconnect due to a unknown error.\");\r\n        let nextRetryDelay = this._getNextRetryDelay(previousReconnectAttempts++, 0, retryError);\r\n        if (nextRetryDelay === null) {\r\n            this._logger.log(LogLevel.Debug, \"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt.\");\r\n            this._completeClose(error);\r\n            return;\r\n        }\r\n        this._connectionState = HubConnectionState.Reconnecting;\r\n        if (error) {\r\n            this._logger.log(LogLevel.Information, `Connection reconnecting because of error '${error}'.`);\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Information, \"Connection reconnecting.\");\r\n        }\r\n        if (this._reconnectingCallbacks.length !== 0) {\r\n            try {\r\n                this._reconnectingCallbacks.forEach((c) => c.apply(this, [error]));\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `An onreconnecting callback called with error '${error}' threw error '${e}'.`);\r\n            }\r\n            // Exit early if an onreconnecting callback called connection.stop().\r\n            if (this._connectionState !== HubConnectionState.Reconnecting) {\r\n                this._logger.log(LogLevel.Debug, \"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.\");\r\n                return;\r\n            }\r\n        }\r\n        while (nextRetryDelay !== null) {\r\n            this._logger.log(LogLevel.Information, `Reconnect attempt number ${previousReconnectAttempts} will start in ${nextRetryDelay} ms.`);\r\n            await new Promise((resolve) => {\r\n                this._reconnectDelayHandle = setTimeout(resolve, nextRetryDelay);\r\n            });\r\n            this._reconnectDelayHandle = undefined;\r\n            if (this._connectionState !== HubConnectionState.Reconnecting) {\r\n                this._logger.log(LogLevel.Debug, \"Connection left the reconnecting state during reconnect delay. Done reconnecting.\");\r\n                return;\r\n            }\r\n            try {\r\n                await this._startInternal();\r\n                this._connectionState = HubConnectionState.Connected;\r\n                this._logger.log(LogLevel.Information, \"HubConnection reconnected successfully.\");\r\n                if (this._reconnectedCallbacks.length !== 0) {\r\n                    try {\r\n                        this._reconnectedCallbacks.forEach((c) => c.apply(this, [this.connection.connectionId]));\r\n                    }\r\n                    catch (e) {\r\n                        this._logger.log(LogLevel.Error, `An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`);\r\n                    }\r\n                }\r\n                return;\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Information, `Reconnect attempt failed because of error '${e}'.`);\r\n                if (this._connectionState !== HubConnectionState.Reconnecting) {\r\n                    this._logger.log(LogLevel.Debug, `Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`);\r\n                    // The TypeScript compiler thinks that connectionState must be Connected here. The TypeScript compiler is wrong.\r\n                    if (this._connectionState === HubConnectionState.Disconnecting) {\r\n                        this._completeClose();\r\n                    }\r\n                    return;\r\n                }\r\n                retryError = e instanceof Error ? e : new Error(e.toString());\r\n                nextRetryDelay = this._getNextRetryDelay(previousReconnectAttempts++, Date.now() - reconnectStartTime, retryError);\r\n            }\r\n        }\r\n        this._logger.log(LogLevel.Information, `Reconnect retries have been exhausted after ${Date.now() - reconnectStartTime} ms and ${previousReconnectAttempts} failed attempts. Connection disconnecting.`);\r\n        this._completeClose();\r\n    }\r\n    _getNextRetryDelay(previousRetryCount, elapsedMilliseconds, retryReason) {\r\n        try {\r\n            return this._reconnectPolicy.nextRetryDelayInMilliseconds({\r\n                elapsedMilliseconds,\r\n                previousRetryCount,\r\n                retryReason,\r\n            });\r\n        }\r\n        catch (e) {\r\n            this._logger.log(LogLevel.Error, `IRetryPolicy.nextRetryDelayInMilliseconds(${previousRetryCount}, ${elapsedMilliseconds}) threw error '${e}'.`);\r\n            return null;\r\n        }\r\n    }\r\n    _cancelCallbacksWithError(error) {\r\n        const callbacks = this._callbacks;\r\n        this._callbacks = {};\r\n        Object.keys(callbacks)\r\n            .forEach((key) => {\r\n            const callback = callbacks[key];\r\n            try {\r\n                callback(null, error);\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `Stream 'error' callback called with '${error}' threw error: ${getErrorString(e)}`);\r\n            }\r\n        });\r\n    }\r\n    _cleanupPingTimer() {\r\n        if (this._pingServerHandle) {\r\n            clearTimeout(this._pingServerHandle);\r\n            this._pingServerHandle = undefined;\r\n        }\r\n    }\r\n    _cleanupTimeout() {\r\n        if (this._timeoutHandle) {\r\n            clearTimeout(this._timeoutHandle);\r\n        }\r\n    }\r\n    _createInvocation(methodName, args, nonblocking, streamIds) {\r\n        if (nonblocking) {\r\n            if (streamIds.length !== 0) {\r\n                return {\r\n                    arguments: args,\r\n                    streamIds,\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    arguments: args,\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n        }\r\n        else {\r\n            const invocationId = this._invocationId;\r\n            this._invocationId++;\r\n            if (streamIds.length !== 0) {\r\n                return {\r\n                    arguments: args,\r\n                    invocationId: invocationId.toString(),\r\n                    streamIds,\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n            else {\r\n                return {\r\n                    arguments: args,\r\n                    invocationId: invocationId.toString(),\r\n                    target: methodName,\r\n                    type: MessageType.Invocation,\r\n                };\r\n            }\r\n        }\r\n    }\r\n    _launchStreams(streams, promiseQueue) {\r\n        if (streams.length === 0) {\r\n            return;\r\n        }\r\n        // Synchronize stream data so they arrive in-order on the server\r\n        if (!promiseQueue) {\r\n            promiseQueue = Promise.resolve();\r\n        }\r\n        // We want to iterate over the keys, since the keys are the stream ids\r\n        // eslint-disable-next-line guard-for-in\r\n        for (const streamId in streams) {\r\n            streams[streamId].subscribe({\r\n                complete: () => {\r\n                    promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createCompletionMessage(streamId)));\r\n                },\r\n                error: (err) => {\r\n                    let message;\r\n                    if (err instanceof Error) {\r\n                        message = err.message;\r\n                    }\r\n                    else if (err && err.toString) {\r\n                        message = err.toString();\r\n                    }\r\n                    else {\r\n                        message = \"Unknown error\";\r\n                    }\r\n                    promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createCompletionMessage(streamId, message)));\r\n                },\r\n                next: (item) => {\r\n                    promiseQueue = promiseQueue.then(() => this._sendWithProtocol(this._createStreamItemMessage(streamId, item)));\r\n                },\r\n            });\r\n        }\r\n    }\r\n    _replaceStreamingParams(args) {\r\n        const streams = [];\r\n        const streamIds = [];\r\n        for (let i = 0; i < args.length; i++) {\r\n            const argument = args[i];\r\n            if (this._isObservable(argument)) {\r\n                const streamId = this._invocationId;\r\n                this._invocationId++;\r\n                // Store the stream for later use\r\n                streams[streamId] = argument;\r\n                streamIds.push(streamId.toString());\r\n                // remove stream from args\r\n                args.splice(i, 1);\r\n            }\r\n        }\r\n        return [streams, streamIds];\r\n    }\r\n    _isObservable(arg) {\r\n        // This allows other stream implementations to just work (like rxjs)\r\n        return arg && arg.subscribe && typeof arg.subscribe === \"function\";\r\n    }\r\n    _createStreamInvocation(methodName, args, streamIds) {\r\n        const invocationId = this._invocationId;\r\n        this._invocationId++;\r\n        if (streamIds.length !== 0) {\r\n            return {\r\n                arguments: args,\r\n                invocationId: invocationId.toString(),\r\n                streamIds,\r\n                target: methodName,\r\n                type: MessageType.StreamInvocation,\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                arguments: args,\r\n                invocationId: invocationId.toString(),\r\n                target: methodName,\r\n                type: MessageType.StreamInvocation,\r\n            };\r\n        }\r\n    }\r\n    _createCancelInvocation(id) {\r\n        return {\r\n            invocationId: id,\r\n            type: MessageType.CancelInvocation,\r\n        };\r\n    }\r\n    _createStreamItemMessage(id, item) {\r\n        return {\r\n            invocationId: id,\r\n            item,\r\n            type: MessageType.StreamItem,\r\n        };\r\n    }\r\n    _createCompletionMessage(id, error, result) {\r\n        if (error) {\r\n            return {\r\n                error,\r\n                invocationId: id,\r\n                type: MessageType.Completion,\r\n            };\r\n        }\r\n        return {\r\n            invocationId: id,\r\n            result,\r\n            type: MessageType.Completion,\r\n        };\r\n    }\r\n    _createCloseMessage() {\r\n        return { type: MessageType.Close };\r\n    }\r\n}\r\n//# sourceMappingURL=HubConnection.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// 0, 2, 10, 30 second delays before reconnect attempts.\r\nconst DEFAULT_RETRY_DELAYS_IN_MILLISECONDS = [0, 2000, 10000, 30000, null];\r\n/** @private */\r\nexport class DefaultReconnectPolicy {\r\n    constructor(retryDelays) {\r\n        this._retryDelays = retryDelays !== undefined ? [...retryDelays, null] : DEFAULT_RETRY_DELAYS_IN_MILLISECONDS;\r\n    }\r\n    nextRetryDelayInMilliseconds(retryContext) {\r\n        return this._retryDelays[retryContext.previousRetryCount];\r\n    }\r\n}\r\n//# sourceMappingURL=DefaultReconnectPolicy.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nexport class HeaderNames {\r\n}\r\nHeaderNames.Authorization = \"Authorization\";\r\nHeaderNames.Cookie = \"Cookie\";\r\n//# sourceMappingURL=HeaderNames.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { HeaderNames } from \"./HeaderNames\";\r\nimport { HttpClient } from \"./HttpClient\";\r\n/** @private */\r\nexport class AccessTokenHttpClient extends HttpClient {\r\n    constructor(innerClient, accessTokenFactory) {\r\n        super();\r\n        this._innerClient = innerClient;\r\n        this._accessTokenFactory = accessTokenFactory;\r\n    }\r\n    async send(request) {\r\n        let allowRetry = true;\r\n        if (this._accessTokenFactory && (!this._accessToken || (request.url && request.url.indexOf(\"/negotiate?\") > 0))) {\r\n            // don't retry if the request is a negotiate or if we just got a potentially new token from the access token factory\r\n            allowRetry = false;\r\n            this._accessToken = await this._accessTokenFactory();\r\n        }\r\n        this._setAuthorizationHeader(request);\r\n        const response = await this._innerClient.send(request);\r\n        if (allowRetry && response.statusCode === 401 && this._accessTokenFactory) {\r\n            this._accessToken = await this._accessTokenFactory();\r\n            this._setAuthorizationHeader(request);\r\n            return await this._innerClient.send(request);\r\n        }\r\n        return response;\r\n    }\r\n    _setAuthorizationHeader(request) {\r\n        if (!request.headers) {\r\n            request.headers = {};\r\n        }\r\n        if (this._accessToken) {\r\n            request.headers[HeaderNames.Authorization] = `Bearer ${this._accessToken}`;\r\n        }\r\n        // don't remove the header if there isn't an access token factory, the user manually added the header in this case\r\n        else if (this._accessTokenFactory) {\r\n            if (request.headers[HeaderNames.Authorization]) {\r\n                delete request.headers[HeaderNames.Authorization];\r\n            }\r\n        }\r\n    }\r\n    getCookieString(url) {\r\n        return this._innerClient.getCookieString(url);\r\n    }\r\n}\r\n//# sourceMappingURL=AccessTokenHttpClient.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// This will be treated as a bit flag in the future, so we keep it using power-of-two values.\r\n/** Specifies a specific HTTP transport type. */\r\nexport var HttpTransportType;\r\n(function (HttpTransportType) {\r\n    /** Specifies no transport preference. */\r\n    HttpTransportType[HttpTransportType[\"None\"] = 0] = \"None\";\r\n    /** Specifies the WebSockets transport. */\r\n    HttpTransportType[HttpTransportType[\"WebSockets\"] = 1] = \"WebSockets\";\r\n    /** Specifies the Server-Sent Events transport. */\r\n    HttpTransportType[HttpTransportType[\"ServerSentEvents\"] = 2] = \"ServerSentEvents\";\r\n    /** Specifies the Long Polling transport. */\r\n    HttpTransportType[HttpTransportType[\"LongPolling\"] = 4] = \"LongPolling\";\r\n})(HttpTransportType || (HttpTransportType = {}));\r\n/** Specifies the transfer format for a connection. */\r\nexport var TransferFormat;\r\n(function (TransferFormat) {\r\n    /** Specifies that only text data will be transmitted over the connection. */\r\n    TransferFormat[TransferFormat[\"Text\"] = 1] = \"Text\";\r\n    /** Specifies that binary data will be transmitted over the connection. */\r\n    TransferFormat[TransferFormat[\"Binary\"] = 2] = \"Binary\";\r\n})(TransferFormat || (TransferFormat = {}));\r\n//# sourceMappingURL=ITransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\n// Rough polyfill of https://developer.mozilla.org/en-US/docs/Web/API/AbortController\r\n// We don't actually ever use the API being polyfilled, we always use the polyfill because\r\n// it's a very new API right now.\r\n// Not exported from index.\r\n/** @private */\r\nexport class AbortController {\r\n    constructor() {\r\n        this._isAborted = false;\r\n        this.onabort = null;\r\n    }\r\n    abort() {\r\n        if (!this._isAborted) {\r\n            this._isAborted = true;\r\n            if (this.onabort) {\r\n                this.onabort();\r\n            }\r\n        }\r\n    }\r\n    get signal() {\r\n        return this;\r\n    }\r\n    get aborted() {\r\n        return this._isAborted;\r\n    }\r\n}\r\n//# sourceMappingURL=AbortController.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AbortController } from \"./AbortController\";\r\nimport { HttpError, TimeoutError } from \"./Errors\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, getUserAgentHeader, sendMessage } from \"./Utils\";\r\n// Not exported from 'index', this type is internal.\r\n/** @private */\r\nexport class LongPollingTransport {\r\n    // This is an internal type, not exported from 'index' so this is really just internal.\r\n    get pollAborted() {\r\n        return this._pollAbort.aborted;\r\n    }\r\n    constructor(httpClient, logger, options) {\r\n        this._httpClient = httpClient;\r\n        this._logger = logger;\r\n        this._pollAbort = new AbortController();\r\n        this._options = options;\r\n        this._running = false;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    async connect(url, transferFormat) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isRequired(transferFormat, \"transferFormat\");\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._url = url;\r\n        this._logger.log(LogLevel.Trace, \"(LongPolling transport) Connecting.\");\r\n        // Allow binary format on Node and Browsers that support binary content (indicated by the presence of responseType property)\r\n        if (transferFormat === TransferFormat.Binary &&\r\n            (typeof XMLHttpRequest !== \"undefined\" && typeof new XMLHttpRequest().responseType !== \"string\")) {\r\n            throw new Error(\"Binary protocols over XmlHttpRequest not implementing advanced features are not supported.\");\r\n        }\r\n        const [name, value] = getUserAgentHeader();\r\n        const headers = { [name]: value, ...this._options.headers };\r\n        const pollOptions = {\r\n            abortSignal: this._pollAbort.signal,\r\n            headers,\r\n            timeout: 100000,\r\n            withCredentials: this._options.withCredentials,\r\n        };\r\n        if (transferFormat === TransferFormat.Binary) {\r\n            pollOptions.responseType = \"arraybuffer\";\r\n        }\r\n        // Make initial long polling request\r\n        // Server uses first long polling request to finish initializing connection and it returns without data\r\n        const pollUrl = `${url}&_=${Date.now()}`;\r\n        this._logger.log(LogLevel.Trace, `(LongPolling transport) polling: ${pollUrl}.`);\r\n        const response = await this._httpClient.get(pollUrl, pollOptions);\r\n        if (response.statusCode !== 200) {\r\n            this._logger.log(LogLevel.Error, `(LongPolling transport) Unexpected response code: ${response.statusCode}.`);\r\n            // Mark running as false so that the poll immediately ends and runs the close logic\r\n            this._closeError = new HttpError(response.statusText || \"\", response.statusCode);\r\n            this._running = false;\r\n        }\r\n        else {\r\n            this._running = true;\r\n        }\r\n        this._receiving = this._poll(this._url, pollOptions);\r\n    }\r\n    async _poll(url, pollOptions) {\r\n        try {\r\n            while (this._running) {\r\n                try {\r\n                    const pollUrl = `${url}&_=${Date.now()}`;\r\n                    this._logger.log(LogLevel.Trace, `(LongPolling transport) polling: ${pollUrl}.`);\r\n                    const response = await this._httpClient.get(pollUrl, pollOptions);\r\n                    if (response.statusCode === 204) {\r\n                        this._logger.log(LogLevel.Information, \"(LongPolling transport) Poll terminated by server.\");\r\n                        this._running = false;\r\n                    }\r\n                    else if (response.statusCode !== 200) {\r\n                        this._logger.log(LogLevel.Error, `(LongPolling transport) Unexpected response code: ${response.statusCode}.`);\r\n                        // Unexpected status code\r\n                        this._closeError = new HttpError(response.statusText || \"\", response.statusCode);\r\n                        this._running = false;\r\n                    }\r\n                    else {\r\n                        // Process the response\r\n                        if (response.content) {\r\n                            this._logger.log(LogLevel.Trace, `(LongPolling transport) data received. ${getDataDetail(response.content, this._options.logMessageContent)}.`);\r\n                            if (this.onreceive) {\r\n                                this.onreceive(response.content);\r\n                            }\r\n                        }\r\n                        else {\r\n                            // This is another way timeout manifest.\r\n                            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\r\n                        }\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    if (!this._running) {\r\n                        // Log but disregard errors that occur after stopping\r\n                        this._logger.log(LogLevel.Trace, `(LongPolling transport) Poll errored after shutdown: ${e.message}`);\r\n                    }\r\n                    else {\r\n                        if (e instanceof TimeoutError) {\r\n                            // Ignore timeouts and reissue the poll.\r\n                            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Poll timed out, reissuing.\");\r\n                        }\r\n                        else {\r\n                            // Close the connection with the error as the result.\r\n                            this._closeError = e;\r\n                            this._running = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        finally {\r\n            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Polling complete.\");\r\n            // We will reach here with pollAborted==false when the server returned a response causing the transport to stop.\r\n            // If pollAborted==true then client initiated the stop and the stop method will raise the close event after DELETE is sent.\r\n            if (!this.pollAborted) {\r\n                this._raiseOnClose();\r\n            }\r\n        }\r\n    }\r\n    async send(data) {\r\n        if (!this._running) {\r\n            return Promise.reject(new Error(\"Cannot send until the transport is connected\"));\r\n        }\r\n        return sendMessage(this._logger, \"LongPolling\", this._httpClient, this._url, data, this._options);\r\n    }\r\n    async stop() {\r\n        this._logger.log(LogLevel.Trace, \"(LongPolling transport) Stopping polling.\");\r\n        // Tell receiving loop to stop, abort any current request, and then wait for it to finish\r\n        this._running = false;\r\n        this._pollAbort.abort();\r\n        try {\r\n            await this._receiving;\r\n            // Send DELETE to clean up long polling on the server\r\n            this._logger.log(LogLevel.Trace, `(LongPolling transport) sending DELETE request to ${this._url}.`);\r\n            const headers = {};\r\n            const [name, value] = getUserAgentHeader();\r\n            headers[name] = value;\r\n            const deleteOptions = {\r\n                headers: { ...headers, ...this._options.headers },\r\n                timeout: this._options.timeout,\r\n                withCredentials: this._options.withCredentials,\r\n            };\r\n            let error;\r\n            try {\r\n                await this._httpClient.delete(this._url, deleteOptions);\r\n            }\r\n            catch (err) {\r\n                error = err;\r\n            }\r\n            if (error) {\r\n                if (error instanceof HttpError) {\r\n                    if (error.statusCode === 404) {\r\n                        this._logger.log(LogLevel.Trace, \"(LongPolling transport) A 404 response was returned from sending a DELETE request.\");\r\n                    }\r\n                    else {\r\n                        this._logger.log(LogLevel.Trace, `(LongPolling transport) Error sending a DELETE request: ${error}`);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                this._logger.log(LogLevel.Trace, \"(LongPolling transport) DELETE request accepted.\");\r\n            }\r\n        }\r\n        finally {\r\n            this._logger.log(LogLevel.Trace, \"(LongPolling transport) Stop finished.\");\r\n            // Raise close event here instead of in polling\r\n            // It needs to happen after the DELETE request is sent\r\n            this._raiseOnClose();\r\n        }\r\n    }\r\n    _raiseOnClose() {\r\n        if (this.onclose) {\r\n            let logMessage = \"(LongPolling transport) Firing onclose event.\";\r\n            if (this._closeError) {\r\n                logMessage += \" Error: \" + this._closeError;\r\n            }\r\n            this._logger.log(LogLevel.Trace, logMessage);\r\n            this.onclose(this._closeError);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=LongPollingTransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, getUserAgentHeader, Platform, sendMessage } from \"./Utils\";\r\n/** @private */\r\nexport class ServerSentEventsTransport {\r\n    constructor(httpClient, accessToken, logger, options) {\r\n        this._httpClient = httpClient;\r\n        this._accessToken = accessToken;\r\n        this._logger = logger;\r\n        this._options = options;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    async connect(url, transferFormat) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isRequired(transferFormat, \"transferFormat\");\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._logger.log(LogLevel.Trace, \"(SSE transport) Connecting.\");\r\n        // set url before accessTokenFactory because this._url is only for send and we set the auth header instead of the query string for send\r\n        this._url = url;\r\n        if (this._accessToken) {\r\n            url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + `access_token=${encodeURIComponent(this._accessToken)}`;\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            let opened = false;\r\n            if (transferFormat !== TransferFormat.Text) {\r\n                reject(new Error(\"The Server-Sent Events transport only supports the 'Text' transfer format\"));\r\n                return;\r\n            }\r\n            let eventSource;\r\n            if (Platform.isBrowser || Platform.isWebWorker) {\r\n                eventSource = new this._options.EventSource(url, { withCredentials: this._options.withCredentials });\r\n            }\r\n            else {\r\n                // Non-browser passes cookies via the dictionary\r\n                const cookies = this._httpClient.getCookieString(url);\r\n                const headers = {};\r\n                headers.Cookie = cookies;\r\n                const [name, value] = getUserAgentHeader();\r\n                headers[name] = value;\r\n                eventSource = new this._options.EventSource(url, { withCredentials: this._options.withCredentials, headers: { ...headers, ...this._options.headers } });\r\n            }\r\n            try {\r\n                eventSource.onmessage = (e) => {\r\n                    if (this.onreceive) {\r\n                        try {\r\n                            this._logger.log(LogLevel.Trace, `(SSE transport) data received. ${getDataDetail(e.data, this._options.logMessageContent)}.`);\r\n                            this.onreceive(e.data);\r\n                        }\r\n                        catch (error) {\r\n                            this._close(error);\r\n                            return;\r\n                        }\r\n                    }\r\n                };\r\n                // @ts-ignore: not using event on purpose\r\n                eventSource.onerror = (e) => {\r\n                    // EventSource doesn't give any useful information about server side closes.\r\n                    if (opened) {\r\n                        this._close();\r\n                    }\r\n                    else {\r\n                        reject(new Error(\"EventSource failed to connect. The connection could not be found on the server,\"\r\n                            + \" either the connection ID is not present on the server, or a proxy is refusing/buffering the connection.\"\r\n                            + \" If you have multiple servers check that sticky sessions are enabled.\"));\r\n                    }\r\n                };\r\n                eventSource.onopen = () => {\r\n                    this._logger.log(LogLevel.Information, `SSE connected to ${this._url}`);\r\n                    this._eventSource = eventSource;\r\n                    opened = true;\r\n                    resolve();\r\n                };\r\n            }\r\n            catch (e) {\r\n                reject(e);\r\n                return;\r\n            }\r\n        });\r\n    }\r\n    async send(data) {\r\n        if (!this._eventSource) {\r\n            return Promise.reject(new Error(\"Cannot send until the transport is connected\"));\r\n        }\r\n        return sendMessage(this._logger, \"SSE\", this._httpClient, this._url, data, this._options);\r\n    }\r\n    stop() {\r\n        this._close();\r\n        return Promise.resolve();\r\n    }\r\n    _close(e) {\r\n        if (this._eventSource) {\r\n            this._eventSource.close();\r\n            this._eventSource = undefined;\r\n            if (this.onclose) {\r\n                this.onclose(e);\r\n            }\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=ServerSentEventsTransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { HeaderNames } from \"./HeaderNames\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { Arg, getDataDetail, getUserAgentHeader, Platform } from \"./Utils\";\r\n/** @private */\r\nexport class WebSocketTransport {\r\n    constructor(httpClient, accessTokenFactory, logger, logMessageContent, webSocketConstructor, headers) {\r\n        this._logger = logger;\r\n        this._accessTokenFactory = accessTokenFactory;\r\n        this._logMessageContent = logMessageContent;\r\n        this._webSocketConstructor = webSocketConstructor;\r\n        this._httpClient = httpClient;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n        this._headers = headers;\r\n    }\r\n    async connect(url, transferFormat) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isRequired(transferFormat, \"transferFormat\");\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._logger.log(LogLevel.Trace, \"(WebSockets transport) Connecting.\");\r\n        let token;\r\n        if (this._accessTokenFactory) {\r\n            token = await this._accessTokenFactory();\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            url = url.replace(/^http/, \"ws\");\r\n            let webSocket;\r\n            const cookies = this._httpClient.getCookieString(url);\r\n            let opened = false;\r\n            if (Platform.isNode || Platform.isReactNative) {\r\n                const headers = {};\r\n                const [name, value] = getUserAgentHeader();\r\n                headers[name] = value;\r\n                if (token) {\r\n                    headers[HeaderNames.Authorization] = `Bearer ${token}`;\r\n                }\r\n                if (cookies) {\r\n                    headers[HeaderNames.Cookie] = cookies;\r\n                }\r\n                // Only pass headers when in non-browser environments\r\n                webSocket = new this._webSocketConstructor(url, undefined, {\r\n                    headers: { ...headers, ...this._headers },\r\n                });\r\n            }\r\n            else {\r\n                if (token) {\r\n                    url += (url.indexOf(\"?\") < 0 ? \"?\" : \"&\") + `access_token=${encodeURIComponent(token)}`;\r\n                }\r\n            }\r\n            if (!webSocket) {\r\n                // Chrome is not happy with passing 'undefined' as protocol\r\n                webSocket = new this._webSocketConstructor(url);\r\n            }\r\n            if (transferFormat === TransferFormat.Binary) {\r\n                webSocket.binaryType = \"arraybuffer\";\r\n            }\r\n            webSocket.onopen = (_event) => {\r\n                this._logger.log(LogLevel.Information, `WebSocket connected to ${url}.`);\r\n                this._webSocket = webSocket;\r\n                opened = true;\r\n                resolve();\r\n            };\r\n            webSocket.onerror = (event) => {\r\n                let error = null;\r\n                // ErrorEvent is a browser only type we need to check if the type exists before using it\r\n                if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\r\n                    error = event.error;\r\n                }\r\n                else {\r\n                    error = \"There was an error with the transport\";\r\n                }\r\n                this._logger.log(LogLevel.Information, `(WebSockets transport) ${error}.`);\r\n            };\r\n            webSocket.onmessage = (message) => {\r\n                this._logger.log(LogLevel.Trace, `(WebSockets transport) data received. ${getDataDetail(message.data, this._logMessageContent)}.`);\r\n                if (this.onreceive) {\r\n                    try {\r\n                        this.onreceive(message.data);\r\n                    }\r\n                    catch (error) {\r\n                        this._close(error);\r\n                        return;\r\n                    }\r\n                }\r\n            };\r\n            webSocket.onclose = (event) => {\r\n                // Don't call close handler if connection was never established\r\n                // We'll reject the connect call instead\r\n                if (opened) {\r\n                    this._close(event);\r\n                }\r\n                else {\r\n                    let error = null;\r\n                    // ErrorEvent is a browser only type we need to check if the type exists before using it\r\n                    if (typeof ErrorEvent !== \"undefined\" && event instanceof ErrorEvent) {\r\n                        error = event.error;\r\n                    }\r\n                    else {\r\n                        error = \"WebSocket failed to connect. The connection could not be found on the server,\"\r\n                            + \" either the endpoint may not be a SignalR endpoint,\"\r\n                            + \" the connection ID is not present on the server, or there is a proxy blocking WebSockets.\"\r\n                            + \" If you have multiple servers check that sticky sessions are enabled.\";\r\n                    }\r\n                    reject(new Error(error));\r\n                }\r\n            };\r\n        });\r\n    }\r\n    send(data) {\r\n        if (this._webSocket && this._webSocket.readyState === this._webSocketConstructor.OPEN) {\r\n            this._logger.log(LogLevel.Trace, `(WebSockets transport) sending data. ${getDataDetail(data, this._logMessageContent)}.`);\r\n            this._webSocket.send(data);\r\n            return Promise.resolve();\r\n        }\r\n        return Promise.reject(\"WebSocket is not in the OPEN state\");\r\n    }\r\n    stop() {\r\n        if (this._webSocket) {\r\n            // Manually invoke onclose callback inline so we know the HttpConnection was closed properly before returning\r\n            // This also solves an issue where websocket.onclose could take 18+ seconds to trigger during network disconnects\r\n            this._close(undefined);\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    _close(event) {\r\n        // webSocket will be null if the transport did not start successfully\r\n        if (this._webSocket) {\r\n            // Clear websocket handlers because we are considering the socket closed now\r\n            this._webSocket.onclose = () => { };\r\n            this._webSocket.onmessage = () => { };\r\n            this._webSocket.onerror = () => { };\r\n            this._webSocket.close();\r\n            this._webSocket = undefined;\r\n        }\r\n        this._logger.log(LogLevel.Trace, \"(WebSockets transport) socket closed.\");\r\n        if (this.onclose) {\r\n            if (this._isCloseEvent(event) && (event.wasClean === false || event.code !== 1000)) {\r\n                this.onclose(new Error(`WebSocket closed with status code: ${event.code} (${event.reason || \"no reason given\"}).`));\r\n            }\r\n            else if (event instanceof Error) {\r\n                this.onclose(event);\r\n            }\r\n            else {\r\n                this.onclose();\r\n            }\r\n        }\r\n    }\r\n    _isCloseEvent(event) {\r\n        return event && typeof event.wasClean === \"boolean\" && typeof event.code === \"number\";\r\n    }\r\n}\r\n//# sourceMappingURL=WebSocketTransport.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { AccessTokenHttpClient } from \"./AccessTokenHttpClient\";\r\nimport { DefaultHttpClient } from \"./DefaultHttpClient\";\r\nimport { AggregateErrors, DisabledTransportError, FailedToNegotiateWithServerError, FailedToStartTransportError, HttpError, UnsupportedTransportError, AbortError } from \"./Errors\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { HttpTransportType, TransferFormat } from \"./ITransport\";\r\nimport { LongPollingTransport } from \"./LongPollingTransport\";\r\nimport { ServerSentEventsTransport } from \"./ServerSentEventsTransport\";\r\nimport { Arg, createLogger, getUserAgentHeader, Platform } from \"./Utils\";\r\nimport { WebSocketTransport } from \"./WebSocketTransport\";\r\nconst MAX_REDIRECTS = 100;\r\n/** @private */\r\nexport class HttpConnection {\r\n    constructor(url, options = {}) {\r\n        this._stopPromiseResolver = () => { };\r\n        this.features = {};\r\n        this._negotiateVersion = 1;\r\n        Arg.isRequired(url, \"url\");\r\n        this._logger = createLogger(options.logger);\r\n        this.baseUrl = this._resolveUrl(url);\r\n        options = options || {};\r\n        options.logMessageContent = options.logMessageContent === undefined ? false : options.logMessageContent;\r\n        if (typeof options.withCredentials === \"boolean\" || options.withCredentials === undefined) {\r\n            options.withCredentials = options.withCredentials === undefined ? true : options.withCredentials;\r\n        }\r\n        else {\r\n            throw new Error(\"withCredentials option was not a 'boolean' or 'undefined' value\");\r\n        }\r\n        options.timeout = options.timeout === undefined ? 100 * 1000 : options.timeout;\r\n        let webSocketModule = null;\r\n        let eventSourceModule = null;\r\n        if (Platform.isNode && typeof require !== \"undefined\") {\r\n            // In order to ignore the dynamic require in webpack builds we need to do this magic\r\n            // @ts-ignore: TS doesn't know about these names\r\n            const requireFunc = typeof __webpack_require__ === \"function\" ? __non_webpack_require__ : require;\r\n            webSocketModule = requireFunc(\"ws\");\r\n            eventSourceModule = requireFunc(\"eventsource\");\r\n        }\r\n        if (!Platform.isNode && typeof WebSocket !== \"undefined\" && !options.WebSocket) {\r\n            options.WebSocket = WebSocket;\r\n        }\r\n        else if (Platform.isNode && !options.WebSocket) {\r\n            if (webSocketModule) {\r\n                options.WebSocket = webSocketModule;\r\n            }\r\n        }\r\n        if (!Platform.isNode && typeof EventSource !== \"undefined\" && !options.EventSource) {\r\n            options.EventSource = EventSource;\r\n        }\r\n        else if (Platform.isNode && !options.EventSource) {\r\n            if (typeof eventSourceModule !== \"undefined\") {\r\n                options.EventSource = eventSourceModule;\r\n            }\r\n        }\r\n        this._httpClient = new AccessTokenHttpClient(options.httpClient || new DefaultHttpClient(this._logger), options.accessTokenFactory);\r\n        this._connectionState = \"Disconnected\" /* ConnectionState.Disconnected */;\r\n        this._connectionStarted = false;\r\n        this._options = options;\r\n        this.onreceive = null;\r\n        this.onclose = null;\r\n    }\r\n    async start(transferFormat) {\r\n        transferFormat = transferFormat || TransferFormat.Binary;\r\n        Arg.isIn(transferFormat, TransferFormat, \"transferFormat\");\r\n        this._logger.log(LogLevel.Debug, `Starting connection with transfer format '${TransferFormat[transferFormat]}'.`);\r\n        if (this._connectionState !== \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n            return Promise.reject(new Error(\"Cannot start an HttpConnection that is not in the 'Disconnected' state.\"));\r\n        }\r\n        this._connectionState = \"Connecting\" /* ConnectionState.Connecting */;\r\n        this._startInternalPromise = this._startInternal(transferFormat);\r\n        await this._startInternalPromise;\r\n        // The TypeScript compiler thinks that connectionState must be Connecting here. The TypeScript compiler is wrong.\r\n        if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */) {\r\n            // stop() was called and transitioned the client into the Disconnecting state.\r\n            const message = \"Failed to start the HttpConnection before stop() was called.\";\r\n            this._logger.log(LogLevel.Error, message);\r\n            // We cannot await stopPromise inside startInternal since stopInternal awaits the startInternalPromise.\r\n            await this._stopPromise;\r\n            return Promise.reject(new AbortError(message));\r\n        }\r\n        else if (this._connectionState !== \"Connected\" /* ConnectionState.Connected */) {\r\n            // stop() was called and transitioned the client into the Disconnecting state.\r\n            const message = \"HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!\";\r\n            this._logger.log(LogLevel.Error, message);\r\n            return Promise.reject(new AbortError(message));\r\n        }\r\n        this._connectionStarted = true;\r\n    }\r\n    send(data) {\r\n        if (this._connectionState !== \"Connected\" /* ConnectionState.Connected */) {\r\n            return Promise.reject(new Error(\"Cannot send data if the connection is not in the 'Connected' State.\"));\r\n        }\r\n        if (!this._sendQueue) {\r\n            this._sendQueue = new TransportSendQueue(this.transport);\r\n        }\r\n        // Transport will not be null if state is connected\r\n        return this._sendQueue.send(data);\r\n    }\r\n    async stop(error) {\r\n        if (this._connectionState === \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnected state.`);\r\n            return Promise.resolve();\r\n        }\r\n        if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stop(${error}) ignored because the connection is already in the disconnecting state.`);\r\n            return this._stopPromise;\r\n        }\r\n        this._connectionState = \"Disconnecting\" /* ConnectionState.Disconnecting */;\r\n        this._stopPromise = new Promise((resolve) => {\r\n            // Don't complete stop() until stopConnection() completes.\r\n            this._stopPromiseResolver = resolve;\r\n        });\r\n        // stopInternal should never throw so just observe it.\r\n        await this._stopInternal(error);\r\n        await this._stopPromise;\r\n    }\r\n    async _stopInternal(error) {\r\n        // Set error as soon as possible otherwise there is a race between\r\n        // the transport closing and providing an error and the error from a close message\r\n        // We would prefer the close message error.\r\n        this._stopError = error;\r\n        try {\r\n            await this._startInternalPromise;\r\n        }\r\n        catch (e) {\r\n            // This exception is returned to the user as a rejected Promise from the start method.\r\n        }\r\n        // The transport's onclose will trigger stopConnection which will run our onclose event.\r\n        // The transport should always be set if currently connected. If it wasn't set, it's likely because\r\n        // stop was called during start() and start() failed.\r\n        if (this.transport) {\r\n            try {\r\n                await this.transport.stop();\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `HttpConnection.transport.stop() threw error '${e}'.`);\r\n                this._stopConnection();\r\n            }\r\n            this.transport = undefined;\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Debug, \"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.\");\r\n        }\r\n    }\r\n    async _startInternal(transferFormat) {\r\n        // Store the original base url and the access token factory since they may change\r\n        // as part of negotiating\r\n        let url = this.baseUrl;\r\n        this._accessTokenFactory = this._options.accessTokenFactory;\r\n        this._httpClient._accessTokenFactory = this._accessTokenFactory;\r\n        try {\r\n            if (this._options.skipNegotiation) {\r\n                if (this._options.transport === HttpTransportType.WebSockets) {\r\n                    // No need to add a connection ID in this case\r\n                    this.transport = this._constructTransport(HttpTransportType.WebSockets);\r\n                    // We should just call connect directly in this case.\r\n                    // No fallback or negotiate in this case.\r\n                    await this._startTransport(url, transferFormat);\r\n                }\r\n                else {\r\n                    throw new Error(\"Negotiation can only be skipped when using the WebSocket transport directly.\");\r\n                }\r\n            }\r\n            else {\r\n                let negotiateResponse = null;\r\n                let redirects = 0;\r\n                do {\r\n                    negotiateResponse = await this._getNegotiationResponse(url);\r\n                    // the user tries to stop the connection when it is being started\r\n                    if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */ || this._connectionState === \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n                        throw new AbortError(\"The connection was stopped during negotiation.\");\r\n                    }\r\n                    if (negotiateResponse.error) {\r\n                        throw new Error(negotiateResponse.error);\r\n                    }\r\n                    if (negotiateResponse.ProtocolVersion) {\r\n                        throw new Error(\"Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.\");\r\n                    }\r\n                    if (negotiateResponse.url) {\r\n                        url = negotiateResponse.url;\r\n                    }\r\n                    if (negotiateResponse.accessToken) {\r\n                        // Replace the current access token factory with one that uses\r\n                        // the returned access token\r\n                        const accessToken = negotiateResponse.accessToken;\r\n                        this._accessTokenFactory = () => accessToken;\r\n                        // set the factory to undefined so the AccessTokenHttpClient won't retry with the same token, since we know it won't change until a connection restart\r\n                        this._httpClient._accessToken = accessToken;\r\n                        this._httpClient._accessTokenFactory = undefined;\r\n                    }\r\n                    redirects++;\r\n                } while (negotiateResponse.url && redirects < MAX_REDIRECTS);\r\n                if (redirects === MAX_REDIRECTS && negotiateResponse.url) {\r\n                    throw new Error(\"Negotiate redirection limit exceeded.\");\r\n                }\r\n                await this._createTransport(url, this._options.transport, negotiateResponse, transferFormat);\r\n            }\r\n            if (this.transport instanceof LongPollingTransport) {\r\n                this.features.inherentKeepAlive = true;\r\n            }\r\n            if (this._connectionState === \"Connecting\" /* ConnectionState.Connecting */) {\r\n                // Ensure the connection transitions to the connected state prior to completing this.startInternalPromise.\r\n                // start() will handle the case when stop was called and startInternal exits still in the disconnecting state.\r\n                this._logger.log(LogLevel.Debug, \"The HttpConnection connected successfully.\");\r\n                this._connectionState = \"Connected\" /* ConnectionState.Connected */;\r\n            }\r\n            // stop() is waiting on us via this.startInternalPromise so keep this.transport around so it can clean up.\r\n            // This is the only case startInternal can exit in neither the connected nor disconnected state because stopConnection()\r\n            // will transition to the disconnected state. start() will wait for the transition using the stopPromise.\r\n        }\r\n        catch (e) {\r\n            this._logger.log(LogLevel.Error, \"Failed to start the connection: \" + e);\r\n            this._connectionState = \"Disconnected\" /* ConnectionState.Disconnected */;\r\n            this.transport = undefined;\r\n            // if start fails, any active calls to stop assume that start will complete the stop promise\r\n            this._stopPromiseResolver();\r\n            return Promise.reject(e);\r\n        }\r\n    }\r\n    async _getNegotiationResponse(url) {\r\n        const headers = {};\r\n        const [name, value] = getUserAgentHeader();\r\n        headers[name] = value;\r\n        const negotiateUrl = this._resolveNegotiateUrl(url);\r\n        this._logger.log(LogLevel.Debug, `Sending negotiation request: ${negotiateUrl}.`);\r\n        try {\r\n            const response = await this._httpClient.post(negotiateUrl, {\r\n                content: \"\",\r\n                headers: { ...headers, ...this._options.headers },\r\n                timeout: this._options.timeout,\r\n                withCredentials: this._options.withCredentials,\r\n            });\r\n            if (response.statusCode !== 200) {\r\n                return Promise.reject(new Error(`Unexpected status code returned from negotiate '${response.statusCode}'`));\r\n            }\r\n            const negotiateResponse = JSON.parse(response.content);\r\n            if (!negotiateResponse.negotiateVersion || negotiateResponse.negotiateVersion < 1) {\r\n                // Negotiate version 0 doesn't use connectionToken\r\n                // So we set it equal to connectionId so all our logic can use connectionToken without being aware of the negotiate version\r\n                negotiateResponse.connectionToken = negotiateResponse.connectionId;\r\n            }\r\n            if (negotiateResponse.useStatefulReconnect && this._options._useStatefulReconnect !== true) {\r\n                return Promise.reject(new FailedToNegotiateWithServerError(\"Client didn't negotiate Stateful Reconnect but the server did.\"));\r\n            }\r\n            return negotiateResponse;\r\n        }\r\n        catch (e) {\r\n            let errorMessage = \"Failed to complete negotiation with the server: \" + e;\r\n            if (e instanceof HttpError) {\r\n                if (e.statusCode === 404) {\r\n                    errorMessage = errorMessage + \" Either this is not a SignalR endpoint or there is a proxy blocking the connection.\";\r\n                }\r\n            }\r\n            this._logger.log(LogLevel.Error, errorMessage);\r\n            return Promise.reject(new FailedToNegotiateWithServerError(errorMessage));\r\n        }\r\n    }\r\n    _createConnectUrl(url, connectionToken) {\r\n        if (!connectionToken) {\r\n            return url;\r\n        }\r\n        return url + (url.indexOf(\"?\") === -1 ? \"?\" : \"&\") + `id=${connectionToken}`;\r\n    }\r\n    async _createTransport(url, requestedTransport, negotiateResponse, requestedTransferFormat) {\r\n        let connectUrl = this._createConnectUrl(url, negotiateResponse.connectionToken);\r\n        if (this._isITransport(requestedTransport)) {\r\n            this._logger.log(LogLevel.Debug, \"Connection was provided an instance of ITransport, using that directly.\");\r\n            this.transport = requestedTransport;\r\n            await this._startTransport(connectUrl, requestedTransferFormat);\r\n            this.connectionId = negotiateResponse.connectionId;\r\n            return;\r\n        }\r\n        const transportExceptions = [];\r\n        const transports = negotiateResponse.availableTransports || [];\r\n        let negotiate = negotiateResponse;\r\n        for (const endpoint of transports) {\r\n            const transportOrError = this._resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat, (negotiate === null || negotiate === void 0 ? void 0 : negotiate.useStatefulReconnect) === true);\r\n            if (transportOrError instanceof Error) {\r\n                // Store the error and continue, we don't want to cause a re-negotiate in these cases\r\n                transportExceptions.push(`${endpoint.transport} failed:`);\r\n                transportExceptions.push(transportOrError);\r\n            }\r\n            else if (this._isITransport(transportOrError)) {\r\n                this.transport = transportOrError;\r\n                if (!negotiate) {\r\n                    try {\r\n                        negotiate = await this._getNegotiationResponse(url);\r\n                    }\r\n                    catch (ex) {\r\n                        return Promise.reject(ex);\r\n                    }\r\n                    connectUrl = this._createConnectUrl(url, negotiate.connectionToken);\r\n                }\r\n                try {\r\n                    await this._startTransport(connectUrl, requestedTransferFormat);\r\n                    this.connectionId = negotiate.connectionId;\r\n                    return;\r\n                }\r\n                catch (ex) {\r\n                    this._logger.log(LogLevel.Error, `Failed to start the transport '${endpoint.transport}': ${ex}`);\r\n                    negotiate = undefined;\r\n                    transportExceptions.push(new FailedToStartTransportError(`${endpoint.transport} failed: ${ex}`, HttpTransportType[endpoint.transport]));\r\n                    if (this._connectionState !== \"Connecting\" /* ConnectionState.Connecting */) {\r\n                        const message = \"Failed to select transport before stop() was called.\";\r\n                        this._logger.log(LogLevel.Debug, message);\r\n                        return Promise.reject(new AbortError(message));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (transportExceptions.length > 0) {\r\n            return Promise.reject(new AggregateErrors(`Unable to connect to the server with any of the available transports. ${transportExceptions.join(\" \")}`, transportExceptions));\r\n        }\r\n        return Promise.reject(new Error(\"None of the transports supported by the client are supported by the server.\"));\r\n    }\r\n    _constructTransport(transport) {\r\n        switch (transport) {\r\n            case HttpTransportType.WebSockets:\r\n                if (!this._options.WebSocket) {\r\n                    throw new Error(\"'WebSocket' is not supported in your environment.\");\r\n                }\r\n                return new WebSocketTransport(this._httpClient, this._accessTokenFactory, this._logger, this._options.logMessageContent, this._options.WebSocket, this._options.headers || {});\r\n            case HttpTransportType.ServerSentEvents:\r\n                if (!this._options.EventSource) {\r\n                    throw new Error(\"'EventSource' is not supported in your environment.\");\r\n                }\r\n                return new ServerSentEventsTransport(this._httpClient, this._httpClient._accessToken, this._logger, this._options);\r\n            case HttpTransportType.LongPolling:\r\n                return new LongPollingTransport(this._httpClient, this._logger, this._options);\r\n            default:\r\n                throw new Error(`Unknown transport: ${transport}.`);\r\n        }\r\n    }\r\n    _startTransport(url, transferFormat) {\r\n        this.transport.onreceive = this.onreceive;\r\n        if (this.features.reconnect) {\r\n            this.transport.onclose = async (e) => {\r\n                let callStop = false;\r\n                if (this.features.reconnect) {\r\n                    try {\r\n                        this.features.disconnected();\r\n                        await this.transport.connect(url, transferFormat);\r\n                        await this.features.resend();\r\n                    }\r\n                    catch {\r\n                        callStop = true;\r\n                    }\r\n                }\r\n                else {\r\n                    this._stopConnection(e);\r\n                    return;\r\n                }\r\n                if (callStop) {\r\n                    this._stopConnection(e);\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            this.transport.onclose = (e) => this._stopConnection(e);\r\n        }\r\n        return this.transport.connect(url, transferFormat);\r\n    }\r\n    _resolveTransportOrError(endpoint, requestedTransport, requestedTransferFormat, useStatefulReconnect) {\r\n        const transport = HttpTransportType[endpoint.transport];\r\n        if (transport === null || transport === undefined) {\r\n            this._logger.log(LogLevel.Debug, `Skipping transport '${endpoint.transport}' because it is not supported by this client.`);\r\n            return new Error(`Skipping transport '${endpoint.transport}' because it is not supported by this client.`);\r\n        }\r\n        else {\r\n            if (transportMatches(requestedTransport, transport)) {\r\n                const transferFormats = endpoint.transferFormats.map((s) => TransferFormat[s]);\r\n                if (transferFormats.indexOf(requestedTransferFormat) >= 0) {\r\n                    if ((transport === HttpTransportType.WebSockets && !this._options.WebSocket) ||\r\n                        (transport === HttpTransportType.ServerSentEvents && !this._options.EventSource)) {\r\n                        this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it is not supported in your environment.'`);\r\n                        return new UnsupportedTransportError(`'${HttpTransportType[transport]}' is not supported in your environment.`, transport);\r\n                    }\r\n                    else {\r\n                        this._logger.log(LogLevel.Debug, `Selecting transport '${HttpTransportType[transport]}'.`);\r\n                        try {\r\n                            this.features.reconnect = transport === HttpTransportType.WebSockets ? useStatefulReconnect : undefined;\r\n                            return this._constructTransport(transport);\r\n                        }\r\n                        catch (ex) {\r\n                            return ex;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it does not support the requested transfer format '${TransferFormat[requestedTransferFormat]}'.`);\r\n                    return new Error(`'${HttpTransportType[transport]}' does not support ${TransferFormat[requestedTransferFormat]}.`);\r\n                }\r\n            }\r\n            else {\r\n                this._logger.log(LogLevel.Debug, `Skipping transport '${HttpTransportType[transport]}' because it was disabled by the client.`);\r\n                return new DisabledTransportError(`'${HttpTransportType[transport]}' is disabled by the client.`, transport);\r\n            }\r\n        }\r\n    }\r\n    _isITransport(transport) {\r\n        return transport && typeof (transport) === \"object\" && \"connect\" in transport;\r\n    }\r\n    _stopConnection(error) {\r\n        this._logger.log(LogLevel.Debug, `HttpConnection.stopConnection(${error}) called while in state ${this._connectionState}.`);\r\n        this.transport = undefined;\r\n        // If we have a stopError, it takes precedence over the error from the transport\r\n        error = this._stopError || error;\r\n        this._stopError = undefined;\r\n        if (this._connectionState === \"Disconnected\" /* ConnectionState.Disconnected */) {\r\n            this._logger.log(LogLevel.Debug, `Call to HttpConnection.stopConnection(${error}) was ignored because the connection is already in the disconnected state.`);\r\n            return;\r\n        }\r\n        if (this._connectionState === \"Connecting\" /* ConnectionState.Connecting */) {\r\n            this._logger.log(LogLevel.Warning, `Call to HttpConnection.stopConnection(${error}) was ignored because the connection is still in the connecting state.`);\r\n            throw new Error(`HttpConnection.stopConnection(${error}) was called while the connection is still in the connecting state.`);\r\n        }\r\n        if (this._connectionState === \"Disconnecting\" /* ConnectionState.Disconnecting */) {\r\n            // A call to stop() induced this call to stopConnection and needs to be completed.\r\n            // Any stop() awaiters will be scheduled to continue after the onclose callback fires.\r\n            this._stopPromiseResolver();\r\n        }\r\n        if (error) {\r\n            this._logger.log(LogLevel.Error, `Connection disconnected with error '${error}'.`);\r\n        }\r\n        else {\r\n            this._logger.log(LogLevel.Information, \"Connection disconnected.\");\r\n        }\r\n        if (this._sendQueue) {\r\n            this._sendQueue.stop().catch((e) => {\r\n                this._logger.log(LogLevel.Error, `TransportSendQueue.stop() threw error '${e}'.`);\r\n            });\r\n            this._sendQueue = undefined;\r\n        }\r\n        this.connectionId = undefined;\r\n        this._connectionState = \"Disconnected\" /* ConnectionState.Disconnected */;\r\n        if (this._connectionStarted) {\r\n            this._connectionStarted = false;\r\n            try {\r\n                if (this.onclose) {\r\n                    this.onclose(error);\r\n                }\r\n            }\r\n            catch (e) {\r\n                this._logger.log(LogLevel.Error, `HttpConnection.onclose(${error}) threw error '${e}'.`);\r\n            }\r\n        }\r\n    }\r\n    _resolveUrl(url) {\r\n        // startsWith is not supported in IE\r\n        if (url.lastIndexOf(\"https://\", 0) === 0 || url.lastIndexOf(\"http://\", 0) === 0) {\r\n            return url;\r\n        }\r\n        if (!Platform.isBrowser) {\r\n            throw new Error(`Cannot resolve '${url}'.`);\r\n        }\r\n        // Setting the url to the href propery of an anchor tag handles normalization\r\n        // for us. There are 3 main cases.\r\n        // 1. Relative path normalization e.g \"b\" -> \"http://localhost:5000/a/b\"\r\n        // 2. Absolute path normalization e.g \"/a/b\" -> \"http://localhost:5000/a/b\"\r\n        // 3. Networkpath reference normalization e.g \"//localhost:5000/a/b\" -> \"http://localhost:5000/a/b\"\r\n        const aTag = window.document.createElement(\"a\");\r\n        aTag.href = url;\r\n        this._logger.log(LogLevel.Information, `Normalizing '${url}' to '${aTag.href}'.`);\r\n        return aTag.href;\r\n    }\r\n    _resolveNegotiateUrl(url) {\r\n        const negotiateUrl = new URL(url);\r\n        if (negotiateUrl.pathname.endsWith('/')) {\r\n            negotiateUrl.pathname += \"negotiate\";\r\n        }\r\n        else {\r\n            negotiateUrl.pathname += \"/negotiate\";\r\n        }\r\n        const searchParams = new URLSearchParams(negotiateUrl.searchParams);\r\n        if (!searchParams.has(\"negotiateVersion\")) {\r\n            searchParams.append(\"negotiateVersion\", this._negotiateVersion.toString());\r\n        }\r\n        if (searchParams.has(\"useStatefulReconnect\")) {\r\n            if (searchParams.get(\"useStatefulReconnect\") === \"true\") {\r\n                this._options._useStatefulReconnect = true;\r\n            }\r\n        }\r\n        else if (this._options._useStatefulReconnect === true) {\r\n            searchParams.append(\"useStatefulReconnect\", \"true\");\r\n        }\r\n        negotiateUrl.search = searchParams.toString();\r\n        return negotiateUrl.toString();\r\n    }\r\n}\r\nfunction transportMatches(requestedTransport, actualTransport) {\r\n    return !requestedTransport || ((actualTransport & requestedTransport) !== 0);\r\n}\r\n/** @private */\r\nexport class TransportSendQueue {\r\n    constructor(_transport) {\r\n        this._transport = _transport;\r\n        this._buffer = [];\r\n        this._executing = true;\r\n        this._sendBufferedData = new PromiseSource();\r\n        this._transportResult = new PromiseSource();\r\n        this._sendLoopPromise = this._sendLoop();\r\n    }\r\n    send(data) {\r\n        this._bufferData(data);\r\n        if (!this._transportResult) {\r\n            this._transportResult = new PromiseSource();\r\n        }\r\n        return this._transportResult.promise;\r\n    }\r\n    stop() {\r\n        this._executing = false;\r\n        this._sendBufferedData.resolve();\r\n        return this._sendLoopPromise;\r\n    }\r\n    _bufferData(data) {\r\n        if (this._buffer.length && typeof (this._buffer[0]) !== typeof (data)) {\r\n            throw new Error(`Expected data to be of type ${typeof (this._buffer)} but was of type ${typeof (data)}`);\r\n        }\r\n        this._buffer.push(data);\r\n        this._sendBufferedData.resolve();\r\n    }\r\n    async _sendLoop() {\r\n        while (true) {\r\n            await this._sendBufferedData.promise;\r\n            if (!this._executing) {\r\n                if (this._transportResult) {\r\n                    this._transportResult.reject(\"Connection stopped.\");\r\n                }\r\n                break;\r\n            }\r\n            this._sendBufferedData = new PromiseSource();\r\n            const transportResult = this._transportResult;\r\n            this._transportResult = undefined;\r\n            const data = typeof (this._buffer[0]) === \"string\" ?\r\n                this._buffer.join(\"\") :\r\n                TransportSendQueue._concatBuffers(this._buffer);\r\n            this._buffer.length = 0;\r\n            try {\r\n                await this._transport.send(data);\r\n                transportResult.resolve();\r\n            }\r\n            catch (error) {\r\n                transportResult.reject(error);\r\n            }\r\n        }\r\n    }\r\n    static _concatBuffers(arrayBuffers) {\r\n        const totalLength = arrayBuffers.map((b) => b.byteLength).reduce((a, b) => a + b);\r\n        const result = new Uint8Array(totalLength);\r\n        let offset = 0;\r\n        for (const item of arrayBuffers) {\r\n            result.set(new Uint8Array(item), offset);\r\n            offset += item.byteLength;\r\n        }\r\n        return result.buffer;\r\n    }\r\n}\r\nclass PromiseSource {\r\n    constructor() {\r\n        this.promise = new Promise((resolve, reject) => [this._resolver, this._rejecter] = [resolve, reject]);\r\n    }\r\n    resolve() {\r\n        this._resolver();\r\n    }\r\n    reject(reason) {\r\n        this._rejecter(reason);\r\n    }\r\n}\r\n//# sourceMappingURL=HttpConnection.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { MessageType } from \"./IHubProtocol\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { TransferFormat } from \"./ITransport\";\r\nimport { NullLogger } from \"./Loggers\";\r\nimport { TextMessageFormat } from \"./TextMessageFormat\";\r\nconst JSON_HUB_PROTOCOL_NAME = \"json\";\r\n/** Implements the JSON Hub Protocol. */\r\nexport class JsonHubProtocol {\r\n    constructor() {\r\n        /** @inheritDoc */\r\n        this.name = JSON_HUB_PROTOCOL_NAME;\r\n        /** @inheritDoc */\r\n        this.version = 2;\r\n        /** @inheritDoc */\r\n        this.transferFormat = TransferFormat.Text;\r\n    }\r\n    /** Creates an array of {@link @microsoft/signalr.HubMessage} objects from the specified serialized representation.\r\n     *\r\n     * @param {string} input A string containing the serialized representation.\r\n     * @param {ILogger} logger A logger that will be used to log messages that occur during parsing.\r\n     */\r\n    parseMessages(input, logger) {\r\n        // The interface does allow \"ArrayBuffer\" to be passed in, but this implementation does not. So let's throw a useful error.\r\n        if (typeof input !== \"string\") {\r\n            throw new Error(\"Invalid input for JSON hub protocol. Expected a string.\");\r\n        }\r\n        if (!input) {\r\n            return [];\r\n        }\r\n        if (logger === null) {\r\n            logger = NullLogger.instance;\r\n        }\r\n        // Parse the messages\r\n        const messages = TextMessageFormat.parse(input);\r\n        const hubMessages = [];\r\n        for (const message of messages) {\r\n            const parsedMessage = JSON.parse(message);\r\n            if (typeof parsedMessage.type !== \"number\") {\r\n                throw new Error(\"Invalid payload.\");\r\n            }\r\n            switch (parsedMessage.type) {\r\n                case MessageType.Invocation:\r\n                    this._isInvocationMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.StreamItem:\r\n                    this._isStreamItemMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Completion:\r\n                    this._isCompletionMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Ping:\r\n                    // Single value, no need to validate\r\n                    break;\r\n                case MessageType.Close:\r\n                    // All optional values, no need to validate\r\n                    break;\r\n                case MessageType.Ack:\r\n                    this._isAckMessage(parsedMessage);\r\n                    break;\r\n                case MessageType.Sequence:\r\n                    this._isSequenceMessage(parsedMessage);\r\n                    break;\r\n                default:\r\n                    // Future protocol changes can add message types, old clients can ignore them\r\n                    logger.log(LogLevel.Information, \"Unknown message type '\" + parsedMessage.type + \"' ignored.\");\r\n                    continue;\r\n            }\r\n            hubMessages.push(parsedMessage);\r\n        }\r\n        return hubMessages;\r\n    }\r\n    /** Writes the specified {@link @microsoft/signalr.HubMessage} to a string and returns it.\r\n     *\r\n     * @param {HubMessage} message The message to write.\r\n     * @returns {string} A string containing the serialized representation of the message.\r\n     */\r\n    writeMessage(message) {\r\n        return TextMessageFormat.write(JSON.stringify(message));\r\n    }\r\n    _isInvocationMessage(message) {\r\n        this._assertNotEmptyString(message.target, \"Invalid payload for Invocation message.\");\r\n        if (message.invocationId !== undefined) {\r\n            this._assertNotEmptyString(message.invocationId, \"Invalid payload for Invocation message.\");\r\n        }\r\n    }\r\n    _isStreamItemMessage(message) {\r\n        this._assertNotEmptyString(message.invocationId, \"Invalid payload for StreamItem message.\");\r\n        if (message.item === undefined) {\r\n            throw new Error(\"Invalid payload for StreamItem message.\");\r\n        }\r\n    }\r\n    _isCompletionMessage(message) {\r\n        if (message.result && message.error) {\r\n            throw new Error(\"Invalid payload for Completion message.\");\r\n        }\r\n        if (!message.result && message.error) {\r\n            this._assertNotEmptyString(message.error, \"Invalid payload for Completion message.\");\r\n        }\r\n        this._assertNotEmptyString(message.invocationId, \"Invalid payload for Completion message.\");\r\n    }\r\n    _isAckMessage(message) {\r\n        if (typeof message.sequenceId !== 'number') {\r\n            throw new Error(\"Invalid SequenceId for Ack message.\");\r\n        }\r\n    }\r\n    _isSequenceMessage(message) {\r\n        if (typeof message.sequenceId !== 'number') {\r\n            throw new Error(\"Invalid SequenceId for Sequence message.\");\r\n        }\r\n    }\r\n    _assertNotEmptyString(value, errorMessage) {\r\n        if (typeof value !== \"string\" || value === \"\") {\r\n            throw new Error(errorMessage);\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=JsonHubProtocol.js.map","// Licensed to the .NET Foundation under one or more agreements.\r\n// The .NET Foundation licenses this file to you under the MIT license.\r\nimport { DefaultReconnectPolicy } from \"./DefaultReconnectPolicy\";\r\nimport { HttpConnection } from \"./HttpConnection\";\r\nimport { HubConnection } from \"./HubConnection\";\r\nimport { LogLevel } from \"./ILogger\";\r\nimport { JsonHubProtocol } from \"./JsonHubProtocol\";\r\nimport { NullLogger } from \"./Loggers\";\r\nimport { Arg, ConsoleLogger } from \"./Utils\";\r\nconst LogLevelNameMapping = {\r\n    trace: LogLevel.Trace,\r\n    debug: LogLevel.Debug,\r\n    info: LogLevel.Information,\r\n    information: LogLevel.Information,\r\n    warn: LogLevel.Warning,\r\n    warning: LogLevel.Warning,\r\n    error: LogLevel.Error,\r\n    critical: LogLevel.Critical,\r\n    none: LogLevel.None,\r\n};\r\nfunction parseLogLevel(name) {\r\n    // Case-insensitive matching via lower-casing\r\n    // Yes, I know case-folding is a complicated problem in Unicode, but we only support\r\n    // the ASCII strings defined in LogLevelNameMapping anyway, so it's fine -anurse.\r\n    const mapping = LogLevelNameMapping[name.toLowerCase()];\r\n    if (typeof mapping !== \"undefined\") {\r\n        return mapping;\r\n    }\r\n    else {\r\n        throw new Error(`Unknown log level: ${name}`);\r\n    }\r\n}\r\n/** A builder for configuring {@link @microsoft/signalr.HubConnection} instances. */\r\nexport class HubConnectionBuilder {\r\n    configureLogging(logging) {\r\n        Arg.isRequired(logging, \"logging\");\r\n        if (isLogger(logging)) {\r\n            this.logger = logging;\r\n        }\r\n        else if (typeof logging === \"string\") {\r\n            const logLevel = parseLogLevel(logging);\r\n            this.logger = new ConsoleLogger(logLevel);\r\n        }\r\n        else {\r\n            this.logger = new ConsoleLogger(logging);\r\n        }\r\n        return this;\r\n    }\r\n    withUrl(url, transportTypeOrOptions) {\r\n        Arg.isRequired(url, \"url\");\r\n        Arg.isNotEmpty(url, \"url\");\r\n        this.url = url;\r\n        // Flow-typing knows where it's at. Since HttpTransportType is a number and IHttpConnectionOptions is guaranteed\r\n        // to be an object, we know (as does TypeScript) this comparison is all we need to figure out which overload was called.\r\n        if (typeof transportTypeOrOptions === \"object\") {\r\n            this.httpConnectionOptions = { ...this.httpConnectionOptions, ...transportTypeOrOptions };\r\n        }\r\n        else {\r\n            this.httpConnectionOptions = {\r\n                ...this.httpConnectionOptions,\r\n                transport: transportTypeOrOptions,\r\n            };\r\n        }\r\n        return this;\r\n    }\r\n    /** Configures the {@link @microsoft/signalr.HubConnection} to use the specified Hub Protocol.\r\n     *\r\n     * @param {IHubProtocol} protocol The {@link @microsoft/signalr.IHubProtocol} implementation to use.\r\n     */\r\n    withHubProtocol(protocol) {\r\n        Arg.isRequired(protocol, \"protocol\");\r\n        this.protocol = protocol;\r\n        return this;\r\n    }\r\n    withAutomaticReconnect(retryDelaysOrReconnectPolicy) {\r\n        if (this.reconnectPolicy) {\r\n            throw new Error(\"A reconnectPolicy has already been set.\");\r\n        }\r\n        if (!retryDelaysOrReconnectPolicy) {\r\n            this.reconnectPolicy = new DefaultReconnectPolicy();\r\n        }\r\n        else if (Array.isArray(retryDelaysOrReconnectPolicy)) {\r\n            this.reconnectPolicy = new DefaultReconnectPolicy(retryDelaysOrReconnectPolicy);\r\n        }\r\n        else {\r\n            this.reconnectPolicy = retryDelaysOrReconnectPolicy;\r\n        }\r\n        return this;\r\n    }\r\n    /** Configures {@link @microsoft/signalr.HubConnection.serverTimeoutInMilliseconds} for the {@link @microsoft/signalr.HubConnection}.\r\n     *\r\n     * @returns The {@link @microsoft/signalr.HubConnectionBuilder} instance, for chaining.\r\n     */\r\n    withServerTimeout(milliseconds) {\r\n        Arg.isRequired(milliseconds, \"milliseconds\");\r\n        this._serverTimeoutInMilliseconds = milliseconds;\r\n        return this;\r\n    }\r\n    /** Configures {@link @microsoft/signalr.HubConnection.keepAliveIntervalInMilliseconds} for the {@link @microsoft/signalr.HubConnection}.\r\n     *\r\n     * @returns The {@link @microsoft/signalr.HubConnectionBuilder} instance, for chaining.\r\n     */\r\n    withKeepAliveInterval(milliseconds) {\r\n        Arg.isRequired(milliseconds, \"milliseconds\");\r\n        this._keepAliveIntervalInMilliseconds = milliseconds;\r\n        return this;\r\n    }\r\n    /** Enables and configures options for the Stateful Reconnect feature.\r\n     *\r\n     * @returns The {@link @microsoft/signalr.HubConnectionBuilder} instance, for chaining.\r\n     */\r\n    withStatefulReconnect(options) {\r\n        if (this.httpConnectionOptions === undefined) {\r\n            this.httpConnectionOptions = {};\r\n        }\r\n        this.httpConnectionOptions._useStatefulReconnect = true;\r\n        this._statefulReconnectBufferSize = options === null || options === void 0 ? void 0 : options.bufferSize;\r\n        return this;\r\n    }\r\n    /** Creates a {@link @microsoft/signalr.HubConnection} from the configuration options specified in this builder.\r\n     *\r\n     * @returns {HubConnection} The configured {@link @microsoft/signalr.HubConnection}.\r\n     */\r\n    build() {\r\n        // If httpConnectionOptions has a logger, use it. Otherwise, override it with the one\r\n        // provided to configureLogger\r\n        const httpConnectionOptions = this.httpConnectionOptions || {};\r\n        // If it's 'null', the user **explicitly** asked for null, don't mess with it.\r\n        if (httpConnectionOptions.logger === undefined) {\r\n            // If our logger is undefined or null, that's OK, the HttpConnection constructor will handle it.\r\n            httpConnectionOptions.logger = this.logger;\r\n        }\r\n        // Now create the connection\r\n        if (!this.url) {\r\n            throw new Error(\"The 'HubConnectionBuilder.withUrl' method must be called before building the connection.\");\r\n        }\r\n        const connection = new HttpConnection(this.url, httpConnectionOptions);\r\n        return HubConnection.create(connection, this.logger || NullLogger.instance, this.protocol || new JsonHubProtocol(), this.reconnectPolicy, this._serverTimeoutInMilliseconds, this._keepAliveIntervalInMilliseconds, this._statefulReconnectBufferSize);\r\n    }\r\n}\r\nfunction isLogger(logger) {\r\n    return logger.log !== undefined;\r\n}\r\n//# sourceMappingURL=HubConnectionBuilder.js.map","// composables/useSignalR.ts\r\nimport { ref, onUnmounted } from 'vue'\r\nimport * as signalR from '@microsoft/signalr'\r\n\r\nexport interface SignalROptions {\r\n  hubUrl?: string\r\n  autoReconnect?: boolean\r\n}\r\n\r\nexport function useSignalR(options: SignalROptions = {}) {\r\n  const hubUrl = options.hubUrl || '/gridhub'\r\n  const autoReconnect = options.autoReconnect !== false\r\n\r\n  const connection = ref<signalR.HubConnection | null>(null)\r\n  const isConnected = ref(false)\r\n  const isConnecting = ref(false)\r\n  const connectionError = ref<Error | null>(null)\r\n\r\n  async function start() {\r\n    if (connection.value || isConnecting.value) {\r\n      console.log('SignalR: Already connected or connecting')\r\n      return\r\n    }\r\n\r\n    isConnecting.value = true\r\n    connectionError.value = null\r\n\r\n    try {\r\n      const builder = new signalR.HubConnectionBuilder()\r\n        .withUrl(hubUrl, {\r\n          skipNegotiation: false,\r\n          transport: signalR.HttpTransportType.WebSockets | signalR.HttpTransportType.ServerSentEvents | signalR.HttpTransportType.LongPolling\r\n        })\r\n\r\n      if (autoReconnect) {\r\n        builder.withAutomaticReconnect({\r\n          nextRetryDelayInMilliseconds: (retryContext) => {\r\n            // Exponential backoff: 0ms, 2s, 10s, 30s, then 30s\r\n            if (retryContext.previousRetryCount === 0) return 0\r\n            if (retryContext.previousRetryCount === 1) return 2000\r\n            if (retryContext.previousRetryCount === 2) return 10000\r\n            return 30000\r\n          }\r\n        })\r\n      }\r\n\r\n      connection.value = builder.build()\r\n\r\n      // Connection lifecycle events\r\n      connection.value.onclose((error) => {\r\n        isConnected.value = false\r\n        if (error) {\r\n          console.error('SignalR connection closed with error:', error)\r\n          connectionError.value = error\r\n        } else {\r\n          console.log('SignalR connection closed')\r\n        }\r\n      })\r\n\r\n      connection.value.onreconnecting((error) => {\r\n        isConnected.value = false\r\n        console.warn('SignalR reconnecting...', error)\r\n      })\r\n\r\n      connection.value.onreconnected((connectionId) => {\r\n        isConnected.value = true\r\n        connectionError.value = null\r\n        console.log('SignalR reconnected:', connectionId)\r\n      })\r\n\r\n      // Start connection\r\n      await connection.value.start()\r\n      isConnected.value = true\r\n      console.log('SignalR connected successfully')\r\n    } catch (error) {\r\n      console.error('SignalR connection failed:', error)\r\n      connectionError.value = error as Error\r\n      connection.value = null\r\n    } finally {\r\n      isConnecting.value = false\r\n    }\r\n  }\r\n\r\n  async function stop() {\r\n    if (connection.value) {\r\n      try {\r\n        await connection.value.stop()\r\n        console.log('SignalR connection stopped')\r\n      } catch (error) {\r\n        console.error('Error stopping SignalR connection:', error)\r\n      } finally {\r\n        connection.value = null\r\n        isConnected.value = false\r\n      }\r\n    }\r\n  }\r\n\r\n  function on<T = any>(eventName: string, handler: (data: T) => void) {\r\n    if (!connection.value) {\r\n      console.warn(`Cannot register handler for '${eventName}': connection not initialized`)\r\n      return\r\n    }\r\n    connection.value.on(eventName, handler)\r\n  }\r\n\r\n  function off(eventName: string, handler?: (...args: any[]) => void) {\r\n    if (!connection.value) return\r\n    if (handler) {\r\n      connection.value.off(eventName, handler)\r\n    } else {\r\n      connection.value.off(eventName)\r\n    }\r\n  }\r\n\r\n  async function invoke<T = any>(methodName: string, ...args: any[]): Promise<T | void> {\r\n    if (!connection.value || !isConnected.value) {\r\n      console.error(`Cannot invoke '${methodName}': not connected`)\r\n      return\r\n    }\r\n\r\n    try {\r\n      return await connection.value.invoke<T>(methodName, ...args)\r\n    } catch (error) {\r\n      console.error(`Error invoking '${methodName}':`, error)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  // Cleanup on unmount\r\n  onUnmounted(() => {\r\n    stop()\r\n  })\r\n\r\n  return {\r\n    connection,\r\n    isConnected,\r\n    isConnecting,\r\n    connectionError,\r\n    start,\r\n    stop,\r\n    on,\r\n    off,\r\n    invoke\r\n  }\r\n}\r\n","import type { App } from 'vue'\nimport { createPinia } from 'pinia'\nimport AdvancedTable from './components/DataGrid/DataGrid.vue'\nimport ListBox from './components/ListBox/ListBox.vue'\n\nexport default {\n  install(app: App) {\n    // Register Pinia\n    app.use(createPinia())\n\n    // Register components globally\n    app.component('AdvancedTable', AdvancedTable)\n    app.component('DataGrid', AdvancedTable)\n    app.component('ListBox', ListBox)\n  }\n}\n","// Components\nexport { default as AdvancedTable } from './components/DataGrid/DataGrid.vue'\nexport { default as DataGrid } from './components/DataGrid/DataGrid.vue'\nexport { default as ListBox } from './components/ListBox/ListBox.vue'\n\n// Composables\nexport { useFiltering } from './composables/useFiltering'\nexport { useSorting } from './composables/useSorting'\nexport { useSearch } from './composables/useSearch'\nexport { useValidation } from './composables/useValidation'\nexport { useCopyPaste } from './composables/useCopyPaste'\nexport { useAutoRowHeight } from './composables/useAutoRowHeight'\nexport { useShortcuts } from './composables/useShortcuts'\nexport { useTheme } from './composables/useTheme'\nexport { useSelection } from './composables/useSelection'\nexport { useLogger } from './composables/useLogger'\nexport { useSignalR } from './composables/useSignalR'\nexport { useImportExport } from './composables/useImportExport'\n\n// Stores\nexport { useDataGridStore } from './stores/dataGridStore'\nexport type { GridColumn } from './stores/dataGridStore'\n\n// Services\nexport { gridApi } from './services/gridApi'\nexport type { GridRow, ValidationRule, GridConfig, ApiResponse } from './services/gridApi'\n\n// Types\nexport type * from './types'\n\n// Plugin\nexport { default as RpaWebUIPlugin } from './plugin'\n\n// Version\nexport const version = '1.0.0'\n"],"names":["getInternetExplorerVersion","ua","msie","trident","rv","edge","isIE","initCompat","script","nextTick","object","_withId","withScopeId","pushScopeId","_hoisted_1","popScopeId","render","_ctx","_cache","$props","$setup","$data","$options","openBlock","createBlock","_typeof","obj","_classCallCheck","instance","Constructor","_defineProperties","target","props","i","descriptor","_createClass","protoProps","staticProps","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_arrayLikeToArray","iter","minLen","len","arr2","processOptions","value","options","throttle","callback","delay","timeout","lastState","currentArgs","throttled","state","_len","args","_key","leading","deepEqual","val1","val2","key","VisibilityState","el","vnode","_this","result","entry","_ref","_leading","entries","intersectingEntry","e","beforeMount","_ref2","updated","_ref3","oldValue","unmounted","ObserveVisibility","mitt","n","t","config","regex","parents","node","ps","style","prop","overflow","scroll","getScrollParent","simpleArray","supportsPassive","opts","uid","script$2","ResizeObserver$1","sizes","items","field","minItemSize","computedMinSize","accumulator","current","l","keyField","lastPosition","pool","index","item","type","nr","markRaw","view","shallowReactive","fake","unusedViews","unusedPool","event","requestUpdate","continuous","isVisible","checkItem","checkPositionDiff","itemSize","gridItems","itemSecondarySize","typeField","count","views","itemIndexByKey","startIndex","endIndex","totalSize","visibleStartIndex","visibleEndIndex","positionDiff","buffer","beforeSize","afterSize","h","a","b","oldI","remainer","unusedIndex","v","newlyUsedView","direction","isVertical","scrollState","bounds","boundsSize","start","size","position","viewport","scrollDirection","scrollDistance","viewportEl","scrollTop","scrollerPosition","viewA","viewB","_hoisted_2","render$1","_component_ResizeObserver","resolveComponent","_directive_observe_visibility","resolveDirective","withDirectives","createElementBlock","normalizeClass","renderSlot","createCommentVNode","resolveDynamicComponent","normalizeStyle","withCtx","Fragment","renderList","mergeProps","toHandlers","createVNode","script$1","width","height","resizeObserverSize","id","next","prev","prevActiveTop","activeTop","length","offset","clear","scroller","cb","_component_RecycleScroller","itemWithSize","active","normalizeProps","guardReactiveProps","oldSize","k","force","useFiltering","currentFilter","ref","evaluateFilter","row","filter","store","evaluateSimpleFilter","evaluateCompositeFilter","cellValue","cell","c","filterValue","leftResult","rightResult","filterRows","rows","setFilter","clearFilter","useSearch","searchTerm","searchMode","searchResults","currentResultIndex","searchInRows","term","mode","matches","caseSensitive","fuzzyThreshold","isMatch","searchValue","flags","fuzzyMatch","text","pattern","threshold","levenshteinDistance","matrix","j","goToNextResult","goToPreviousResult","clearSearch","isSearchMatch","rowId","columnName","m","useDataGridStore","storeId","defineStore","rowsMap","rowsOrder","columns","selectedCells","checkedRows","pageSize","currentPage","sortColumnsMap","sortColumnsOrder","filterExpression","searchQuery","pressedCell","isDragging","wasCtrlPressed","isAutoRowHeightEnabled","validatedCells","changedCellsSinceValidation","computed","sortColumns","sortInfo","getRow","hasRow","totalRows","totalPages","visibleRows","filteredRows","storeInterface","searchRowIds","r","sortRows","end","loadRows","data","newMap","newOrder","rowData","idx","generateULID","col","_a","updateCell","cellKey","updateRowHeight","newHeight","oldHeight","setAutoRowHeightEnabled","enabled","rowsToSort","sorts","aCell","bCell","aVal","bVal","cmp","compareValues","addSort","multiSort","existing","clearSort","setPageSize","goToPage","page","deleteRow","checkedIndex","insertRow","afterRowId","newRowId","newRow","insertMultipleRows","insertIndex","newRowIds","toggleCheckbox","checked","checkboxState","isRowChecked","toggleAllCheckboxes","currentCount","totalCount","newCount","newState","checkedCount","setConfig","newConfig","initializeEmptyRows","rowCount","_b","setSearchQuery","query","selectCell","isCtrlPressed","startDragSelection","expandDragSelection","currentRowId","currentColumnName","pressedRowIndex","currentRowIndex","selectableColumns","pressedColIndex","currentColIndex","startRowIndex","endRowIndex","startColIndex","endColIndex","rowIdx","colIdx","endDragSelection","isCellSelected","SPECIAL_COLUMN_NAMES","setColumns","inputColumns","conflicts","uniqueColumns","ensureUniqueColumnNames","nameCounts","originalName","areNonEmptyRowsValid","markCellValidated","clearValidationTracking","getCellsNeedingValidation","columnsToValidate","cellsToValidate","emptyRowsSkipped","alreadyValidatedCells","changedCells","neverValidatedCells","isValidated","isChanged","toValue","unref","noop","createFilterWrapper","fn","wrapper","resolve","reject","debounceFilter","ms","timer","maxTimer","lastRejector","_clearTimeout","timer2","invoke","duration","maxDuration","useDebounceFn","useValidation","validationRules","validationErrors","reactive","errorCount","ruleCount","updateErrorCount","addValidationRule","rule","rules","validateCell","isEmpty","numValue","isRowCompletelyEmpty","rowCells","validateCellThrottled","rowErrors","filteredErrors","existingErrorIdx","error","validateAll","totalErrors","rowIndex","BATCH_SIZE","totalBatches","batchIndex","batchStart","batchEnd","batch","rowsWithErrorsCount","allErrors","getValidationErrors","clearValidationErrors","clearedCount","useCopyPaste","clipboardData","escapeTsvValue","formatAsTabSeparated","columnNames","lines","values","parseTabSeparated","clipboardText","currentRow","currentCell","inQuotes","isFirstRow","headers","isHeaderRow","_","firstDataRow","dataRow","copySelectedCells","allRows","allColumns","cellPositions","columnIndex","minRowIndex","maxRowIndex","minColIndex","maxColIndex","cellPos","tsvData","copyToClipboard","pasteFromClipboard","canPaste","clearClipboard","ImportMode","useImportExport","exportToJson","includeHiddenColumns","includeSpecialColumns","onlySelectedRows","prettify","dataToExport","filteredData","filteredRow","jsonString","blob","url","link","importFromJson","file","existingRows","parsedData","errors","rowsSkipped","firstRow","importKeys","missingColumns","resultRows","existingRowsMap","importRow","existingRow","openImportDialog","input","defaultAutoRowHeightConfig","useAutoRowHeight","canvas","context","getContext","measureTextHeight","ctx","explicitLines","lineHeight","totalLines","line","words","currentLine","linesInThisSegment","word","testLine","totalHeight","calculateRowHeight","maxHeight","column","textValue","cellHeight","calculateRowHeights","applyAutoRowHeight","updatedCount","recalculateRows","rowIds","updateMaxHeight","newMaxHeight","ShortcutContext","useShortcuts","shortcuts","currentContext","keyCombinationToString","parts","matchesKeyCombination","isContextMatch","shortcutContext","handleKeyDown","matchingShortcuts","shortcut","registerShortcut","definition","keyString","registerShortcuts","definitions","unregisterShortcut","unregisterShortcutByName","name","def","setShortcutEnabled","getShortcuts","getShortcutsByContext","s","clearShortcuts","onMounted","onUnmounted","Keys","createDefaultShortcuts","handlers","logQueue","isProcessing","PROCESSING_INTERVAL","processingTimer","getTimestamp","enqueueLog","level","category","message","startProcessing","processLogBatch","stopProcessing","writeLogToConsole","useLogger","BASE_URL","GridApiService","method","resultJson","endpoint","response","jsonData","optionsJson","params","jsonRules","gridApi","defaultDataGridTheme","defaultListBoxTheme","THEME_KEY","useTheme","inject","generateDataGridCSSVariables","theme","generateListBoxCSSVariables","le","ht","mt","ot","Ke","ee","se","o","ue","pt","u","We","gt","bt","lt","Ct","Ye","q","te","re","yt","xt","Mt","Ve","Ue","Xe","d","p","x","kt","me","Ze","St","Ge","wt","It","W","B","L","_e","S","M","De","H","f","C","y","I","g","de","K","R","N","V","U","A","w","$","Q","Z","ne","Y","G","O","ce","Fe","Ce","be","ae","Me","P","oe","ye","z","E","D","ke","Wt","_t","Ht","Rt","Ot","Bt","Pt","$t","At","Ft","Lt","Tt","Et","zt","jt","Dt","Nt","$e","T","J","F","He","ie","Re","Kt","Yt","Vt","qe","ge","Ae","X","fe","Se","ut","at","it","Le","we","Ie","ze","je","Te","rt","ct","Ee","ve","he","Be","et","dt","pe","Oe","Pe","tt","st","nt","xe","Ut","ft","vt","Xt","Zt","Ne","Je","Qe","__props","emit","__emit","resizingColumn","resizeStartX","resizeStartWidth","sortInfoMap","map","sortCol","getSortInfo","handleHeaderClick","handleSort","showHeaderContextMenu","handleCheckboxHeaderClick","currentSort","newDirection","startResize","onResizeMove","onResizeEnd","delta","newWidth","sortColumnsCopy","filterExpressionCopy","menuItems","hasOtherSorts","newSorts","ContextMenu","_createElementBlock","_Fragment","_renderList","_normalizeClass","$event","_withModifiers","_unref","_hoisted_3","_openBlock","_hoisted_4","_toDisplayString","_createTextVNode","_c","_hoisted_5","_d","_createElementVNode","storeToRefs","validation","cellRef","inputRef","isEditing","editValue","originalValue","isHovered","tooltipPosition","isConfirming","displayValue","hasNewlines","highlightedValue","escapeHtml","escapedQuery","div","validationError","cellClasses","cellStyle","handleMouseDown","handleMouseEnter","rect","isLeftButtonPressed","handleMouseLeave","handleCellKeyDown","enterEditMode","handleDoubleClick","getRowCells","handleInput","confirmEdit","cancelEdit","handleBlur","handleContextMenu","selectedRowData","selectedRowCount","selectedRowIndices","minRow","maxRow","_createBlock","_Teleport","_normalizeStyle","DELETE_DEBOUNCE_MS","watch","newVal","oldVal","isDeleting","lastDeleteClick","rowNumber","validationErrorsForRow","hasValidationErrors","hasValidationWarnings","validationMessage","specialCellClasses","handleCheckboxChange","handleDelete","now","handleInsert","isRowCheckedComputed","getCellForColumn","handleEditComplete","handleCellInput","handleDeleteRow","handleInsertRow","handleInsertAbove","handleInsertBelow","SpecialColumnCell","DataGridCell","sortedPageSizeOptions","visiblePages","total","maxVisible","pages","step","handlePageSizeChange","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_10","filterMode","searchText","regexPattern","newValues","newPattern","filteredValues","search","displayText","selectAll","deselectAll","handleApply","selectedValues","handleClose","handleClear","_vModelCheckbox","_hoisted_9","instanceId","logger","provide","copyPaste","filterRowsHelper","isGridReady","containerHeight","computedMaxHeight","autoRowHeight","applyAutoRowHeightToAll","measureContainerHeight","scrollerRef","handleDocumentMouseUp","handleKeyboardShortcuts","checkBackendConnection","onBeforeUnmount","isBackendConnected","isLoadingFromBackend","isSavingToBackend","getSelectedRows","cellId","getDataColumnNames","dataColumns","handleCopy","handlePaste","targetRowIndex","targetRow","lastRowId","handleCut","handleSelectAll","handleCopySelectedCells","handlePasteSelectedCells","targetColIndex","firstCellKey","firstRowId","firstColName","firstColIdx","rowOffset","pasteRowIndex","columnKey","colOffset","pasteColIndex","targetColumn","onBeforeMount","validateAllCellsInBatches","validatedCount","batchNumber","wasEnabled","specialColumns","cols","validationColumn","actionColumns","gridTemplateColumns","template","newColumns","oldCount","rulesSize","newLength","oldLength","hasRules","oldErrorCount","newErrors","resetAllRowHeights","handleResize","handleCellEditComplete","recalculateRowHeightAfterEdit","recalculateRowHeightForNewlines","hiddenColumns","handleHideColumn","showColumn","showAllColumns","handleAutoFitColumn","maxWidth","headerWidth","textWidth","filterFlyout","extractFiltersExceptColumn","excludeColumnName","compositeFilter","leftFiltered","rightFiltered","extractSelectedValuesForColumn","traverse","expr","simpleFilter","getUniqueValues","filtersExceptThisColumn","sampleSize","trueCount","falseCount","currentlySelectedValues","valueMap","handleShowFilter","uniqueValues","closeFilterFlyout","extractColumnFilters","columnFilters","isAndContext","simple","composite","leftCol","rightCol","combineFiltersWithAnd","filters","validFilters","combineWithExistingFilters","newColumnFilter","allFilters","handleApplyCheckboxFilter","combinedFilter","filterValues","handleApplyRegexFilter","handleClearFilter","columnsForMeasurement","heightsBefore","heightsAfter","rowsProcessed","defaultHeight","maxLines","calculatedHeight","loadDataFromBackend","saveDataToBackend","mergedTheme","_f","_g","_h","cssVariables","enhancedValidation","__expose","_createVNode","DataGridHeader","DynamicScroller","DynamicScrollerItem","DataGridRow","PaginationControl","FilterFlyout","hoveredValue","newPreSelected","listboxStyle","isSelected","handleItemClick","useSorting","aDate","bDate","aStr","bStr","existingIdx","removeSort","useSelection","anchorCell","selectRange","startCell","endCell","startRowIdx","endRowIdx","startColIdx","endColIdx","minCol","maxCol","selectRow","selectColumn","clearSelection","getSelectedCells","HttpError","errorMessage","statusCode","trueProto","TimeoutError","AbortError","UnsupportedTransportError","transport","DisabledTransportError","FailedToStartTransportError","FailedToNegotiateWithServerError","AggregateErrors","innerErrors","HttpResponse","statusText","content","HttpClient","LogLevel","NullLogger","_logLevel","_message","VERSION","Arg","val","Platform","getDataDetail","includeContent","detail","isArrayBuffer","formatArrayBuffer","str","num","pad","sendMessage","transportName","httpClient","getUserAgentHeader","responseType","createLogger","ConsoleLogger","SubjectSubscription","subject","observer","minimumLogLevel","logLevel","msg","userAgentHeaderName","constructUserAgent","getOsName","getRuntime","getRuntimeVersion","version","os","runtime","runtimeVersion","userAgent","majorAndMinor","getErrorString","getGlobalThis","FetchHttpClient","requireFunc","request","abortController","timeoutId","msTimeout","deserializeContent","payload","cookies","XhrHttpClient","xhr","header","DefaultHttpClient","TextMessageFormat","output","messages","HandshakeProtocol","handshakeRequest","messageData","remainingData","binaryData","separatorIndex","responseLength","textData","MessageType","Subject","err","MessageBuffer","protocol","connection","bufferSize","serializedMessage","backpressurePromise","backpressurePromiseResolver","backpressurePromiseRejector","BufferedItem","ackMessage","newestAckedMessage","element","currentId","sequenceId","resolver","rejector","DEFAULT_TIMEOUT_IN_MS","DEFAULT_PING_INTERVAL_IN_MS","DEFAULT_STATEFUL_RECONNECT_BUFFER_SIZE","HubConnectionState","HubConnection","reconnectPolicy","serverTimeoutInMilliseconds","keepAliveIntervalInMilliseconds","statefulReconnectBufferSize","handshakePromise","startPromise","methodName","streams","streamIds","invocationDescriptor","promiseQueue","cancelInvocation","invocationEvent","sendPromise","newMethod","removeIdx","responseMessage","nextPing","invocationMessage","methods","methodsCopy","expectsResponse","res","exception","completionMessage","prevRes","reconnectStartTime","previousReconnectAttempts","retryError","nextRetryDelay","previousRetryCount","elapsedMilliseconds","retryReason","callbacks","nonblocking","invocationId","streamId","argument","arg","DEFAULT_RETRY_DELAYS_IN_MILLISECONDS","DefaultReconnectPolicy","retryDelays","retryContext","HeaderNames","AccessTokenHttpClient","innerClient","accessTokenFactory","allowRetry","HttpTransportType","TransferFormat","AbortController$1","LongPollingTransport","AbortController","transferFormat","pollOptions","pollUrl","deleteOptions","logMessage","ServerSentEventsTransport","accessToken","opened","eventSource","WebSocketTransport","logMessageContent","webSocketConstructor","token","webSocket","_event","MAX_REDIRECTS","HttpConnection","webSocketModule","eventSourceModule","TransportSendQueue","negotiateResponse","redirects","negotiateUrl","connectionToken","requestedTransport","requestedTransferFormat","connectUrl","transportExceptions","transports","negotiate","transportOrError","ex","callStop","useStatefulReconnect","transportMatches","aTag","searchParams","actualTransport","_transport","PromiseSource","transportResult","arrayBuffers","totalLength","reason","JSON_HUB_PROTOCOL_NAME","JsonHubProtocol","hubMessages","parsedMessage","LogLevelNameMapping","parseLogLevel","mapping","HubConnectionBuilder","logging","isLogger","transportTypeOrOptions","retryDelaysOrReconnectPolicy","milliseconds","httpConnectionOptions","useSignalR","hubUrl","autoReconnect","isConnected","isConnecting","connectionError","builder","signalR.HubConnectionBuilder","signalR.HttpTransportType","connectionId","stop","on","eventName","handler","off","plugin","app","createPinia","AdvancedTable","ListBox"],"mappings":"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","x_google_ignoreList":[0,1,2,3,7,16,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]}