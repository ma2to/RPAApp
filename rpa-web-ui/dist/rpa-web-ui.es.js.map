{"version":3,"file":"rpa-web-ui.es.js","sources":["../node_modules/vue-resize/dist/vue-resize.esm.js","../node_modules/vue-observe-visibility/dist/vue-observe-visibility.esm.js","../node_modules/vue-virtual-scroller/node_modules/mitt/dist/mitt.es.js","../node_modules/vue-virtual-scroller/dist/vue-virtual-scroller.esm.js","../node_modules/vue-demi/lib/index.mjs","../node_modules/@vue/devtools-api/lib/esm/env.js","../node_modules/@vue/devtools-api/lib/esm/const.js","../node_modules/@vue/devtools-api/lib/esm/time.js","../node_modules/@vue/devtools-api/lib/esm/proxy.js","../node_modules/@vue/devtools-api/lib/esm/index.js","../node_modules/pinia/dist/pinia.mjs","../src/composables/useFiltering.ts","../src/composables/useSearch.ts","../src/stores/dataGridStore.ts","../src/composables/useValidation.ts","../src/composables/useCopyPaste.ts","../src/composables/useAutoRowHeight.ts","../src/composables/useShortcuts.ts","../src/composables/useLogger.ts","../src/services/gridApi.ts","../src/composables/useTheme.ts","../src/components/DataGridHeader.vue","../src/components/DataGridCell.vue","../src/components/SpecialColumnCell.vue","../src/components/DataGridRow.vue","../src/components/PaginationControl.vue","../src/components/FilterFlyout.vue","../src/components/DataGrid.vue","../src/components/ListBox.vue","../src/components/SearchPanel.vue","../src/components/FilterRow.vue","../src/index.ts"],"sourcesContent":["import { nextTick, pushScopeId, popScopeId, openBlock, createBlock, withScopeId } from 'vue';\n\nfunction getInternetExplorerVersion() {\n  var ua = window.navigator.userAgent;\n  var msie = ua.indexOf('MSIE ');\n\n  if (msie > 0) {\n    // IE 10 or older => return version number\n    return parseInt(ua.substring(msie + 5, ua.indexOf('.', msie)), 10);\n  }\n\n  var trident = ua.indexOf('Trident/');\n\n  if (trident > 0) {\n    // IE 11 => return version number\n    var rv = ua.indexOf('rv:');\n    return parseInt(ua.substring(rv + 3, ua.indexOf('.', rv)), 10);\n  }\n\n  var edge = ua.indexOf('Edge/');\n\n  if (edge > 0) {\n    // Edge (IE 12+) => return version number\n    return parseInt(ua.substring(edge + 5, ua.indexOf('.', edge)), 10);\n  } // other browser\n\n\n  return -1;\n}\n\nlet isIE;\n\nfunction initCompat () {\n  if (!initCompat.init) {\n    initCompat.init = true;\n    isIE = getInternetExplorerVersion() !== -1;\n  }\n}\n\nvar script = {\n  name: 'ResizeObserver',\n\n  props: {\n    emitOnMount: {\n      type: Boolean,\n      default: false,\n    },\n\n    ignoreWidth: {\n      type: Boolean,\n      default: false,\n    },\n\n    ignoreHeight: {\n      type: Boolean,\n      default: false,\n    },\n  },\n\n  emits: [\n    'notify',\n  ],\n\n  mounted () {\n    initCompat();\n    nextTick(() => {\n      this._w = this.$el.offsetWidth;\n      this._h = this.$el.offsetHeight;\n      if (this.emitOnMount) {\n        this.emitSize();\n      }\n    });\n    const object = document.createElement('object');\n    this._resizeObject = object;\n    object.setAttribute('aria-hidden', 'true');\n    object.setAttribute('tabindex', -1);\n    object.onload = this.addResizeHandlers;\n    object.type = 'text/html';\n    if (isIE) {\n      this.$el.appendChild(object);\n    }\n    object.data = 'about:blank';\n    if (!isIE) {\n      this.$el.appendChild(object);\n    }\n  },\n\n  beforeUnmount () {\n    this.removeResizeHandlers();\n  },\n\n  methods: {\n    compareAndNotify () {\n      if ((!this.ignoreWidth && this._w !== this.$el.offsetWidth) || (!this.ignoreHeight && this._h !== this.$el.offsetHeight)) {\n        this._w = this.$el.offsetWidth;\n        this._h = this.$el.offsetHeight;\n        this.emitSize();\n      }\n    },\n\n    emitSize () {\n      this.$emit('notify', {\n        width: this._w,\n        height: this._h,\n      });\n    },\n\n    addResizeHandlers () {\n      this._resizeObject.contentDocument.defaultView.addEventListener('resize', this.compareAndNotify);\n      this.compareAndNotify();\n    },\n\n    removeResizeHandlers () {\n      if (this._resizeObject && this._resizeObject.onload) {\n        if (!isIE && this._resizeObject.contentDocument) {\n          this._resizeObject.contentDocument.defaultView.removeEventListener('resize', this.compareAndNotify);\n        }\n        this.$el.removeChild(this._resizeObject);\n        this._resizeObject.onload = null;\n        this._resizeObject = null;\n      }\n    },\n  },\n};\n\nconst _withId = /*#__PURE__*/withScopeId(\"data-v-b329ee4c\");\n\npushScopeId(\"data-v-b329ee4c\");\nconst _hoisted_1 = {\n  class: \"resize-observer\",\n  tabindex: \"-1\"\n};\npopScopeId();\n\nconst render = /*#__PURE__*/_withId((_ctx, _cache, $props, $setup, $data, $options) => {\n  return (openBlock(), createBlock(\"div\", _hoisted_1))\n});\n\nscript.render = render;\nscript.__scopeId = \"data-v-b329ee4c\";\nscript.__file = \"src/components/ResizeObserver.vue\";\n\nfunction install(app) {\n  // eslint-disable-next-line vue/component-definition-name-casing\n  app.component('resize-observer', script);\n  app.component('ResizeObserver', script);\n}\n\nvar plugin = {\n  // eslint-disable-next-line no-undef\n  version: \"2.0.0-alpha.1\",\n  install: install\n};\n\nexport default plugin;\nexport { script as ResizeObserver, install };\n//# sourceMappingURL=vue-resize.esm.js.map\n","import { nextTick } from 'vue';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction processOptions(value) {\n  var options;\n\n  if (typeof value === 'function') {\n    // Simple options (callback-only)\n    options = {\n      callback: value\n    };\n  } else {\n    // Options object\n    options = value;\n  }\n\n  return options;\n}\nfunction throttle(callback, delay) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var timeout;\n  var lastState;\n  var currentArgs;\n\n  var throttled = function throttled(state) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    currentArgs = args;\n    if (timeout && state === lastState) return;\n    var leading = options.leading;\n\n    if (typeof leading === 'function') {\n      leading = leading(state, lastState);\n    }\n\n    if ((!timeout || state !== lastState) && leading) {\n      callback.apply(void 0, [state].concat(_toConsumableArray(currentArgs)));\n    }\n\n    lastState = state;\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      callback.apply(void 0, [state].concat(_toConsumableArray(currentArgs)));\n      timeout = 0;\n    }, delay);\n  };\n\n  throttled._clear = function () {\n    clearTimeout(timeout);\n    timeout = null;\n  };\n\n  return throttled;\n}\nfunction deepEqual(val1, val2) {\n  if (val1 === val2) return true;\n\n  if (_typeof(val1) === 'object') {\n    for (var key in val1) {\n      if (!deepEqual(val1[key], val2[key])) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  return false;\n}\n\nvar VisibilityState = /*#__PURE__*/function () {\n  function VisibilityState(el, options, vnode) {\n    _classCallCheck(this, VisibilityState);\n\n    this.el = el;\n    this.observer = null;\n    this.frozen = false;\n    this.createObserver(options, vnode);\n  }\n\n  _createClass(VisibilityState, [{\n    key: \"createObserver\",\n    value: function createObserver(options, vnode) {\n      var _this = this;\n\n      if (this.observer) {\n        this.destroyObserver();\n      }\n\n      if (this.frozen) return;\n      this.options = processOptions(options);\n\n      this.callback = function (result, entry) {\n        _this.options.callback(result, entry);\n\n        if (result && _this.options.once) {\n          _this.frozen = true;\n\n          _this.destroyObserver();\n        }\n      }; // Throttle\n\n\n      if (this.callback && this.options.throttle) {\n        var _ref = this.options.throttleOptions || {},\n            _leading = _ref.leading;\n\n        this.callback = throttle(this.callback, this.options.throttle, {\n          leading: function leading(state) {\n            return _leading === 'both' || _leading === 'visible' && state || _leading === 'hidden' && !state;\n          }\n        });\n      }\n\n      this.oldResult = undefined;\n      this.observer = new IntersectionObserver(function (entries) {\n        var entry = entries[0];\n\n        if (entries.length > 1) {\n          var intersectingEntry = entries.find(function (e) {\n            return e.isIntersecting;\n          });\n\n          if (intersectingEntry) {\n            entry = intersectingEntry;\n          }\n        }\n\n        if (_this.callback) {\n          // Use isIntersecting if possible because browsers can report isIntersecting as true, but intersectionRatio as 0, when something very slowly enters the viewport.\n          var result = entry.isIntersecting && entry.intersectionRatio >= _this.threshold;\n          if (result === _this.oldResult) return;\n          _this.oldResult = result;\n\n          _this.callback(result, entry);\n        }\n      }, this.options.intersection); // Wait for the element to be in document\n\n      nextTick(function () {\n        if (_this.observer) {\n          _this.observer.observe(_this.el);\n        }\n      });\n    }\n  }, {\n    key: \"destroyObserver\",\n    value: function destroyObserver() {\n      if (this.observer) {\n        this.observer.disconnect();\n        this.observer = null;\n      } // Cancel throttled call\n\n\n      if (this.callback && this.callback._clear) {\n        this.callback._clear();\n\n        this.callback = null;\n      }\n    }\n  }, {\n    key: \"threshold\",\n    get: function get() {\n      return this.options.intersection && typeof this.options.intersection.threshold === 'number' ? this.options.intersection.threshold : 0;\n    }\n  }]);\n\n  return VisibilityState;\n}();\n\nfunction beforeMount(el, _ref2, vnode) {\n  var value = _ref2.value;\n  if (!value) return;\n\n  if (typeof IntersectionObserver === 'undefined') {\n    console.warn('[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill');\n  } else {\n    var state = new VisibilityState(el, value, vnode);\n    el._vue_visibilityState = state;\n  }\n}\n\nfunction updated(el, _ref3, vnode) {\n  var value = _ref3.value,\n      oldValue = _ref3.oldValue;\n  if (deepEqual(value, oldValue)) return;\n  var state = el._vue_visibilityState;\n\n  if (!value) {\n    unmounted(el);\n    return;\n  }\n\n  if (state) {\n    state.createObserver(value, vnode);\n  } else {\n    beforeMount(el, {\n      value: value\n    }, vnode);\n  }\n}\n\nfunction unmounted(el) {\n  var state = el._vue_visibilityState;\n\n  if (state) {\n    state.destroyObserver();\n    delete el._vue_visibilityState;\n  }\n}\n\nvar ObserveVisibility = {\n  beforeMount: beforeMount,\n  updated: updated,\n  unmounted: unmounted\n};\n\nfunction install(app) {\n  app.directive('observe-visibility', ObserveVisibility);\n  /* -- Add more components here -- */\n}\n/* -- Plugin definition & Auto-install -- */\n\n/* You shouldn't have to modify the code below */\n// Plugin\n\nvar plugin = {\n  // eslint-disable-next-line no-undef\n  version: \"2.0.0-alpha.1\",\n  install: install\n};\n\nexport default plugin;\nexport { ObserveVisibility, install };\n","export default function(n){return{all:n=n||new Map,on:function(t,e){var i=n.get(t);i&&i.push(e)||n.set(t,[e])},off:function(t,e){var i=n.get(t);i&&i.splice(i.indexOf(e)>>>0,1)},emit:function(t,e){(n.get(t)||[]).slice().map(function(n){n(e)}),(n.get(\"*\")||[]).slice().map(function(n){n(t,e)})}}}\n//# sourceMappingURL=mitt.es.js.map\n","import { markRaw, shallowReactive, resolveComponent, resolveDirective, withDirectives, openBlock, createElementBlock, normalizeClass, renderSlot, createCommentVNode, createBlock, resolveDynamicComponent, normalizeStyle, withCtx, Fragment, renderList, mergeProps, toHandlers, createVNode, normalizeProps, guardReactiveProps, h, reactive } from 'vue';\nimport { ResizeObserver as ResizeObserver$1 } from 'vue-resize';\nimport { ObserveVisibility } from 'vue-observe-visibility';\nimport mitt from 'mitt';\n\nvar config = {\n  itemsLimit: 1000\n};\n\n// Fork of https://github.com/olahol/scrollparent.js to be able to build with Rollup\n\nvar regex = /(auto|scroll)/;\nfunction parents(node, ps) {\n  if (node.parentNode === null) {\n    return ps;\n  }\n  return parents(node.parentNode, ps.concat([node]));\n}\nvar style = function style(node, prop) {\n  return getComputedStyle(node, null).getPropertyValue(prop);\n};\nvar overflow = function overflow(node) {\n  return style(node, 'overflow') + style(node, 'overflow-y') + style(node, 'overflow-x');\n};\nvar scroll = function scroll(node) {\n  return regex.test(overflow(node));\n};\nfunction getScrollParent(node) {\n  if (!(node instanceof HTMLElement || node instanceof SVGElement)) {\n    return;\n  }\n  var ps = parents(node.parentNode, []);\n  for (var i = 0; i < ps.length; i += 1) {\n    if (scroll(ps[i])) {\n      return ps[i];\n    }\n  }\n  return document.scrollingElement || document.documentElement;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nvar props = {\n  items: {\n    type: Array,\n    required: true\n  },\n  keyField: {\n    type: String,\n    default: 'id'\n  },\n  direction: {\n    type: String,\n    default: 'vertical',\n    validator: function validator(value) {\n      return ['vertical', 'horizontal'].includes(value);\n    }\n  },\n  listTag: {\n    type: String,\n    default: 'div'\n  },\n  itemTag: {\n    type: String,\n    default: 'div'\n  }\n};\nfunction simpleArray() {\n  return this.items.length && _typeof(this.items[0]) !== 'object';\n}\n\nvar supportsPassive = false;\nif (typeof window !== 'undefined') {\n  supportsPassive = false;\n  try {\n    var opts = Object.defineProperty({}, 'passive', {\n      get: function get() {\n        supportsPassive = true;\n      }\n    });\n    window.addEventListener('test', null, opts);\n  } catch (e) {}\n}\n\nlet uid = 0;\n\nvar script$2 = {\n  name: 'RecycleScroller',\n\n  components: {\n    ResizeObserver: ResizeObserver$1,\n  },\n\n  directives: {\n    ObserveVisibility,\n  },\n\n  props: {\n    ...props,\n\n    itemSize: {\n      type: Number,\n      default: null,\n    },\n\n    gridItems: {\n      type: Number,\n      default: undefined,\n    },\n\n    itemSecondarySize: {\n      type: Number,\n      default: undefined,\n    },\n\n    minItemSize: {\n      type: [Number, String],\n      default: null,\n    },\n\n    sizeField: {\n      type: String,\n      default: 'size',\n    },\n\n    typeField: {\n      type: String,\n      default: 'type',\n    },\n\n    buffer: {\n      type: Number,\n      default: 200,\n    },\n\n    pageMode: {\n      type: Boolean,\n      default: false,\n    },\n\n    prerender: {\n      type: Number,\n      default: 0,\n    },\n\n    emitUpdate: {\n      type: Boolean,\n      default: false,\n    },\n\n    updateInterval: {\n      type: Number,\n      default: 0,\n    },\n\n    skipHover: {\n      type: Boolean,\n      default: false,\n    },\n\n    listTag: {\n      type: String,\n      default: 'div',\n    },\n\n    itemTag: {\n      type: String,\n      default: 'div',\n    },\n\n    listClass: {\n      type: [String, Object, Array],\n      default: '',\n    },\n\n    itemClass: {\n      type: [String, Object, Array],\n      default: '',\n    },\n  },\n\n  emits: [\n    'resize',\n    'visible',\n    'hidden',\n    'update',\n    'scroll-start',\n    'scroll-end',\n  ],\n\n  data () {\n    return {\n      pool: [],\n      totalSize: 0,\n      ready: false,\n      hoverKey: null,\n    }\n  },\n\n  computed: {\n    sizes () {\n      if (this.itemSize === null) {\n        const sizes = {\n          '-1': { accumulator: 0 },\n        };\n        const items = this.items;\n        const field = this.sizeField;\n        const minItemSize = this.minItemSize;\n        let computedMinSize = 10000;\n        let accumulator = 0;\n        let current;\n        for (let i = 0, l = items.length; i < l; i++) {\n          current = items[i][field] || minItemSize;\n          if (current < computedMinSize) {\n            computedMinSize = current;\n          }\n          accumulator += current;\n          sizes[i] = { accumulator, size: current };\n        }\n        // eslint-disable-next-line\n        this.$_computedMinItemSize = computedMinSize;\n        return sizes\n      }\n      return []\n    },\n\n    simpleArray,\n\n    itemIndexByKey () {\n      const { keyField, items } = this;\n      const result = {};\n      for (let i = 0, l = items.length; i < l; i++) {\n        result[items[i][keyField]] = i;\n      }\n      return result\n    },\n  },\n\n  watch: {\n    items () {\n      this.updateVisibleItems(true);\n    },\n\n    pageMode () {\n      this.applyPageMode();\n      this.updateVisibleItems(false);\n    },\n\n    sizes: {\n      handler () {\n        this.updateVisibleItems(false);\n      },\n      deep: true,\n    },\n\n    gridItems () {\n      this.updateVisibleItems(true);\n    },\n\n    itemSecondarySize () {\n      this.updateVisibleItems(true);\n    },\n  },\n\n  created () {\n    this.$_startIndex = 0;\n    this.$_endIndex = 0;\n    this.$_views = new Map();\n    this.$_unusedViews = new Map();\n    this.$_scrollDirty = false;\n    this.$_lastUpdateScrollPosition = 0;\n\n    // In SSR mode, we also prerender the same number of item for the first render\n    // to avoir mismatch between server and client templates\n    if (this.prerender) {\n      this.$_prerender = true;\n      this.updateVisibleItems(false);\n    }\n\n    if (this.gridItems && !this.itemSize) {\n      console.error('[vue-recycle-scroller] You must provide an itemSize when using gridItems');\n    }\n  },\n\n  mounted () {\n    this.applyPageMode();\n    this.$nextTick(() => {\n      // In SSR mode, render the real number of visible items\n      this.$_prerender = false;\n      this.updateVisibleItems(true);\n      this.ready = true;\n    });\n  },\n\n  activated () {\n    const lastPosition = this.$_lastUpdateScrollPosition;\n    if (typeof lastPosition === 'number') {\n      this.$nextTick(() => {\n        this.scrollToPosition(lastPosition);\n      });\n    }\n  },\n\n  beforeUnmount () {\n    this.removeListeners();\n  },\n\n  methods: {\n    addView (pool, index, item, key, type) {\n      const nr = markRaw({\n        id: uid++,\n        index,\n        used: true,\n        key,\n        type,\n      });\n      const view = shallowReactive({\n        item,\n        position: 0,\n        nr,\n      });\n      pool.push(view);\n      return view\n    },\n\n    unuseView (view, fake = false) {\n      const unusedViews = this.$_unusedViews;\n      const type = view.nr.type;\n      let unusedPool = unusedViews.get(type);\n      if (!unusedPool) {\n        unusedPool = [];\n        unusedViews.set(type, unusedPool);\n      }\n      unusedPool.push(view);\n      if (!fake) {\n        view.nr.used = false;\n        view.position = -9999;\n      }\n    },\n\n    handleResize () {\n      this.$emit('resize');\n      if (this.ready) this.updateVisibleItems(false);\n    },\n\n    handleScroll (event) {\n      if (!this.$_scrollDirty) {\n        this.$_scrollDirty = true;\n        if (this.$_updateTimeout) return\n\n        const requestUpdate = () => requestAnimationFrame(() => {\n          this.$_scrollDirty = false;\n          const { continuous } = this.updateVisibleItems(false, true);\n\n          // It seems sometimes chrome doesn't fire scroll event :/\n          // When non continous scrolling is ending, we force a refresh\n          if (!continuous) {\n            clearTimeout(this.$_refreshTimout);\n            this.$_refreshTimout = setTimeout(this.handleScroll, this.updateInterval + 100);\n          }\n        });\n\n        requestUpdate();\n\n        // Schedule the next update with throttling\n        if (this.updateInterval) {\n          this.$_updateTimeout = setTimeout(() => {\n            this.$_updateTimeout = 0;\n            if (this.$_scrollDirty) requestUpdate();\n          }, this.updateInterval);\n        }\n      }\n    },\n\n    handleVisibilityChange (isVisible, entry) {\n      if (this.ready) {\n        if (isVisible || entry.boundingClientRect.width !== 0 || entry.boundingClientRect.height !== 0) {\n          this.$emit('visible');\n          requestAnimationFrame(() => {\n            this.updateVisibleItems(false);\n          });\n        } else {\n          this.$emit('hidden');\n        }\n      }\n    },\n\n    updateVisibleItems (checkItem, checkPositionDiff = false) {\n      const itemSize = this.itemSize;\n      const gridItems = this.gridItems || 1;\n      const itemSecondarySize = this.itemSecondarySize || itemSize;\n      const minItemSize = this.$_computedMinItemSize;\n      const typeField = this.typeField;\n      const keyField = this.simpleArray ? null : this.keyField;\n      const items = this.items;\n      const count = items.length;\n      const sizes = this.sizes;\n      const views = this.$_views;\n      const unusedViews = this.$_unusedViews;\n      const pool = this.pool;\n      const itemIndexByKey = this.itemIndexByKey;\n      let startIndex, endIndex;\n      let totalSize;\n      let visibleStartIndex, visibleEndIndex;\n\n      if (!count) {\n        startIndex = endIndex = visibleStartIndex = visibleEndIndex = totalSize = 0;\n      } else if (this.$_prerender) {\n        startIndex = visibleStartIndex = 0;\n        endIndex = visibleEndIndex = Math.min(this.prerender, items.length);\n        totalSize = null;\n      } else {\n        const scroll = this.getScroll();\n\n        // Skip update if use hasn't scrolled enough\n        if (checkPositionDiff) {\n          let positionDiff = scroll.start - this.$_lastUpdateScrollPosition;\n          if (positionDiff < 0) positionDiff = -positionDiff;\n          if ((itemSize === null && positionDiff < minItemSize) || positionDiff < itemSize) {\n            return {\n              continuous: true,\n            }\n          }\n        }\n        this.$_lastUpdateScrollPosition = scroll.start;\n\n        const buffer = this.buffer;\n        scroll.start -= buffer;\n        scroll.end += buffer;\n\n        // account for leading slot\n        let beforeSize = 0;\n        if (this.$refs.before) {\n          beforeSize = this.$refs.before.scrollHeight;\n          scroll.start -= beforeSize;\n        }\n\n        // account for trailing slot\n        if (this.$refs.after) {\n          const afterSize = this.$refs.after.scrollHeight;\n          scroll.end += afterSize;\n        }\n\n        // Variable size mode\n        if (itemSize === null) {\n          let h;\n          let a = 0;\n          let b = count - 1;\n          let i = ~~(count / 2);\n          let oldI;\n\n          // Searching for startIndex\n          do {\n            oldI = i;\n            h = sizes[i].accumulator;\n            if (h < scroll.start) {\n              a = i;\n            } else if (i < count - 1 && sizes[i + 1].accumulator > scroll.start) {\n              b = i;\n            }\n            i = ~~((a + b) / 2);\n          } while (i !== oldI)\n          i < 0 && (i = 0);\n          startIndex = i;\n\n          // For container style\n          totalSize = sizes[count - 1].accumulator;\n\n          // Searching for endIndex\n          for (endIndex = i; endIndex < count && sizes[endIndex].accumulator < scroll.end; endIndex++);\n          if (endIndex === -1) {\n            endIndex = items.length - 1;\n          } else {\n            endIndex++;\n            // Bounds\n            endIndex > count && (endIndex = count);\n          }\n\n          // search visible startIndex\n          for (visibleStartIndex = startIndex; visibleStartIndex < count && (beforeSize + sizes[visibleStartIndex].accumulator) < scroll.start; visibleStartIndex++);\n\n          // search visible endIndex\n          for (visibleEndIndex = visibleStartIndex; visibleEndIndex < count && (beforeSize + sizes[visibleEndIndex].accumulator) < scroll.end; visibleEndIndex++);\n        } else {\n          // Fixed size mode\n          startIndex = ~~(scroll.start / itemSize * gridItems);\n          const remainer = startIndex % gridItems;\n          startIndex -= remainer;\n          endIndex = Math.ceil(scroll.end / itemSize * gridItems);\n          visibleStartIndex = Math.max(0, Math.floor((scroll.start - beforeSize) / itemSize * gridItems));\n          visibleEndIndex = Math.floor((scroll.end - beforeSize) / itemSize * gridItems);\n\n          // Bounds\n          startIndex < 0 && (startIndex = 0);\n          endIndex > count && (endIndex = count);\n          visibleStartIndex < 0 && (visibleStartIndex = 0);\n          visibleEndIndex > count && (visibleEndIndex = count);\n\n          totalSize = Math.ceil(count / gridItems) * itemSize;\n        }\n      }\n\n      if (endIndex - startIndex > config.itemsLimit) {\n        this.itemsLimitError();\n      }\n\n      this.totalSize = totalSize;\n\n      let view;\n\n      const continuous = startIndex <= this.$_endIndex && endIndex >= this.$_startIndex;\n\n      // Unuse views that are no longer visible\n      if (continuous) {\n        for (let i = 0, l = pool.length; i < l; i++) {\n          view = pool[i];\n          if (view.nr.used) {\n            // Update view item index\n            if (checkItem) {\n              view.nr.index = itemIndexByKey[view.item[keyField]];\n            }\n\n            // Check if index is still in visible range\n            if (\n              view.nr.index == null ||\n              view.nr.index < startIndex ||\n              view.nr.index >= endIndex\n            ) {\n              this.unuseView(view);\n            }\n          }\n        }\n      }\n\n      const unusedIndex = continuous ? null : new Map();\n\n      let item, type;\n      let v;\n      for (let i = startIndex; i < endIndex; i++) {\n        item = items[i];\n        const key = keyField ? item[keyField] : item;\n        if (key == null) {\n          throw new Error(`Key is ${key} on item (keyField is '${keyField}')`)\n        }\n        view = views.get(key);\n\n        if (!itemSize && !sizes[i].size) {\n          if (view) this.unuseView(view);\n          continue\n        }\n\n        type = item[typeField];\n\n        let unusedPool = unusedViews.get(type);\n        let newlyUsedView = false;\n\n        // No view assigned to item\n        if (!view) {\n          if (continuous) {\n            // Reuse existing view\n            if (unusedPool && unusedPool.length) {\n              view = unusedPool.pop();\n            } else {\n              view = this.addView(pool, i, item, key, type);\n            }\n          } else {\n            // Use existing view\n            // We don't care if they are already used\n            // because we are not in continous scrolling\n            v = unusedIndex.get(type) || 0;\n\n            if (!unusedPool || v >= unusedPool.length) {\n              view = this.addView(pool, i, item, key, type);\n              this.unuseView(view, true);\n              unusedPool = unusedViews.get(type);\n            }\n\n            view = unusedPool[v];\n            unusedIndex.set(type, v + 1);\n          }\n\n          // Assign view to item\n          views.delete(view.nr.key);\n          view.nr.used = true;\n          view.nr.index = i;\n          view.nr.key = key;\n          view.nr.type = type;\n          views.set(key, view);\n\n          newlyUsedView = true;\n        } else {\n          // View already assigned to item\n          if (!view.nr.used) {\n            view.nr.used = true;\n            newlyUsedView = true;\n            if (unusedPool) {\n              const index = unusedPool.indexOf(view);\n              if (index !== -1) unusedPool.splice(index, 1);\n            }\n          }\n        }\n\n        // Always set item in case it's a new object with the same key\n        view.item = item;\n\n        if (newlyUsedView) {\n          if (i === items.length - 1) this.$emit('scroll-end');\n          if (i === 0) this.$emit('scroll-start');\n        }\n\n        // Update position\n        if (itemSize === null) {\n          view.position = sizes[i - 1].accumulator;\n          view.offset = 0;\n        } else {\n          view.position = Math.floor(i / gridItems) * itemSize;\n          view.offset = (i % gridItems) * itemSecondarySize;\n        }\n      }\n\n      this.$_startIndex = startIndex;\n      this.$_endIndex = endIndex;\n\n      if (this.emitUpdate) this.$emit('update', startIndex, endIndex, visibleStartIndex, visibleEndIndex);\n\n      // After the user has finished scrolling\n      // Sort views so text selection is correct\n      clearTimeout(this.$_sortTimer);\n      this.$_sortTimer = setTimeout(this.sortViews, this.updateInterval + 300);\n\n      return {\n        continuous,\n      }\n    },\n\n    getListenerTarget () {\n      let target = getScrollParent(this.$el);\n      // Fix global scroll target for Chrome and Safari\n      if (window.document && (target === window.document.documentElement || target === window.document.body)) {\n        target = window;\n      }\n      return target\n    },\n\n    getScroll () {\n      const { $el: el, direction } = this;\n      const isVertical = direction === 'vertical';\n      let scrollState;\n\n      if (this.pageMode) {\n        const bounds = el.getBoundingClientRect();\n        const boundsSize = isVertical ? bounds.height : bounds.width;\n        let start = -(isVertical ? bounds.top : bounds.left);\n        let size = isVertical ? window.innerHeight : window.innerWidth;\n        if (start < 0) {\n          size += start;\n          start = 0;\n        }\n        if (start + size > boundsSize) {\n          size = boundsSize - start;\n        }\n        scrollState = {\n          start,\n          end: start + size,\n        };\n      } else if (isVertical) {\n        scrollState = {\n          start: el.scrollTop,\n          end: el.scrollTop + el.clientHeight,\n        };\n      } else {\n        scrollState = {\n          start: el.scrollLeft,\n          end: el.scrollLeft + el.clientWidth,\n        };\n      }\n\n      return scrollState\n    },\n\n    applyPageMode () {\n      if (this.pageMode) {\n        this.addListeners();\n      } else {\n        this.removeListeners();\n      }\n    },\n\n    addListeners () {\n      this.listenerTarget = this.getListenerTarget();\n      this.listenerTarget.addEventListener('scroll', this.handleScroll, supportsPassive\n        ? {\n            passive: true,\n          }\n        : false);\n      this.listenerTarget.addEventListener('resize', this.handleResize);\n    },\n\n    removeListeners () {\n      if (!this.listenerTarget) {\n        return\n      }\n\n      this.listenerTarget.removeEventListener('scroll', this.handleScroll);\n      this.listenerTarget.removeEventListener('resize', this.handleResize);\n\n      this.listenerTarget = null;\n    },\n\n    scrollToItem (index) {\n      let scroll;\n      const gridItems = this.gridItems || 1;\n      if (this.itemSize === null) {\n        scroll = index > 0 ? this.sizes[index - 1].accumulator : 0;\n      } else {\n        scroll = Math.floor(index / gridItems) * this.itemSize;\n      }\n      this.scrollToPosition(scroll);\n    },\n\n    scrollToPosition (position) {\n      const direction = this.direction === 'vertical'\n        ? { scroll: 'scrollTop', start: 'top' }\n        : { scroll: 'scrollLeft', start: 'left' };\n\n      let viewport;\n      let scrollDirection;\n      let scrollDistance;\n\n      if (this.pageMode) {\n        const viewportEl = getScrollParent(this.$el);\n        // HTML doesn't overflow like other elements\n        const scrollTop = viewportEl.tagName === 'HTML' ? 0 : viewportEl[direction.scroll];\n        const bounds = viewportEl.getBoundingClientRect();\n\n        const scroller = this.$el.getBoundingClientRect();\n        const scrollerPosition = scroller[direction.start] - bounds[direction.start];\n\n        viewport = viewportEl;\n        scrollDirection = direction.scroll;\n        scrollDistance = position + scrollTop + scrollerPosition;\n      } else {\n        viewport = this.$el;\n        scrollDirection = direction.scroll;\n        scrollDistance = position;\n      }\n\n      viewport[scrollDirection] = scrollDistance;\n    },\n\n    itemsLimitError () {\n      setTimeout(() => {\n        console.log('It seems the scroller element isn\\'t scrolling, so it tries to render all the items at once.', 'Scroller:', this.$el);\n        console.log('Make sure the scroller has a fixed height (or width) and \\'overflow-y\\' (or \\'overflow-x\\') set to \\'auto\\' so it can scroll correctly and only render the items visible in the scroll viewport.');\n      });\n      throw new Error('Rendered items limit reached')\n    },\n\n    sortViews () {\n      this.pool.sort((viewA, viewB) => viewA.nr.index - viewB.nr.index);\n    },\n  },\n};\n\nconst _hoisted_1 = {\n  key: 0,\n  ref: \"before\",\n  class: \"vue-recycle-scroller__slot\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  ref: \"after\",\n  class: \"vue-recycle-scroller__slot\"\n};\n\nfunction render$1(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ResizeObserver = resolveComponent(\"ResizeObserver\");\n  const _directive_observe_visibility = resolveDirective(\"observe-visibility\");\n\n  return withDirectives((openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass([\"vue-recycle-scroller\", {\n      ready: $data.ready,\n      'page-mode': $props.pageMode,\n      [`direction-${_ctx.direction}`]: true,\n    }]),\n    onScrollPassive: _cache[0] || (_cache[0] = (...args) => ($options.handleScroll && $options.handleScroll(...args)))\n  }, [\n    (_ctx.$slots.before)\n      ? (openBlock(), createElementBlock(\"div\", _hoisted_1, [\n          renderSlot(_ctx.$slots, \"before\")\n        ], 512 /* NEED_PATCH */))\n      : createCommentVNode(\"v-if\", true),\n    (openBlock(), createBlock(resolveDynamicComponent($props.listTag), {\n      ref: \"wrapper\",\n      style: normalizeStyle({ [_ctx.direction === 'vertical' ? 'minHeight' : 'minWidth']: $data.totalSize + 'px' }),\n      class: normalizeClass([\"vue-recycle-scroller__item-wrapper\", $props.listClass])\n    }, {\n      default: withCtx(() => [\n        (openBlock(true), createElementBlock(Fragment, null, renderList($data.pool, (view) => {\n          return (openBlock(), createBlock(resolveDynamicComponent($props.itemTag), mergeProps({\n            key: view.nr.id,\n            style: $data.ready ? {\n          transform: `translate${_ctx.direction === 'vertical' ? 'Y' : 'X'}(${view.position}px) translate${_ctx.direction === 'vertical' ? 'X' : 'Y'}(${view.offset}px)`,\n          width: $props.gridItems ? `${_ctx.direction === 'vertical' ? $props.itemSecondarySize || $props.itemSize : $props.itemSize}px` : undefined,\n          height: $props.gridItems ? `${_ctx.direction === 'horizontal' ? $props.itemSecondarySize || $props.itemSize : $props.itemSize}px` : undefined,\n        } : null,\n            class: [\"vue-recycle-scroller__item-view\", [\n          $props.itemClass,\n          {\n            hover: !$props.skipHover && $data.hoverKey === view.nr.key\n          },\n        ]]\n          }, toHandlers($props.skipHover ? {} : {\n          mouseenter: () => { $data.hoverKey = view.nr.key; },\n          mouseleave: () => { $data.hoverKey = null; },\n        })), {\n            default: withCtx(() => [\n              renderSlot(_ctx.$slots, \"default\", {\n                item: view.item,\n                index: view.nr.index,\n                active: view.nr.used\n              })\n            ]),\n            _: 2 /* DYNAMIC */\n          }, 1040 /* FULL_PROPS, DYNAMIC_SLOTS */, [\"style\", \"class\"]))\n        }), 128 /* KEYED_FRAGMENT */)),\n        renderSlot(_ctx.$slots, \"empty\")\n      ]),\n      _: 3 /* FORWARDED */\n    }, 8 /* PROPS */, [\"style\", \"class\"])),\n    (_ctx.$slots.after)\n      ? (openBlock(), createElementBlock(\"div\", _hoisted_2, [\n          renderSlot(_ctx.$slots, \"after\")\n        ], 512 /* NEED_PATCH */))\n      : createCommentVNode(\"v-if\", true),\n    createVNode(_component_ResizeObserver, { onNotify: $options.handleResize }, null, 8 /* PROPS */, [\"onNotify\"])\n  ], 34 /* CLASS, HYDRATE_EVENTS */)), [\n    [_directive_observe_visibility, $options.handleVisibilityChange]\n  ])\n}\n\nscript$2.render = render$1;\nscript$2.__file = \"src/components/RecycleScroller.vue\";\n\nvar script$1 = {\n  name: 'DynamicScroller',\n\n  components: {\n    RecycleScroller: script$2,\n  },\n\n  provide () {\n    if (typeof ResizeObserver !== 'undefined') {\n      this.$_resizeObserver = new ResizeObserver(entries => {\n        requestAnimationFrame(() => {\n          if (!Array.isArray(entries)) {\n            return\n          }\n          for (const entry of entries) {\n            if (entry.target && entry.target.$_vs_onResize) {\n              let width, height;\n              if (entry.borderBoxSize) {\n                const resizeObserverSize = entry.borderBoxSize[0];\n                width = resizeObserverSize.inlineSize;\n                height = resizeObserverSize.blockSize;\n              } else {\n                // @TODO remove when contentRect is deprecated\n                width = entry.contentRect.width;\n                height = entry.contentRect.height;\n              }\n              entry.target.$_vs_onResize(entry.target.$_vs_id, width, height);\n            }\n          }\n        });\n      });\n    }\n\n    return {\n      vscrollData: this.vscrollData,\n      vscrollParent: this,\n      vscrollResizeObserver: this.$_resizeObserver,\n    }\n  },\n\n  inheritAttrs: false,\n\n  props: {\n    ...props,\n\n    minItemSize: {\n      type: [Number, String],\n      required: true,\n    },\n  },\n\n  emits: [\n    'resize',\n    'visible',\n  ],\n\n  data () {\n    return {\n      vscrollData: {\n        active: true,\n        sizes: {},\n        keyField: this.keyField,\n        simpleArray: false,\n      },\n    }\n  },\n\n  computed: {\n    simpleArray,\n\n    itemsWithSize () {\n      const result = [];\n      const { items, keyField, simpleArray } = this;\n      const sizes = this.vscrollData.sizes;\n      const l = items.length;\n      for (let i = 0; i < l; i++) {\n        const item = items[i];\n        const id = simpleArray ? i : item[keyField];\n        let size = sizes[id];\n        if (typeof size === 'undefined' && !this.$_undefinedMap[id]) {\n          size = 0;\n        }\n        result.push({\n          item,\n          id,\n          size,\n        });\n      }\n      return result\n    },\n  },\n\n  watch: {\n    items () {\n      this.forceUpdate();\n    },\n\n    simpleArray: {\n      handler (value) {\n        this.vscrollData.simpleArray = value;\n      },\n      immediate: true,\n    },\n\n    direction (value) {\n      this.forceUpdate(true);\n    },\n\n    itemsWithSize (next, prev) {\n      const scrollTop = this.$el.scrollTop;\n\n      // Calculate total diff between prev and next sizes\n      // over current scroll top. Then add it to scrollTop to\n      // avoid jumping the contents that the user is seeing.\n      let prevActiveTop = 0; let activeTop = 0;\n      const length = Math.min(next.length, prev.length);\n      for (let i = 0; i < length; i++) {\n        if (prevActiveTop >= scrollTop) {\n          break\n        }\n        prevActiveTop += prev[i].size || this.minItemSize;\n        activeTop += next[i].size || this.minItemSize;\n      }\n      const offset = activeTop - prevActiveTop;\n\n      if (offset === 0) {\n        return\n      }\n\n      this.$el.scrollTop += offset;\n    },\n  },\n\n  beforeCreate () {\n    this.$_updates = [];\n    this.$_undefinedSizes = 0;\n    this.$_undefinedMap = {};\n    this.$_events = mitt();\n  },\n\n  activated () {\n    this.vscrollData.active = true;\n  },\n\n  deactivated () {\n    this.vscrollData.active = false;\n  },\n\n  unmounted () {\n    this.$_events.all.clear();\n  },\n\n  methods: {\n    onScrollerResize () {\n      const scroller = this.$refs.scroller;\n      if (scroller) {\n        this.forceUpdate();\n      }\n      this.$emit('resize');\n    },\n\n    onScrollerVisible () {\n      this.$_events.emit('vscroll:update', { force: false });\n      this.$emit('visible');\n    },\n\n    forceUpdate (clear = false) {\n      if (clear || this.simpleArray) {\n        this.vscrollData.sizes = {};\n      }\n      this.$_events.emit('vscroll:update', { force: true });\n    },\n\n    scrollToItem (index) {\n      const scroller = this.$refs.scroller;\n      if (scroller) scroller.scrollToItem(index);\n    },\n\n    getItemSize (item, index = undefined) {\n      const id = this.simpleArray ? (index != null ? index : this.items.indexOf(item)) : item[this.keyField];\n      return this.vscrollData.sizes[id] || 0\n    },\n\n    scrollToBottom () {\n      if (this.$_scrollingToBottom) return\n      this.$_scrollingToBottom = true;\n      const el = this.$el;\n      // Item is inserted to the DOM\n      this.$nextTick(() => {\n        el.scrollTop = el.scrollHeight + 5000;\n        // Item sizes are computed\n        const cb = () => {\n          el.scrollTop = el.scrollHeight + 5000;\n          requestAnimationFrame(() => {\n            el.scrollTop = el.scrollHeight + 5000;\n            if (this.$_undefinedSizes === 0) {\n              this.$_scrollingToBottom = false;\n            } else {\n              requestAnimationFrame(cb);\n            }\n          });\n        };\n        requestAnimationFrame(cb);\n      });\n    },\n  },\n};\n\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_RecycleScroller = resolveComponent(\"RecycleScroller\");\n\n  return (openBlock(), createBlock(_component_RecycleScroller, mergeProps({\n    ref: \"scroller\",\n    items: $options.itemsWithSize,\n    \"min-item-size\": $props.minItemSize,\n    direction: _ctx.direction,\n    \"key-field\": \"id\",\n    \"list-tag\": _ctx.listTag,\n    \"item-tag\": _ctx.itemTag\n  }, _ctx.$attrs, {\n    onResize: $options.onScrollerResize,\n    onVisible: $options.onScrollerVisible\n  }), {\n    default: withCtx(({ item: itemWithSize, index, active }) => [\n      renderSlot(_ctx.$slots, \"default\", normalizeProps(guardReactiveProps({\n          item: itemWithSize.item,\n          index,\n          active,\n          itemWithSize\n        })))\n    ]),\n    before: withCtx(() => [\n      renderSlot(_ctx.$slots, \"before\")\n    ]),\n    after: withCtx(() => [\n      renderSlot(_ctx.$slots, \"after\")\n    ]),\n    empty: withCtx(() => [\n      renderSlot(_ctx.$slots, \"empty\")\n    ]),\n    _: 3 /* FORWARDED */\n  }, 16 /* FULL_PROPS */, [\"items\", \"min-item-size\", \"direction\", \"list-tag\", \"item-tag\", \"onResize\", \"onVisible\"]))\n}\n\nscript$1.render = render;\nscript$1.__file = \"src/components/DynamicScroller.vue\";\n\nvar script = {\n  name: 'DynamicScrollerItem',\n\n  inject: [\n    'vscrollData',\n    'vscrollParent',\n    'vscrollResizeObserver',\n  ],\n\n  props: {\n    // eslint-disable-next-line vue/require-prop-types\n    item: {\n      required: true,\n    },\n\n    watchData: {\n      type: Boolean,\n      default: false,\n    },\n\n    /**\n     * Indicates if the view is actively used to display an item.\n     */\n    active: {\n      type: Boolean,\n      required: true,\n    },\n\n    index: {\n      type: Number,\n      default: undefined,\n    },\n\n    sizeDependencies: {\n      type: [Array, Object],\n      default: null,\n    },\n\n    emitResize: {\n      type: Boolean,\n      default: false,\n    },\n\n    tag: {\n      type: String,\n      default: 'div',\n    },\n  },\n\n  emits: [\n    'resize',\n  ],\n\n  computed: {\n    id () {\n      if (this.vscrollData.simpleArray) return this.index\n      // eslint-disable-next-line no-prototype-builtins\n      if (this.vscrollData.keyField in this.item) return this.item[this.vscrollData.keyField]\n      throw new Error(`keyField '${this.vscrollData.keyField}' not found in your item. You should set a valid keyField prop on your Scroller`)\n    },\n\n    size () {\n      return this.vscrollData.sizes[this.id] || 0\n    },\n\n    finalActive () {\n      return this.active && this.vscrollData.active\n    },\n  },\n\n  watch: {\n    watchData: 'updateWatchData',\n\n    id (value, oldValue) {\n      this.$el.$_vs_id = this.id;\n      if (!this.size) {\n        this.onDataUpdate();\n      }\n\n      if (this.$_sizeObserved) {\n        // In case the old item had the same size, it won't trigger the ResizeObserver\n        // since we are reusing the same DOM node\n        const oldSize = this.vscrollData.sizes[oldValue];\n        const size = this.vscrollData.sizes[value];\n        if (oldSize != null && oldSize !== size) {\n          this.applySize(oldSize);\n        }\n      }\n    },\n\n    finalActive (value) {\n      if (!this.size) {\n        if (value) {\n          if (!this.vscrollParent.$_undefinedMap[this.id]) {\n            this.vscrollParent.$_undefinedSizes++;\n            this.vscrollParent.$_undefinedMap[this.id] = true;\n          }\n        } else {\n          if (this.vscrollParent.$_undefinedMap[this.id]) {\n            this.vscrollParent.$_undefinedSizes--;\n            this.vscrollParent.$_undefinedMap[this.id] = false;\n          }\n        }\n      }\n\n      if (this.vscrollResizeObserver) {\n        if (value) {\n          this.observeSize();\n        } else {\n          this.unobserveSize();\n        }\n      } else if (value && this.$_pendingVScrollUpdate === this.id) {\n        this.updateSize();\n      }\n    },\n  },\n\n  created () {\n    if (this.$isServer) return\n\n    this.$_forceNextVScrollUpdate = null;\n    this.updateWatchData();\n\n    if (!this.vscrollResizeObserver) {\n      for (const k in this.sizeDependencies) {\n        this.$watch(() => this.sizeDependencies[k], this.onDataUpdate);\n      }\n\n      this.vscrollParent.$_events.on('vscroll:update', this.onVscrollUpdate);\n    }\n  },\n\n  mounted () {\n    if (this.finalActive) {\n      this.updateSize();\n      this.observeSize();\n    }\n  },\n\n  beforeUnmount () {\n    this.vscrollParent.$_events.off('vscroll:update', this.onVscrollUpdate);\n    this.unobserveSize();\n  },\n\n  methods: {\n    updateSize () {\n      if (this.finalActive) {\n        if (this.$_pendingSizeUpdate !== this.id) {\n          this.$_pendingSizeUpdate = this.id;\n          this.$_forceNextVScrollUpdate = null;\n          this.$_pendingVScrollUpdate = null;\n          this.computeSize(this.id);\n        }\n      } else {\n        this.$_forceNextVScrollUpdate = this.id;\n      }\n    },\n\n    updateWatchData () {\n      if (this.watchData && !this.vscrollResizeObserver) {\n        this.$_watchData = this.$watch('item', () => {\n          this.onDataUpdate();\n        }, {\n          deep: true,\n        });\n      } else if (this.$_watchData) {\n        this.$_watchData();\n        this.$_watchData = null;\n      }\n    },\n\n    onVscrollUpdate ({ force }) {\n      // If not active, sechedule a size update when it becomes active\n      if (!this.finalActive && force) {\n        this.$_pendingVScrollUpdate = this.id;\n      }\n\n      if (this.$_forceNextVScrollUpdate === this.id || force || !this.size) {\n        this.updateSize();\n      }\n    },\n\n    onDataUpdate () {\n      this.updateSize();\n    },\n\n    computeSize (id) {\n      this.$nextTick(() => {\n        if (this.id === id) {\n          const width = this.$el.offsetWidth;\n          const height = this.$el.offsetHeight;\n          this.applyWidthHeight(width, height);\n        }\n        this.$_pendingSizeUpdate = null;\n      });\n    },\n\n    applyWidthHeight (width, height) {\n      const size = ~~(this.vscrollParent.direction === 'vertical' ? height : width);\n      if (size && this.size !== size) {\n        this.applySize(size);\n      }\n    },\n\n    applySize (size) {\n      if (this.vscrollParent.$_undefinedMap[this.id]) {\n        this.vscrollParent.$_undefinedSizes--;\n        this.vscrollParent.$_undefinedMap[this.id] = undefined;\n      }\n      this.vscrollData.sizes[this.id] = size;\n      if (this.emitResize) this.$emit('resize', this.id);\n    },\n\n    observeSize () {\n      if (!this.vscrollResizeObserver) return\n      if (this.$_sizeObserved) return\n      this.vscrollResizeObserver.observe(this.$el);\n      this.$el.$_vs_id = this.id;\n      this.$el.$_vs_onResize = this.onResize;\n      this.$_sizeObserved = true;\n    },\n\n    unobserveSize () {\n      if (!this.vscrollResizeObserver) return\n      if (!this.$_sizeObserved) return\n      this.vscrollResizeObserver.unobserve(this.$el);\n      this.$el.$_vs_onResize = undefined;\n      this.$_sizeObserved = false;\n    },\n\n    onResize (id, width, height) {\n      if (this.id === id) {\n        this.applyWidthHeight(width, height);\n      }\n    },\n  },\n\n  render () {\n    return h(this.tag, this.$slots.default())\n  },\n};\n\nscript.__file = \"src/components/DynamicScrollerItem.vue\";\n\nfunction IdState () {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n    _ref$idProp = _ref.idProp,\n    idProp = _ref$idProp === void 0 ? function (vm) {\n      return vm.item.id;\n    } : _ref$idProp;\n  var store = reactive({});\n\n  // @vue/component\n  return {\n    data: function data() {\n      return {\n        idState: null\n      };\n    },\n    created: function created() {\n      var _this = this;\n      this.$_id = null;\n      if (typeof idProp === 'function') {\n        this.$_getId = function () {\n          return idProp.call(_this, _this);\n        };\n      } else {\n        this.$_getId = function () {\n          return _this[idProp];\n        };\n      }\n      this.$watch(this.$_getId, {\n        handler: function handler(value) {\n          var _this2 = this;\n          this.$nextTick(function () {\n            _this2.$_id = value;\n          });\n        },\n        immediate: true\n      });\n      this.$_updateIdState();\n    },\n    beforeUpdate: function beforeUpdate() {\n      this.$_updateIdState();\n    },\n    methods: {\n      /**\n       * Initialize an idState\n       * @param {number|string} id Unique id for the data\n       */$_idStateInit: function $_idStateInit(id) {\n        var factory = this.$options.idState;\n        if (typeof factory === 'function') {\n          var data = factory.call(this, this);\n          store[id] = data;\n          this.$_id = id;\n          return data;\n        } else {\n          throw new Error('[mixin IdState] Missing `idState` function on component definition.');\n        }\n      },\n      /**\n       * Ensure idState is created and up-to-date\n       */$_updateIdState: function $_updateIdState() {\n        var id = this.$_getId();\n        if (id == null) {\n          console.warn(\"No id found for IdState with idProp: '\".concat(idProp, \"'.\"));\n        }\n        if (id !== this.$_id) {\n          if (!store[id]) {\n            this.$_idStateInit(id);\n          }\n          this.idState = store[id];\n        }\n      }\n    }\n  };\n}\n\nfunction registerComponents(app, prefix) {\n  app.component(\"\".concat(prefix, \"recycle-scroller\"), script$2);\n  app.component(\"\".concat(prefix, \"RecycleScroller\"), script$2);\n  app.component(\"\".concat(prefix, \"dynamic-scroller\"), script$1);\n  app.component(\"\".concat(prefix, \"DynamicScroller\"), script$1);\n  app.component(\"\".concat(prefix, \"dynamic-scroller-item\"), script);\n  app.component(\"\".concat(prefix, \"DynamicScrollerItem\"), script);\n}\nvar plugin = {\n  // eslint-disable-next-line no-undef\n  version: \"2.0.0-beta.8\",\n  install: function install(app, options) {\n    var finalOptions = Object.assign({}, {\n      installComponents: true,\n      componentsPrefix: ''\n    }, options);\n    for (var key in finalOptions) {\n      if (typeof finalOptions[key] !== 'undefined') {\n        config[key] = finalOptions[key];\n      }\n    }\n    if (finalOptions.installComponents) {\n      registerComponents(app, finalOptions.componentsPrefix);\n    }\n  }\n};\n\nexport { script$1 as DynamicScroller, script as DynamicScrollerItem, IdState, script$2 as RecycleScroller, plugin as default };\n//# sourceMappingURL=vue-virtual-scroller.esm.js.map\n","import * as Vue from 'vue'\n\nvar isVue2 = false\nvar isVue3 = true\nvar Vue2 = undefined\n\nfunction install() {}\n\nexport function set(target, key, val) {\n  if (Array.isArray(target)) {\n    target.length = Math.max(target.length, key)\n    target.splice(key, 1, val)\n    return val\n  }\n  target[key] = val\n  return val\n}\n\nexport function del(target, key) {\n  if (Array.isArray(target)) {\n    target.splice(key, 1)\n    return\n  }\n  delete target[key]\n}\n\nexport * from 'vue'\nexport {\n  Vue,\n  Vue2,\n  isVue2,\n  isVue3,\n  install,\n}\n","export function getDevtoolsGlobalHook() {\n    return getTarget().__VUE_DEVTOOLS_GLOBAL_HOOK__;\n}\nexport function getTarget() {\n    // @ts-expect-error navigator and windows are not available in all environments\n    return (typeof navigator !== 'undefined' && typeof window !== 'undefined')\n        ? window\n        : typeof globalThis !== 'undefined'\n            ? globalThis\n            : {};\n}\nexport const isProxyAvailable = typeof Proxy === 'function';\n","export const HOOK_SETUP = 'devtools-plugin:setup';\nexport const HOOK_PLUGIN_SETTINGS_SET = 'plugin:settings:set';\n","let supported;\nlet perf;\nexport function isPerformanceSupported() {\n    var _a;\n    if (supported !== undefined) {\n        return supported;\n    }\n    if (typeof window !== 'undefined' && window.performance) {\n        supported = true;\n        perf = window.performance;\n    }\n    else if (typeof globalThis !== 'undefined' && ((_a = globalThis.perf_hooks) === null || _a === void 0 ? void 0 : _a.performance)) {\n        supported = true;\n        perf = globalThis.perf_hooks.performance;\n    }\n    else {\n        supported = false;\n    }\n    return supported;\n}\nexport function now() {\n    return isPerformanceSupported() ? perf.now() : Date.now();\n}\n","import { HOOK_PLUGIN_SETTINGS_SET } from './const.js';\nimport { now } from './time.js';\nexport class ApiProxy {\n    constructor(plugin, hook) {\n        this.target = null;\n        this.targetQueue = [];\n        this.onQueue = [];\n        this.plugin = plugin;\n        this.hook = hook;\n        const defaultSettings = {};\n        if (plugin.settings) {\n            for (const id in plugin.settings) {\n                const item = plugin.settings[id];\n                defaultSettings[id] = item.defaultValue;\n            }\n        }\n        const localSettingsSaveId = `__vue-devtools-plugin-settings__${plugin.id}`;\n        let currentSettings = Object.assign({}, defaultSettings);\n        try {\n            const raw = localStorage.getItem(localSettingsSaveId);\n            const data = JSON.parse(raw);\n            Object.assign(currentSettings, data);\n        }\n        catch (e) {\n            // noop\n        }\n        this.fallbacks = {\n            getSettings() {\n                return currentSettings;\n            },\n            setSettings(value) {\n                try {\n                    localStorage.setItem(localSettingsSaveId, JSON.stringify(value));\n                }\n                catch (e) {\n                    // noop\n                }\n                currentSettings = value;\n            },\n            now() {\n                return now();\n            },\n        };\n        if (hook) {\n            hook.on(HOOK_PLUGIN_SETTINGS_SET, (pluginId, value) => {\n                if (pluginId === this.plugin.id) {\n                    this.fallbacks.setSettings(value);\n                }\n            });\n        }\n        this.proxiedOn = new Proxy({}, {\n            get: (_target, prop) => {\n                if (this.target) {\n                    return this.target.on[prop];\n                }\n                else {\n                    return (...args) => {\n                        this.onQueue.push({\n                            method: prop,\n                            args,\n                        });\n                    };\n                }\n            },\n        });\n        this.proxiedTarget = new Proxy({}, {\n            get: (_target, prop) => {\n                if (this.target) {\n                    return this.target[prop];\n                }\n                else if (prop === 'on') {\n                    return this.proxiedOn;\n                }\n                else if (Object.keys(this.fallbacks).includes(prop)) {\n                    return (...args) => {\n                        this.targetQueue.push({\n                            method: prop,\n                            args,\n                            resolve: () => { },\n                        });\n                        return this.fallbacks[prop](...args);\n                    };\n                }\n                else {\n                    return (...args) => {\n                        return new Promise((resolve) => {\n                            this.targetQueue.push({\n                                method: prop,\n                                args,\n                                resolve,\n                            });\n                        });\n                    };\n                }\n            },\n        });\n    }\n    async setRealTarget(target) {\n        this.target = target;\n        for (const item of this.onQueue) {\n            this.target.on[item.method](...item.args);\n        }\n        for (const item of this.targetQueue) {\n            item.resolve(await this.target[item.method](...item.args));\n        }\n    }\n}\n","import { getDevtoolsGlobalHook, getTarget, isProxyAvailable } from './env.js';\nimport { HOOK_SETUP } from './const.js';\nimport { ApiProxy } from './proxy.js';\nexport * from './api/index.js';\nexport * from './plugin.js';\nexport * from './time.js';\nexport function setupDevtoolsPlugin(pluginDescriptor, setupFn) {\n    const descriptor = pluginDescriptor;\n    const target = getTarget();\n    const hook = getDevtoolsGlobalHook();\n    const enableProxy = isProxyAvailable && descriptor.enableEarlyProxy;\n    if (hook && (target.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__ || !enableProxy)) {\n        hook.emit(HOOK_SETUP, pluginDescriptor, setupFn);\n    }\n    else {\n        const proxy = enableProxy ? new ApiProxy(descriptor, hook) : null;\n        const list = target.__VUE_DEVTOOLS_PLUGINS__ = target.__VUE_DEVTOOLS_PLUGINS__ || [];\n        list.push({\n            pluginDescriptor: descriptor,\n            setupFn,\n            proxy,\n        });\n        if (proxy) {\n            setupFn(proxy.proxiedTarget);\n        }\n    }\n}\n","/*!\n * pinia v2.3.1\n * (c) 2025 Eduardo San Martin Morote\n * @license MIT\n */\nimport { hasInjectionContext, inject, toRaw, watch, unref, markRaw, effectScope, ref, isVue2, isRef, isReactive, set, getCurrentScope, onScopeDispose, getCurrentInstance, reactive, toRef, del, nextTick, computed, toRefs } from 'vue-demi';\nimport { setupDevtoolsPlugin } from '@vue/devtools-api';\n\n/**\n * setActivePinia must be called to handle SSR at the top of functions like\n * `fetch`, `setup`, `serverPrefetch` and others\n */\nlet activePinia;\n/**\n * Sets or unsets the active pinia. Used in SSR and internally when calling\n * actions and getters\n *\n * @param pinia - Pinia instance\n */\n// @ts-expect-error: cannot constrain the type of the return\nconst setActivePinia = (pinia) => (activePinia = pinia);\n/**\n * Get the currently active pinia if there is any.\n */\nconst getActivePinia = () => (hasInjectionContext() && inject(piniaSymbol)) || activePinia;\nconst piniaSymbol = ((process.env.NODE_ENV !== 'production') ? Symbol('pinia') : /* istanbul ignore next */ Symbol());\n\nfunction isPlainObject(\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\no) {\n    return (o &&\n        typeof o === 'object' &&\n        Object.prototype.toString.call(o) === '[object Object]' &&\n        typeof o.toJSON !== 'function');\n}\n// type DeepReadonly<T> = { readonly [P in keyof T]: DeepReadonly<T[P]> }\n// TODO: can we change these to numbers?\n/**\n * Possible types for SubscriptionCallback\n */\nvar MutationType;\n(function (MutationType) {\n    /**\n     * Direct mutation of the state:\n     *\n     * - `store.name = 'new name'`\n     * - `store.$state.name = 'new name'`\n     * - `store.list.push('new item')`\n     */\n    MutationType[\"direct\"] = \"direct\";\n    /**\n     * Mutated the state with `$patch` and an object\n     *\n     * - `store.$patch({ name: 'newName' })`\n     */\n    MutationType[\"patchObject\"] = \"patch object\";\n    /**\n     * Mutated the state with `$patch` and a function\n     *\n     * - `store.$patch(state => state.name = 'newName')`\n     */\n    MutationType[\"patchFunction\"] = \"patch function\";\n    // maybe reset? for $state = {} and $reset\n})(MutationType || (MutationType = {}));\n\nconst IS_CLIENT = typeof window !== 'undefined';\n\n/*\n * FileSaver.js A saveAs() FileSaver implementation.\n *\n * Originally by Eli Grey, adapted as an ESM module by Eduardo San Martin\n * Morote.\n *\n * License : MIT\n */\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nconst _global = /*#__PURE__*/ (() => typeof window === 'object' && window.window === window\n    ? window\n    : typeof self === 'object' && self.self === self\n        ? self\n        : typeof global === 'object' && global.global === global\n            ? global\n            : typeof globalThis === 'object'\n                ? globalThis\n                : { HTMLElement: null })();\nfunction bom(blob, { autoBom = false } = {}) {\n    // prepend BOM for UTF-8 XML and text/* types (including HTML)\n    // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n    if (autoBom &&\n        /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n        return new Blob([String.fromCharCode(0xfeff), blob], { type: blob.type });\n    }\n    return blob;\n}\nfunction download(url, name, opts) {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', url);\n    xhr.responseType = 'blob';\n    xhr.onload = function () {\n        saveAs(xhr.response, name, opts);\n    };\n    xhr.onerror = function () {\n        console.error('could not download file');\n    };\n    xhr.send();\n}\nfunction corsEnabled(url) {\n    const xhr = new XMLHttpRequest();\n    // use sync to avoid popup blocker\n    xhr.open('HEAD', url, false);\n    try {\n        xhr.send();\n    }\n    catch (e) { }\n    return xhr.status >= 200 && xhr.status <= 299;\n}\n// `a.click()` doesn't work for all browsers (#465)\nfunction click(node) {\n    try {\n        node.dispatchEvent(new MouseEvent('click'));\n    }\n    catch (e) {\n        const evt = document.createEvent('MouseEvents');\n        evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);\n        node.dispatchEvent(evt);\n    }\n}\nconst _navigator = typeof navigator === 'object' ? navigator : { userAgent: '' };\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nconst isMacOSWebView = /*#__PURE__*/ (() => /Macintosh/.test(_navigator.userAgent) &&\n    /AppleWebKit/.test(_navigator.userAgent) &&\n    !/Safari/.test(_navigator.userAgent))();\nconst saveAs = !IS_CLIENT\n    ? () => { } // noop\n    : // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView or mini program\n        typeof HTMLAnchorElement !== 'undefined' &&\n            'download' in HTMLAnchorElement.prototype &&\n            !isMacOSWebView\n            ? downloadSaveAs\n            : // Use msSaveOrOpenBlob as a second approach\n                'msSaveOrOpenBlob' in _navigator\n                    ? msSaveAs\n                    : // Fallback to using FileReader and a popup\n                        fileSaverSaveAs;\nfunction downloadSaveAs(blob, name = 'download', opts) {\n    const a = document.createElement('a');\n    a.download = name;\n    a.rel = 'noopener'; // tabnabbing\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n    if (typeof blob === 'string') {\n        // Support regular links\n        a.href = blob;\n        if (a.origin !== location.origin) {\n            if (corsEnabled(a.href)) {\n                download(blob, name, opts);\n            }\n            else {\n                a.target = '_blank';\n                click(a);\n            }\n        }\n        else {\n            click(a);\n        }\n    }\n    else {\n        // Support blobs\n        a.href = URL.createObjectURL(blob);\n        setTimeout(function () {\n            URL.revokeObjectURL(a.href);\n        }, 4e4); // 40s\n        setTimeout(function () {\n            click(a);\n        }, 0);\n    }\n}\nfunction msSaveAs(blob, name = 'download', opts) {\n    if (typeof blob === 'string') {\n        if (corsEnabled(blob)) {\n            download(blob, name, opts);\n        }\n        else {\n            const a = document.createElement('a');\n            a.href = blob;\n            a.target = '_blank';\n            setTimeout(function () {\n                click(a);\n            });\n        }\n    }\n    else {\n        // @ts-ignore: works on windows\n        navigator.msSaveOrOpenBlob(bom(blob, opts), name);\n    }\n}\nfunction fileSaverSaveAs(blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank');\n    if (popup) {\n        popup.document.title = popup.document.body.innerText = 'downloading...';\n    }\n    if (typeof blob === 'string')\n        return download(blob, name, opts);\n    const force = blob.type === 'application/octet-stream';\n    const isSafari = /constructor/i.test(String(_global.HTMLElement)) || 'safari' in _global;\n    const isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent);\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) &&\n        typeof FileReader !== 'undefined') {\n        // Safari doesn't allow downloading of blob URLs\n        const reader = new FileReader();\n        reader.onloadend = function () {\n            let url = reader.result;\n            if (typeof url !== 'string') {\n                popup = null;\n                throw new Error('Wrong reader.result type');\n            }\n            url = isChromeIOS\n                ? url\n                : url.replace(/^data:[^;]*;/, 'data:attachment/file;');\n            if (popup) {\n                popup.location.href = url;\n            }\n            else {\n                location.assign(url);\n            }\n            popup = null; // reverse-tabnabbing #460\n        };\n        reader.readAsDataURL(blob);\n    }\n    else {\n        const url = URL.createObjectURL(blob);\n        if (popup)\n            popup.location.assign(url);\n        else\n            location.href = url;\n        popup = null; // reverse-tabnabbing #460\n        setTimeout(function () {\n            URL.revokeObjectURL(url);\n        }, 4e4); // 40s\n    }\n}\n\n/**\n * Shows a toast or console.log\n *\n * @param message - message to log\n * @param type - different color of the tooltip\n */\nfunction toastMessage(message, type) {\n    const piniaMessage = ' ' + message;\n    if (typeof __VUE_DEVTOOLS_TOAST__ === 'function') {\n        // No longer available :(\n        __VUE_DEVTOOLS_TOAST__(piniaMessage, type);\n    }\n    else if (type === 'error') {\n        console.error(piniaMessage);\n    }\n    else if (type === 'warn') {\n        console.warn(piniaMessage);\n    }\n    else {\n        console.log(piniaMessage);\n    }\n}\nfunction isPinia(o) {\n    return '_a' in o && 'install' in o;\n}\n\n/**\n * This file contain devtools actions, they are not Pinia actions.\n */\n// ---\nfunction checkClipboardAccess() {\n    if (!('clipboard' in navigator)) {\n        toastMessage(`Your browser doesn't support the Clipboard API`, 'error');\n        return true;\n    }\n}\nfunction checkNotFocusedError(error) {\n    if (error instanceof Error &&\n        error.message.toLowerCase().includes('document is not focused')) {\n        toastMessage('You need to activate the \"Emulate a focused page\" setting in the \"Rendering\" panel of devtools.', 'warn');\n        return true;\n    }\n    return false;\n}\nasync function actionGlobalCopyState(pinia) {\n    if (checkClipboardAccess())\n        return;\n    try {\n        await navigator.clipboard.writeText(JSON.stringify(pinia.state.value));\n        toastMessage('Global state copied to clipboard.');\n    }\n    catch (error) {\n        if (checkNotFocusedError(error))\n            return;\n        toastMessage(`Failed to serialize the state. Check the console for more details.`, 'error');\n        console.error(error);\n    }\n}\nasync function actionGlobalPasteState(pinia) {\n    if (checkClipboardAccess())\n        return;\n    try {\n        loadStoresState(pinia, JSON.parse(await navigator.clipboard.readText()));\n        toastMessage('Global state pasted from clipboard.');\n    }\n    catch (error) {\n        if (checkNotFocusedError(error))\n            return;\n        toastMessage(`Failed to deserialize the state from clipboard. Check the console for more details.`, 'error');\n        console.error(error);\n    }\n}\nasync function actionGlobalSaveState(pinia) {\n    try {\n        saveAs(new Blob([JSON.stringify(pinia.state.value)], {\n            type: 'text/plain;charset=utf-8',\n        }), 'pinia-state.json');\n    }\n    catch (error) {\n        toastMessage(`Failed to export the state as JSON. Check the console for more details.`, 'error');\n        console.error(error);\n    }\n}\nlet fileInput;\nfunction getFileOpener() {\n    if (!fileInput) {\n        fileInput = document.createElement('input');\n        fileInput.type = 'file';\n        fileInput.accept = '.json';\n    }\n    function openFile() {\n        return new Promise((resolve, reject) => {\n            fileInput.onchange = async () => {\n                const files = fileInput.files;\n                if (!files)\n                    return resolve(null);\n                const file = files.item(0);\n                if (!file)\n                    return resolve(null);\n                return resolve({ text: await file.text(), file });\n            };\n            // @ts-ignore: TODO: changed from 4.3 to 4.4\n            fileInput.oncancel = () => resolve(null);\n            fileInput.onerror = reject;\n            fileInput.click();\n        });\n    }\n    return openFile;\n}\nasync function actionGlobalOpenStateFile(pinia) {\n    try {\n        const open = getFileOpener();\n        const result = await open();\n        if (!result)\n            return;\n        const { text, file } = result;\n        loadStoresState(pinia, JSON.parse(text));\n        toastMessage(`Global state imported from \"${file.name}\".`);\n    }\n    catch (error) {\n        toastMessage(`Failed to import the state from JSON. Check the console for more details.`, 'error');\n        console.error(error);\n    }\n}\nfunction loadStoresState(pinia, state) {\n    for (const key in state) {\n        const storeState = pinia.state.value[key];\n        // store is already instantiated, patch it\n        if (storeState) {\n            Object.assign(storeState, state[key]);\n        }\n        else {\n            // store is not instantiated, set the initial state\n            pinia.state.value[key] = state[key];\n        }\n    }\n}\n\nfunction formatDisplay(display) {\n    return {\n        _custom: {\n            display,\n        },\n    };\n}\nconst PINIA_ROOT_LABEL = ' Pinia (root)';\nconst PINIA_ROOT_ID = '_root';\nfunction formatStoreForInspectorTree(store) {\n    return isPinia(store)\n        ? {\n            id: PINIA_ROOT_ID,\n            label: PINIA_ROOT_LABEL,\n        }\n        : {\n            id: store.$id,\n            label: store.$id,\n        };\n}\nfunction formatStoreForInspectorState(store) {\n    if (isPinia(store)) {\n        const storeNames = Array.from(store._s.keys());\n        const storeMap = store._s;\n        const state = {\n            state: storeNames.map((storeId) => ({\n                editable: true,\n                key: storeId,\n                value: store.state.value[storeId],\n            })),\n            getters: storeNames\n                .filter((id) => storeMap.get(id)._getters)\n                .map((id) => {\n                const store = storeMap.get(id);\n                return {\n                    editable: false,\n                    key: id,\n                    value: store._getters.reduce((getters, key) => {\n                        getters[key] = store[key];\n                        return getters;\n                    }, {}),\n                };\n            }),\n        };\n        return state;\n    }\n    const state = {\n        state: Object.keys(store.$state).map((key) => ({\n            editable: true,\n            key,\n            value: store.$state[key],\n        })),\n    };\n    // avoid adding empty getters\n    if (store._getters && store._getters.length) {\n        state.getters = store._getters.map((getterName) => ({\n            editable: false,\n            key: getterName,\n            value: store[getterName],\n        }));\n    }\n    if (store._customProperties.size) {\n        state.customProperties = Array.from(store._customProperties).map((key) => ({\n            editable: true,\n            key,\n            value: store[key],\n        }));\n    }\n    return state;\n}\nfunction formatEventData(events) {\n    if (!events)\n        return {};\n    if (Array.isArray(events)) {\n        // TODO: handle add and delete for arrays and objects\n        return events.reduce((data, event) => {\n            data.keys.push(event.key);\n            data.operations.push(event.type);\n            data.oldValue[event.key] = event.oldValue;\n            data.newValue[event.key] = event.newValue;\n            return data;\n        }, {\n            oldValue: {},\n            keys: [],\n            operations: [],\n            newValue: {},\n        });\n    }\n    else {\n        return {\n            operation: formatDisplay(events.type),\n            key: formatDisplay(events.key),\n            oldValue: events.oldValue,\n            newValue: events.newValue,\n        };\n    }\n}\nfunction formatMutationType(type) {\n    switch (type) {\n        case MutationType.direct:\n            return 'mutation';\n        case MutationType.patchFunction:\n            return '$patch';\n        case MutationType.patchObject:\n            return '$patch';\n        default:\n            return 'unknown';\n    }\n}\n\n// timeline can be paused when directly changing the state\nlet isTimelineActive = true;\nconst componentStateTypes = [];\nconst MUTATIONS_LAYER_ID = 'pinia:mutations';\nconst INSPECTOR_ID = 'pinia';\nconst { assign: assign$1 } = Object;\n/**\n * Gets the displayed name of a store in devtools\n *\n * @param id - id of the store\n * @returns a formatted string\n */\nconst getStoreType = (id) => ' ' + id;\n/**\n * Add the pinia plugin without any store. Allows displaying a Pinia plugin tab\n * as soon as it is added to the application.\n *\n * @param app - Vue application\n * @param pinia - pinia instance\n */\nfunction registerPiniaDevtools(app, pinia) {\n    setupDevtoolsPlugin({\n        id: 'dev.esm.pinia',\n        label: 'Pinia ',\n        logo: 'https://pinia.vuejs.org/logo.svg',\n        packageName: 'pinia',\n        homepage: 'https://pinia.vuejs.org',\n        componentStateTypes,\n        app,\n    }, (api) => {\n        if (typeof api.now !== 'function') {\n            toastMessage('You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html.');\n        }\n        api.addTimelineLayer({\n            id: MUTATIONS_LAYER_ID,\n            label: `Pinia `,\n            color: 0xe5df88,\n        });\n        api.addInspector({\n            id: INSPECTOR_ID,\n            label: 'Pinia ',\n            icon: 'storage',\n            treeFilterPlaceholder: 'Search stores',\n            actions: [\n                {\n                    icon: 'content_copy',\n                    action: () => {\n                        actionGlobalCopyState(pinia);\n                    },\n                    tooltip: 'Serialize and copy the state',\n                },\n                {\n                    icon: 'content_paste',\n                    action: async () => {\n                        await actionGlobalPasteState(pinia);\n                        api.sendInspectorTree(INSPECTOR_ID);\n                        api.sendInspectorState(INSPECTOR_ID);\n                    },\n                    tooltip: 'Replace the state with the content of your clipboard',\n                },\n                {\n                    icon: 'save',\n                    action: () => {\n                        actionGlobalSaveState(pinia);\n                    },\n                    tooltip: 'Save the state as a JSON file',\n                },\n                {\n                    icon: 'folder_open',\n                    action: async () => {\n                        await actionGlobalOpenStateFile(pinia);\n                        api.sendInspectorTree(INSPECTOR_ID);\n                        api.sendInspectorState(INSPECTOR_ID);\n                    },\n                    tooltip: 'Import the state from a JSON file',\n                },\n            ],\n            nodeActions: [\n                {\n                    icon: 'restore',\n                    tooltip: 'Reset the state (with \"$reset\")',\n                    action: (nodeId) => {\n                        const store = pinia._s.get(nodeId);\n                        if (!store) {\n                            toastMessage(`Cannot reset \"${nodeId}\" store because it wasn't found.`, 'warn');\n                        }\n                        else if (typeof store.$reset !== 'function') {\n                            toastMessage(`Cannot reset \"${nodeId}\" store because it doesn't have a \"$reset\" method implemented.`, 'warn');\n                        }\n                        else {\n                            store.$reset();\n                            toastMessage(`Store \"${nodeId}\" reset.`);\n                        }\n                    },\n                },\n            ],\n        });\n        api.on.inspectComponent((payload, ctx) => {\n            const proxy = (payload.componentInstance &&\n                payload.componentInstance.proxy);\n            if (proxy && proxy._pStores) {\n                const piniaStores = payload.componentInstance.proxy._pStores;\n                Object.values(piniaStores).forEach((store) => {\n                    payload.instanceData.state.push({\n                        type: getStoreType(store.$id),\n                        key: 'state',\n                        editable: true,\n                        value: store._isOptionsAPI\n                            ? {\n                                _custom: {\n                                    value: toRaw(store.$state),\n                                    actions: [\n                                        {\n                                            icon: 'restore',\n                                            tooltip: 'Reset the state of this store',\n                                            action: () => store.$reset(),\n                                        },\n                                    ],\n                                },\n                            }\n                            : // NOTE: workaround to unwrap transferred refs\n                                Object.keys(store.$state).reduce((state, key) => {\n                                    state[key] = store.$state[key];\n                                    return state;\n                                }, {}),\n                    });\n                    if (store._getters && store._getters.length) {\n                        payload.instanceData.state.push({\n                            type: getStoreType(store.$id),\n                            key: 'getters',\n                            editable: false,\n                            value: store._getters.reduce((getters, key) => {\n                                try {\n                                    getters[key] = store[key];\n                                }\n                                catch (error) {\n                                    // @ts-expect-error: we just want to show it in devtools\n                                    getters[key] = error;\n                                }\n                                return getters;\n                            }, {}),\n                        });\n                    }\n                });\n            }\n        });\n        api.on.getInspectorTree((payload) => {\n            if (payload.app === app && payload.inspectorId === INSPECTOR_ID) {\n                let stores = [pinia];\n                stores = stores.concat(Array.from(pinia._s.values()));\n                payload.rootNodes = (payload.filter\n                    ? stores.filter((store) => '$id' in store\n                        ? store.$id\n                            .toLowerCase()\n                            .includes(payload.filter.toLowerCase())\n                        : PINIA_ROOT_LABEL.toLowerCase().includes(payload.filter.toLowerCase()))\n                    : stores).map(formatStoreForInspectorTree);\n            }\n        });\n        // Expose pinia instance as $pinia to window\n        globalThis.$pinia = pinia;\n        api.on.getInspectorState((payload) => {\n            if (payload.app === app && payload.inspectorId === INSPECTOR_ID) {\n                const inspectedStore = payload.nodeId === PINIA_ROOT_ID\n                    ? pinia\n                    : pinia._s.get(payload.nodeId);\n                if (!inspectedStore) {\n                    // this could be the selected store restored for a different project\n                    // so it's better not to say anything here\n                    return;\n                }\n                if (inspectedStore) {\n                    // Expose selected store as $store to window\n                    if (payload.nodeId !== PINIA_ROOT_ID)\n                        globalThis.$store = toRaw(inspectedStore);\n                    payload.state = formatStoreForInspectorState(inspectedStore);\n                }\n            }\n        });\n        api.on.editInspectorState((payload, ctx) => {\n            if (payload.app === app && payload.inspectorId === INSPECTOR_ID) {\n                const inspectedStore = payload.nodeId === PINIA_ROOT_ID\n                    ? pinia\n                    : pinia._s.get(payload.nodeId);\n                if (!inspectedStore) {\n                    return toastMessage(`store \"${payload.nodeId}\" not found`, 'error');\n                }\n                const { path } = payload;\n                if (!isPinia(inspectedStore)) {\n                    // access only the state\n                    if (path.length !== 1 ||\n                        !inspectedStore._customProperties.has(path[0]) ||\n                        path[0] in inspectedStore.$state) {\n                        path.unshift('$state');\n                    }\n                }\n                else {\n                    // Root access, we can omit the `.value` because the devtools API does it for us\n                    path.unshift('state');\n                }\n                isTimelineActive = false;\n                payload.set(inspectedStore, path, payload.state.value);\n                isTimelineActive = true;\n            }\n        });\n        api.on.editComponentState((payload) => {\n            if (payload.type.startsWith('')) {\n                const storeId = payload.type.replace(/^\\s*/, '');\n                const store = pinia._s.get(storeId);\n                if (!store) {\n                    return toastMessage(`store \"${storeId}\" not found`, 'error');\n                }\n                const { path } = payload;\n                if (path[0] !== 'state') {\n                    return toastMessage(`Invalid path for store \"${storeId}\":\\n${path}\\nOnly state can be modified.`);\n                }\n                // rewrite the first entry to be able to directly set the state as\n                // well as any other path\n                path[0] = '$state';\n                isTimelineActive = false;\n                payload.set(store, path, payload.state.value);\n                isTimelineActive = true;\n            }\n        });\n    });\n}\nfunction addStoreToDevtools(app, store) {\n    if (!componentStateTypes.includes(getStoreType(store.$id))) {\n        componentStateTypes.push(getStoreType(store.$id));\n    }\n    setupDevtoolsPlugin({\n        id: 'dev.esm.pinia',\n        label: 'Pinia ',\n        logo: 'https://pinia.vuejs.org/logo.svg',\n        packageName: 'pinia',\n        homepage: 'https://pinia.vuejs.org',\n        componentStateTypes,\n        app,\n        settings: {\n            logStoreChanges: {\n                label: 'Notify about new/deleted stores',\n                type: 'boolean',\n                defaultValue: true,\n            },\n            // useEmojis: {\n            //   label: 'Use emojis in messages ',\n            //   type: 'boolean',\n            //   defaultValue: true,\n            // },\n        },\n    }, (api) => {\n        // gracefully handle errors\n        const now = typeof api.now === 'function' ? api.now.bind(api) : Date.now;\n        store.$onAction(({ after, onError, name, args }) => {\n            const groupId = runningActionId++;\n            api.addTimelineEvent({\n                layerId: MUTATIONS_LAYER_ID,\n                event: {\n                    time: now(),\n                    title: ' ' + name,\n                    subtitle: 'start',\n                    data: {\n                        store: formatDisplay(store.$id),\n                        action: formatDisplay(name),\n                        args,\n                    },\n                    groupId,\n                },\n            });\n            after((result) => {\n                activeAction = undefined;\n                api.addTimelineEvent({\n                    layerId: MUTATIONS_LAYER_ID,\n                    event: {\n                        time: now(),\n                        title: ' ' + name,\n                        subtitle: 'end',\n                        data: {\n                            store: formatDisplay(store.$id),\n                            action: formatDisplay(name),\n                            args,\n                            result,\n                        },\n                        groupId,\n                    },\n                });\n            });\n            onError((error) => {\n                activeAction = undefined;\n                api.addTimelineEvent({\n                    layerId: MUTATIONS_LAYER_ID,\n                    event: {\n                        time: now(),\n                        logType: 'error',\n                        title: ' ' + name,\n                        subtitle: 'end',\n                        data: {\n                            store: formatDisplay(store.$id),\n                            action: formatDisplay(name),\n                            args,\n                            error,\n                        },\n                        groupId,\n                    },\n                });\n            });\n        }, true);\n        store._customProperties.forEach((name) => {\n            watch(() => unref(store[name]), (newValue, oldValue) => {\n                api.notifyComponentUpdate();\n                api.sendInspectorState(INSPECTOR_ID);\n                if (isTimelineActive) {\n                    api.addTimelineEvent({\n                        layerId: MUTATIONS_LAYER_ID,\n                        event: {\n                            time: now(),\n                            title: 'Change',\n                            subtitle: name,\n                            data: {\n                                newValue,\n                                oldValue,\n                            },\n                            groupId: activeAction,\n                        },\n                    });\n                }\n            }, { deep: true });\n        });\n        store.$subscribe(({ events, type }, state) => {\n            api.notifyComponentUpdate();\n            api.sendInspectorState(INSPECTOR_ID);\n            if (!isTimelineActive)\n                return;\n            // rootStore.state[store.id] = state\n            const eventData = {\n                time: now(),\n                title: formatMutationType(type),\n                data: assign$1({ store: formatDisplay(store.$id) }, formatEventData(events)),\n                groupId: activeAction,\n            };\n            if (type === MutationType.patchFunction) {\n                eventData.subtitle = '';\n            }\n            else if (type === MutationType.patchObject) {\n                eventData.subtitle = '';\n            }\n            else if (events && !Array.isArray(events)) {\n                eventData.subtitle = events.type;\n            }\n            if (events) {\n                eventData.data['rawEvent(s)'] = {\n                    _custom: {\n                        display: 'DebuggerEvent',\n                        type: 'object',\n                        tooltip: 'raw DebuggerEvent[]',\n                        value: events,\n                    },\n                };\n            }\n            api.addTimelineEvent({\n                layerId: MUTATIONS_LAYER_ID,\n                event: eventData,\n            });\n        }, { detached: true, flush: 'sync' });\n        const hotUpdate = store._hotUpdate;\n        store._hotUpdate = markRaw((newStore) => {\n            hotUpdate(newStore);\n            api.addTimelineEvent({\n                layerId: MUTATIONS_LAYER_ID,\n                event: {\n                    time: now(),\n                    title: ' ' + store.$id,\n                    subtitle: 'HMR update',\n                    data: {\n                        store: formatDisplay(store.$id),\n                        info: formatDisplay(`HMR update`),\n                    },\n                },\n            });\n            // update the devtools too\n            api.notifyComponentUpdate();\n            api.sendInspectorTree(INSPECTOR_ID);\n            api.sendInspectorState(INSPECTOR_ID);\n        });\n        const { $dispose } = store;\n        store.$dispose = () => {\n            $dispose();\n            api.notifyComponentUpdate();\n            api.sendInspectorTree(INSPECTOR_ID);\n            api.sendInspectorState(INSPECTOR_ID);\n            api.getSettings().logStoreChanges &&\n                toastMessage(`Disposed \"${store.$id}\" store `);\n        };\n        // trigger an update so it can display new registered stores\n        api.notifyComponentUpdate();\n        api.sendInspectorTree(INSPECTOR_ID);\n        api.sendInspectorState(INSPECTOR_ID);\n        api.getSettings().logStoreChanges &&\n            toastMessage(`\"${store.$id}\" store installed `);\n    });\n}\nlet runningActionId = 0;\nlet activeAction;\n/**\n * Patches a store to enable action grouping in devtools by wrapping the store with a Proxy that is passed as the\n * context of all actions, allowing us to set `runningAction` on each access and effectively associating any state\n * mutation to the action.\n *\n * @param store - store to patch\n * @param actionNames - list of actionst to patch\n */\nfunction patchActionForGrouping(store, actionNames, wrapWithProxy) {\n    // original actions of the store as they are given by pinia. We are going to override them\n    const actions = actionNames.reduce((storeActions, actionName) => {\n        // use toRaw to avoid tracking #541\n        storeActions[actionName] = toRaw(store)[actionName];\n        return storeActions;\n    }, {});\n    for (const actionName in actions) {\n        store[actionName] = function () {\n            // the running action id is incremented in a before action hook\n            const _actionId = runningActionId;\n            const trackedStore = wrapWithProxy\n                ? new Proxy(store, {\n                    get(...args) {\n                        activeAction = _actionId;\n                        return Reflect.get(...args);\n                    },\n                    set(...args) {\n                        activeAction = _actionId;\n                        return Reflect.set(...args);\n                    },\n                })\n                : store;\n            // For Setup Stores we need https://github.com/tc39/proposal-async-context\n            activeAction = _actionId;\n            const retValue = actions[actionName].apply(trackedStore, arguments);\n            // this is safer as async actions in Setup Stores would associate mutations done outside of the action\n            activeAction = undefined;\n            return retValue;\n        };\n    }\n}\n/**\n * pinia.use(devtoolsPlugin)\n */\nfunction devtoolsPlugin({ app, store, options }) {\n    // HMR module\n    if (store.$id.startsWith('__hot:')) {\n        return;\n    }\n    // detect option api vs setup api\n    store._isOptionsAPI = !!options.state;\n    // Do not overwrite actions mocked by @pinia/testing (#2298)\n    if (!store._p._testing) {\n        patchActionForGrouping(store, Object.keys(options.actions), store._isOptionsAPI);\n        // Upgrade the HMR to also update the new actions\n        const originalHotUpdate = store._hotUpdate;\n        toRaw(store)._hotUpdate = function (newStore) {\n            originalHotUpdate.apply(this, arguments);\n            patchActionForGrouping(store, Object.keys(newStore._hmrPayload.actions), !!store._isOptionsAPI);\n        };\n    }\n    addStoreToDevtools(app, \n    // FIXME: is there a way to allow the assignment from Store<Id, S, G, A> to StoreGeneric?\n    store);\n}\n\n/**\n * Creates a Pinia instance to be used by the application\n */\nfunction createPinia() {\n    const scope = effectScope(true);\n    // NOTE: here we could check the window object for a state and directly set it\n    // if there is anything like it with Vue 3 SSR\n    const state = scope.run(() => ref({}));\n    let _p = [];\n    // plugins added before calling app.use(pinia)\n    let toBeInstalled = [];\n    const pinia = markRaw({\n        install(app) {\n            // this allows calling useStore() outside of a component setup after\n            // installing pinia's plugin\n            setActivePinia(pinia);\n            if (!isVue2) {\n                pinia._a = app;\n                app.provide(piniaSymbol, pinia);\n                app.config.globalProperties.$pinia = pinia;\n                /* istanbul ignore else */\n                if ((((process.env.NODE_ENV !== 'production') || (typeof __VUE_PROD_DEVTOOLS__ !== 'undefined' && __VUE_PROD_DEVTOOLS__)) && !(process.env.NODE_ENV === 'test')) && IS_CLIENT) {\n                    registerPiniaDevtools(app, pinia);\n                }\n                toBeInstalled.forEach((plugin) => _p.push(plugin));\n                toBeInstalled = [];\n            }\n        },\n        use(plugin) {\n            if (!this._a && !isVue2) {\n                toBeInstalled.push(plugin);\n            }\n            else {\n                _p.push(plugin);\n            }\n            return this;\n        },\n        _p,\n        // it's actually undefined here\n        // @ts-expect-error\n        _a: null,\n        _e: scope,\n        _s: new Map(),\n        state,\n    });\n    // pinia devtools rely on dev only features so they cannot be forced unless\n    // the dev build of Vue is used. Avoid old browsers like IE11.\n    if ((((process.env.NODE_ENV !== 'production') || (typeof __VUE_PROD_DEVTOOLS__ !== 'undefined' && __VUE_PROD_DEVTOOLS__)) && !(process.env.NODE_ENV === 'test')) && IS_CLIENT && typeof Proxy !== 'undefined') {\n        pinia.use(devtoolsPlugin);\n    }\n    return pinia;\n}\n/**\n * Dispose a Pinia instance by stopping its effectScope and removing the state, plugins and stores. This is mostly\n * useful in tests, with both a testing pinia or a regular pinia and in applications that use multiple pinia instances.\n * Once disposed, the pinia instance cannot be used anymore.\n *\n * @param pinia - pinia instance\n */\nfunction disposePinia(pinia) {\n    pinia._e.stop();\n    pinia._s.clear();\n    pinia._p.splice(0);\n    pinia.state.value = {};\n    // @ts-expect-error: non valid\n    pinia._a = null;\n}\n\n/**\n * Checks if a function is a `StoreDefinition`.\n *\n * @param fn - object to test\n * @returns true if `fn` is a StoreDefinition\n */\nconst isUseStore = (fn) => {\n    return typeof fn === 'function' && typeof fn.$id === 'string';\n};\n/**\n * Mutates in place `newState` with `oldState` to _hot update_ it. It will\n * remove any key not existing in `newState` and recursively merge plain\n * objects.\n *\n * @param newState - new state object to be patched\n * @param oldState - old state that should be used to patch newState\n * @returns - newState\n */\nfunction patchObject(newState, oldState) {\n    // no need to go through symbols because they cannot be serialized anyway\n    for (const key in oldState) {\n        const subPatch = oldState[key];\n        // skip the whole sub tree\n        if (!(key in newState)) {\n            continue;\n        }\n        const targetValue = newState[key];\n        if (isPlainObject(targetValue) &&\n            isPlainObject(subPatch) &&\n            !isRef(subPatch) &&\n            !isReactive(subPatch)) {\n            newState[key] = patchObject(targetValue, subPatch);\n        }\n        else {\n            // objects are either a bit more complex (e.g. refs) or primitives, so we\n            // just set the whole thing\n            if (isVue2) {\n                set(newState, key, subPatch);\n            }\n            else {\n                newState[key] = subPatch;\n            }\n        }\n    }\n    return newState;\n}\n/**\n * Creates an _accept_ function to pass to `import.meta.hot` in Vite applications.\n *\n * @example\n * ```js\n * const useUser = defineStore(...)\n * if (import.meta.hot) {\n *   import.meta.hot.accept(acceptHMRUpdate(useUser, import.meta.hot))\n * }\n * ```\n *\n * @param initialUseStore - return of the defineStore to hot update\n * @param hot - `import.meta.hot`\n */\nfunction acceptHMRUpdate(initialUseStore, hot) {\n    // strip as much as possible from iife.prod\n    if (!(process.env.NODE_ENV !== 'production')) {\n        return () => { };\n    }\n    return (newModule) => {\n        const pinia = hot.data.pinia || initialUseStore._pinia;\n        if (!pinia) {\n            // this store is still not used\n            return;\n        }\n        // preserve the pinia instance across loads\n        hot.data.pinia = pinia;\n        // console.log('got data', newStore)\n        for (const exportName in newModule) {\n            const useStore = newModule[exportName];\n            // console.log('checking for', exportName)\n            if (isUseStore(useStore) && pinia._s.has(useStore.$id)) {\n                // console.log('Accepting update for', useStore.$id)\n                const id = useStore.$id;\n                if (id !== initialUseStore.$id) {\n                    console.warn(`The id of the store changed from \"${initialUseStore.$id}\" to \"${id}\". Reloading.`);\n                    // return import.meta.hot.invalidate()\n                    return hot.invalidate();\n                }\n                const existingStore = pinia._s.get(id);\n                if (!existingStore) {\n                    console.log(`[Pinia]: skipping hmr because store doesn't exist yet`);\n                    return;\n                }\n                useStore(pinia, existingStore);\n            }\n        }\n    };\n}\n\nconst noop = () => { };\nfunction addSubscription(subscriptions, callback, detached, onCleanup = noop) {\n    subscriptions.push(callback);\n    const removeSubscription = () => {\n        const idx = subscriptions.indexOf(callback);\n        if (idx > -1) {\n            subscriptions.splice(idx, 1);\n            onCleanup();\n        }\n    };\n    if (!detached && getCurrentScope()) {\n        onScopeDispose(removeSubscription);\n    }\n    return removeSubscription;\n}\nfunction triggerSubscriptions(subscriptions, ...args) {\n    subscriptions.slice().forEach((callback) => {\n        callback(...args);\n    });\n}\n\nconst fallbackRunWithContext = (fn) => fn();\n/**\n * Marks a function as an action for `$onAction`\n * @internal\n */\nconst ACTION_MARKER = Symbol();\n/**\n * Action name symbol. Allows to add a name to an action after defining it\n * @internal\n */\nconst ACTION_NAME = Symbol();\nfunction mergeReactiveObjects(target, patchToApply) {\n    // Handle Map instances\n    if (target instanceof Map && patchToApply instanceof Map) {\n        patchToApply.forEach((value, key) => target.set(key, value));\n    }\n    else if (target instanceof Set && patchToApply instanceof Set) {\n        // Handle Set instances\n        patchToApply.forEach(target.add, target);\n    }\n    // no need to go through symbols because they cannot be serialized anyway\n    for (const key in patchToApply) {\n        if (!patchToApply.hasOwnProperty(key))\n            continue;\n        const subPatch = patchToApply[key];\n        const targetValue = target[key];\n        if (isPlainObject(targetValue) &&\n            isPlainObject(subPatch) &&\n            target.hasOwnProperty(key) &&\n            !isRef(subPatch) &&\n            !isReactive(subPatch)) {\n            // NOTE: here I wanted to warn about inconsistent types but it's not possible because in setup stores one might\n            // start the value of a property as a certain type e.g. a Map, and then for some reason, during SSR, change that\n            // to `undefined`. When trying to hydrate, we want to override the Map with `undefined`.\n            target[key] = mergeReactiveObjects(targetValue, subPatch);\n        }\n        else {\n            // @ts-expect-error: subPatch is a valid value\n            target[key] = subPatch;\n        }\n    }\n    return target;\n}\nconst skipHydrateSymbol = (process.env.NODE_ENV !== 'production')\n    ? Symbol('pinia:skipHydration')\n    : /* istanbul ignore next */ Symbol();\n/**\n * Tells Pinia to skip the hydration process of a given object. This is useful in setup stores (only) when you return a\n * stateful object in the store but it isn't really state. e.g. returning a router instance in a setup store.\n *\n * @param obj - target object\n * @returns obj\n */\nfunction skipHydrate(obj) {\n    return Object.defineProperty(obj, skipHydrateSymbol, {});\n}\n/**\n * Returns whether a value should be hydrated\n *\n * @param obj - target variable\n * @returns true if `obj` should be hydrated\n */\nfunction shouldHydrate(obj) {\n    return !isPlainObject(obj) || !obj.hasOwnProperty(skipHydrateSymbol);\n}\nconst { assign } = Object;\nfunction isComputed(o) {\n    return !!(isRef(o) && o.effect);\n}\nfunction createOptionsStore(id, options, pinia, hot) {\n    const { state, actions, getters } = options;\n    const initialState = pinia.state.value[id];\n    let store;\n    function setup() {\n        if (!initialState && (!(process.env.NODE_ENV !== 'production') || !hot)) {\n            /* istanbul ignore if */\n            if (isVue2) {\n                set(pinia.state.value, id, state ? state() : {});\n            }\n            else {\n                pinia.state.value[id] = state ? state() : {};\n            }\n        }\n        // avoid creating a state in pinia.state.value\n        const localState = (process.env.NODE_ENV !== 'production') && hot\n            ? // use ref() to unwrap refs inside state TODO: check if this is still necessary\n                toRefs(ref(state ? state() : {}).value)\n            : toRefs(pinia.state.value[id]);\n        return assign(localState, actions, Object.keys(getters || {}).reduce((computedGetters, name) => {\n            if ((process.env.NODE_ENV !== 'production') && name in localState) {\n                console.warn(`[]: A getter cannot have the same name as another state property. Rename one of them. Found with \"${name}\" in store \"${id}\".`);\n            }\n            computedGetters[name] = markRaw(computed(() => {\n                setActivePinia(pinia);\n                // it was created just before\n                const store = pinia._s.get(id);\n                // allow cross using stores\n                /* istanbul ignore if */\n                if (isVue2 && !store._r)\n                    return;\n                // @ts-expect-error\n                // return getters![name].call(context, context)\n                // TODO: avoid reading the getter while assigning with a global variable\n                return getters[name].call(store, store);\n            }));\n            return computedGetters;\n        }, {}));\n    }\n    store = createSetupStore(id, setup, options, pinia, hot, true);\n    return store;\n}\nfunction createSetupStore($id, setup, options = {}, pinia, hot, isOptionsStore) {\n    let scope;\n    const optionsForPlugin = assign({ actions: {} }, options);\n    /* istanbul ignore if */\n    if ((process.env.NODE_ENV !== 'production') && !pinia._e.active) {\n        throw new Error('Pinia destroyed');\n    }\n    // watcher options for $subscribe\n    const $subscribeOptions = { deep: true };\n    /* istanbul ignore else */\n    if ((process.env.NODE_ENV !== 'production') && !isVue2) {\n        $subscribeOptions.onTrigger = (event) => {\n            /* istanbul ignore else */\n            if (isListening) {\n                debuggerEvents = event;\n                // avoid triggering this while the store is being built and the state is being set in pinia\n            }\n            else if (isListening == false && !store._hotUpdating) {\n                // let patch send all the events together later\n                /* istanbul ignore else */\n                if (Array.isArray(debuggerEvents)) {\n                    debuggerEvents.push(event);\n                }\n                else {\n                    console.error(' debuggerEvents should be an array. This is most likely an internal Pinia bug.');\n                }\n            }\n        };\n    }\n    // internal state\n    let isListening; // set to true at the end\n    let isSyncListening; // set to true at the end\n    let subscriptions = [];\n    let actionSubscriptions = [];\n    let debuggerEvents;\n    const initialState = pinia.state.value[$id];\n    // avoid setting the state for option stores if it is set\n    // by the setup\n    if (!isOptionsStore && !initialState && (!(process.env.NODE_ENV !== 'production') || !hot)) {\n        /* istanbul ignore if */\n        if (isVue2) {\n            set(pinia.state.value, $id, {});\n        }\n        else {\n            pinia.state.value[$id] = {};\n        }\n    }\n    const hotState = ref({});\n    // avoid triggering too many listeners\n    // https://github.com/vuejs/pinia/issues/1129\n    let activeListener;\n    function $patch(partialStateOrMutator) {\n        let subscriptionMutation;\n        isListening = isSyncListening = false;\n        // reset the debugger events since patches are sync\n        /* istanbul ignore else */\n        if ((process.env.NODE_ENV !== 'production')) {\n            debuggerEvents = [];\n        }\n        if (typeof partialStateOrMutator === 'function') {\n            partialStateOrMutator(pinia.state.value[$id]);\n            subscriptionMutation = {\n                type: MutationType.patchFunction,\n                storeId: $id,\n                events: debuggerEvents,\n            };\n        }\n        else {\n            mergeReactiveObjects(pinia.state.value[$id], partialStateOrMutator);\n            subscriptionMutation = {\n                type: MutationType.patchObject,\n                payload: partialStateOrMutator,\n                storeId: $id,\n                events: debuggerEvents,\n            };\n        }\n        const myListenerId = (activeListener = Symbol());\n        nextTick().then(() => {\n            if (activeListener === myListenerId) {\n                isListening = true;\n            }\n        });\n        isSyncListening = true;\n        // because we paused the watcher, we need to manually call the subscriptions\n        triggerSubscriptions(subscriptions, subscriptionMutation, pinia.state.value[$id]);\n    }\n    const $reset = isOptionsStore\n        ? function $reset() {\n            const { state } = options;\n            const newState = state ? state() : {};\n            // we use a patch to group all changes into one single subscription\n            this.$patch(($state) => {\n                // @ts-expect-error: FIXME: shouldn't error?\n                assign($state, newState);\n            });\n        }\n        : /* istanbul ignore next */\n            (process.env.NODE_ENV !== 'production')\n                ? () => {\n                    throw new Error(`: Store \"${$id}\" is built using the setup syntax and does not implement $reset().`);\n                }\n                : noop;\n    function $dispose() {\n        scope.stop();\n        subscriptions = [];\n        actionSubscriptions = [];\n        pinia._s.delete($id);\n    }\n    /**\n     * Helper that wraps function so it can be tracked with $onAction\n     * @param fn - action to wrap\n     * @param name - name of the action\n     */\n    const action = (fn, name = '') => {\n        if (ACTION_MARKER in fn) {\n            fn[ACTION_NAME] = name;\n            return fn;\n        }\n        const wrappedAction = function () {\n            setActivePinia(pinia);\n            const args = Array.from(arguments);\n            const afterCallbackList = [];\n            const onErrorCallbackList = [];\n            function after(callback) {\n                afterCallbackList.push(callback);\n            }\n            function onError(callback) {\n                onErrorCallbackList.push(callback);\n            }\n            // @ts-expect-error\n            triggerSubscriptions(actionSubscriptions, {\n                args,\n                name: wrappedAction[ACTION_NAME],\n                store,\n                after,\n                onError,\n            });\n            let ret;\n            try {\n                ret = fn.apply(this && this.$id === $id ? this : store, args);\n                // handle sync errors\n            }\n            catch (error) {\n                triggerSubscriptions(onErrorCallbackList, error);\n                throw error;\n            }\n            if (ret instanceof Promise) {\n                return ret\n                    .then((value) => {\n                    triggerSubscriptions(afterCallbackList, value);\n                    return value;\n                })\n                    .catch((error) => {\n                    triggerSubscriptions(onErrorCallbackList, error);\n                    return Promise.reject(error);\n                });\n            }\n            // trigger after callbacks\n            triggerSubscriptions(afterCallbackList, ret);\n            return ret;\n        };\n        wrappedAction[ACTION_MARKER] = true;\n        wrappedAction[ACTION_NAME] = name; // will be set later\n        // @ts-expect-error: we are intentionally limiting the returned type to just Fn\n        // because all the added properties are internals that are exposed through `$onAction()` only\n        return wrappedAction;\n    };\n    const _hmrPayload = /*#__PURE__*/ markRaw({\n        actions: {},\n        getters: {},\n        state: [],\n        hotState,\n    });\n    const partialStore = {\n        _p: pinia,\n        // _s: scope,\n        $id,\n        $onAction: addSubscription.bind(null, actionSubscriptions),\n        $patch,\n        $reset,\n        $subscribe(callback, options = {}) {\n            const removeSubscription = addSubscription(subscriptions, callback, options.detached, () => stopWatcher());\n            const stopWatcher = scope.run(() => watch(() => pinia.state.value[$id], (state) => {\n                if (options.flush === 'sync' ? isSyncListening : isListening) {\n                    callback({\n                        storeId: $id,\n                        type: MutationType.direct,\n                        events: debuggerEvents,\n                    }, state);\n                }\n            }, assign({}, $subscribeOptions, options)));\n            return removeSubscription;\n        },\n        $dispose,\n    };\n    /* istanbul ignore if */\n    if (isVue2) {\n        // start as non ready\n        partialStore._r = false;\n    }\n    const store = reactive((process.env.NODE_ENV !== 'production') || ((((process.env.NODE_ENV !== 'production') || (typeof __VUE_PROD_DEVTOOLS__ !== 'undefined' && __VUE_PROD_DEVTOOLS__)) && !(process.env.NODE_ENV === 'test')) && IS_CLIENT)\n        ? assign({\n            _hmrPayload,\n            _customProperties: markRaw(new Set()), // devtools custom properties\n        }, partialStore\n        // must be added later\n        // setupStore\n        )\n        : partialStore);\n    // store the partial store now so the setup of stores can instantiate each other before they are finished without\n    // creating infinite loops.\n    pinia._s.set($id, store);\n    const runWithContext = (pinia._a && pinia._a.runWithContext) || fallbackRunWithContext;\n    // TODO: idea create skipSerialize that marks properties as non serializable and they are skipped\n    const setupStore = runWithContext(() => pinia._e.run(() => (scope = effectScope()).run(() => setup({ action }))));\n    // overwrite existing actions to support $onAction\n    for (const key in setupStore) {\n        const prop = setupStore[key];\n        if ((isRef(prop) && !isComputed(prop)) || isReactive(prop)) {\n            // mark it as a piece of state to be serialized\n            if ((process.env.NODE_ENV !== 'production') && hot) {\n                set(hotState.value, key, toRef(setupStore, key));\n                // createOptionStore directly sets the state in pinia.state.value so we\n                // can just skip that\n            }\n            else if (!isOptionsStore) {\n                // in setup stores we must hydrate the state and sync pinia state tree with the refs the user just created\n                if (initialState && shouldHydrate(prop)) {\n                    if (isRef(prop)) {\n                        prop.value = initialState[key];\n                    }\n                    else {\n                        // probably a reactive object, lets recursively assign\n                        // @ts-expect-error: prop is unknown\n                        mergeReactiveObjects(prop, initialState[key]);\n                    }\n                }\n                // transfer the ref to the pinia state to keep everything in sync\n                /* istanbul ignore if */\n                if (isVue2) {\n                    set(pinia.state.value[$id], key, prop);\n                }\n                else {\n                    pinia.state.value[$id][key] = prop;\n                }\n            }\n            /* istanbul ignore else */\n            if ((process.env.NODE_ENV !== 'production')) {\n                _hmrPayload.state.push(key);\n            }\n            // action\n        }\n        else if (typeof prop === 'function') {\n            const actionValue = (process.env.NODE_ENV !== 'production') && hot ? prop : action(prop, key);\n            // this a hot module replacement store because the hotUpdate method needs\n            // to do it with the right context\n            /* istanbul ignore if */\n            if (isVue2) {\n                set(setupStore, key, actionValue);\n            }\n            else {\n                // @ts-expect-error\n                setupStore[key] = actionValue;\n            }\n            /* istanbul ignore else */\n            if ((process.env.NODE_ENV !== 'production')) {\n                _hmrPayload.actions[key] = prop;\n            }\n            // list actions so they can be used in plugins\n            // @ts-expect-error\n            optionsForPlugin.actions[key] = prop;\n        }\n        else if ((process.env.NODE_ENV !== 'production')) {\n            // add getters for devtools\n            if (isComputed(prop)) {\n                _hmrPayload.getters[key] = isOptionsStore\n                    ? // @ts-expect-error\n                        options.getters[key]\n                    : prop;\n                if (IS_CLIENT) {\n                    const getters = setupStore._getters ||\n                        // @ts-expect-error: same\n                        (setupStore._getters = markRaw([]));\n                    getters.push(key);\n                }\n            }\n        }\n    }\n    // add the state, getters, and action properties\n    /* istanbul ignore if */\n    if (isVue2) {\n        Object.keys(setupStore).forEach((key) => {\n            set(store, key, setupStore[key]);\n        });\n    }\n    else {\n        assign(store, setupStore);\n        // allows retrieving reactive objects with `storeToRefs()`. Must be called after assigning to the reactive object.\n        // Make `storeToRefs()` work with `reactive()` #799\n        assign(toRaw(store), setupStore);\n    }\n    // use this instead of a computed with setter to be able to create it anywhere\n    // without linking the computed lifespan to wherever the store is first\n    // created.\n    Object.defineProperty(store, '$state', {\n        get: () => ((process.env.NODE_ENV !== 'production') && hot ? hotState.value : pinia.state.value[$id]),\n        set: (state) => {\n            /* istanbul ignore if */\n            if ((process.env.NODE_ENV !== 'production') && hot) {\n                throw new Error('cannot set hotState');\n            }\n            $patch(($state) => {\n                // @ts-expect-error: FIXME: shouldn't error?\n                assign($state, state);\n            });\n        },\n    });\n    // add the hotUpdate before plugins to allow them to override it\n    /* istanbul ignore else */\n    if ((process.env.NODE_ENV !== 'production')) {\n        store._hotUpdate = markRaw((newStore) => {\n            store._hotUpdating = true;\n            newStore._hmrPayload.state.forEach((stateKey) => {\n                if (stateKey in store.$state) {\n                    const newStateTarget = newStore.$state[stateKey];\n                    const oldStateSource = store.$state[stateKey];\n                    if (typeof newStateTarget === 'object' &&\n                        isPlainObject(newStateTarget) &&\n                        isPlainObject(oldStateSource)) {\n                        patchObject(newStateTarget, oldStateSource);\n                    }\n                    else {\n                        // transfer the ref\n                        newStore.$state[stateKey] = oldStateSource;\n                    }\n                }\n                // patch direct access properties to allow store.stateProperty to work as\n                // store.$state.stateProperty\n                set(store, stateKey, toRef(newStore.$state, stateKey));\n            });\n            // remove deleted state properties\n            Object.keys(store.$state).forEach((stateKey) => {\n                if (!(stateKey in newStore.$state)) {\n                    del(store, stateKey);\n                }\n            });\n            // avoid devtools logging this as a mutation\n            isListening = false;\n            isSyncListening = false;\n            pinia.state.value[$id] = toRef(newStore._hmrPayload, 'hotState');\n            isSyncListening = true;\n            nextTick().then(() => {\n                isListening = true;\n            });\n            for (const actionName in newStore._hmrPayload.actions) {\n                const actionFn = newStore[actionName];\n                set(store, actionName, action(actionFn, actionName));\n            }\n            // TODO: does this work in both setup and option store?\n            for (const getterName in newStore._hmrPayload.getters) {\n                const getter = newStore._hmrPayload.getters[getterName];\n                const getterValue = isOptionsStore\n                    ? // special handling of options api\n                        computed(() => {\n                            setActivePinia(pinia);\n                            return getter.call(store, store);\n                        })\n                    : getter;\n                set(store, getterName, getterValue);\n            }\n            // remove deleted getters\n            Object.keys(store._hmrPayload.getters).forEach((key) => {\n                if (!(key in newStore._hmrPayload.getters)) {\n                    del(store, key);\n                }\n            });\n            // remove old actions\n            Object.keys(store._hmrPayload.actions).forEach((key) => {\n                if (!(key in newStore._hmrPayload.actions)) {\n                    del(store, key);\n                }\n            });\n            // update the values used in devtools and to allow deleting new properties later on\n            store._hmrPayload = newStore._hmrPayload;\n            store._getters = newStore._getters;\n            store._hotUpdating = false;\n        });\n    }\n    if ((((process.env.NODE_ENV !== 'production') || (typeof __VUE_PROD_DEVTOOLS__ !== 'undefined' && __VUE_PROD_DEVTOOLS__)) && !(process.env.NODE_ENV === 'test')) && IS_CLIENT) {\n        const nonEnumerable = {\n            writable: true,\n            configurable: true,\n            // avoid warning on devtools trying to display this property\n            enumerable: false,\n        };\n        ['_p', '_hmrPayload', '_getters', '_customProperties'].forEach((p) => {\n            Object.defineProperty(store, p, assign({ value: store[p] }, nonEnumerable));\n        });\n    }\n    /* istanbul ignore if */\n    if (isVue2) {\n        // mark the store as ready before plugins\n        store._r = true;\n    }\n    // apply all plugins\n    pinia._p.forEach((extender) => {\n        /* istanbul ignore else */\n        if ((((process.env.NODE_ENV !== 'production') || (typeof __VUE_PROD_DEVTOOLS__ !== 'undefined' && __VUE_PROD_DEVTOOLS__)) && !(process.env.NODE_ENV === 'test')) && IS_CLIENT) {\n            const extensions = scope.run(() => extender({\n                store: store,\n                app: pinia._a,\n                pinia,\n                options: optionsForPlugin,\n            }));\n            Object.keys(extensions || {}).forEach((key) => store._customProperties.add(key));\n            assign(store, extensions);\n        }\n        else {\n            assign(store, scope.run(() => extender({\n                store: store,\n                app: pinia._a,\n                pinia,\n                options: optionsForPlugin,\n            })));\n        }\n    });\n    if ((process.env.NODE_ENV !== 'production') &&\n        store.$state &&\n        typeof store.$state === 'object' &&\n        typeof store.$state.constructor === 'function' &&\n        !store.$state.constructor.toString().includes('[native code]')) {\n        console.warn(`[]: The \"state\" must be a plain object. It cannot be\\n` +\n            `\\tstate: () => new MyClass()\\n` +\n            `Found in store \"${store.$id}\".`);\n    }\n    // only apply hydrate to option stores with an initial state in pinia\n    if (initialState &&\n        isOptionsStore &&\n        options.hydrate) {\n        options.hydrate(store.$state, initialState);\n    }\n    isListening = true;\n    isSyncListening = true;\n    return store;\n}\n// allows unused stores to be tree shaken\n/*! #__NO_SIDE_EFFECTS__ */\nfunction defineStore(\n// TODO: add proper types from above\nidOrOptions, setup, setupOptions) {\n    let id;\n    let options;\n    const isSetupStore = typeof setup === 'function';\n    if (typeof idOrOptions === 'string') {\n        id = idOrOptions;\n        // the option store setup will contain the actual options in this case\n        options = isSetupStore ? setupOptions : setup;\n    }\n    else {\n        options = idOrOptions;\n        id = idOrOptions.id;\n        if ((process.env.NODE_ENV !== 'production') && typeof id !== 'string') {\n            throw new Error(`[]: \"defineStore()\" must be passed a store id as its first argument.`);\n        }\n    }\n    function useStore(pinia, hot) {\n        const hasContext = hasInjectionContext();\n        pinia =\n            // in test mode, ignore the argument provided as we can always retrieve a\n            // pinia instance with getActivePinia()\n            ((process.env.NODE_ENV === 'test') && activePinia && activePinia._testing ? null : pinia) ||\n                (hasContext ? inject(piniaSymbol, null) : null);\n        if (pinia)\n            setActivePinia(pinia);\n        if ((process.env.NODE_ENV !== 'production') && !activePinia) {\n            throw new Error(`[]: \"getActivePinia()\" was called but there was no active Pinia. Are you trying to use a store before calling \"app.use(pinia)\"?\\n` +\n                `See https://pinia.vuejs.org/core-concepts/outside-component-usage.html for help.\\n` +\n                `This will fail in production.`);\n        }\n        pinia = activePinia;\n        if (!pinia._s.has(id)) {\n            // creating the store registers it in `pinia._s`\n            if (isSetupStore) {\n                createSetupStore(id, setup, options, pinia);\n            }\n            else {\n                createOptionsStore(id, options, pinia);\n            }\n            /* istanbul ignore else */\n            if ((process.env.NODE_ENV !== 'production')) {\n                // @ts-expect-error: not the right inferred type\n                useStore._pinia = pinia;\n            }\n        }\n        const store = pinia._s.get(id);\n        if ((process.env.NODE_ENV !== 'production') && hot) {\n            const hotId = '__hot:' + id;\n            const newStore = isSetupStore\n                ? createSetupStore(hotId, setup, options, pinia, true)\n                : createOptionsStore(hotId, assign({}, options), pinia, true);\n            hot._hotUpdate(newStore);\n            // cleanup the state properties and the store from the cache\n            delete pinia.state.value[hotId];\n            pinia._s.delete(hotId);\n        }\n        if ((process.env.NODE_ENV !== 'production') && IS_CLIENT) {\n            const currentInstance = getCurrentInstance();\n            // save stores in instances to access them devtools\n            if (currentInstance &&\n                currentInstance.proxy &&\n                // avoid adding stores that are just built for hot module replacement\n                !hot) {\n                const vm = currentInstance.proxy;\n                const cache = '_pStores' in vm ? vm._pStores : (vm._pStores = {});\n                cache[id] = store;\n            }\n        }\n        // StoreGeneric cannot be casted towards Store\n        return store;\n    }\n    useStore.$id = id;\n    return useStore;\n}\n\nlet mapStoreSuffix = 'Store';\n/**\n * Changes the suffix added by `mapStores()`. Can be set to an empty string.\n * Defaults to `\"Store\"`. Make sure to extend the MapStoresCustomization\n * interface if you are using TypeScript.\n *\n * @param suffix - new suffix\n */\nfunction setMapStoreSuffix(suffix // could be 'Store' but that would be annoying for JS\n) {\n    mapStoreSuffix = suffix;\n}\n/**\n * Allows using stores without the composition API (`setup()`) by generating an\n * object to be spread in the `computed` field of a component. It accepts a list\n * of store definitions.\n *\n * @example\n * ```js\n * export default {\n *   computed: {\n *     // other computed properties\n *     ...mapStores(useUserStore, useCartStore)\n *   },\n *\n *   created() {\n *     this.userStore // store with id \"user\"\n *     this.cartStore // store with id \"cart\"\n *   }\n * }\n * ```\n *\n * @param stores - list of stores to map to an object\n */\nfunction mapStores(...stores) {\n    if ((process.env.NODE_ENV !== 'production') && Array.isArray(stores[0])) {\n        console.warn(`[]: Directly pass all stores to \"mapStores()\" without putting them in an array:\\n` +\n            `Replace\\n` +\n            `\\tmapStores([useAuthStore, useCartStore])\\n` +\n            `with\\n` +\n            `\\tmapStores(useAuthStore, useCartStore)\\n` +\n            `This will fail in production if not fixed.`);\n        stores = stores[0];\n    }\n    return stores.reduce((reduced, useStore) => {\n        // @ts-expect-error: $id is added by defineStore\n        reduced[useStore.$id + mapStoreSuffix] = function () {\n            return useStore(this.$pinia);\n        };\n        return reduced;\n    }, {});\n}\n/**\n * Allows using state and getters from one store without using the composition\n * API (`setup()`) by generating an object to be spread in the `computed` field\n * of a component.\n *\n * @param useStore - store to map from\n * @param keysOrMapper - array or object\n */\nfunction mapState(useStore, keysOrMapper) {\n    return Array.isArray(keysOrMapper)\n        ? keysOrMapper.reduce((reduced, key) => {\n            reduced[key] = function () {\n                // @ts-expect-error: FIXME: should work?\n                return useStore(this.$pinia)[key];\n            };\n            return reduced;\n        }, {})\n        : Object.keys(keysOrMapper).reduce((reduced, key) => {\n            // @ts-expect-error\n            reduced[key] = function () {\n                const store = useStore(this.$pinia);\n                const storeKey = keysOrMapper[key];\n                // for some reason TS is unable to infer the type of storeKey to be a\n                // function\n                return typeof storeKey === 'function'\n                    ? storeKey.call(this, store)\n                    : // @ts-expect-error: FIXME: should work?\n                        store[storeKey];\n            };\n            return reduced;\n        }, {});\n}\n/**\n * Alias for `mapState()`. You should use `mapState()` instead.\n * @deprecated use `mapState()` instead.\n */\nconst mapGetters = mapState;\n/**\n * Allows directly using actions from your store without using the composition\n * API (`setup()`) by generating an object to be spread in the `methods` field\n * of a component.\n *\n * @param useStore - store to map from\n * @param keysOrMapper - array or object\n */\nfunction mapActions(useStore, keysOrMapper) {\n    return Array.isArray(keysOrMapper)\n        ? keysOrMapper.reduce((reduced, key) => {\n            // @ts-expect-error\n            reduced[key] = function (...args) {\n                // @ts-expect-error: FIXME: should work?\n                return useStore(this.$pinia)[key](...args);\n            };\n            return reduced;\n        }, {})\n        : Object.keys(keysOrMapper).reduce((reduced, key) => {\n            // @ts-expect-error\n            reduced[key] = function (...args) {\n                // @ts-expect-error: FIXME: should work?\n                return useStore(this.$pinia)[keysOrMapper[key]](...args);\n            };\n            return reduced;\n        }, {});\n}\n/**\n * Allows using state and getters from one store without using the composition\n * API (`setup()`) by generating an object to be spread in the `computed` field\n * of a component.\n *\n * @param useStore - store to map from\n * @param keysOrMapper - array or object\n */\nfunction mapWritableState(useStore, keysOrMapper) {\n    return Array.isArray(keysOrMapper)\n        ? keysOrMapper.reduce((reduced, key) => {\n            reduced[key] = {\n                get() {\n                    return useStore(this.$pinia)[key];\n                },\n                set(value) {\n                    return (useStore(this.$pinia)[key] = value);\n                },\n            };\n            return reduced;\n        }, {})\n        : Object.keys(keysOrMapper).reduce((reduced, key) => {\n            reduced[key] = {\n                get() {\n                    return useStore(this.$pinia)[keysOrMapper[key]];\n                },\n                set(value) {\n                    return (useStore(this.$pinia)[keysOrMapper[key]] = value);\n                },\n            };\n            return reduced;\n        }, {});\n}\n\n/**\n * Creates an object of references with all the state, getters, and plugin-added\n * state properties of the store. Similar to `toRefs()` but specifically\n * designed for Pinia stores so methods and non reactive properties are\n * completely ignored.\n *\n * @param store - store to extract the refs from\n */\nfunction storeToRefs(store) {\n    // See https://github.com/vuejs/pinia/issues/852\n    // It's easier to just use toRefs() even if it includes more stuff\n    if (isVue2) {\n        // @ts-expect-error: toRefs include methods and others\n        return toRefs(store);\n    }\n    else {\n        const rawStore = toRaw(store);\n        const refs = {};\n        for (const key in rawStore) {\n            const value = rawStore[key];\n            // There is no native method to check for a computed\n            // https://github.com/vuejs/core/pull/4165\n            if (value.effect) {\n                // @ts-expect-error: too hard to type correctly\n                refs[key] =\n                    // ...\n                    computed({\n                        get: () => store[key],\n                        set(value) {\n                            store[key] = value;\n                        },\n                    });\n            }\n            else if (isRef(value) || isReactive(value)) {\n                // @ts-expect-error: the key is state or getter\n                refs[key] =\n                    // ---\n                    toRef(store, key);\n            }\n        }\n        return refs;\n    }\n}\n\n/**\n * Vue 2 Plugin that must be installed for pinia to work. Note **you don't need\n * this plugin if you are using Nuxt.js**. Use the `buildModule` instead:\n * https://pinia.vuejs.org/ssr/nuxt.html.\n *\n * @example\n * ```js\n * import Vue from 'vue'\n * import { PiniaVuePlugin, createPinia } from 'pinia'\n *\n * Vue.use(PiniaVuePlugin)\n * const pinia = createPinia()\n *\n * new Vue({\n *   el: '#app',\n *   // ...\n *   pinia,\n * })\n * ```\n *\n * @param _Vue - `Vue` imported from 'vue'.\n */\nconst PiniaVuePlugin = function (_Vue) {\n    // Equivalent of\n    // app.config.globalProperties.$pinia = pinia\n    _Vue.mixin({\n        beforeCreate() {\n            const options = this.$options;\n            if (options.pinia) {\n                const pinia = options.pinia;\n                // HACK: taken from provide(): https://github.com/vuejs/composition-api/blob/main/src/apis/inject.ts#L31\n                /* istanbul ignore else */\n                if (!this._provided) {\n                    const provideCache = {};\n                    Object.defineProperty(this, '_provided', {\n                        get: () => provideCache,\n                        set: (v) => Object.assign(provideCache, v),\n                    });\n                }\n                this._provided[piniaSymbol] = pinia;\n                // propagate the pinia instance in an SSR friendly way\n                // avoid adding it to nuxt twice\n                /* istanbul ignore else */\n                if (!this.$pinia) {\n                    this.$pinia = pinia;\n                }\n                pinia._a = this;\n                if (IS_CLIENT) {\n                    // this allows calling useStore() outside of a component setup after\n                    // installing pinia's plugin\n                    setActivePinia(pinia);\n                }\n                if ((((process.env.NODE_ENV !== 'production') || (typeof __VUE_PROD_DEVTOOLS__ !== 'undefined' && __VUE_PROD_DEVTOOLS__)) && !(process.env.NODE_ENV === 'test')) && IS_CLIENT) {\n                    registerPiniaDevtools(pinia._a, pinia);\n                }\n            }\n            else if (!this.$pinia && options.parent && options.parent.$pinia) {\n                this.$pinia = options.parent.$pinia;\n            }\n        },\n        destroyed() {\n            delete this._pStores;\n        },\n    });\n};\n\nexport { MutationType, PiniaVuePlugin, acceptHMRUpdate, createPinia, defineStore, disposePinia, getActivePinia, mapActions, mapGetters, mapState, mapStores, mapWritableState, setActivePinia, setMapStoreSuffix, shouldHydrate, skipHydrate, storeToRefs };\n","// composables/useFiltering.ts\r\nimport { ref } from 'vue'\r\nimport type { GridRow } from '@/stores/dataGridStore'\r\n\r\n//  FIX: Store interface for accessing checkbox state\r\ninterface DataGridStoreInterface {\r\n  checkedRows: string[]\r\n  isRowChecked(rowId: string): boolean\r\n}\r\n\r\nexport type FilterOperator =\r\n  | 'Equals'\r\n  | 'NotEquals'\r\n  | 'Contains'\r\n  | 'StartsWith'\r\n  | 'EndsWith'\r\n  | 'GreaterThan'\r\n  | 'LessThan'\r\n  | 'GreaterThanOrEquals'\r\n  | 'LessThanOrEquals'\r\n  | 'IsEmpty'\r\n  | 'IsNotEmpty'\r\n\r\nexport interface FilterExpression {\r\n  type: 'simple' | 'composite'\r\n}\r\n\r\nexport interface SimpleFilter extends FilterExpression {\r\n  type: 'simple'\r\n  columnName: string\r\n  operator: FilterOperator\r\n  value: any\r\n}\r\n\r\nexport interface CompositeFilter extends FilterExpression {\r\n  type: 'composite'\r\n  left: FilterExpression\r\n  right: FilterExpression\r\n  operator: 'AND' | 'OR'\r\n}\r\n\r\nexport function useFiltering() {\r\n  const currentFilter = ref<FilterExpression | null>(null)\r\n\r\n  function evaluateFilter(row: GridRow, filter: FilterExpression, store?: DataGridStoreInterface): boolean {\r\n    if (filter.type === 'simple') {\r\n      return evaluateSimpleFilter(row, filter as SimpleFilter, store)\r\n    } else {\r\n      return evaluateCompositeFilter(row, filter as CompositeFilter, store)\r\n    }\r\n  }\r\n\r\n  function evaluateSimpleFilter(row: GridRow, filter: SimpleFilter, store?: DataGridStoreInterface): boolean {\r\n    //  FIX: Special handling for checkbox column (__checkbox)\r\n    // Checkbox values are stored in store.checkedRows, NOT in row.cells\r\n    let cellValue: any\r\n\r\n    if (filter.columnName === '__checkbox' && store) {\r\n      // Get checkbox state from store.checkedRows\r\n      cellValue = store.isRowChecked(row.rowId)\r\n    } else {\r\n      // Normal columns - get value from row.cells\r\n      const cell = row.cells.find(c => c.columnName === filter.columnName)\r\n      cellValue = cell?.value\r\n    }\r\n\r\n    const filterValue = filter.value\r\n\r\n    switch (filter.operator) {\r\n      case 'Equals':\r\n        return cellValue === filterValue\r\n\r\n      case 'NotEquals':\r\n        return cellValue !== filterValue\r\n\r\n      case 'GreaterThan':\r\n        return Number(cellValue) > Number(filterValue)\r\n\r\n      case 'LessThan':\r\n        return Number(cellValue) < Number(filterValue)\r\n\r\n      case 'GreaterThanOrEquals':\r\n        return Number(cellValue) >= Number(filterValue)\r\n\r\n      case 'LessThanOrEquals':\r\n        return Number(cellValue) <= Number(filterValue)\r\n\r\n      case 'Contains':\r\n        return String(cellValue).toLowerCase().includes(String(filterValue).toLowerCase())\r\n\r\n      case 'StartsWith':\r\n        return String(cellValue).toLowerCase().startsWith(String(filterValue).toLowerCase())\r\n\r\n      case 'EndsWith':\r\n        return String(cellValue).toLowerCase().endsWith(String(filterValue).toLowerCase())\r\n\r\n      case 'IsEmpty':\r\n        return cellValue == null || String(cellValue).trim() === ''\r\n\r\n      case 'IsNotEmpty':\r\n        return cellValue != null && String(cellValue).trim() !== ''\r\n\r\n      default:\r\n        return true\r\n    }\r\n  }\r\n\r\n  function evaluateCompositeFilter(row: GridRow, filter: CompositeFilter, store?: DataGridStoreInterface): boolean {\r\n    //  FIX: Defensive check for null/undefined children\r\n    if (!filter.left || !filter.right) {\r\n      console.error('[evaluateCompositeFilter] Invalid filter structure - missing children:', filter)\r\n      return true // Return true to not filter out rows when filter is corrupted\r\n    }\r\n\r\n    const leftResult = evaluateFilter(row, filter.left, store)\r\n\r\n    // Short-circuit evaluation\r\n    if (filter.operator === 'AND' && !leftResult) {\r\n      return false // No need to evaluate right if left is false\r\n    }\r\n    if (filter.operator === 'OR' && leftResult) {\r\n      return true // No need to evaluate right if left is true\r\n    }\r\n\r\n    const rightResult = evaluateFilter(row, filter.right, store)\r\n\r\n    return filter.operator === 'AND' ? leftResult && rightResult : leftResult || rightResult\r\n  }\r\n\r\n  function filterRows(rows: GridRow[], filter: FilterExpression | null, store?: DataGridStoreInterface): GridRow[] {\r\n    if (!filter) return rows\r\n    return rows.filter(row => evaluateFilter(row, filter, store))\r\n  }\r\n\r\n  function setFilter(filter: FilterExpression | null) {\r\n    currentFilter.value = filter\r\n  }\r\n\r\n  function clearFilter() {\r\n    currentFilter.value = null\r\n  }\r\n\r\n  return {\r\n    currentFilter,\r\n    filterRows,\r\n    setFilter,\r\n    clearFilter,\r\n    evaluateFilter\r\n  }\r\n}\r\n","// composables/useSearch.ts\r\nimport { ref, type Ref } from 'vue'\r\nimport type { GridRow } from '@/stores/dataGridStore'\r\n\r\nexport type SearchMode = 'Exact' | 'Contains' | 'StartsWith' | 'EndsWith' | 'Regex' | 'Fuzzy'\r\n\r\nexport interface SearchMatch {\r\n  rowId: string\r\n  columnName: string\r\n  value: string\r\n}\r\n\r\nexport interface SearchOptions {\r\n  caseSensitive?: boolean\r\n  fuzzyThreshold?: number\r\n}\r\n\r\nexport function useSearch(rows: Ref<GridRow[]>) {\r\n  const searchTerm = ref('')\r\n  const searchMode = ref<SearchMode>('Contains')\r\n  const searchResults = ref<SearchMatch[]>([])\r\n  const currentResultIndex = ref(-1)\r\n\r\n  function searchInRows(term: string, mode: SearchMode, options: SearchOptions = {}) {\r\n    if (!term) {\r\n      searchResults.value = []\r\n      currentResultIndex.value = -1\r\n      return\r\n    }\r\n\r\n    const matches: SearchMatch[] = []\r\n    const caseSensitive = options.caseSensitive ?? false\r\n    const fuzzyThreshold = options.fuzzyThreshold ?? 3\r\n\r\n    for (const row of rows.value) {\r\n      for (const cell of row.cells) {\r\n        const cellValue = String(cell.value || '')\r\n        let isMatch = false\r\n\r\n        const searchValue = caseSensitive ? cellValue : cellValue.toLowerCase()\r\n        const searchTerm = caseSensitive ? term : term.toLowerCase()\r\n\r\n        switch (mode) {\r\n          case 'Exact':\r\n            isMatch = caseSensitive ? cellValue === term : cellValue.toLowerCase() === term.toLowerCase()\r\n            break\r\n\r\n          case 'Contains':\r\n            isMatch = searchValue.includes(searchTerm)\r\n            break\r\n\r\n          case 'StartsWith':\r\n            isMatch = searchValue.startsWith(searchTerm)\r\n            break\r\n\r\n          case 'EndsWith':\r\n            isMatch = searchValue.endsWith(searchTerm)\r\n            break\r\n\r\n          case 'Regex':\r\n            try {\r\n              const flags = caseSensitive ? '' : 'i'\r\n              const regex = new RegExp(term, flags)\r\n              isMatch = regex.test(cellValue)\r\n            } catch {\r\n              isMatch = false\r\n            }\r\n            break\r\n\r\n          case 'Fuzzy':\r\n            isMatch = fuzzyMatch(cellValue, term, fuzzyThreshold)\r\n            break\r\n        }\r\n\r\n        if (isMatch) {\r\n          matches.push({\r\n            rowId: row.rowId,\r\n            columnName: cell.columnName,\r\n            value: cellValue\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    searchResults.value = matches\r\n    currentResultIndex.value = matches.length > 0 ? 0 : -1\r\n  }\r\n\r\n  function fuzzyMatch(text: string, pattern: string, threshold: number): boolean {\r\n    const distance = levenshteinDistance(text.toLowerCase(), pattern.toLowerCase())\r\n    return distance <= threshold\r\n  }\r\n\r\n  function levenshteinDistance(a: string, b: string): number {\r\n    const matrix: number[][] = []\r\n\r\n    // Initialize matrix\r\n    for (let i = 0; i <= b.length; i++) {\r\n      matrix[i] = [i]\r\n    }\r\n\r\n    for (let j = 0; j <= a.length; j++) {\r\n      matrix[0][j] = j\r\n    }\r\n\r\n    // Calculate distances\r\n    for (let i = 1; i <= b.length; i++) {\r\n      for (let j = 1; j <= a.length; j++) {\r\n        if (b.charAt(i - 1) === a.charAt(j - 1)) {\r\n          matrix[i][j] = matrix[i - 1][j - 1]\r\n        } else {\r\n          matrix[i][j] = Math.min(\r\n            matrix[i - 1][j - 1] + 1, // substitution\r\n            matrix[i][j - 1] + 1,      // insertion\r\n            matrix[i - 1][j] + 1       // deletion\r\n          )\r\n        }\r\n      }\r\n    }\r\n\r\n    return matrix[b.length][a.length]\r\n  }\r\n\r\n  function goToNextResult() {\r\n    if (currentResultIndex.value < searchResults.value.length - 1) {\r\n      currentResultIndex.value++\r\n    }\r\n  }\r\n\r\n  function goToPreviousResult() {\r\n    if (currentResultIndex.value > 0) {\r\n      currentResultIndex.value--\r\n    }\r\n  }\r\n\r\n  function clearSearch() {\r\n    searchTerm.value = ''\r\n    searchResults.value = []\r\n    currentResultIndex.value = -1\r\n  }\r\n\r\n  function isSearchMatch(rowId: string, columnName: string): boolean {\r\n    return searchResults.value.some(\r\n      m => m.rowId === rowId && m.columnName === columnName\r\n    )\r\n  }\r\n\r\n  return {\r\n    searchTerm,\r\n    searchMode,\r\n    searchResults,\r\n    currentResultIndex,\r\n    searchInRows,\r\n    goToNextResult,\r\n    goToPreviousResult,\r\n    clearSearch,\r\n    isSearchMatch\r\n  }\r\n}\r\n","import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\nimport { useFiltering, type FilterExpression } from '@/composables/useFiltering'\r\nimport { useSearch } from '@/composables/useSearch'\r\n\r\nexport interface GridCell {\r\n  rowId: string\r\n  columnName: string\r\n  value: any\r\n  isSelected: boolean\r\n  isValidationError: boolean\r\n  validationMessage?: string\r\n}\r\n\r\nexport interface GridRow {\r\n  rowId: string\r\n  rowIndex: number\r\n  height: number\r\n  cells: GridCell[]\r\n  validationErrorCount?: number  // Track validation errors for DynamicScroller size-dependencies\r\n}\r\n\r\nexport interface GridColumn {\r\n  name: string\r\n  header: string\r\n  width: number\r\n  minWidth: number\r\n  maxWidth: number\r\n  isVisible: boolean\r\n  isReadOnly: boolean\r\n  isSortable: boolean\r\n  isFilterable: boolean\r\n  autoWidth?: boolean  // Star sizing - column expands to fill remaining space\r\n  specialType?: 'RowNumber' | 'Checkbox' | 'ValidationAlerts' | 'DeleteRow' | 'InsertRow'\r\n  dataType?: 'string' | 'number' | 'boolean' | 'date' | 'datetime' | 'time'  // Data type for validation and formatting\r\n  visibleForGrid?: boolean  // Default: true. If false, column holds data but is not shown in UI, validation, filter, or sort\r\n}\r\n\r\nexport interface GridConfig {\r\n  pageSize: number\r\n  pageSizeOptions?: number[]\r\n  enableSort: boolean\r\n  enableFilter: boolean\r\n  enableSearch: boolean\r\n  enableValidation: boolean\r\n  autoValidate: boolean  // true = validate on every change, false = validate only on manual request\r\n  showRowNumber: boolean\r\n  showCheckbox: boolean\r\n  showValidationAlerts: boolean\r\n  showDeleteButton: boolean\r\n  showInsertButton: boolean\r\n  minRowHeight?: number  // Minimum row height in pixels (default: 25)\r\n}\r\n\r\nexport const useDataGridStore = (storeId: string = 'dataGrid') => {\r\n  if (!storeId || typeof storeId !== 'string') {\r\n    console.error('[useDataGridStore] Invalid storeId:', storeId)\r\n    throw new Error(`Invalid storeId: ${storeId}`)\r\n  }\r\n\r\n  console.log('[useDataGridStore] Creating store definition for:', storeId)\r\n  const storeDefinition = defineStore(storeId, () => {\r\n  // State\r\n  //  RIEENIE E: Map-based storage for O(1) lookup and thread-safety\r\n  const rowsMap = ref<Map<string, GridRow>>(new Map())  // O(1) lookup by rowId\r\n  const rowsOrder = ref<string[]>([])  // Maintain insertion order for rendering\r\n\r\n  const columns = ref<GridColumn[]>([])\r\n  const selectedCells = ref<Set<string>>(new Set())\r\n  const checkedRows = ref<string[]>([])\r\n  const pageSize = ref(100)\r\n  const currentPage = ref(1)\r\n\r\n  //  RIEENIE E: Map-based storage for sortColumns (O(1) lookup)\r\n  const sortColumnsMap = ref<Map<string, { direction: 'asc' | 'desc'; order: number }>>(new Map())\r\n  const sortColumnsOrder = ref<string[]>([])  // Maintain sort order\r\n\r\n  const filterExpression = ref<FilterExpression | null>(null)\r\n  const searchQuery = ref('')\r\n  const config = ref<GridConfig>({\r\n    pageSize: 100,\r\n    enableSort: true,\r\n    enableFilter: true,\r\n    enableSearch: true,\r\n    enableValidation: true,\r\n    autoValidate: true,  // Default: validate automatically on every change\r\n    showRowNumber: false,\r\n    showCheckbox: false,\r\n    showValidationAlerts: true,\r\n    showDeleteButton: false,\r\n    showInsertButton: false\r\n  })\r\n\r\n  // Selection state (based on WinUI3 patterns)\r\n  const pressedCell = ref<{ rowId: string; columnName: string } | null>(null)\r\n  const isDragging = ref(false)\r\n  const wasCtrlPressed = ref(false)\r\n\r\n  // Auto row height state\r\n  const isAutoRowHeightEnabled = ref(false)\r\n\r\n  // Validation tracking state (for optimized validation)\r\n  const validatedCells = ref<Set<string>>(new Set())  // Cells that have been validated: \"rowId:columnName\"\r\n  const changedCellsSinceValidation = ref<Set<string>>(new Set())  // Cells changed since last validation\r\n\r\n  // Minimum rows configuration (ensures table always has visible rows)\r\n  const minRows = ref<number>(5)  // Default minimum: 5 empty rows\r\n\r\n  //  RIEENIE E: Computed properties - convert Map to Array for rendering\r\n  const rows = computed(() => {\r\n    return rowsOrder.value.map(rowId => rowsMap.value.get(rowId)!).filter(Boolean)\r\n  })\r\n\r\n  const sortColumns = computed(() => {\r\n    return sortColumnsOrder.value.map(columnName => {\r\n      const sortInfo = sortColumnsMap.value.get(columnName)!\r\n      return {\r\n        columnName,\r\n        direction: sortInfo.direction\r\n      }\r\n    })\r\n  })\r\n\r\n  //  RIEENIE E: Helper functions for O(1) access\r\n  function getRow(rowId: string): GridRow | undefined {\r\n    return rowsMap.value.get(rowId)\r\n  }\r\n\r\n  function hasRow(rowId: string): boolean {\r\n    return rowsMap.value.has(rowId)\r\n  }\r\n\r\n  function getSortInfo(columnName: string) {\r\n    return sortColumnsMap.value.get(columnName) ?? null\r\n  }\r\n\r\n  // Composables\r\n  const { filterRows, evaluateFilter } = useFiltering()\r\n  const { searchResults, isSearchMatch } = useSearch(rows)\r\n\r\n  // Computed\r\n  const totalRows = computed(() => rowsOrder.value.length)\r\n  const totalPages = computed(() => Math.ceil(totalRows.value / pageSize.value))\r\n\r\n  const visibleRows = computed(() => {\r\n    let filteredRows = rows.value\r\n\r\n    // Apply filtering\r\n    if (filterExpression.value) {\r\n      //  FIX: Pass store interface so filterRows can access checkbox state\r\n      const storeInterface = {\r\n        checkedRows: checkedRows.value,\r\n        isRowChecked: (rowId: string) => checkedRows.value.includes(rowId)\r\n      }\r\n      filteredRows = filterRows(filteredRows, filterExpression.value, storeInterface)\r\n    }\r\n\r\n    // Apply search filtering\r\n    if (searchQuery.value && searchResults.value.length > 0) {\r\n      const searchRowIds = new Set(searchResults.value.map(r => r.rowId))\r\n      filteredRows = filteredRows.filter(row => searchRowIds.has(row.rowId))\r\n    }\r\n\r\n    // Apply sorting\r\n    if (sortColumns.value.length > 0) {\r\n      filteredRows = sortRows(filteredRows, sortColumns.value)\r\n    }\r\n\r\n    // Apply pagination\r\n    const start = (currentPage.value - 1) * pageSize.value\r\n    const end = start + pageSize.value\r\n    return filteredRows.slice(start, end)\r\n  })\r\n\r\n  // Helper: Create empty row with all columns\r\n  function createEmptyRow(rowIndex: number): GridRow {\r\n    const rowId = `empty-${generateULID()}`\r\n    return {\r\n      rowId,\r\n      rowIndex,\r\n      height: config.value.minRowHeight || 25,\r\n      cells: columns.value.map(col => ({\r\n        rowId,\r\n        columnName: col.name,\r\n        value: null,\r\n        isSelected: false,\r\n        isValidationError: false\r\n      }))\r\n    }\r\n  }\r\n\r\n  // Helper: Ensure minimum number of rows\r\n  function ensureMinimumRows() {\r\n    const currentRowCount = rowsOrder.value.length\r\n    const minimumRequired = minRows.value\r\n\r\n    if (currentRowCount < minimumRequired) {\r\n      const rowsToAdd = minimumRequired - currentRowCount\r\n      console.log(`[dataGridStore] ensureMinimumRows: Adding ${rowsToAdd} empty rows (current: ${currentRowCount}, min: ${minimumRequired})`)\r\n\r\n      for (let i = 0; i < rowsToAdd; i++) {\r\n        const row = createEmptyRow(currentRowCount + i)\r\n        rowsMap.value.set(row.rowId, row)\r\n        rowsOrder.value.push(row.rowId)\r\n      }\r\n    }\r\n  }\r\n\r\n  // Actions\r\n  //  RIEENIE E: loadRows using Map structure\r\n  function loadRows(data: Record<string, any>[]) {\r\n    console.log('[dataGridStore] loadRows:', {\r\n      rowCount: data.length,\r\n      columnCount: columns.value.length,\r\n      autoValidate: config.value.autoValidate\r\n    })\r\n\r\n    const newMap = new Map<string, GridRow>()\r\n    const newOrder: string[] = []\r\n\r\n    data.forEach((rowData, idx) => {\r\n      const rowId = rowData.__rowId || generateULID()\r\n      const height = rowData.__rowHeight || 40\r\n\r\n      const row: GridRow = {\r\n        rowId,\r\n        rowIndex: idx,\r\n        height,\r\n        cells: columns.value.map(col => ({\r\n          rowId,\r\n          columnName: col.name,\r\n          value: rowData[col.name],\r\n          isSelected: false,\r\n          isValidationError: false\r\n        }))\r\n      }\r\n\r\n      newMap.set(rowId, row)  //  O(1) insert\r\n      newOrder.push(rowId)\r\n    })\r\n\r\n    rowsMap.value = newMap\r\n    rowsOrder.value = newOrder\r\n\r\n    // Ensure minimum rows after loading\r\n    ensureMinimumRows()\r\n\r\n    console.log('[dataGridStore] loadRows complete:', {\r\n      loadedRows: rowsOrder.value.length,\r\n      minRowsRequired: minRows.value,\r\n      firstRowId: rowsOrder.value[0],\r\n      firstRowCells: newMap.get(rowsOrder.value[0])?.cells.length\r\n    })\r\n  }\r\n\r\n  //  RIEENIE E: updateCell using O(1) Map.get()\r\n  function updateCell(rowId: string, columnName: string, value: any) {\r\n    const row = getRow(rowId)  //  O(1) instead of O(n)\r\n    if (row) {\r\n      const cell = row.cells.find(c => c.columnName === columnName)\r\n      if (cell) {\r\n        const oldValue = cell.value\r\n        cell.value = value\r\n\r\n        console.log('[dataGridStore] updateCell:', {\r\n          rowId,\r\n          columnName,\r\n          oldValue,\r\n          newValue: value,\r\n          autoValidate: config.value.autoValidate\r\n        })\r\n\r\n        // Mark cell as changed for validation tracking\r\n        const cellKey = `${rowId}:${columnName}`\r\n        changedCellsSinceValidation.value.add(cellKey)\r\n      } else {\r\n        console.warn('[dataGridStore] updateCell: cell not found', { rowId, columnName })\r\n      }\r\n    } else {\r\n      console.warn('[dataGridStore] updateCell: row not found', { rowId })\r\n    }\r\n  }\r\n\r\n  //  RIEENIE E: updateRowHeight using O(1) Map.get()\r\n  function updateRowHeight(rowId: string, newHeight: number) {\r\n    const row = getRow(rowId)  //  O(1) instead of O(n)\r\n    if (row) {\r\n      const oldHeight = row.height\r\n      row.height = newHeight\r\n\r\n      console.log('[dataGridStore] updateRowHeight:', {\r\n        rowId,\r\n        oldHeight,\r\n        newHeight,\r\n        autoRowHeightEnabled: isAutoRowHeightEnabled.value\r\n      })\r\n    } else {\r\n      console.warn('[dataGridStore] updateRowHeight: row not found', { rowId })\r\n    }\r\n  }\r\n\r\n  function setAutoRowHeightEnabled(enabled: boolean) {\r\n    console.log(`[dataGridStore] setAutoRowHeightEnabled: oldValue=${isAutoRowHeightEnabled.value}, newValue=${enabled}`)\r\n    isAutoRowHeightEnabled.value = enabled\r\n  }\r\n\r\n  function sortRows(rowsToSort: GridRow[], sorts: { columnName: string; direction: 'asc' | 'desc' }[]) {\r\n    if (sorts.length === 0) return rowsToSort\r\n\r\n    return [...rowsToSort].sort((a, b) => {\r\n      for (const { columnName, direction } of sorts) {\r\n        const aCell = a.cells.find(c => c.columnName === columnName)\r\n        const bCell = b.cells.find(c => c.columnName === columnName)\r\n\r\n        const aVal = aCell?.value\r\n        const bVal = bCell?.value\r\n\r\n        const cmp = compareValues(aVal, bVal)\r\n        if (cmp !== 0) {\r\n          return direction === 'asc' ? cmp : -cmp\r\n        }\r\n      }\r\n      return 0\r\n    })\r\n  }\r\n\r\n  function compareValues(a: any, b: any): number {\r\n    if (a == null && b == null) return 0\r\n    if (a == null) return -1\r\n    if (b == null) return 1\r\n\r\n    if (typeof a === 'number' && typeof b === 'number') {\r\n      return a - b\r\n    }\r\n\r\n    return String(a).localeCompare(String(b))\r\n  }\r\n\r\n  //  RIEENIE E: addSort using Map - O(1) lookup instead of O(n) findIndex\r\n  function addSort(columnName: string, direction: 'asc' | 'desc', multiSort = false) {\r\n    if (!multiSort) {\r\n      // Single sort - clear all and add new\r\n      sortColumnsMap.value.clear()\r\n      sortColumnsOrder.value = [columnName]\r\n      sortColumnsMap.value.set(columnName, { direction, order: 1 })\r\n    } else {\r\n      // Multi-sort\r\n      if (sortColumnsMap.value.has(columnName)) {\r\n        // Update existing - keep same order\r\n        const existing = sortColumnsMap.value.get(columnName)!\r\n        sortColumnsMap.value.set(columnName, { direction, order: existing.order })\r\n      } else {\r\n        // Add new - append to end\r\n        const newOrder = sortColumnsOrder.value.length + 1\r\n        sortColumnsMap.value.set(columnName, { direction, order: newOrder })\r\n        sortColumnsOrder.value.push(columnName)\r\n      }\r\n    }\r\n  }\r\n\r\n  function clearSort() {\r\n    sortColumnsMap.value.clear()\r\n    sortColumnsOrder.value = []\r\n  }\r\n\r\n  function setSortColumns(sorts: { columnName: string; direction: 'asc' | 'desc' }[]) {\r\n    sortColumnsMap.value.clear()\r\n    sortColumnsOrder.value = []\r\n    sorts.forEach((sort, index) => {\r\n      sortColumnsMap.value.set(sort.columnName, { direction: sort.direction, order: index + 1 })\r\n      sortColumnsOrder.value.push(sort.columnName)\r\n    })\r\n  }\r\n\r\n  function setPageSize(size: number) {\r\n    pageSize.value = size\r\n    currentPage.value = 1 // Reset to first page\r\n  }\r\n\r\n  function goToPage(page: number) {\r\n    if (page >= 1 && page <= totalPages.value) {\r\n      currentPage.value = page\r\n    }\r\n  }\r\n\r\n  function generateULID(): string {\r\n    // Simple ULID-like generator\r\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`\r\n  }\r\n\r\n  //  RIEENIE E: deleteRow using Map.delete() - O(1)\r\n  function deleteRow(rowId: string) {\r\n    if (hasRow(rowId)) {\r\n      console.log('[dataGridStore] deleteRow:', {\r\n        rowId,\r\n        rowsBefore: rowsOrder.value.length,\r\n        wasChecked: checkedRows.value.includes(rowId)\r\n      })\r\n\r\n      rowsMap.value.delete(rowId)  //  O(1) delete from Map\r\n      rowsOrder.value = rowsOrder.value.filter(id => id !== rowId)  //  O(n) but only on string[]\r\n\r\n      // Remove from checked rows\r\n      const checkedIndex = checkedRows.value.indexOf(rowId)\r\n      if (checkedIndex > -1) {\r\n        checkedRows.value.splice(checkedIndex, 1)\r\n      }\r\n\r\n      // Reindex rows (update rowIndex in remaining rows)\r\n      rowsOrder.value.forEach((id, idx) => {\r\n        const row = rowsMap.value.get(id)\r\n        if (row) {\r\n          row.rowIndex = idx\r\n        }\r\n      })\r\n\r\n      console.log('[dataGridStore] deleteRow complete:', {\r\n        rowsAfter: rowsOrder.value.length\r\n      })\r\n    } else {\r\n      console.warn('[dataGridStore] deleteRow: row not found', { rowId })\r\n    }\r\n  }\r\n\r\n  //  RIEENIE E: insertRow using Map - O(n) only for indexOf on string[]\r\n  function insertRow(afterRowId: string) {\r\n    const index = rowsOrder.value.indexOf(afterRowId)  //  O(n) but on string[] (fast)\r\n    const newRowId = generateULID()\r\n\r\n    console.log('[dataGridStore] insertRow:', {\r\n      afterRowId,\r\n      index,\r\n      newRowId,\r\n      rowsBefore: rowsOrder.value.length\r\n    })\r\n\r\n    const newRow: GridRow = {\r\n      rowId: newRowId,\r\n      rowIndex: index + 1,\r\n      height: 32,\r\n      cells: columns.value\r\n        .filter(col => !col.specialType)\r\n        .map(col => ({\r\n          rowId: newRowId,\r\n          columnName: col.name,\r\n          value: null,\r\n          isSelected: false,\r\n          isValidationError: false\r\n        }))\r\n    }\r\n\r\n    rowsMap.value.set(newRowId, newRow)  //  O(1) insert into Map\r\n    rowsOrder.value.splice(index + 1, 0, newRowId)  //  O(1) insert into order array\r\n\r\n    // Reindex rows\r\n    rowsOrder.value.forEach((id, idx) => {\r\n      const row = rowsMap.value.get(id)\r\n      if (row) {\r\n        row.rowIndex = idx\r\n      }\r\n    })\r\n\r\n    console.log('[dataGridStore] insertRow complete:', {\r\n      rowsAfter: rowsOrder.value.length\r\n    })\r\n  }\r\n\r\n  //  RIEENIE E: insertMultipleRows using Map\r\n  function insertMultipleRows(rowId: string, count: number, position: 'above' | 'below') {\r\n    const index = rowsOrder.value.indexOf(rowId)\r\n    if (index === -1) {\r\n      console.warn('[dataGridStore] insertMultipleRows: row not found', { rowId })\r\n      return\r\n    }\r\n\r\n    console.log('[dataGridStore] insertMultipleRows:', {\r\n      rowId,\r\n      count,\r\n      position,\r\n      index,\r\n      rowsBefore: rowsOrder.value.length\r\n    })\r\n\r\n    const insertIndex = position === 'above' ? index : index + 1\r\n    const newRowIds: string[] = []\r\n\r\n    for (let i = 0; i < count; i++) {\r\n      const newRowId = generateULID()\r\n      const newRow: GridRow = {\r\n        rowId: newRowId,\r\n        rowIndex: insertIndex + i,\r\n        height: 32,\r\n        cells: columns.value\r\n          .filter(col => !col.specialType)\r\n          .map(col => ({\r\n            rowId: newRowId,\r\n            columnName: col.name,\r\n            value: null,\r\n            isSelected: false,\r\n            isValidationError: false\r\n          }))\r\n      }\r\n\r\n      rowsMap.value.set(newRowId, newRow)  //  O(1) per row\r\n      newRowIds.push(newRowId)\r\n    }\r\n\r\n    rowsOrder.value.splice(insertIndex, 0, ...newRowIds)  //  O(n) splice on string[]\r\n\r\n    // Reindex rows\r\n    rowsOrder.value.forEach((id, idx) => {\r\n      const row = rowsMap.value.get(id)\r\n      if (row) {\r\n        row.rowIndex = idx\r\n      }\r\n    })\r\n\r\n    console.log('[dataGridStore] insertMultipleRows complete:', {\r\n      rowsAfter: rowsOrder.value.length,\r\n      newRowIds\r\n    })\r\n  }\r\n\r\n  function toggleCheckbox(rowId: string, checked: boolean) {\r\n    console.log('[toggleCheckbox] Called:', { rowId, checked, currentCount: checkedRows.value.length })\r\n    if (checked) {\r\n      if (!checkedRows.value.includes(rowId)) {\r\n        checkedRows.value.push(rowId)\r\n      }\r\n    } else {\r\n      const index = checkedRows.value.indexOf(rowId)\r\n      if (index > -1) {\r\n        checkedRows.value.splice(index, 1)\r\n      }\r\n    }\r\n    console.log('[toggleCheckbox] After:', { count: checkedRows.value.length, checkboxState: checkboxState.value })\r\n  }\r\n\r\n  function isRowChecked(rowId: string): boolean {\r\n    return checkedRows.value.includes(rowId)\r\n  }\r\n\r\n  function toggleAllCheckboxes() {\r\n    const currentCount = checkedRows.value.length\r\n    const totalCount = rows.value.length\r\n    console.log('[toggleAllCheckboxes] BEFORE:', { currentCount, totalCount, checkboxState: checkboxState.value })\r\n\r\n    if (checkedRows.value.length === rows.value.length) {\r\n      // All checked -> uncheck all\r\n      console.log('[toggleAllCheckboxes] ACTION: Unchecking all (was all checked)')\r\n      checkedRows.value = []\r\n    } else {\r\n      // Not all checked -> check all\r\n      console.log('[toggleAllCheckboxes] ACTION: Checking all (was not all checked)')\r\n      checkedRows.value = rows.value.map(r => r.rowId)\r\n    }\r\n\r\n    const newCount = checkedRows.value.length\r\n    const newState = checkboxState.value\r\n    console.log('[toggleAllCheckboxes] AFTER:', { newCount, totalCount, newState })\r\n  }\r\n\r\n  // Computed for better reactivity tracking\r\n  const checkboxState = computed(() => {\r\n    const checkedCount = checkedRows.value.length\r\n    if (checkedCount === 0) return 'none'\r\n    if (checkedCount === rows.value.length) return 'all'\r\n    return 'some'\r\n  })\r\n\r\n  function setConfig(newConfig: Partial<GridConfig>) {\r\n    console.log('[dataGridStore] setConfig:', {\r\n      newConfig,\r\n      oldAutoValidate: config.value.autoValidate,\r\n      newAutoValidate: newConfig.autoValidate\r\n    })\r\n\r\n    config.value = { ...config.value, ...newConfig }\r\n    if (newConfig.pageSize) {\r\n      pageSize.value = newConfig.pageSize\r\n    }\r\n\r\n    console.log('[dataGridStore] setConfig complete:', {\r\n      autoValidate: config.value.autoValidate,\r\n      enableValidation: config.value.enableValidation\r\n    })\r\n  }\r\n\r\n  function initializeEmptyRows(count?: number) {\r\n    const rowCount = count || pageSize.value\r\n    console.log('[dataGridStore] initializeEmptyRows:', {\r\n      requestedCount: count,\r\n      rowCount,\r\n      currentRowsLength: rows.value.length,\r\n      columnsLength: columns.value.length\r\n    })\r\n\r\n    //  Use Map-based storage like loadRows()\r\n    const newMap = new Map<string, GridRow>()\r\n    const newOrder: string[] = []\r\n\r\n    for (let i = 0; i < rowCount; i++) {\r\n      const rowId = generateULID()\r\n      const row: GridRow = {\r\n        rowId,\r\n        rowIndex: i,\r\n        height: 32,\r\n        cells: columns.value\r\n          .filter(col => !col.specialType) // Don't create cells for special columns\r\n          .map(col => ({\r\n            rowId,\r\n            columnName: col.name,\r\n            value: null,\r\n            isSelected: false,\r\n            isValidationError: false\r\n          }))\r\n      }\r\n\r\n      newMap.set(rowId, row)\r\n      newOrder.push(rowId)\r\n    }\r\n\r\n    //  CORRECT: Update rowsMap and rowsOrder (not the computed property 'rows')\r\n    rowsMap.value = newMap\r\n    rowsOrder.value = newOrder\r\n\r\n    console.log('[dataGridStore] initializeEmptyRows complete:', {\r\n      newRowsLength: rows.value.length,\r\n      firstRowCellsCount: rows.value[0]?.cells?.length\r\n    })\r\n  }\r\n\r\n  function setFilter(filter: FilterExpression | null) {\r\n    console.log('[dataGridStore] setFilter:', { filter })\r\n    filterExpression.value = filter\r\n  }\r\n\r\n  function clearFilter() {\r\n    console.log('[dataGridStore] clearFilter')\r\n    filterExpression.value = null\r\n  }\r\n\r\n  function setSearchQuery(query: string) {\r\n    searchQuery.value = query\r\n  }\r\n\r\n  function clearSearch() {\r\n    searchQuery.value = ''\r\n  }\r\n\r\n  // Selection methods (based on WinUI3 patterns)\r\n  function selectCell(rowId: string, columnName: string, isCtrlPressed: boolean) {\r\n    const cellKey = `${rowId}:${columnName}`\r\n\r\n    console.log('[dataGridStore] selectCell:', {\r\n      rowId,\r\n      columnName,\r\n      isCtrlPressed,\r\n      wasSelected: selectedCells.value.has(cellKey),\r\n      currentSelectionCount: selectedCells.value.size\r\n    })\r\n\r\n    if (isCtrlPressed) {\r\n      // Ctrl+Click: Toggle selection\r\n      wasCtrlPressed.value = true\r\n      pressedCell.value = null // Disable drag for Ctrl+Click\r\n      isDragging.value = false\r\n\r\n      if (selectedCells.value.has(cellKey)) {\r\n        selectedCells.value.delete(cellKey)\r\n        console.log('[dataGridStore] selectCell: toggled OFF', { cellKey })\r\n      } else {\r\n        selectedCells.value.add(cellKey)\r\n        console.log('[dataGridStore] selectCell: toggled ON', { cellKey })\r\n      }\r\n    } else {\r\n      // Normal Click: Clear previous selection and select this cell\r\n      wasCtrlPressed.value = false\r\n      pressedCell.value = { rowId, columnName } // Enable drag selection\r\n      isDragging.value = false\r\n\r\n      selectedCells.value.clear()\r\n      selectedCells.value.add(cellKey)\r\n      console.log('[dataGridStore] selectCell: single select', { cellKey })\r\n    }\r\n\r\n    console.log('[dataGridStore] selectCell complete:', {\r\n      newSelectionCount: selectedCells.value.size\r\n    })\r\n  }\r\n\r\n  function startDragSelection(rowId: string, columnName: string) {\r\n    if (!pressedCell.value) return\r\n\r\n    isDragging.value = true\r\n\r\n    // Clear previous selection and select range from pressedCell to current cell\r\n    selectedCells.value.clear()\r\n    expandDragSelection(rowId, columnName)\r\n  }\r\n\r\n  function expandDragSelection(currentRowId: string, currentColumnName: string) {\r\n    if (!pressedCell.value || !isDragging.value) return\r\n\r\n    console.log('[dataGridStore] expandDragSelection:', {\r\n      pressedCell: pressedCell.value,\r\n      currentRowId,\r\n      currentColumnName\r\n    })\r\n\r\n    const pressedRowIndex = rows.value.findIndex(r => r.rowId === pressedCell.value!.rowId)\r\n    const currentRowIndex = rows.value.findIndex(r => r.rowId === currentRowId)\r\n\r\n    if (pressedRowIndex === -1 || currentRowIndex === -1) return\r\n\r\n    // Get selectable column names (data columns + validation, excluding insert/delete/checkbox/rownumber)\r\n    const selectableColumns = columns.value.filter(col =>\r\n      !col.specialType || col.specialType === 'ValidationAlerts'\r\n    ).map(col => col.name)\r\n\r\n    console.log('[dataGridStore] expandDragSelection: selectableColumns', {\r\n      total: selectableColumns.length,\r\n      columns: selectableColumns\r\n    })\r\n\r\n    const pressedColIndex = selectableColumns.indexOf(pressedCell.value.columnName)\r\n    const currentColIndex = selectableColumns.indexOf(currentColumnName)\r\n\r\n    if (pressedColIndex === -1 || currentColIndex === -1) {\r\n      console.warn('[dataGridStore] expandDragSelection: column not found in selectableColumns', {\r\n        pressedColumn: pressedCell.value.columnName,\r\n        currentColumn: currentColumnName,\r\n        pressedColIndex,\r\n        currentColIndex\r\n      })\r\n      return\r\n    }\r\n\r\n    // Calculate rectangular selection bounds\r\n    const startRowIndex = Math.min(pressedRowIndex, currentRowIndex)\r\n    const endRowIndex = Math.max(pressedRowIndex, currentRowIndex)\r\n    const startColIndex = Math.min(pressedColIndex, currentColIndex)\r\n    const endColIndex = Math.max(pressedColIndex, currentColIndex)\r\n\r\n    console.log('[dataGridStore] expandDragSelection: bounds', {\r\n      rowRange: [startRowIndex, endRowIndex],\r\n      colRange: [startColIndex, endColIndex],\r\n      cellsToSelect: (endRowIndex - startRowIndex + 1) * (endColIndex - startColIndex + 1)\r\n    })\r\n\r\n    // Clear and select all cells in the rectangular range\r\n    selectedCells.value.clear()\r\n    for (let rowIdx = startRowIndex; rowIdx <= endRowIndex; rowIdx++) {\r\n      const rowId = rows.value[rowIdx].rowId\r\n      for (let colIdx = startColIndex; colIdx <= endColIndex; colIdx++) {\r\n        const columnName = selectableColumns[colIdx]\r\n        const cellKey = `${rowId}:${columnName}`\r\n        selectedCells.value.add(cellKey)\r\n      }\r\n    }\r\n\r\n    console.log('[dataGridStore] expandDragSelection complete:', {\r\n      selectedCellsCount: selectedCells.value.size\r\n    })\r\n  }\r\n\r\n  function endDragSelection() {\r\n    pressedCell.value = null\r\n    isDragging.value = false\r\n  }\r\n\r\n  function isCellSelected(rowId: string, columnName: string): boolean {\r\n    const cellKey = `${rowId}:${columnName}`\r\n    return selectedCells.value.has(cellKey)\r\n  }\r\n\r\n  /**\r\n   * Reserved special column names that cannot be used for data columns\r\n   */\r\n  const SPECIAL_COLUMN_NAMES = [\r\n    '__rowNumber',\r\n    '__checkbox',\r\n    '__validationAlerts',\r\n    '__deleteRow',\r\n    '__insertRow'\r\n  ]\r\n\r\n  /**\r\n   * Sets columns with validation and duplicate name handling\r\n   * @throws Error if any column name conflicts with special column names\r\n   */\r\n  function setColumns(inputColumns: GridColumn[]) {\r\n    // Check for conflicts with special column names\r\n    const conflicts = inputColumns\r\n      .filter(col => !col.specialType) // Only check data columns\r\n      .filter(col => SPECIAL_COLUMN_NAMES.includes(col.name))\r\n      .map(col => col.name)\r\n\r\n    if (conflicts.length > 0) {\r\n      throw new Error(\r\n        `Column name conflict: The following column names are reserved for special columns and cannot be used: ${conflicts.join(', ')}. ` +\r\n        `Reserved names: ${SPECIAL_COLUMN_NAMES.join(', ')}`\r\n      )\r\n    }\r\n\r\n    // Ensure unique column names (rename duplicates)\r\n    const uniqueColumns = ensureUniqueColumnNames(inputColumns)\r\n    columns.value = uniqueColumns\r\n\r\n    console.log('[dataGridStore] setColumns:', {\r\n      originalCount: inputColumns.length,\r\n      uniqueCount: uniqueColumns.length,\r\n      columnNames: uniqueColumns.map(c => c.name)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Ensures all column names are unique by appending _1, _2, _3 etc. to duplicates\r\n   * Example: [priezvisko, meno, priezvisko, mesto, priezvisko]\r\n   *       -> [priezvisko_1, meno, priezvisko_2, mesto, priezvisko_3]\r\n   */\r\n  function ensureUniqueColumnNames(inputColumns: GridColumn[]): GridColumn[] {\r\n    const nameCounts = new Map<string, number>()\r\n\r\n    return inputColumns.map(col => {\r\n      const originalName = col.name\r\n      const count = nameCounts.get(originalName) || 0\r\n      nameCounts.set(originalName, count + 1)\r\n\r\n      if (count > 0) {\r\n        // This is a duplicate - append _N\r\n        return {\r\n          ...col,\r\n          name: `${originalName}_${count + 1}`\r\n        }\r\n      }\r\n\r\n      // First occurrence - keep original name but mark it as _1 if there will be duplicates\r\n      return col\r\n    }).map((col, index, arr) => {\r\n      const originalName = col.name.replace(/_\\d+$/, '') // Remove any _N suffix\r\n      const duplicateCount = arr.filter(c =>\r\n        c.name === originalName || c.name.startsWith(`${originalName}_`)\r\n      ).length\r\n\r\n      if (duplicateCount > 1 && col.name === originalName) {\r\n        // First occurrence of a duplicate - rename to _1\r\n        return { ...col, name: `${originalName}_1` }\r\n      }\r\n\r\n      return col\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Checks if all non-empty rows have valid cells (no validation errors)\r\n   * A row is considered empty if ALL its cells are null/empty\r\n   * Returns true if all non-empty rows are valid\r\n   */\r\n  function areNonEmptyRowsValid(): boolean {\r\n    for (const row of rows.value) {\r\n      // Check if row is empty (all cells null/empty)\r\n      const isEmpty = row.cells.every(cell =>\r\n        cell.value === null ||\r\n        cell.value === undefined ||\r\n        cell.value === ''\r\n      )\r\n\r\n      if (isEmpty) {\r\n        continue // Skip empty rows\r\n      }\r\n\r\n      // Row is not empty - check if any cell has validation error\r\n      const hasError = row.cells.some(cell => cell.isValidationError)\r\n\r\n      if (hasError) {\r\n        return false // Found a non-empty row with validation error\r\n      }\r\n    }\r\n\r\n    return true // All non-empty rows are valid\r\n  }\r\n\r\n  /**\r\n   * Marks a cell as validated\r\n   */\r\n  function markCellValidated(rowId: string, columnName: string) {\r\n    const cellKey = `${rowId}:${columnName}`\r\n    console.log('[dataGridStore] markCellValidated:', {\r\n      rowId,\r\n      columnName,\r\n      cellKey,\r\n      validatedCount: validatedCells.value.size\r\n    })\r\n    validatedCells.value.add(cellKey)\r\n    changedCellsSinceValidation.value.delete(cellKey)\r\n  }\r\n\r\n  /**\r\n   * Clears all validation tracking (e.g., when loading new data)\r\n   */\r\n  function clearValidationTracking() {\r\n    console.log('[dataGridStore] clearValidationTracking:', {\r\n      clearedValidatedCount: validatedCells.value.size,\r\n      clearedChangedCount: changedCellsSinceValidation.value.size\r\n    })\r\n    validatedCells.value.clear()\r\n    changedCellsSinceValidation.value.clear()\r\n  }\r\n\r\n  /**\r\n   * Gets cells that need validation (unvalidated or changed since last validation)\r\n   * SOLUTION 2: Enhanced logging to debug validation tracking\r\n   */\r\n  function getCellsNeedingValidation(forceValidateAll = false): { rowId: string; columnName: string }[] {\r\n    console.log('[getCellsNeedingValidation]  START', {\r\n      totalRows: rows.value.length,\r\n      validatedCellsCount: validatedCells.value.size,\r\n      changedCellsCount: changedCellsSinceValidation.value.size,\r\n      forceValidateAll\r\n    })\r\n\r\n    // Get columns that should be validated (visibleForGrid !== false)\r\n    const columnsToValidate = new Set(\r\n      columns.value\r\n        .filter(col => col.visibleForGrid !== false)\r\n        .map(col => col.name)\r\n    )\r\n\r\n    const cellsToValidate: { rowId: string; columnName: string }[] = []\r\n    let emptyRowsSkipped = 0\r\n    let alreadyValidatedCells = 0\r\n    let changedCells = 0\r\n    let neverValidatedCells = 0\r\n    let skippedInvisibleCells = 0\r\n\r\n    for (const row of rows.value) {\r\n      //  RIEENIE #5: ALWAYS skip completely empty rows (even with forceValidateAll)\r\n      const isEmpty = row.cells.every(cell =>\r\n        cell.value === null ||\r\n        cell.value === undefined ||\r\n        cell.value === ''\r\n      )\r\n\r\n      if (isEmpty) {\r\n        emptyRowsSkipped++\r\n        continue  // Skip empty rows unconditionally\r\n      }\r\n\r\n      for (const cell of row.cells) {\r\n        // Skip cells for columns with visibleForGrid=false\r\n        if (!columnsToValidate.has(cell.columnName)) {\r\n          skippedInvisibleCells++\r\n          continue\r\n        }\r\n\r\n        const cellKey = `${cell.rowId}:${cell.columnName}`\r\n        const isValidated = validatedCells.value.has(cellKey)\r\n        const isChanged = changedCellsSinceValidation.value.has(cellKey)\r\n\r\n        // With forceValidateAll=true: validate ALL cells (even if already validated and unchanged)\r\n        // With forceValidateAll=false: only validate unvalidated or changed cells\r\n        if (forceValidateAll || !isValidated || isChanged) {\r\n          cellsToValidate.push({\r\n            rowId: cell.rowId,\r\n            columnName: cell.columnName\r\n          })\r\n\r\n          // Track reason for validation\r\n          if (!isValidated) {\r\n            neverValidatedCells++\r\n          } else if (isChanged) {\r\n            changedCells++\r\n          }\r\n        } else {\r\n          alreadyValidatedCells++\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('[getCellsNeedingValidation]  RESULT:', {\r\n      cellsToValidate: cellsToValidate.length,\r\n      neverValidated: neverValidatedCells,\r\n      changedSinceValidation: changedCells,\r\n      alreadyValidated: alreadyValidatedCells,\r\n      emptyRowsSkipped: emptyRowsSkipped,\r\n      sampleCells: cellsToValidate.slice(0, 3).map(c => `${c.rowId}:${c.columnName}`)\r\n    })\r\n\r\n    return cellsToValidate\r\n  }\r\n\r\n  // Set minimum rows configuration\r\n  function setMinRows(newMinRows: number) {\r\n    if (newMinRows < 0) {\r\n      console.warn('[dataGridStore] setMinRows: Invalid value, must be >= 0:', newMinRows)\r\n      return\r\n    }\r\n    minRows.value = newMinRows\r\n    ensureMinimumRows()  // Immediately apply if current rows below new minimum\r\n    console.log(`[dataGridStore] setMinRows: ${newMinRows}`)\r\n  }\r\n\r\n  return {\r\n    // State\r\n    rows,\r\n    columns,\r\n    selectedCells,\r\n    checkedRows,\r\n    pageSize,\r\n    currentPage,\r\n    sortColumns,\r\n    filterExpression,\r\n    searchQuery,\r\n    searchResults,\r\n    config,\r\n    pressedCell,\r\n    isDragging,\r\n    wasCtrlPressed,\r\n    isAutoRowHeightEnabled,\r\n    minRows,\r\n\r\n    // Computed\r\n    visibleRows,\r\n    totalRows,\r\n    totalPages,\r\n    checkboxState,\r\n\r\n    // Actions\r\n    getRow,          //  RIEENIE #3: O(1) row lookup\r\n    loadRows,\r\n    updateCell,\r\n    updateRowHeight,\r\n    setAutoRowHeightEnabled,\r\n    addSort,\r\n    clearSort,\r\n    setSortColumns,\r\n    setPageSize,\r\n    goToPage,\r\n    deleteRow,\r\n    insertRow,\r\n    insertMultipleRows,\r\n    toggleCheckbox,\r\n    isRowChecked,\r\n    toggleAllCheckboxes,\r\n    setConfig,\r\n    initializeEmptyRows,\r\n    setFilter,\r\n    clearFilter,\r\n    setSearchQuery,\r\n    clearSearch,\r\n    selectCell,\r\n    startDragSelection,\r\n    expandDragSelection,\r\n    endDragSelection,\r\n    isCellSelected,\r\n    setColumns,\r\n    ensureUniqueColumnNames,\r\n    areNonEmptyRowsValid,\r\n    markCellValidated,\r\n    clearValidationTracking,\r\n    getCellsNeedingValidation,\r\n    setMinRows\r\n  }\r\n  })\r\n\r\n  // Return StoreDefinition - let component call it\r\n  return storeDefinition\r\n}\r\n","import { ref, reactive, nextTick } from 'vue'\r\nimport { useDebounceFn } from '@vueuse/core'\r\nimport { clog, cinfo, cerror, cwarn } from './useConditionalLogging'\r\n\r\nexport interface ValidationRule {\r\n  columnName: string\r\n  ruleType: 'Required' | 'Regex' | 'Range' | 'Custom'\r\n  errorMessage: string\r\n  regexPattern?: string\r\n  minValue?: any\r\n  maxValue?: any\r\n  severity: 'Info' | 'Warning' | 'Error' | 'Critical'\r\n  customValidator?: (value: any) => boolean\r\n}\r\n\r\nexport interface ValidationError {\r\n  rowId: string\r\n  columnName: string\r\n  message: string\r\n  severity: string\r\n}\r\n\r\nexport interface ValidationResult {\r\n  isValid: boolean\r\n  error?: string\r\n  severity?: string\r\n}\r\n\r\nexport function useValidation() {\r\n  // Each instance has its own validation state\r\n  const validationRules = ref<Map<string, ValidationRule[]>>(new Map())\r\n  // Use reactive object instead of ref<Map> for proper Vue reactivity\r\n  const validationErrors = reactive<Record<string, ValidationError[]>>({})\r\n  // SOLUTION A: Reactive counter to trigger watch in DataGrid when validation errors change\r\n  const errorCount = ref(0)\r\n  // SOLUTION B: Reactive counter to trigger watch when validation rules change (Map.set() doesn't trigger reactivity)\r\n  const ruleCount = ref(0)\r\n\r\n  // Helper function to update errorCount whenever validationErrors changes\r\n  function updateErrorCount() {\r\n    errorCount.value = Object.keys(validationErrors).length\r\n  }\r\n\r\n  function addValidationRule(rule: ValidationRule) {\r\n    const rules = validationRules.value.get(rule.columnName) || []\r\n    rules.push(rule)\r\n    validationRules.value.set(rule.columnName, rules)\r\n\r\n    console.log('[useValidation] addValidationRule:', {\r\n      columnName: rule.columnName,\r\n      ruleType: rule.ruleType,\r\n      severity: rule.severity,\r\n      totalRulesForColumn: rules.length\r\n    })\r\n    ruleCount.value++\r\n  }\r\n\r\n  function validateCell(rowId: string, columnName: string, value: any): ValidationResult {\r\n    const rules = validationRules.value.get(columnName) || []\r\n\r\n    console.log('[useValidation] validateCell:', {\r\n      rowId,\r\n      columnName,\r\n      value,\r\n      ruleCount: rules.length,\r\n      isEmpty: value == null || value === ''\r\n    })\r\n\r\n    // Check if value is empty\r\n    const isEmpty = value == null || value === ''\r\n\r\n    for (const rule of rules) {\r\n      // Required validation\r\n      if (rule.ruleType === 'Required') {\r\n        if (isEmpty) {\r\n          console.log('[useValidation] validateCell FAILED: Required', {\r\n            rowId,\r\n            columnName,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n\r\n      // Skip other validations if value is empty (only validate non-empty values)\r\n      if (isEmpty) continue\r\n\r\n      // Regex validation\r\n      if (rule.ruleType === 'Regex' && rule.regexPattern) {\r\n        const regex = new RegExp(rule.regexPattern)\r\n        if (!regex.test(String(value))) {\r\n          console.log('[useValidation] validateCell FAILED: Regex', {\r\n            rowId,\r\n            columnName,\r\n            value,\r\n            pattern: rule.regexPattern,\r\n            error: rule.errorMessage\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n\r\n      // Range validation\r\n      if (rule.ruleType === 'Range') {\r\n        const numValue = Number(value)\r\n        if (isNaN(numValue)) {\r\n          console.log('[useValidation] validateCell FAILED: Range (not a number)', {\r\n            rowId,\r\n            columnName,\r\n            value\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: 'Value must be a number',\r\n            severity: rule.severity\r\n          }\r\n        }\r\n\r\n        if (rule.minValue != null && numValue < rule.minValue) {\r\n          console.log('[useValidation] validateCell FAILED: Range (below min)', {\r\n            rowId,\r\n            columnName,\r\n            value: numValue,\r\n            minValue: rule.minValue\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n\r\n        if (rule.maxValue != null && numValue > rule.maxValue) {\r\n          console.log('[useValidation] validateCell FAILED: Range (above max)', {\r\n            rowId,\r\n            columnName,\r\n            value: numValue,\r\n            maxValue: rule.maxValue\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n\r\n      // Custom validation\r\n      if (rule.ruleType === 'Custom' && rule.customValidator) {\r\n        if (!rule.customValidator(value)) {\r\n          console.log('[useValidation] validateCell FAILED: Custom', {\r\n            rowId,\r\n            columnName,\r\n            value,\r\n            error: rule.errorMessage\r\n          })\r\n          return {\r\n            isValid: false,\r\n            error: rule.errorMessage,\r\n            severity: rule.severity\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    console.log('[useValidation] validateCell PASSED', {\r\n      rowId,\r\n      columnName,\r\n      value\r\n    })\r\n    return { isValid: true }\r\n  }\r\n\r\n  // Helper: Check if entire row is empty (all data columns have no value)\r\n  function isRowCompletelyEmpty(rowCells: Array<{ columnName: string; value: any }>): boolean {\r\n    return rowCells.every(cell => cell.value == null || cell.value === '')\r\n  }\r\n\r\n  //  RIEENIE #2: Direct validation (no debounce) for bulk operations\r\n  //  RIEENIE #2: Added skipErrorCountUpdate parameter for batch operations\r\n  function validateCellDirect(\r\n    rowId: string,\r\n    columnName: string,\r\n    value: any,\r\n    rowCells?: Array<{ columnName: string; value: any }>,\r\n    skipErrorCountUpdate = false  //  New parameter - skip updateErrorCount in batch mode\r\n  ): Promise<void> {\r\n    console.log('[useValidation] validateCellDirect:', {\r\n      rowId,\r\n      columnName,\r\n      value,\r\n      hasRowCells: !!rowCells,\r\n      rowCellsCount: rowCells?.length,\r\n      skipErrorCountUpdate\r\n    })\r\n\r\n    // If row cells provided, check if entire row is empty\r\n    if (rowCells && isRowCompletelyEmpty(rowCells)) {\r\n      console.log('[useValidation] validateCellDirect: Row is completely empty, clearing errors', {\r\n        rowId\r\n      })\r\n      // Entire row is empty - clear ALL validation errors for this row\r\n      delete validationErrors[rowId]\r\n\r\n      //  Only update error count if not in batch mode\r\n      if (!skipErrorCountUpdate) {\r\n        updateErrorCount()\r\n      }\r\n      return Promise.resolve()\r\n    }\r\n\r\n    const result = validateCell(rowId, columnName, value)\r\n\r\n    // Update errors map\r\n    const rowErrors = validationErrors[rowId] || []\r\n\r\n    if (!result.isValid) {\r\n      // Add/update error\r\n      const existingErrorIdx = rowErrors.findIndex(e => e.columnName === columnName)\r\n      const error: ValidationError = {\r\n        rowId,\r\n        columnName,\r\n        message: result.error!,\r\n        severity: result.severity!\r\n      }\r\n\r\n      if (existingErrorIdx >= 0) {\r\n        rowErrors[existingErrorIdx] = error\r\n        console.log('[useValidation] validateCellDirect: Updated existing error', {\r\n          rowId,\r\n          columnName,\r\n          error: error.message\r\n        })\r\n      } else {\r\n        rowErrors.push(error)\r\n        console.log('[useValidation] validateCellDirect: Added new error', {\r\n          rowId,\r\n          columnName,\r\n          error: error.message\r\n        })\r\n      }\r\n\r\n      validationErrors[rowId] = rowErrors\r\n    } else {\r\n      // Clear error for this column\r\n      const filteredErrors = rowErrors.filter(e => e.columnName !== columnName)\r\n      if (filteredErrors.length > 0) {\r\n        validationErrors[rowId] = filteredErrors\r\n        console.log('[useValidation] validateCellDirect: Cleared error for column, other errors remain', {\r\n          rowId,\r\n          columnName,\r\n          remainingErrors: filteredErrors.length\r\n        })\r\n      } else {\r\n        delete validationErrors[rowId]\r\n        console.log('[useValidation] validateCellDirect: Cleared all errors for row', {\r\n          rowId\r\n        })\r\n      }\r\n    }\r\n\r\n    //  RIEENIE #2: Only update error count if not in batch mode\r\n    if (!skipErrorCountUpdate) {\r\n      updateErrorCount()\r\n    }\r\n\r\n    return Promise.resolve()\r\n  }\r\n\r\n  // Throttled validation (300ms) for user input - wraps validateCellDirect\r\n  const validateCellThrottled = useDebounceFn(\r\n    validateCellDirect,\r\n    300\r\n  )\r\n\r\n  async function validateAll(rows: any[]) {\r\n    console.log('[useValidation] validateAll START:', {\r\n      rowCount: rows.length\r\n    })\r\n\r\n    // Clear all errors\r\n    Object.keys(validationErrors).forEach(key => delete validationErrors[key])\r\n    let totalErrors = 0\r\n    let rowIndex = 0\r\n\r\n    //  FIX: Batch processing with UI yielding\r\n    const BATCH_SIZE = 50  // Process 50 rows at a time\r\n    const totalBatches = Math.ceil(rows.length / BATCH_SIZE)\r\n\r\n    for (let batchIndex = 0; batchIndex < totalBatches; batchIndex++) {\r\n      const batchStart = batchIndex * BATCH_SIZE\r\n      const batchEnd = Math.min(batchStart + BATCH_SIZE, rows.length)\r\n      const batch = rows.slice(batchStart, batchEnd)\r\n\r\n      console.log(`[useValidation] Processing batch ${batchIndex + 1}/${totalBatches} (rows ${batchStart}-${batchEnd - 1})`)\r\n\r\n      for (const row of batch) {\r\n        // DEBUG: Log first 3 rows to see what data we have (use counter instead of indexOf)\r\n        if (rowIndex < 3) {\r\n          console.log('[useValidation] validateAll: Examining row', {\r\n            rowId: row.rowId,\r\n            rowIndex,\r\n            cellCount: row.cells?.length || 0\r\n          })\r\n        }\r\n        rowIndex++\r\n\r\n        // Skip rows without cells array\r\n        if (!row.cells || !Array.isArray(row.cells)) {\r\n          console.log('[useValidation] validateAll: Skipping row without cells', {\r\n            rowId: row.rowId,\r\n            hasCells: !!row.cells,\r\n            isArray: Array.isArray(row.cells)\r\n          })\r\n          continue\r\n        }\r\n\r\n        // Skip empty rows - only validate rows with at least one non-empty cell\r\n        if (isRowCompletelyEmpty(row.cells)) {\r\n          console.log('[useValidation] validateAll: Skipping empty row', {\r\n            rowId: row.rowId,\r\n            cellCount: row.cells?.length || 0\r\n          })\r\n          continue\r\n        }\r\n\r\n        for (const cell of row.cells) {\r\n          const result = validateCell(row.rowId, cell.columnName, cell.value)\r\n          if (!result.isValid) {\r\n            const rowErrors = validationErrors[row.rowId] || []\r\n            rowErrors.push({\r\n              rowId: row.rowId,\r\n              columnName: cell.columnName,\r\n              message: result.error!,\r\n              severity: result.severity!\r\n            })\r\n            validationErrors[row.rowId] = rowErrors\r\n            totalErrors++\r\n          }\r\n        }\r\n      }\r\n\r\n      //  K: Yield UI po kadom batchi\r\n      await nextTick()\r\n    }\r\n\r\n    console.log('[useValidation] validateAll - loop FINISHED, processed', rowIndex, 'rows')\r\n    console.log('[useValidation] validateAll - totalErrors:', totalErrors)\r\n\r\n    // SIMPLIFIED: Avoid complex operations on reactive validationErrors object\r\n    const rowsWithErrorsCount = Object.keys(validationErrors).length\r\n    console.log('[useValidation] validateAll - rowsWithErrors:', rowsWithErrorsCount)\r\n\r\n    console.log('[useValidation] validateAll complete - SUCCESS')\r\n\r\n    console.log('[useValidation] validateAll - calling updateErrorCount...')\r\n    updateErrorCount()\r\n    console.log('[useValidation] validateAll - updateErrorCount DONE')\r\n\r\n    // SIMPLIFIED: Build errors array without Object.values().flat() on reactive object\r\n    console.log('[useValidation] validateAll - building errors array...')\r\n    const allErrors: ValidationError[] = []\r\n    for (const rowId in validationErrors) {\r\n      const rowErrors = validationErrors[rowId]\r\n      if (rowErrors && Array.isArray(rowErrors)) {\r\n        allErrors.push(...rowErrors)\r\n      }\r\n    }\r\n    console.log('[useValidation] validateAll - errors array built, count:', allErrors.length)\r\n\r\n    console.log('[useValidation] validateAll - returning result...')\r\n    return {\r\n      isValid: totalErrors === 0,\r\n      totalErrors,\r\n      errors: allErrors\r\n    }\r\n  }\r\n\r\n  function getValidationErrors(rowId: string): ValidationError[] {\r\n    return validationErrors[rowId] || []\r\n  }\r\n\r\n  function clearValidationErrors() {\r\n    const clearedCount = Object.keys(validationErrors).length\r\n    console.log('[useValidation] clearValidationErrors:', {\r\n      clearedCount\r\n    })\r\n    Object.keys(validationErrors).forEach(key => delete validationErrors[key])\r\n    updateErrorCount()\r\n  }\r\n\r\n  return {\r\n    validationRules,\r\n    validationErrors,\r\n    errorCount,\r\n    ruleCount,\r\n    addValidationRule,\r\n    validateCell,\r\n    validateCellDirect,      //  Direct validation for bulk operations (no debounce)\r\n    validateCellThrottled,   // Throttled validation for user input (300ms debounce)\r\n    validateAll,\r\n    getValidationErrors,\r\n    clearValidationErrors,\r\n    updateErrorCount         //  RIEENIE #2: Export for manual call after batch validation\r\n  }\r\n}\r\n","/**\r\n * Copy/Paste Composable with Excel-like TSV Format\r\n *\r\n * EXCEL TSV FORMAT:\r\n * - Normal cells: separated by \\t (no quotes)\r\n * - Multiline cells: wrapped in quotes \"Multi\\nLine\\nCell\"\r\n * - Cells with tabs: wrapped in quotes \"Cell\\tWith\\tTabs\"\r\n * - Cells with quotes: quotes doubled AND wrapped \"Cell with \"\"quote\"\"\"\r\n *\r\n * CRITICAL: Before copying, values are ESCAPED (quotes added if needed)\r\n * CRITICAL: After pasting, values are UNESCAPED (quotes removed)\r\n */\r\n\r\nimport { ref } from 'vue'\r\nimport type { GridRow } from '@/types/grid'\r\n\r\nexport interface CopyPasteOptions {\r\n  includeHeaders?: boolean\r\n}\r\n\r\nexport interface CopyPasteResult {\r\n  success: boolean\r\n  message?: string\r\n  processedRows?: number\r\n}\r\n\r\nexport function useCopyPaste() {\r\n  const clipboardData = ref<string>('')\r\n\r\n  /**\r\n   * Escapes TSV value for Excel compatibility\r\n   *\r\n   * ESCAPING RULES:\r\n   * 1. If value contains tab, newline, carriage return, or quote  wrap in quotes\r\n   * 2. If wrapping in quotes, double any existing quotes (\"  \"\")\r\n   * 3. Otherwise, return value as-is (no quotes needed)\r\n   *\r\n   * EXAMPLES:\r\n   * - \"NormalText\"  NormalText (no special chars, no quotes)\r\n   * - \"Multi\\nLine\"  \"Multi\\nLine\" (newline  quoted)\r\n   * - \"Cell\\tWith\\tTab\"  \"Cell\\tWith\\tTab\" (tabs  quoted)\r\n   * - 'Cell with \"quote\"'  \"Cell with \"\"quote\"\"\" (quote  doubled AND quoted)\r\n   * - \"\"  \"\" (empty string stays empty)\r\n   */\r\n  function escapeTsvValue(value: string): string {\r\n    if (!value) return value\r\n\r\n    // Check if quoting is needed\r\n    const needsQuoting = value.includes('\\t') ||\r\n                        value.includes('\\n') ||\r\n                        value.includes('\\r') ||\r\n                        value.includes('\"')\r\n\r\n    if (!needsQuoting) {\r\n      // Normal value - no escaping needed\r\n      return value\r\n    }\r\n\r\n    // Escape quotes by doubling them, then wrap entire value in quotes\r\n    // Example: Cell with \"quote\"  Cell with \"\"quote\"\"  \"Cell with \"\"quote\"\"\"\r\n    const escaped = value.replace(/\"/g, '\"\"')\r\n    return `\"${escaped}\"`\r\n  }\r\n\r\n  /**\r\n   * Formats rows as Tab-Separated Values with Excel escaping\r\n   *\r\n   * EXAMPLE OUTPUT:\r\n   * Column1\\tColumn2\\tColumn3\\n\r\n   * Cell1\\t\"Multi\\nLine\\nCell\"\\tCell3\\n\r\n   * Cell1\\t\"Cell\\tWith\\tTabs\"\\tCell3\\n\r\n   * Cell1\\t\"Cell with \"\"quote\"\"\"\\tCell3\\n\r\n   */\r\n  function formatAsTabSeparated(\r\n    rows: GridRow[],\r\n    columnNames: string[],\r\n    options: CopyPasteOptions = {}\r\n  ): string {\r\n    const lines: string[] = []\r\n\r\n    // Add headers if requested\r\n    if (options.includeHeaders) {\r\n      // Escape header values too (in case column names contain special chars)\r\n      lines.push(columnNames.map(escapeTsvValue).join('\\t'))\r\n    }\r\n\r\n    // Add data rows\r\n    for (const row of rows) {\r\n      // Escape all cell values before joining with tabs\r\n      // This ensures multiline/tab content is properly quoted for Excel\r\n      const values = columnNames.map(col => {\r\n        const cell = row.cells.find(c => c.columnName === col)\r\n        const value = cell?.value\r\n        return escapeTsvValue(value?.toString() ?? '')\r\n      })\r\n      lines.push(values.join('\\t'))\r\n    }\r\n\r\n    return lines.join('\\n')\r\n  }\r\n\r\n  /**\r\n   * Parses Tab-Separated Values with Excel multiline/tab support\r\n   *\r\n   * EXCEL TSV FORMAT:\r\n   * - Normal cells: separated by \\t\r\n   * - Multiline cells: wrapped in quotes \"Multi\\nLine\\nCell\"\r\n   * - Cells with tabs: wrapped in quotes \"Cell\\tWith\\tTabs\"\r\n   * - Escaped quotes: doubled \"\" inside quoted values \"Cell with \"\"quote\"\"\"\r\n   *\r\n   * CRITICAL: Uses character-by-character parsing instead of Split() to handle embedded delimiters\r\n   *\r\n   * EXAMPLE INPUT:\r\n   * Column1\\tColumn2\\tColumn3\\n\r\n   * Cell1\\t\"Multi\\nLine\\nCell\"\\tCell3\\n\r\n   * Cell1\\t\"Cell\\tWith\\tTabs\"\\tCell3\\n\r\n   * Cell1\\t\"Cell with \"\"quote\"\"\"\\tCell3\\n\r\n   *\r\n   * EXAMPLE OUTPUT (unescaped):\r\n   * Column2 value: \"Multi\\nLine\\nCell\" (3 lines, NO quotes in final value)\r\n   */\r\n  function parseTabSeparated(clipboardText: string): { headers: string[], rows: Record<string, any>[] } {\r\n    const result: Record<string, any>[] = []\r\n    const currentRow: string[] = []\r\n    let currentCell = ''\r\n    let inQuotes = false\r\n    let isFirstRow = true\r\n    let headers: string[] = []\r\n\r\n    for (let i = 0; i < clipboardText.length; i++) {\r\n      const c = clipboardText[i]\r\n      const next = i + 1 < clipboardText.length ? clipboardText[i + 1] : null\r\n\r\n      if (c === '\"') {\r\n        if (inQuotes && next === '\"') {\r\n          // Escaped quote (\"\")  append single quote to cell content\r\n          // Example: \"Cell with \"\"quote\"\"\"  Cell with \"quote\"\r\n          currentCell += '\"'\r\n          i++ // Skip next quote\r\n        } else {\r\n          // Toggle quote mode (start or end of quoted value)\r\n          // CRITICAL: Quotes themselves are NOT added to cell content\r\n          inQuotes = !inQuotes\r\n        }\r\n      } else if (c === '\\t' && !inQuotes) {\r\n        // Tab outside quotes = end of cell\r\n        currentRow.push(currentCell)\r\n        currentCell = ''\r\n      } else if ((c === '\\n' || c === '\\r') && !inQuotes) {\r\n        // Newline outside quotes = end of row\r\n        if (c === '\\r' && next === '\\n') {\r\n          i++ // Skip \\n after \\r (handle Windows CRLF)\r\n        }\r\n\r\n        if (currentCell.length > 0 || currentRow.length > 0) {\r\n          currentRow.push(currentCell)\r\n          currentCell = ''\r\n\r\n          if (isFirstRow) {\r\n            // First row = headers (or auto-generate if not header-like)\r\n            if (isHeaderRow(currentRow)) {\r\n              headers = [...currentRow]\r\n            } else {\r\n              // First row is data - generate column names\r\n              headers = currentRow.map((_, idx) => `Column${idx + 1}`)\r\n\r\n              // Add first row as data\r\n              const firstDataRow: Record<string, any> = {}\r\n              for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n                firstDataRow[headers[j]] = currentRow[j] || null\r\n              }\r\n              result.push(firstDataRow)\r\n            }\r\n\r\n            isFirstRow = false\r\n          } else {\r\n            // Build data row dictionary\r\n            const dataRow: Record<string, any> = {}\r\n            for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n              // CRITICAL: Values are UNESCAPED (quotes removed, \"\"  \")\r\n              dataRow[headers[j]] = currentRow[j] || null\r\n            }\r\n            result.push(dataRow)\r\n          }\r\n\r\n          currentRow.length = 0\r\n        }\r\n      } else {\r\n        // Regular character - add to current cell\r\n        // Tabs and newlines inside quotes are preserved as-is\r\n        currentCell += c\r\n      }\r\n    }\r\n\r\n    // Handle last row if no trailing newline\r\n    if (currentCell.length > 0 || currentRow.length > 0) {\r\n      currentRow.push(currentCell)\r\n\r\n      if (isFirstRow && headers.length === 0) {\r\n        // Only one row total - treat as headers or generate column names\r\n        if (isHeaderRow(currentRow)) {\r\n          headers = [...currentRow]\r\n        } else {\r\n          headers = currentRow.map((_, idx) => `Column${idx + 1}`)\r\n          const dataRow: Record<string, any> = {}\r\n          for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n            dataRow[headers[j]] = currentRow[j] || null\r\n          }\r\n          result.push(dataRow)\r\n        }\r\n      } else if (headers.length > 0) {\r\n        // Last data row\r\n        const dataRow: Record<string, any> = {}\r\n        for (let j = 0; j < Math.min(headers.length, currentRow.length); j++) {\r\n          dataRow[headers[j]] = currentRow[j] || null\r\n        }\r\n        result.push(dataRow)\r\n      }\r\n    }\r\n\r\n    return { headers, rows: result }\r\n  }\r\n\r\n  /**\r\n   * Checks if row contains headers (non-numeric values)\r\n   */\r\n  function isHeaderRow(values: string[]): boolean {\r\n    return values.some(v => v && isNaN(Number(v)))\r\n  }\r\n\r\n  /**\r\n   * Copies selected CELLS (not full rows) to clipboard with position preservation\r\n   *\r\n   * POSITION PRESERVATION:\r\n   * - Calculates min/max row and column indices from selected cells\r\n   * - Creates rectangular range including EMPTY cells to preserve positions\r\n   * - Example: If cells (2,3) and (4,5) are selected, copies a 3x3 grid:\r\n   *   Row 2: empty, empty, Cell(2,3), empty, empty\r\n   *   Row 3: empty, empty, empty,     empty, empty\r\n   *   Row 4: empty, empty, empty,     empty, Cell(4,5)\r\n   */\r\n  async function copySelectedCells(\r\n    selectedCells: Set<string>,\r\n    allRows: GridRow[],\r\n    allColumns: { name: string }[]\r\n  ): Promise<CopyPasteResult> {\r\n    try {\r\n      if (selectedCells.size === 0) {\r\n        return {\r\n          success: false,\r\n          message: 'No cells selected for copy'\r\n        }\r\n      }\r\n\r\n      console.log('[useCopyPaste] copySelectedCells:', {\r\n        selectedCount: selectedCells.size,\r\n        selectedCells: Array.from(selectedCells)\r\n      })\r\n\r\n      // Parse selected cells to get row/column indices\r\n      const cellPositions: Array<{ rowId: string; rowIndex: number; columnName: string; columnIndex: number; value: any }> = []\r\n\r\n      selectedCells.forEach(cellKey => {\r\n        const [rowId, columnName] = cellKey.split(':')\r\n        const row = allRows.find(r => r.rowId === rowId)\r\n        if (!row) return\r\n\r\n        const columnIndex = allColumns.findIndex(c => c.name === columnName)\r\n        if (columnIndex === -1) return\r\n\r\n        const cell = row.cells.find(c => c.columnName === columnName)\r\n        cellPositions.push({\r\n          rowId,\r\n          rowIndex: row.rowIndex,\r\n          columnName,\r\n          columnIndex,\r\n          value: cell?.value\r\n        })\r\n      })\r\n\r\n      if (cellPositions.length === 0) {\r\n        return {\r\n          success: false,\r\n          message: 'No valid cells to copy'\r\n        }\r\n      }\r\n\r\n      // Calculate rectangular bounds\r\n      const minRowIndex = Math.min(...cellPositions.map(c => c.rowIndex))\r\n      const maxRowIndex = Math.max(...cellPositions.map(c => c.rowIndex))\r\n      const minColIndex = Math.min(...cellPositions.map(c => c.columnIndex))\r\n      const maxColIndex = Math.max(...cellPositions.map(c => c.columnIndex))\r\n\r\n      console.log('[useCopyPaste] copySelectedCells bounds:', {\r\n        minRowIndex,\r\n        maxRowIndex,\r\n        minColIndex,\r\n        maxColIndex,\r\n        rows: maxRowIndex - minRowIndex + 1,\r\n        cols: maxColIndex - minColIndex + 1\r\n      })\r\n\r\n      // Build TSV with position preservation (include empty cells)\r\n      const lines: string[] = []\r\n\r\n      for (let rowIdx = minRowIndex; rowIdx <= maxRowIndex; rowIdx++) {\r\n        const rowCells: string[] = []\r\n\r\n        for (let colIdx = minColIndex; colIdx <= maxColIndex; colIdx++) {\r\n          // Find if this cell is selected\r\n          const cellPos = cellPositions.find(c => c.rowIndex === rowIdx && c.columnIndex === colIdx)\r\n\r\n          if (cellPos) {\r\n            // Cell is selected - add its value\r\n            const value = cellPos.value?.toString() ?? ''\r\n            rowCells.push(escapeTsvValue(value))\r\n          } else {\r\n            // Cell is not selected - add empty placeholder to preserve position\r\n            rowCells.push('')\r\n          }\r\n        }\r\n\r\n        lines.push(rowCells.join('\\t'))\r\n      }\r\n\r\n      const tsvData = lines.join('\\n')\r\n\r\n      console.log('[useCopyPaste] copySelectedCells TSV:', {\r\n        lineCount: lines.length,\r\n        preview: tsvData.substring(0, 200)\r\n      })\r\n\r\n      // Copy to system clipboard\r\n      await navigator.clipboard.writeText(tsvData)\r\n\r\n      // Store internally for fallback\r\n      clipboardData.value = tsvData\r\n\r\n      return {\r\n        success: true,\r\n        message: `Copied ${cellPositions.length} cells to clipboard`,\r\n        processedRows: cellPositions.length\r\n      }\r\n    } catch (error) {\r\n      console.error('[useCopyPaste] Copy failed:', error)\r\n      return {\r\n        success: false,\r\n        message: `Copy failed: ${error}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Copies selected rows to clipboard (legacy method for full row copy)\r\n   */\r\n  async function copyToClipboard(\r\n    rows: GridRow[],\r\n    columnNames: string[],\r\n    options: CopyPasteOptions = {}\r\n  ): Promise<CopyPasteResult> {\r\n    try {\r\n      if (rows.length === 0) {\r\n        return {\r\n          success: false,\r\n          message: 'No data selected for copy'\r\n        }\r\n      }\r\n\r\n      // Format data as TSV with Excel escaping\r\n      const tsvData = formatAsTabSeparated(rows, columnNames, options)\r\n\r\n      // Copy to system clipboard\r\n      await navigator.clipboard.writeText(tsvData)\r\n\r\n      // Store internally for fallback\r\n      clipboardData.value = tsvData\r\n\r\n      return {\r\n        success: true,\r\n        message: `Copied ${rows.length} rows to clipboard`,\r\n        processedRows: rows.length\r\n      }\r\n    } catch (error) {\r\n      console.error('Copy failed:', error)\r\n      return {\r\n        success: false,\r\n        message: `Copy failed: ${error}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Pastes from clipboard and returns parsed rows\r\n   */\r\n  async function pasteFromClipboard(): Promise<CopyPasteResult & { rows?: Record<string, any>[], headers?: string[] }> {\r\n    try {\r\n      // Try to read from system clipboard\r\n      let tsvData = ''\r\n      try {\r\n        tsvData = await navigator.clipboard.readText()\r\n      } catch {\r\n        // Fallback to internal clipboard if system clipboard fails\r\n        tsvData = clipboardData.value\r\n      }\r\n\r\n      if (!tsvData) {\r\n        return {\r\n          success: false,\r\n          message: 'No data available in clipboard'\r\n        }\r\n      }\r\n\r\n      // Parse TSV data with Excel multiline support\r\n      const { headers, rows } = parseTabSeparated(tsvData)\r\n\r\n      return {\r\n        success: true,\r\n        message: `Pasted ${rows.length} rows from clipboard`,\r\n        processedRows: rows.length,\r\n        rows,\r\n        headers\r\n      }\r\n    } catch (error) {\r\n      console.error('Paste failed:', error)\r\n      return {\r\n        success: false,\r\n        message: `Paste failed: ${error}`\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Checks if paste is possible\r\n   */\r\n  function canPaste(): boolean {\r\n    return !!clipboardData.value\r\n  }\r\n\r\n  /**\r\n   * Clears internal clipboard\r\n   */\r\n  function clearClipboard(): void {\r\n    clipboardData.value = ''\r\n  }\r\n\r\n  return {\r\n    copyToClipboard,\r\n    copySelectedCells,\r\n    pasteFromClipboard,\r\n    canPaste,\r\n    clearClipboard\r\n  }\r\n}\r\n","/**\r\n * Auto Row Height Composable\r\n *\r\n * Calculates row heights based on cell content and text wrapping\r\n */\r\n\r\nexport interface AutoRowHeightConfig {\r\n  minHeight: number\r\n  maxHeight: number\r\n  fontFamily: string\r\n  fontSize: number\r\n  enableWrapping: boolean\r\n  padding: number\r\n}\r\n\r\nexport interface RowHeightResult {\r\n  rowId: string\r\n  calculatedHeight: number\r\n  isSuccess: boolean\r\n}\r\n\r\nexport const defaultAutoRowHeightConfig: AutoRowHeightConfig = {\r\n  minHeight: 32, // 32px default row height (matches default in store)\r\n  maxHeight: 400, // Default fallback (will be overridden by 70% of container height)\r\n  fontFamily: 'system-ui, -apple-system, sans-serif',\r\n  fontSize: 14,  // MUST match CSS font-size in .grid-cell\r\n  enableWrapping: true,\r\n  padding: 16 // 8px left + 8px right (horizontal padding for width calculation)\r\n}\r\n\r\nexport function useAutoRowHeight(config: AutoRowHeightConfig = defaultAutoRowHeightConfig) {\r\n  // Create a canvas for text measurement (reused for all calculations)\r\n  let canvas: HTMLCanvasElement | null = null\r\n  let context: CanvasRenderingContext2D | null = null\r\n\r\n  /**\r\n   * Gets the canvas context for text measurement\r\n   */\r\n  function getContext(): CanvasRenderingContext2D {\r\n    if (!canvas) {\r\n      canvas = document.createElement('canvas')\r\n      context = canvas.getContext('2d')\r\n    }\r\n\r\n    if (!context) {\r\n      throw new Error('Failed to get canvas context')\r\n    }\r\n\r\n    // Set font for measurement\r\n    context.font = `${config.fontSize}px ${config.fontFamily}`\r\n\r\n    return context\r\n  }\r\n\r\n  /**\r\n   * Measures the height required for text in a given width\r\n   * IMPORTANT: Handles explicit newlines (\\n) from Shift+Enter\r\n   */\r\n  function measureTextHeight(text: string, width: number): number {\r\n    if (!text) return config.minHeight\r\n\r\n    const ctx = getContext()\r\n\r\n    if (!config.enableWrapping) {\r\n      // Single line - just return min height\r\n      return config.minHeight\r\n    }\r\n\r\n    // Split by newline characters FIRST to respect explicit line breaks (Shift+Enter)\r\n    const explicitLines = text.toString().split('\\n')\r\n\r\n    let lineHeight = config.fontSize * 1.5 // Line height is typically 1.5x font size\r\n    let totalLines = 0\r\n\r\n    // For each explicit line, calculate how many visual lines it needs (accounting for wrapping)\r\n    for (const line of explicitLines) {\r\n      if (!line || line.trim() === '') {\r\n        // Empty line still counts as one line\r\n        totalLines++\r\n        continue\r\n      }\r\n\r\n      // Split this line into words and calculate wrapping\r\n      const words = line.split(' ')\r\n      let currentLine = ''\r\n      let linesInThisSegment = 1\r\n\r\n      for (const word of words) {\r\n        const testLine = currentLine ? `${currentLine} ${word}` : word\r\n        const metrics = ctx.measureText(testLine)\r\n\r\n        if (metrics.width > width - config.padding) {\r\n          // Line is too long, wrap to next line\r\n          if (currentLine) {\r\n            linesInThisSegment++\r\n            currentLine = word\r\n          } else {\r\n            // Single word is too long, force it on one line\r\n            currentLine = word\r\n          }\r\n        } else {\r\n          currentLine = testLine\r\n        }\r\n      }\r\n\r\n      totalLines += linesInThisSegment\r\n    }\r\n\r\n    // Calculate total height\r\n    // Add vertical padding (10px from CSS: 5px top + 5px bottom = 10px total)\r\n    const verticalPadding = 10  // Must match CSS padding in .grid-cell (5px + 5px)\r\n    const totalHeight = totalLines * lineHeight + verticalPadding\r\n\r\n    // Apply min/max constraints\r\n    return Math.max(config.minHeight, Math.min(config.maxHeight, Math.ceil(totalHeight)))\r\n  }\r\n\r\n  /**\r\n   * Calculates the height for a single row based on all cell contents\r\n   */\r\n  function calculateRowHeight(\r\n    row: Record<string, any>,\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): RowHeightResult {\r\n    try {\r\n      let maxHeight = config.minHeight\r\n\r\n      // Measure each cell in the row\r\n      for (const column of columns) {\r\n        // Skip special columns EXCEPT ValidationAlerts\r\n        // ValidationAlerts should be measured because it contains important validation messages\r\n        // that need proper row height calculation for wrapping\r\n        if (column.specialType && column.specialType !== 'ValidationAlerts') {\r\n          continue\r\n        }\r\n\r\n        // Access cell value from cells array structure\r\n        let cellValue = null\r\n        if (row.cells && Array.isArray(row.cells)) {\r\n          // GridRow structure with cells array\r\n          const cell = row.cells.find((c: any) => c.columnName === column.name)\r\n          cellValue = cell?.value\r\n        } else {\r\n          // Fallback to direct property access for backwards compatibility\r\n          cellValue = row[column.name]\r\n        }\r\n\r\n        if (cellValue == null) continue\r\n\r\n        const textValue = String(cellValue)\r\n        const cellHeight = measureTextHeight(textValue, column.width)\r\n\r\n        maxHeight = Math.max(maxHeight, cellHeight)\r\n      }\r\n\r\n      return {\r\n        rowId: row.__rowId || row.rowId,\r\n        calculatedHeight: maxHeight,\r\n        isSuccess: true\r\n      }\r\n    } catch (error) {\r\n      console.error('Row height calculation failed:', error)\r\n      return {\r\n        rowId: row.__rowId || row.rowId,\r\n        calculatedHeight: config.minHeight,\r\n        isSuccess: false\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Calculates heights for multiple rows (batch operation)\r\n   */\r\n  function calculateRowHeights(\r\n    rows: Record<string, any>[],\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): RowHeightResult[] {\r\n    return rows.map(row => calculateRowHeight(row, columns))\r\n  }\r\n\r\n  /**\r\n   * Calculates heights for all rows and updates them in place\r\n   *  FIX: Async with batching to prevent UI freeze\r\n   */\r\n  async function applyAutoRowHeight(\r\n    rows: Array<{ rowId: string; height: number; [key: string]: any }>,\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): Promise<{ totalRowsUpdated: number; averageHeight: number }> {\r\n    let totalHeight = 0\r\n    let updatedCount = 0\r\n\r\n    //  FIX: Batch processing with UI yielding\r\n    const BATCH_SIZE = 50  // Process 50 rows at a time\r\n    const totalBatches = Math.ceil(rows.length / BATCH_SIZE)\r\n\r\n    for (let batchIndex = 0; batchIndex < totalBatches; batchIndex++) {\r\n      const batchStart = batchIndex * BATCH_SIZE\r\n      const batchEnd = Math.min(batchStart + BATCH_SIZE, rows.length)\r\n      const batch = rows.slice(batchStart, batchEnd)\r\n\r\n      console.log(`[AutoRowHeight] Processing batch ${batchIndex + 1}/${totalBatches} (rows ${batchStart}-${batchEnd - 1})`)\r\n\r\n      for (const row of batch) {\r\n        const result = calculateRowHeight(row, columns)\r\n\r\n        if (result.isSuccess) {\r\n          row.height = result.calculatedHeight\r\n          totalHeight += result.calculatedHeight\r\n          updatedCount++\r\n        }\r\n      }\r\n\r\n      //  K: Yield UI po kadom batchi\r\n      await new Promise(resolve => setTimeout(resolve, 0))\r\n    }\r\n\r\n    return {\r\n      totalRowsUpdated: updatedCount,\r\n      averageHeight: updatedCount > 0 ? totalHeight / updatedCount : config.minHeight\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Recalculates heights for specific rows (e.g., after editing)\r\n   */\r\n  function recalculateRows(\r\n    rows: Array<{ rowId: string; height: number; [key: string]: any }>,\r\n    rowIds: string[],\r\n    columns: Array<{ name: string; width: number; specialType?: string }>\r\n  ): number {\r\n    let updatedCount = 0\r\n\r\n    for (const row of rows) {\r\n      if (rowIds.includes(row.rowId)) {\r\n        const result = calculateRowHeight(row, columns)\r\n\r\n        if (result.isSuccess) {\r\n          row.height = result.calculatedHeight\r\n          updatedCount++\r\n        }\r\n      }\r\n    }\r\n\r\n    return updatedCount\r\n  }\r\n\r\n  /**\r\n   * Updates the maxHeight config value dynamically\r\n   * Used when container height changes\r\n   */\r\n  function updateMaxHeight(newMaxHeight: number) {\r\n    config.maxHeight = newMaxHeight\r\n    console.log(`[useAutoRowHeight] maxHeight updated to: ${newMaxHeight}px`)\r\n  }\r\n\r\n  return {\r\n    calculateRowHeight,\r\n    calculateRowHeights,\r\n    applyAutoRowHeight,\r\n    recalculateRows,\r\n    measureTextHeight,\r\n    updateMaxHeight  // NEW: Allow dynamic maxHeight updates\r\n  }\r\n}\r\n","/**\r\n * Keyboard Shortcuts Composable\r\n *\r\n * Provides keyboard shortcut registration and handling with context support\r\n */\r\n\r\nimport { onMounted, onUnmounted } from 'vue'\r\n\r\nexport enum ShortcutContext {\r\n  Normal = 'normal',\r\n  Editing = 'editing',\r\n  Selection = 'selection',\r\n  Any = 'any'\r\n}\r\n\r\nexport interface KeyCombination {\r\n  key: string\r\n  ctrl?: boolean\r\n  shift?: boolean\r\n  alt?: boolean\r\n  meta?: boolean\r\n}\r\n\r\nexport interface ShortcutDefinition {\r\n  name: string\r\n  key: KeyCombination\r\n  handler: (event: KeyboardEvent) => void | Promise<void>\r\n  context?: ShortcutContext\r\n  enabled?: boolean\r\n  priority?: number\r\n  description?: string\r\n}\r\n\r\nexport interface ShortcutOptions {\r\n  enabled?: boolean\r\n  context?: ShortcutContext\r\n}\r\n\r\nexport function useShortcuts(options: ShortcutOptions = {}) {\r\n  const shortcuts = new Map<string, ShortcutDefinition>()\r\n  const currentContext = options.context || ShortcutContext.Normal\r\n\r\n  /**\r\n   * Converts KeyCombination to string key for map\r\n   */\r\n  function keyCombinationToString(key: KeyCombination): string {\r\n    const parts: string[] = []\r\n    if (key.ctrl) parts.push('Ctrl')\r\n    if (key.shift) parts.push('Shift')\r\n    if (key.alt) parts.push('Alt')\r\n    if (key.meta) parts.push('Meta')\r\n    parts.push(key.key.toUpperCase())\r\n    return parts.join('+')\r\n  }\r\n\r\n  /**\r\n   * Checks if keyboard event matches key combination\r\n   */\r\n  function matchesKeyCombination(event: KeyboardEvent, key: KeyCombination): boolean {\r\n    return (\r\n      event.key.toUpperCase() === key.key.toUpperCase() &&\r\n      !!event.ctrlKey === !!key.ctrl &&\r\n      !!event.shiftKey === !!key.shift &&\r\n      !!event.altKey === !!key.alt &&\r\n      !!event.metaKey === !!key.meta\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Checks if shortcut should execute in current context\r\n   */\r\n  function isContextMatch(shortcutContext: ShortcutContext, current: ShortcutContext): boolean {\r\n    return shortcutContext === ShortcutContext.Any ||\r\n           shortcutContext === current ||\r\n           current === ShortcutContext.Any\r\n  }\r\n\r\n  /**\r\n   * Handles keyboard events\r\n   */\r\n  async function handleKeyDown(event: KeyboardEvent): Promise<void> {\r\n    if (!options.enabled && options.enabled !== undefined) {\r\n      return\r\n    }\r\n\r\n    // Find matching shortcuts\r\n    const matchingShortcuts = Array.from(shortcuts.values()).filter(shortcut => {\r\n      return (\r\n        shortcut.enabled !== false &&\r\n        matchesKeyCombination(event, shortcut.key) &&\r\n        isContextMatch(shortcut.context || ShortcutContext.Normal, currentContext)\r\n      )\r\n    })\r\n\r\n    if (matchingShortcuts.length === 0) {\r\n      return\r\n    }\r\n\r\n    // Sort by priority (higher priority first)\r\n    matchingShortcuts.sort((a, b) => (b.priority || 0) - (a.priority || 0))\r\n\r\n    // Execute highest priority shortcut\r\n    const shortcut = matchingShortcuts[0]\r\n    event.preventDefault()\r\n    event.stopPropagation()\r\n\r\n    try {\r\n      await shortcut.handler(event)\r\n    } catch (error) {\r\n      console.error(`Shortcut execution failed for ${shortcut.name}:`, error)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Registers a keyboard shortcut\r\n   */\r\n  function registerShortcut(definition: ShortcutDefinition): void {\r\n    const keyString = keyCombinationToString(definition.key)\r\n\r\n    if (shortcuts.has(keyString)) {\r\n      console.warn(`Shortcut ${keyString} is already registered. Overwriting.`)\r\n    }\r\n\r\n    shortcuts.set(keyString, {\r\n      ...definition,\r\n      enabled: definition.enabled !== false,\r\n      context: definition.context || ShortcutContext.Normal,\r\n      priority: definition.priority || 0\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Registers multiple shortcuts\r\n   */\r\n  function registerShortcuts(definitions: ShortcutDefinition[]): void {\r\n    definitions.forEach(registerShortcut)\r\n  }\r\n\r\n  /**\r\n   * Unregisters a shortcut by key combination\r\n   */\r\n  function unregisterShortcut(key: KeyCombination): boolean {\r\n    const keyString = keyCombinationToString(key)\r\n    return shortcuts.delete(keyString)\r\n  }\r\n\r\n  /**\r\n   * Unregisters a shortcut by name\r\n   */\r\n  function unregisterShortcutByName(name: string): boolean {\r\n    const entry = Array.from(shortcuts.entries()).find(([_, def]) => def.name === name)\r\n    if (entry) {\r\n      shortcuts.delete(entry[0])\r\n      return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  /**\r\n   * Enables or disables a shortcut\r\n   */\r\n  function setShortcutEnabled(name: string, enabled: boolean): void {\r\n    const entry = Array.from(shortcuts.entries()).find(([_, def]) => def.name === name)\r\n    if (entry) {\r\n      entry[1].enabled = enabled\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets all registered shortcuts\r\n   */\r\n  function getShortcuts(): ShortcutDefinition[] {\r\n    return Array.from(shortcuts.values())\r\n  }\r\n\r\n  /**\r\n   * Gets shortcuts for specific context\r\n   */\r\n  function getShortcutsByContext(context: ShortcutContext): ShortcutDefinition[] {\r\n    return Array.from(shortcuts.values()).filter(\r\n      s => s.context === context || s.context === ShortcutContext.Any\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Clears all shortcuts\r\n   */\r\n  function clearShortcuts(): void {\r\n    shortcuts.clear()\r\n  }\r\n\r\n  // Setup keyboard event listener\r\n  onMounted(() => {\r\n    if (options.enabled !== false) {\r\n      document.addEventListener('keydown', handleKeyDown as unknown as EventListener)\r\n    }\r\n  })\r\n\r\n  // Cleanup\r\n  onUnmounted(() => {\r\n    document.removeEventListener('keydown', handleKeyDown as unknown as EventListener)\r\n  })\r\n\r\n  return {\r\n    registerShortcut,\r\n    registerShortcuts,\r\n    unregisterShortcut,\r\n    unregisterShortcutByName,\r\n    setShortcutEnabled,\r\n    getShortcuts,\r\n    getShortcutsByContext,\r\n    clearShortcuts,\r\n    handleKeyDown\r\n  }\r\n}\r\n\r\n/**\r\n * Helper functions to create common key combinations\r\n */\r\nexport const Keys = {\r\n  ctrl: (key: string): KeyCombination => ({ key, ctrl: true }),\r\n  shift: (key: string): KeyCombination => ({ key, shift: true }),\r\n  alt: (key: string): KeyCombination => ({ key, alt: true }),\r\n  ctrlShift: (key: string): KeyCombination => ({ key, ctrl: true, shift: true }),\r\n  ctrlAlt: (key: string): KeyCombination => ({ key, ctrl: true, alt: true }),\r\n  single: (key: string): KeyCombination => ({ key })\r\n}\r\n\r\n/**\r\n * Pre-defined shortcut definitions for common operations\r\n */\r\nexport function createDefaultShortcuts(handlers: {\r\n  onCopy?: () => void | Promise<void>\r\n  onPaste?: () => void | Promise<void>\r\n  onCut?: () => void | Promise<void>\r\n  onDelete?: () => void | Promise<void>\r\n  onSelectAll?: () => void | Promise<void>\r\n  onFind?: () => void | Promise<void>\r\n  onUndo?: () => void | Promise<void>\r\n  onRedo?: () => void | Promise<void>\r\n  onEscape?: () => void | Promise<void>\r\n  onEnter?: () => void | Promise<void>\r\n  onTab?: () => void | Promise<void>\r\n  onArrowUp?: () => void | Promise<void>\r\n  onArrowDown?: () => void | Promise<void>\r\n  onArrowLeft?: () => void | Promise<void>\r\n  onArrowRight?: () => void | Promise<void>\r\n}): ShortcutDefinition[] {\r\n  const shortcuts: ShortcutDefinition[] = []\r\n\r\n  if (handlers.onCopy) {\r\n    shortcuts.push({\r\n      name: 'Copy',\r\n      key: Keys.ctrl('c'),\r\n      handler: handlers.onCopy,\r\n      description: 'Copy selected cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onPaste) {\r\n    shortcuts.push({\r\n      name: 'Paste',\r\n      key: Keys.ctrl('v'),\r\n      handler: handlers.onPaste,\r\n      description: 'Paste from clipboard',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onCut) {\r\n    shortcuts.push({\r\n      name: 'Cut',\r\n      key: Keys.ctrl('x'),\r\n      handler: handlers.onCut,\r\n      description: 'Cut selected cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onDelete) {\r\n    shortcuts.push({\r\n      name: 'Delete',\r\n      key: Keys.single('Delete'),\r\n      handler: handlers.onDelete,\r\n      description: 'Delete selected cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onSelectAll) {\r\n    shortcuts.push({\r\n      name: 'SelectAll',\r\n      key: Keys.ctrl('a'),\r\n      handler: handlers.onSelectAll,\r\n      description: 'Select all cells',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onFind) {\r\n    shortcuts.push({\r\n      name: 'Find',\r\n      key: Keys.ctrl('f'),\r\n      handler: handlers.onFind,\r\n      description: 'Open find dialog',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onUndo) {\r\n    shortcuts.push({\r\n      name: 'Undo',\r\n      key: Keys.ctrl('z'),\r\n      handler: handlers.onUndo,\r\n      description: 'Undo last action',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onRedo) {\r\n    shortcuts.push({\r\n      name: 'Redo',\r\n      key: Keys.ctrlShift('z'),\r\n      handler: handlers.onRedo,\r\n      description: 'Redo last undone action',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onEscape) {\r\n    shortcuts.push({\r\n      name: 'Escape',\r\n      key: Keys.single('Escape'),\r\n      handler: handlers.onEscape,\r\n      description: 'Cancel current operation',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onEnter) {\r\n    shortcuts.push({\r\n      name: 'Enter',\r\n      key: Keys.single('Enter'),\r\n      handler: handlers.onEnter,\r\n      description: 'Confirm edit and move to next row',\r\n      context: ShortcutContext.Editing,\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onTab) {\r\n    shortcuts.push({\r\n      name: 'Tab',\r\n      key: Keys.single('Tab'),\r\n      handler: handlers.onTab,\r\n      description: 'Move to next cell',\r\n      priority: 100\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowUp) {\r\n    shortcuts.push({\r\n      name: 'ArrowUp',\r\n      key: Keys.single('ArrowUp'),\r\n      handler: handlers.onArrowUp,\r\n      description: 'Move selection up',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowDown) {\r\n    shortcuts.push({\r\n      name: 'ArrowDown',\r\n      key: Keys.single('ArrowDown'),\r\n      handler: handlers.onArrowDown,\r\n      description: 'Move selection down',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowLeft) {\r\n    shortcuts.push({\r\n      name: 'ArrowLeft',\r\n      key: Keys.single('ArrowLeft'),\r\n      handler: handlers.onArrowLeft,\r\n      description: 'Move selection left',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  if (handlers.onArrowRight) {\r\n    shortcuts.push({\r\n      name: 'ArrowRight',\r\n      key: Keys.single('ArrowRight'),\r\n      handler: handlers.onArrowRight,\r\n      description: 'Move selection right',\r\n      priority: 50\r\n    })\r\n  }\r\n\r\n  return shortcuts\r\n}\r\n","/**\r\n * Asynchronous Logger with Queue\r\n *\r\n * FEATURES:\r\n * - Non-blocking: logs are queued and written asynchronously\r\n * - FIFO queue: oldest logs are written first\r\n * - Batch processing: multiple logs written in one operation\r\n * - Error tracking: captures unhandled errors automatically\r\n */\r\n\r\nimport { ref } from 'vue'\r\n\r\nexport type LogLevel = 'DEBUG' | 'INFO' | 'WARN' | 'ERROR' | 'FATAL'\r\n\r\nexport interface LogEntry {\r\n  timestamp: string\r\n  level: LogLevel\r\n  category: string\r\n  message: string\r\n  data?: any\r\n}\r\n\r\n// Global log queue (FIFO - First In, First Out)\r\nconst logQueue = ref<LogEntry[]>([])\r\nconst isProcessing = ref(false)\r\nconst BATCH_SIZE = 50 // Process 50 logs at once\r\nconst PROCESSING_INTERVAL = 100 // Process every 100ms\r\n\r\nlet processingTimer: number | null = null\r\n\r\n/**\r\n * Formats timestamp to ISO string with milliseconds\r\n */\r\nfunction getTimestamp(): string {\r\n  const now = new Date()\r\n  return now.toISOString()\r\n}\r\n\r\n/**\r\n * Adds log entry to queue (non-blocking)\r\n */\r\nfunction enqueueLog(level: LogLevel, category: string, message: string, data?: any) {\r\n  const entry: LogEntry = {\r\n    timestamp: getTimestamp(),\r\n    level,\r\n    category,\r\n    message,\r\n    data: data !== undefined ? JSON.parse(JSON.stringify(data)) : undefined\r\n  }\r\n\r\n  logQueue.value.push(entry)\r\n\r\n  // Start processing if not already running\r\n  if (!isProcessing.value) {\r\n    startProcessing()\r\n  }\r\n}\r\n\r\n/**\r\n * Starts asynchronous log processing\r\n */\r\nfunction startProcessing() {\r\n  if (processingTimer !== null) return\r\n\r\n  isProcessing.value = true\r\n\r\n  processingTimer = window.setInterval(() => {\r\n    processLogBatch()\r\n  }, PROCESSING_INTERVAL)\r\n}\r\n\r\n/**\r\n * Stops log processing (when queue is empty)\r\n */\r\nfunction stopProcessing() {\r\n  if (processingTimer !== null) {\r\n    window.clearInterval(processingTimer)\r\n    processingTimer = null\r\n  }\r\n  isProcessing.value = false\r\n}\r\n\r\n/**\r\n * Processes a batch of logs from the queue\r\n * Uses FIFO - oldest logs are processed first\r\n */\r\nfunction processLogBatch() {\r\n  if (logQueue.value.length === 0) {\r\n    stopProcessing()\r\n    return\r\n  }\r\n\r\n  // Take oldest logs (FIFO)\r\n  const batch = logQueue.value.splice(0, BATCH_SIZE)\r\n\r\n  // Write batch to console\r\n  for (const entry of batch) {\r\n    writeLogToConsole(entry)\r\n  }\r\n}\r\n\r\n/**\r\n * Writes a single log entry to console\r\n */\r\nfunction writeLogToConsole(entry: LogEntry) {\r\n  const prefix = `[${entry.timestamp}] [${entry.level}] [${entry.category}]`\r\n  const message = `${prefix} ${entry.message}`\r\n\r\n  switch (entry.level) {\r\n    case 'DEBUG':\r\n      if (entry.data !== undefined) {\r\n        console.debug(message, entry.data)\r\n      } else {\r\n        console.debug(message)\r\n      }\r\n      break\r\n    case 'INFO':\r\n      if (entry.data !== undefined) {\r\n        console.log(message, entry.data)\r\n      } else {\r\n        console.log(message)\r\n      }\r\n      break\r\n    case 'WARN':\r\n      if (entry.data !== undefined) {\r\n        console.warn(message, entry.data)\r\n      } else {\r\n        console.warn(message)\r\n      }\r\n      break\r\n    case 'ERROR':\r\n    case 'FATAL':\r\n      if (entry.data !== undefined) {\r\n        console.error(message, entry.data)\r\n      } else {\r\n        console.error(message)\r\n      }\r\n      break\r\n  }\r\n}\r\n\r\n/**\r\n * Public Logger Interface\r\n */\r\nexport function useLogger(category: string = 'App') {\r\n  return {\r\n    debug(message: string, data?: any) {\r\n      enqueueLog('DEBUG', category, message, data)\r\n    },\r\n\r\n    info(message: string, data?: any) {\r\n      enqueueLog('INFO', category, message, data)\r\n    },\r\n\r\n    warn(message: string, data?: any) {\r\n      enqueueLog('WARN', category, message, data)\r\n    },\r\n\r\n    error(message: string, data?: any) {\r\n      enqueueLog('ERROR', category, message, data)\r\n    },\r\n\r\n    fatal(message: string, data?: any) {\r\n      enqueueLog('FATAL', category, message, data)\r\n    },\r\n\r\n    /**\r\n     * Flushes all pending logs immediately (synchronously)\r\n     */\r\n    flush() {\r\n      while (logQueue.value.length > 0) {\r\n        const entry = logQueue.value.shift()!\r\n        writeLogToConsole(entry)\r\n      }\r\n      stopProcessing()\r\n    },\r\n\r\n    /**\r\n     * Gets current queue size\r\n     */\r\n    getQueueSize(): number {\r\n      return logQueue.value.length\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Global Error Handlers\r\n * Captures unhandled errors and promise rejections\r\n */\r\nexport function setupGlobalErrorHandlers() {\r\n  const logger = useLogger('GlobalError')\r\n\r\n  // Capture unhandled JavaScript errors\r\n  window.addEventListener('error', (event: ErrorEvent) => {\r\n    logger.error('Unhandled Error', {\r\n      message: event.message,\r\n      filename: event.filename,\r\n      lineno: event.lineno,\r\n      colno: event.colno,\r\n      error: event.error?.stack || event.error?.toString() || 'No stack trace'\r\n    })\r\n  })\r\n\r\n  // Capture unhandled promise rejections\r\n  window.addEventListener('unhandledrejection', (event: PromiseRejectionEvent) => {\r\n    logger.error('Unhandled Promise Rejection', {\r\n      reason: event.reason?.toString() || 'Unknown reason',\r\n      stack: event.reason?.stack || 'No stack trace'\r\n    })\r\n  })\r\n\r\n  logger.info('Global error handlers initialized')\r\n}\r\n\r\n/**\r\n * Vue Error Handler\r\n * Install this in main.ts: app.config.errorHandler = vueErrorHandler\r\n */\r\nexport function vueErrorHandler(err: any, instance: any, info: string) {\r\n  const logger = useLogger('VueError')\r\n\r\n  logger.error('Vue Error', {\r\n    error: err?.toString() || 'Unknown error',\r\n    stack: err?.stack || 'No stack trace',\r\n    component: instance?.$options?.name || instance?.$options?.__name || 'Unknown component',\r\n    info\r\n  })\r\n}\r\n","/**\r\n * Grid API Service\r\n *\r\n * Supports both HTTP mode (development) and WebView2 Host Objects mode (production)\r\n */\r\n\r\n// Extend Window interface for WebView2 gridApi\r\ndeclare global {\r\n  interface Window {\r\n    gridApi?: {\r\n      GetData(): Promise<string>\r\n      ImportData(jsonData: string): Promise<string>\r\n      ExportData(options: string): Promise<string>\r\n      GetConfig(): Promise<string>\r\n      SetValidationRules(jsonRules: string): Promise<string>\r\n      GetValidationRules(): Promise<string>\r\n      GetColumnNames(): Promise<string>\r\n      HealthCheck(): Promise<string>\r\n    }\r\n  }\r\n}\r\n\r\nconst BASE_URL = 'http://localhost:5000/api/grid'\r\n\r\nexport interface GridRow {\r\n  [key: string]: any\r\n  Checkbox?: boolean\r\n}\r\n\r\nexport interface ValidationRule {\r\n  columnName: string\r\n  ruleType: string\r\n  parameters: Record<string, any>\r\n  errorMessage: string\r\n}\r\n\r\nexport interface GridConfig {\r\n  pageSize: number\r\n  enableSort: boolean\r\n  enableFilter: boolean\r\n  enableSearch: boolean\r\n  enableValidation: boolean\r\n  showRowNumber: boolean\r\n  showCheckbox: boolean\r\n  showValidationAlerts: boolean\r\n  minRowHeight: number\r\n  maxRowHeight: number\r\n}\r\n\r\nexport interface ApiResponse<T> {\r\n  success: boolean\r\n  data?: T\r\n  error?: string\r\n  message?: string\r\n  rowCount?: number\r\n}\r\n\r\nclass GridApiService {\r\n  private isHostMode = false\r\n\r\n  constructor() {\r\n    // Detect if running in WebView2 with Host Objects\r\n    this.isHostMode = this.detectHostMode()\r\n    console.log(`Grid API Mode: ${this.isHostMode ? 'Host Objects' : 'HTTP'}`)\r\n  }\r\n\r\n  /**\r\n   * Detect if running in WebView2 with gridApi bridge\r\n   */\r\n  private detectHostMode(): boolean {\r\n    return !!window.gridApi\r\n  }\r\n\r\n  /**\r\n   * Call gridApi method (WebView2 mode with postMessage bridge)\r\n   */\r\n  private async callHostApi<T>(method: string, ...args: string[]): Promise<ApiResponse<T>> {\r\n    try {\r\n      if (!window.gridApi) {\r\n        throw new Error('Grid API not available')\r\n      }\r\n\r\n      const hostApi = window.gridApi\r\n      const resultJson = await (hostApi as any)[method](...args)\r\n\r\n      // Parse JSON response from C#\r\n      const result = JSON.parse(resultJson)\r\n      return result as ApiResponse<T>\r\n    } catch (error) {\r\n      console.error('Grid API call failed:', error)\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Unknown error'\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * HTTP request (development mode)\r\n   */\r\n  private async request<T>(endpoint: string, options?: RequestInit): Promise<ApiResponse<T>> {\r\n    try {\r\n      const response = await fetch(`${BASE_URL}${endpoint}`, {\r\n        ...options,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          ...options?.headers\r\n        },\r\n        credentials: 'include'\r\n      })\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({ error: response.statusText }))\r\n        return {\r\n          success: false,\r\n          error: errorData.error || `HTTP ${response.status}: ${response.statusText}`\r\n        }\r\n      }\r\n\r\n      const data = await response.json()\r\n      return data\r\n    } catch (error) {\r\n      console.error('API request failed:', error)\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Unknown error'\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get grid data from backend\r\n   */\r\n  async getData(): Promise<ApiResponse<GridRow[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<GridRow[]>('GetData')\r\n    } else {\r\n      return this.request<GridRow[]>('/data')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Import data to backend (replaces existing data)\r\n   */\r\n  async importData(data: GridRow[]): Promise<ApiResponse<void>> {\r\n    if (this.isHostMode) {\r\n      const jsonData = JSON.stringify({ data })\r\n      return this.callHostApi<void>('ImportData', jsonData)\r\n    } else {\r\n      return this.request<void>('/import', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ data })\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Export data from backend\r\n   */\r\n  async exportData(options?: {\r\n    onlyFiltered?: boolean\r\n    filteredRowIds?: string[]\r\n    columnNames?: string[]\r\n  }): Promise<ApiResponse<GridRow[]>> {\r\n    if (this.isHostMode) {\r\n      const optionsJson = JSON.stringify({\r\n        OnlyFiltered: options?.onlyFiltered ?? false,\r\n        FilteredRowIds: options?.filteredRowIds ?? null,\r\n        ColumnNames: options?.columnNames ?? null\r\n      })\r\n      return this.callHostApi<GridRow[]>('ExportData', optionsJson)\r\n    } else {\r\n      const params = new URLSearchParams()\r\n      if (options?.onlyFiltered) params.append('onlyFiltered', 'true')\r\n      if (options?.filteredRowIds) params.append('filteredRowIds', JSON.stringify(options.filteredRowIds))\r\n      if (options?.columnNames) params.append('columnNames', JSON.stringify(options.columnNames))\r\n\r\n      const query = params.toString() ? `?${params.toString()}` : ''\r\n      return this.request<GridRow[]>(`/export${query}`)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get grid configuration\r\n   */\r\n  async getConfig(): Promise<ApiResponse<GridConfig>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<GridConfig>('GetConfig')\r\n    } else {\r\n      return this.request<GridConfig>('/config')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set validation rules\r\n   */\r\n  async setValidationRules(rules: ValidationRule[]): Promise<ApiResponse<void>> {\r\n    if (this.isHostMode) {\r\n      const jsonRules = JSON.stringify({ rules })\r\n      return this.callHostApi<void>('SetValidationRules', jsonRules)\r\n    } else {\r\n      return this.request<void>('/validation-rules', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ rules })\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get validation rules\r\n   */\r\n  async getValidationRules(): Promise<ApiResponse<ValidationRule[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<ValidationRule[]>('GetValidationRules')\r\n    } else {\r\n      return this.request<ValidationRule[]>('/validation-rules')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all column names (data columns + checkbox special column)\r\n   */\r\n  async getColumnNames(): Promise<ApiResponse<string[]>> {\r\n    if (this.isHostMode) {\r\n      const result = await this.callHostApi<{ columnNames: string[] }>('GetColumnNames')\r\n      return {\r\n        success: result.success,\r\n        data: result.data?.columnNames,\r\n        error: result.error\r\n      }\r\n    } else {\r\n      return this.request<string[]>('/columns')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get column definitions\r\n   */\r\n  async getColumns(): Promise<ApiResponse<any[]>> {\r\n    if (this.isHostMode) {\r\n      return this.callHostApi<any[]>('GetColumns')\r\n    } else {\r\n      return this.request<any[]>('/columns/definitions')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Health check\r\n   */\r\n  async healthCheck(): Promise<boolean> {\r\n    try {\r\n      if (this.isHostMode) {\r\n        const result = await this.callHostApi<any>('HealthCheck')\r\n        return result.success\r\n      } else {\r\n        const response = await fetch('http://localhost:5000/health')\r\n        return response.ok\r\n      }\r\n    } catch {\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\nexport const gridApi = new GridApiService()\r\n","import { computed, inject, provide, ref, type Ref } from 'vue'\r\nimport type {\r\n  DataGridTheme,\r\n  ListBoxTheme,\r\n  ThemeConfig,\r\n  ComprehensiveDataGridTheme,\r\n  ComprehensiveListBoxTheme\r\n} from '@/types/theme'\r\n\r\n// ============================================================================\r\n// Default Theme: Light\r\n// ============================================================================\r\n\r\nexport const defaultDataGridTheme: DataGridTheme = {\r\n  cellColors: {\r\n    defaultBackground: '#ffffff',\r\n    defaultForeground: '#212529',\r\n    hoverBackground: '#f8f9fa',\r\n    hoverForeground: '#212529',\r\n    focusedBackground: '#e3f2fd',\r\n    focusedForeground: '#0d6efd',\r\n    disabledBackground: '#e9ecef',\r\n    disabledForeground: '#6c757d',\r\n    readOnlyBackground: '#f8f9fa',\r\n    readOnlyForeground: '#495057'\r\n  },\r\n  rowColors: {\r\n    evenRowBackground: '#ffffff',\r\n    oddRowBackground: '#f8f9fa',\r\n    hoverBackground: '#e3f2fd',\r\n    selectedBackground: '#0d6efd',\r\n    selectedForeground: '#ffffff',\r\n    selectedInactiveBackground: '#e9ecef',\r\n    selectedInactiveForeground: '#495057'\r\n  },\r\n  headerColors: {\r\n    background: '#f1f3f5',\r\n    foreground: '#212529',\r\n    hoverBackground: '#e9ecef',\r\n    pressedBackground: '#dee2e6',\r\n    sortIndicatorColor: '#0d6efd'\r\n  },\r\n  validationColors: {\r\n    errorBackground: '#ffebee',\r\n    errorForeground: '#c62828',\r\n    errorBorder: '#ef5350',\r\n    warningBackground: '#fff3e0',\r\n    warningForeground: '#e65100',\r\n    warningBorder: '#ff9800',\r\n    infoBackground: '#e3f2fd',\r\n    infoForeground: '#1565c0',\r\n    infoBorder: '#2196f3'\r\n  },\r\n  selectionColors: {\r\n    selectionBorder: '#0d6efd',\r\n    selectionFill: 'rgba(13, 110, 253, 0.1)',\r\n    multiSelectionBackground: '#bbdefb',\r\n    multiSelectionForeground: '#0d6efd'\r\n  },\r\n  borderColors: {\r\n    cellBorder: '#e0e0e0',\r\n    rowBorder: '#e0e0e0',\r\n    columnBorder: '#dee2e6',\r\n    gridBorder: '#ced4da',\r\n    focusedCellBorder: '#0d6efd'\r\n  },\r\n  specialColumnColors: {\r\n    rowNumberBackground: '#f5f5f5',\r\n    rowNumberForeground: '#666666',\r\n    checkboxBorder: '#ced4da',\r\n    checkboxBackground: '#ffffff',\r\n    checkboxForeground: '#212529',\r\n    deleteRowBackground: 'transparent',\r\n    deleteRowForeground: '#dc3545',\r\n    deleteRowHoverBackground: '#ffebee',\r\n    insertRowBackground: 'transparent',\r\n    insertRowForeground: '#28a745',\r\n    insertRowBorder: 'transparent',\r\n    insertRowHoverBackground: '#e8f5e9',\r\n    insertRowHoverForeground: '#1b5e20',\r\n    validationAlertsErrorBackground: '#ffebee',\r\n    validationAlertsErrorForeground: '#c62828'\r\n  },\r\n  uiControlColors: {\r\n    resizeGripColor: '#adb5bd',\r\n    menuBackground: '#ffffff',\r\n    menuForeground: '#212529',\r\n    menuHoverBackground: '#f8f9fa',\r\n    dialogBackground: '#ffffff',\r\n    dialogForeground: '#212529',\r\n    dialogBorder: '#dee2e6',\r\n    placeholderColor: '#6c757d',\r\n    searchPanelBackground: '#f8f9fa',\r\n    searchPanelForeground: '#212529',\r\n    searchPanelBorder: '#ced4da',\r\n    filterRowBackground: '#f8f9fa',\r\n    filterRowForeground: '#212529',\r\n    filterRowBorder: '#dee2e6',\r\n    paginationBackground: '#ffffff',\r\n    paginationForeground: '#212529',\r\n    paginationBorder: '#dee2e6',\r\n    paginationButtonHoverBackground: '#e9ecef'\r\n  }\r\n}\r\n\r\nexport const defaultListBoxTheme: ListBoxTheme = {\r\n  itemColors: {\r\n    defaultBackground: '#ffffff',\r\n    defaultForeground: '#212529',\r\n    hoverBackground: '#f8f9fa',\r\n    hoverForeground: '#212529',\r\n    selectedBackground: '#e3f2fd',\r\n    selectedForeground: '#0d6efd',\r\n    selectedHoverBackground: '#bbdefb',\r\n    selectedHoverForeground: '#0d6efd',\r\n    disabledBackground: '#e9ecef',\r\n    disabledForeground: '#6c757d'\r\n  },\r\n  containerColors: {\r\n    background: '#ffffff',\r\n    border: '#ced4da',\r\n    focusedBorder: '#0d6efd',\r\n    titleForeground: '#212529'\r\n  },\r\n  checkboxColors: {\r\n    border: '#ced4da',\r\n    background: '#ffffff',\r\n    checkedBackground: '#0d6efd',\r\n    checkedBorder: '#0d6efd',\r\n    hoverBorder: '#adb5bd'\r\n  },\r\n  scrollbarColors: {\r\n    trackBackground: '#f1f1f1',\r\n    thumbBackground: '#c1c1c1',\r\n    thumbHoverBackground: '#a8a8a8'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Dark Theme\r\n// ============================================================================\r\n\r\nexport const darkDataGridTheme: DataGridTheme = {\r\n  cellColors: {\r\n    defaultBackground: '#1e1e1e',\r\n    defaultForeground: '#e0e0e0',\r\n    hoverBackground: '#2d2d2d',\r\n    hoverForeground: '#e0e0e0',\r\n    focusedBackground: '#1e3a5f',\r\n    focusedForeground: '#64b5f6',\r\n    disabledBackground: '#2a2a2a',\r\n    disabledForeground: '#808080',\r\n    readOnlyBackground: '#252525',\r\n    readOnlyForeground: '#b0b0b0'\r\n  },\r\n  rowColors: {\r\n    evenRowBackground: '#1e1e1e',\r\n    oddRowBackground: '#252525',\r\n    hoverBackground: '#2d2d2d',\r\n    selectedBackground: '#1976d2',\r\n    selectedForeground: '#ffffff',\r\n    selectedInactiveBackground: '#3a3a3a',\r\n    selectedInactiveForeground: '#b0b0b0'\r\n  },\r\n  headerColors: {\r\n    background: '#2a2a2a',\r\n    foreground: '#e0e0e0',\r\n    hoverBackground: '#333333',\r\n    pressedBackground: '#3a3a3a',\r\n    sortIndicatorColor: '#64b5f6'\r\n  },\r\n  validationColors: {\r\n    errorBackground: '#3d1a1a',\r\n    errorForeground: '#ef5350',\r\n    errorBorder: '#c62828',\r\n    warningBackground: '#3d2e1a',\r\n    warningForeground: '#ffb74d',\r\n    warningBorder: '#f57c00',\r\n    infoBackground: '#1a2a3d',\r\n    infoForeground: '#64b5f6',\r\n    infoBorder: '#1976d2'\r\n  },\r\n  selectionColors: {\r\n    selectionBorder: '#1976d2',\r\n    selectionFill: 'rgba(25, 118, 210, 0.2)',\r\n    multiSelectionBackground: '#1e3a5f',\r\n    multiSelectionForeground: '#64b5f6'\r\n  },\r\n  borderColors: {\r\n    cellBorder: '#3a3a3a',\r\n    rowBorder: '#3a3a3a',\r\n    columnBorder: '#3a3a3a',\r\n    gridBorder: '#4a4a4a',\r\n    focusedCellBorder: '#1976d2'\r\n  },\r\n  specialColumnColors: {\r\n    rowNumberBackground: '#252525',\r\n    rowNumberForeground: '#b0b0b0',\r\n    checkboxBorder: '#4a4a4a',\r\n    checkboxBackground: '#2a2a2a',\r\n    checkboxForeground: '#e0e0e0',\r\n    deleteRowBackground: 'transparent',\r\n    deleteRowForeground: '#ef5350',\r\n    deleteRowHoverBackground: '#3d1a1a',\r\n    insertRowBackground: 'transparent',\r\n    insertRowForeground: '#66bb6a',\r\n    insertRowBorder: 'transparent',\r\n    insertRowHoverBackground: '#1a3d1a',\r\n    insertRowHoverForeground: '#81c784',\r\n    validationAlertsErrorBackground: '#3d1a1a',\r\n    validationAlertsErrorForeground: '#ef5350'\r\n  },\r\n  uiControlColors: {\r\n    resizeGripColor: '#5a5a5a',\r\n    menuBackground: '#2a2a2a',\r\n    menuForeground: '#e0e0e0',\r\n    menuHoverBackground: '#333333',\r\n    dialogBackground: '#2a2a2a',\r\n    dialogForeground: '#e0e0e0',\r\n    dialogBorder: '#4a4a4a',\r\n    placeholderColor: '#808080',\r\n    searchPanelBackground: '#252525',\r\n    searchPanelForeground: '#e0e0e0',\r\n    searchPanelBorder: '#4a4a4a',\r\n    filterRowBackground: '#252525',\r\n    filterRowForeground: '#e0e0e0',\r\n    filterRowBorder: '#4a4a4a',\r\n    paginationBackground: '#2a2a2a',\r\n    paginationForeground: '#e0e0e0',\r\n    paginationBorder: '#4a4a4a',\r\n    paginationButtonHoverBackground: '#333333'\r\n  }\r\n}\r\n\r\nexport const darkListBoxTheme: ListBoxTheme = {\r\n  itemColors: {\r\n    defaultBackground: '#1e1e1e',\r\n    defaultForeground: '#e0e0e0',\r\n    hoverBackground: '#2d2d2d',\r\n    hoverForeground: '#e0e0e0',\r\n    selectedBackground: '#1e3a5f',\r\n    selectedForeground: '#64b5f6',\r\n    selectedHoverBackground: '#2d4a6f',\r\n    selectedHoverForeground: '#64b5f6',\r\n    disabledBackground: '#2a2a2a',\r\n    disabledForeground: '#808080'\r\n  },\r\n  containerColors: {\r\n    background: '#1e1e1e',\r\n    border: '#4a4a4a',\r\n    focusedBorder: '#1976d2',\r\n    titleForeground: '#e0e0e0'\r\n  },\r\n  checkboxColors: {\r\n    border: '#4a4a4a',\r\n    background: '#2a2a2a',\r\n    checkedBackground: '#1976d2',\r\n    checkedBorder: '#1976d2',\r\n    hoverBorder: '#5a5a5a'\r\n  },\r\n  scrollbarColors: {\r\n    trackBackground: '#2a2a2a',\r\n    thumbBackground: '#4a4a4a',\r\n    thumbHoverBackground: '#5a5a5a'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// High Contrast Theme\r\n// ============================================================================\r\n\r\nexport const highContrastDataGridTheme: DataGridTheme = {\r\n  cellColors: {\r\n    defaultBackground: '#000000',\r\n    defaultForeground: '#ffffff',\r\n    hoverBackground: '#1a1a1a',\r\n    hoverForeground: '#ffff00',\r\n    focusedBackground: '#000080',\r\n    focusedForeground: '#ffffff',\r\n    disabledBackground: '#333333',\r\n    disabledForeground: '#808080',\r\n    readOnlyBackground: '#1a1a1a',\r\n    readOnlyForeground: '#c0c0c0'\r\n  },\r\n  rowColors: {\r\n    evenRowBackground: '#000000',\r\n    oddRowBackground: '#0d0d0d',\r\n    hoverBackground: '#1a1a1a',\r\n    selectedBackground: '#000080',\r\n    selectedForeground: '#ffffff',\r\n    selectedInactiveBackground: '#333333',\r\n    selectedInactiveForeground: '#c0c0c0'\r\n  },\r\n  headerColors: {\r\n    background: '#1a1a1a',\r\n    foreground: '#ffffff',\r\n    hoverBackground: '#333333',\r\n    pressedBackground: '#4d4d4d',\r\n    sortIndicatorColor: '#00ff00'\r\n  },\r\n  validationColors: {\r\n    errorBackground: '#330000',\r\n    errorForeground: '#ff0000',\r\n    errorBorder: '#ff0000',\r\n    warningBackground: '#332200',\r\n    warningForeground: '#ffff00',\r\n    warningBorder: '#ffff00',\r\n    infoBackground: '#003333',\r\n    infoForeground: '#00ffff',\r\n    infoBorder: '#00ffff'\r\n  },\r\n  selectionColors: {\r\n    selectionBorder: '#00ff00',\r\n    selectionFill: 'rgba(0, 255, 0, 0.2)',\r\n    multiSelectionBackground: '#000080',\r\n    multiSelectionForeground: '#ffffff'\r\n  },\r\n  borderColors: {\r\n    cellBorder: '#808080',\r\n    rowBorder: '#808080',\r\n    columnBorder: '#808080',\r\n    gridBorder: '#ffffff',\r\n    focusedCellBorder: '#00ff00'\r\n  },\r\n  specialColumnColors: {\r\n    rowNumberBackground: '#1a1a1a',\r\n    rowNumberForeground: '#ffffff',\r\n    checkboxBorder: '#ffffff',\r\n    checkboxBackground: '#000000',\r\n    checkboxForeground: '#ffffff',\r\n    deleteRowBackground: 'transparent',\r\n    deleteRowForeground: '#ff0000',\r\n    deleteRowHoverBackground: '#330000',\r\n    insertRowBackground: 'transparent',\r\n    insertRowForeground: '#00ff00',\r\n    insertRowBorder: 'transparent',\r\n    insertRowHoverBackground: '#003300',\r\n    insertRowHoverForeground: '#00ff00',\r\n    validationAlertsErrorBackground: '#330000',\r\n    validationAlertsErrorForeground: '#ff0000'\r\n  },\r\n  uiControlColors: {\r\n    resizeGripColor: '#ffffff',\r\n    menuBackground: '#000000',\r\n    menuForeground: '#ffffff',\r\n    menuHoverBackground: '#1a1a1a',\r\n    dialogBackground: '#000000',\r\n    dialogForeground: '#ffffff',\r\n    dialogBorder: '#ffffff',\r\n    placeholderColor: '#808080',\r\n    searchPanelBackground: '#1a1a1a',\r\n    searchPanelForeground: '#ffffff',\r\n    searchPanelBorder: '#ffffff',\r\n    filterRowBackground: '#1a1a1a',\r\n    filterRowForeground: '#ffffff',\r\n    filterRowBorder: '#ffffff',\r\n    paginationBackground: '#000000',\r\n    paginationForeground: '#ffffff',\r\n    paginationBorder: '#ffffff',\r\n    paginationButtonHoverBackground: '#333333'\r\n  }\r\n}\r\n\r\nexport const highContrastListBoxTheme: ListBoxTheme = {\r\n  itemColors: {\r\n    defaultBackground: '#000000',\r\n    defaultForeground: '#ffffff',\r\n    hoverBackground: '#1a1a1a',\r\n    hoverForeground: '#ffff00',\r\n    selectedBackground: '#000080',\r\n    selectedForeground: '#ffffff',\r\n    selectedHoverBackground: '#0000b0',\r\n    selectedHoverForeground: '#ffffff',\r\n    disabledBackground: '#333333',\r\n    disabledForeground: '#808080'\r\n  },\r\n  containerColors: {\r\n    background: '#000000',\r\n    border: '#ffffff',\r\n    focusedBorder: '#00ff00',\r\n    titleForeground: '#ffffff'\r\n  },\r\n  checkboxColors: {\r\n    border: '#ffffff',\r\n    background: '#000000',\r\n    checkedBackground: '#000080',\r\n    checkedBorder: '#ffffff',\r\n    hoverBorder: '#ffff00'\r\n  },\r\n  scrollbarColors: {\r\n    trackBackground: '#1a1a1a',\r\n    thumbBackground: '#808080',\r\n    thumbHoverBackground: '#c0c0c0'\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Theme Provider\r\n// ============================================================================\r\n\r\nconst THEME_KEY = Symbol('theme')\r\n\r\nexport function useThemeProvider(theme: ThemeConfig = {}) {\r\n  const dataGridTheme = ref<DataGridTheme>(\r\n    mergeDeep(defaultDataGridTheme, theme.dataGrid || {}) as DataGridTheme\r\n  )\r\n  const listBoxTheme = ref<ListBoxTheme>(\r\n    mergeDeep(defaultListBoxTheme, theme.listBox || {}) as ListBoxTheme\r\n  )\r\n\r\n  provide(THEME_KEY, {\r\n    dataGridTheme,\r\n    listBoxTheme\r\n  })\r\n\r\n  return {\r\n    dataGridTheme,\r\n    listBoxTheme\r\n  }\r\n}\r\n\r\nexport function useTheme() {\r\n  const theme = inject<{\r\n    dataGridTheme: Ref<DataGridTheme>\r\n    listBoxTheme: Ref<ListBoxTheme>\r\n  }>(THEME_KEY, {\r\n    dataGridTheme: ref(defaultDataGridTheme),\r\n    listBoxTheme: ref(defaultListBoxTheme)\r\n  })\r\n\r\n  return theme\r\n}\r\n\r\n// ============================================================================\r\n// Utility Functions\r\n// ============================================================================\r\n\r\nfunction mergeDeep(target: any, source: any): any {\r\n  const output = { ...target }\r\n\r\n  if (isObject(target) && isObject(source)) {\r\n    Object.keys(source).forEach(key => {\r\n      if (isObject(source[key])) {\r\n        if (!(key in target)) {\r\n          Object.assign(output, { [key]: source[key] })\r\n        } else {\r\n          output[key] = mergeDeep(target[key], source[key])\r\n        }\r\n      } else {\r\n        Object.assign(output, { [key]: source[key] })\r\n      }\r\n    })\r\n  }\r\n\r\n  return output\r\n}\r\n\r\nfunction isObject(item: any): boolean {\r\n  return item && typeof item === 'object' && !Array.isArray(item)\r\n}\r\n\r\n// ============================================================================\r\n// CSS Variable Generation\r\n// ============================================================================\r\n\r\nexport function generateDataGridCSSVariables(theme: DataGridTheme): Record<string, string> {\r\n  return {\r\n    // Cell Colors\r\n    '--dg-cell-bg': theme.cellColors.defaultBackground,\r\n    '--dg-cell-fg': theme.cellColors.defaultForeground,\r\n    '--dg-cell-hover-bg': theme.cellColors.hoverBackground,\r\n    '--dg-cell-hover-fg': theme.cellColors.hoverForeground,\r\n    '--dg-cell-focused-bg': theme.cellColors.focusedBackground,\r\n    '--dg-cell-focused-fg': theme.cellColors.focusedForeground,\r\n    '--dg-cell-disabled-bg': theme.cellColors.disabledBackground,\r\n    '--dg-cell-disabled-fg': theme.cellColors.disabledForeground,\r\n    '--dg-cell-readonly-bg': theme.cellColors.readOnlyBackground,\r\n    '--dg-cell-readonly-fg': theme.cellColors.readOnlyForeground,\r\n\r\n    // Row Colors\r\n    '--dg-row-even-bg': theme.rowColors.evenRowBackground,\r\n    '--dg-row-odd-bg': theme.rowColors.oddRowBackground,\r\n    '--dg-row-hover-bg': theme.rowColors.hoverBackground,\r\n    '--dg-row-selected-bg': theme.rowColors.selectedBackground,\r\n    '--dg-row-selected-fg': theme.rowColors.selectedForeground,\r\n    '--dg-row-selected-inactive-bg': theme.rowColors.selectedInactiveBackground,\r\n    '--dg-row-selected-inactive-fg': theme.rowColors.selectedInactiveForeground,\r\n\r\n    // Header Colors\r\n    '--dg-header-bg': theme.headerColors.background,\r\n    '--dg-header-fg': theme.headerColors.foreground,\r\n    '--dg-header-hover-bg': theme.headerColors.hoverBackground,\r\n    '--dg-header-pressed-bg': theme.headerColors.pressedBackground,\r\n    '--dg-header-sort-indicator': theme.headerColors.sortIndicatorColor,\r\n\r\n    // Validation Colors\r\n    '--dg-validation-error-bg': theme.validationColors.errorBackground,\r\n    '--dg-validation-error-fg': theme.validationColors.errorForeground,\r\n    '--dg-validation-error-border': theme.validationColors.errorBorder,\r\n    '--dg-validation-warning-bg': theme.validationColors.warningBackground,\r\n    '--dg-validation-warning-fg': theme.validationColors.warningForeground,\r\n    '--dg-validation-warning-border': theme.validationColors.warningBorder,\r\n    '--dg-validation-info-bg': theme.validationColors.infoBackground,\r\n    '--dg-validation-info-fg': theme.validationColors.infoForeground,\r\n    '--dg-validation-info-border': theme.validationColors.infoBorder,\r\n\r\n    // Selection Colors\r\n    '--dg-selection-border': theme.selectionColors.selectionBorder,\r\n    '--dg-selection-fill': theme.selectionColors.selectionFill,\r\n    '--dg-multi-selection-bg': theme.selectionColors.multiSelectionBackground,\r\n    '--dg-multi-selection-fg': theme.selectionColors.multiSelectionForeground,\r\n\r\n    // Border Colors\r\n    '--dg-border-cell': theme.borderColors.cellBorder,\r\n    '--dg-border-row': theme.borderColors.rowBorder,\r\n    '--dg-border-column': theme.borderColors.columnBorder,\r\n    '--dg-border-grid': theme.borderColors.gridBorder,\r\n    '--dg-border-focused-cell': theme.borderColors.focusedCellBorder,\r\n\r\n    // Special Column Colors\r\n    '--dg-special-rownumber-bg': theme.specialColumnColors.rowNumberBackground,\r\n    '--dg-special-rownumber-fg': theme.specialColumnColors.rowNumberForeground,\r\n    '--dg-special-checkbox-border': theme.specialColumnColors.checkboxBorder,\r\n    '--dg-special-checkbox-bg': theme.specialColumnColors.checkboxBackground,\r\n    '--dg-special-checkbox-fg': theme.specialColumnColors.checkboxForeground,\r\n    '--dg-special-delete-bg': theme.specialColumnColors.deleteRowBackground,\r\n    '--dg-special-delete-fg': theme.specialColumnColors.deleteRowForeground,\r\n    '--dg-special-delete-hover-bg': theme.specialColumnColors.deleteRowHoverBackground,\r\n    '--dg-special-insert-bg': theme.specialColumnColors.insertRowBackground,\r\n    '--dg-special-insert-fg': theme.specialColumnColors.insertRowForeground,\r\n    '--dg-special-insert-border': theme.specialColumnColors.insertRowBorder,\r\n    '--dg-special-insert-hover-bg': theme.specialColumnColors.insertRowHoverBackground,\r\n    '--dg-special-insert-hover-fg': theme.specialColumnColors.insertRowHoverForeground,\r\n    '--dg-special-validation-error-bg': theme.specialColumnColors.validationAlertsErrorBackground,\r\n    '--dg-special-validation-error-fg': theme.specialColumnColors.validationAlertsErrorForeground,\r\n\r\n    // UI Control Colors\r\n    '--dg-ui-resize-grip': theme.uiControlColors.resizeGripColor,\r\n    '--dg-ui-menu-bg': theme.uiControlColors.menuBackground,\r\n    '--dg-ui-menu-fg': theme.uiControlColors.menuForeground,\r\n    '--dg-ui-menu-hover-bg': theme.uiControlColors.menuHoverBackground,\r\n    '--dg-ui-dialog-bg': theme.uiControlColors.dialogBackground,\r\n    '--dg-ui-dialog-fg': theme.uiControlColors.dialogForeground,\r\n    '--dg-ui-dialog-border': theme.uiControlColors.dialogBorder,\r\n    '--dg-ui-placeholder': theme.uiControlColors.placeholderColor,\r\n    '--dg-ui-search-bg': theme.uiControlColors.searchPanelBackground,\r\n    '--dg-ui-search-fg': theme.uiControlColors.searchPanelForeground,\r\n    '--dg-ui-search-border': theme.uiControlColors.searchPanelBorder,\r\n    '--dg-ui-filter-bg': theme.uiControlColors.filterRowBackground,\r\n    '--dg-ui-filter-fg': theme.uiControlColors.filterRowForeground,\r\n    '--dg-ui-filter-border': theme.uiControlColors.filterRowBorder,\r\n    '--dg-ui-pagination-bg': theme.uiControlColors.paginationBackground,\r\n    '--dg-ui-pagination-fg': theme.uiControlColors.paginationForeground,\r\n    '--dg-ui-pagination-border': theme.uiControlColors.paginationBorder,\r\n    '--dg-ui-pagination-button-hover-bg': theme.uiControlColors.paginationButtonHoverBackground\r\n  }\r\n}\r\n\r\nexport function generateListBoxCSSVariables(theme: ListBoxTheme): Record<string, string> {\r\n  return {\r\n    // Item Colors\r\n    '--lb-item-bg': theme.itemColors.defaultBackground,\r\n    '--lb-item-fg': theme.itemColors.defaultForeground,\r\n    '--lb-item-hover-bg': theme.itemColors.hoverBackground,\r\n    '--lb-item-hover-fg': theme.itemColors.hoverForeground,\r\n    '--lb-item-selected-bg': theme.itemColors.selectedBackground,\r\n    '--lb-item-selected-fg': theme.itemColors.selectedForeground,\r\n    '--lb-item-selected-hover-bg': theme.itemColors.selectedHoverBackground,\r\n    '--lb-item-selected-hover-fg': theme.itemColors.selectedHoverForeground,\r\n    '--lb-item-disabled-bg': theme.itemColors.disabledBackground,\r\n    '--lb-item-disabled-fg': theme.itemColors.disabledForeground,\r\n\r\n    // Container Colors\r\n    '--lb-container-bg': theme.containerColors.background,\r\n    '--lb-container-border': theme.containerColors.border,\r\n    '--lb-container-focused-border': theme.containerColors.focusedBorder,\r\n    '--lb-title-fg': theme.containerColors.titleForeground,\r\n\r\n    // Checkbox Colors\r\n    '--lb-checkbox-border': theme.checkboxColors.border,\r\n    '--lb-checkbox-bg': theme.checkboxColors.background,\r\n    '--lb-checkbox-checked-bg': theme.checkboxColors.checkedBackground,\r\n    '--lb-checkbox-checked-border': theme.checkboxColors.checkedBorder,\r\n    '--lb-checkbox-hover-border': theme.checkboxColors.hoverBorder,\r\n\r\n    // Scrollbar Colors\r\n    '--lb-scrollbar-track-bg': theme.scrollbarColors.trackBackground,\r\n    '--lb-scrollbar-thumb-bg': theme.scrollbarColors.thumbBackground,\r\n    '--lb-scrollbar-thumb-hover-bg': theme.scrollbarColors.thumbHoverBackground\r\n  }\r\n}\r\n","<template>\r\n  <div class=\"grid-header\" :style=\"{ gridTemplateColumns }\">\r\n    <div\r\n      v-for=\"column in columns\"\r\n      :key=\"column.name\"\r\n      class=\"header-cell\"\r\n      :class=\"{ 'header-cell--auto-width': column.autoWidth }\"\r\n      @click=\"handleHeaderClick($event, column)\"\r\n      @contextmenu.prevent=\"showHeaderContextMenu($event, column)\"\r\n    >\r\n      <!-- Custom tri-state checkbox (not native input) -->\r\n      <div\r\n        v-if=\"column.specialType === 'Checkbox'\"\r\n        class=\"custom-checkbox\"\r\n        :class=\"{\r\n          'checkbox-none': store.checkboxState === 'none',\r\n          'checkbox-some': store.checkboxState === 'some',\r\n          'checkbox-all': store.checkboxState === 'all'\r\n        }\"\r\n        @click.stop=\"handleCheckboxHeaderClick\"\r\n        title=\"Toggle all checkboxes\"\r\n      >\r\n        <!-- Checkmark for 'all' state -->\r\n        <span v-if=\"store.checkboxState === 'all'\" class=\"checkbox-icon\"></span>\r\n        <!-- Dash for 'some' state -->\r\n        <span v-else-if=\"store.checkboxState === 'some'\" class=\"checkbox-icon\"></span>\r\n      </div>\r\n\r\n      <span v-else class=\"header-text\">{{ column.header }}</span>\r\n\r\n      <!-- Multi-column sort indicator -->\r\n      <span\r\n        v-if=\"column.isSortable && getSortInfo(column.name)\"\r\n        class=\"sort-icon\"\r\n        :class=\"getSortInfo(column.name)?.isPrimary ? 'sort-icon--primary' : 'sort-icon--secondary'\"\r\n      >\r\n        {{ getSortInfo(column.name)?.direction === 'asc' ? '' : '' }}\r\n        <span v-if=\"getSortInfo(column.name)?.order && getSortInfo(column.name)!.order > 1\" class=\"sort-order\">\r\n          {{ getSortInfo(column.name)?.order }}\r\n        </span>\r\n      </span>\r\n\r\n      <!-- Resize grip -->\r\n      <div\r\n        class=\"resize-grip\"\r\n        @mousedown.stop=\"startResize(column, $event)\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed } from 'vue'\r\nimport { useDataGridStore, type GridColumn } from '@/stores/dataGridStore'\r\nimport ContextMenu from '@imengyu/vue3-context-menu'\r\n\r\nconst props = defineProps<{\r\n  columns: GridColumn[]\r\n  gridTemplateColumns: string\r\n  gridId?: string\r\n  isGridReady?: boolean\r\n  isProcessing?: boolean  //  RIEENIE A: Processing flag\r\n  showHiddenColumnsPanel?: boolean  // Optional: Show hidden columns panel (default: true)\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  sort: [columnName: string, direction: 'asc' | 'desc']\r\n  resize: [columnName: string, newWidth: number]\r\n  hideColumn: [columnName: string]\r\n  autoFitColumn: [columnName: string]\r\n  showFilter: [columnName: string]\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId)()\r\n\r\n// No longer need ref or watch - custom checkbox is controlled by Vue reactivity\r\n\r\nconst resizingColumn = ref<GridColumn | null>(null)\r\nconst resizeStartX = ref(0)\r\nconst resizeStartWidth = ref(0)\r\n\r\n/**\r\n *  RIEENIE B: Computed sortInfoMap - cache sort info for all columns\r\n * Only recalculates when store.sortColumns changes (1 access instead of 6 per column)\r\n */\r\nconst sortInfoMap = computed(() => {\r\n  const map = new Map<string, { direction: 'asc' | 'desc'; order: number; isPrimary: boolean }>()\r\n\r\n  store.sortColumns.forEach((sortCol, index) => {\r\n    map.set(sortCol.columnName, {\r\n      direction: sortCol.direction,\r\n      order: index + 1,\r\n      isPrimary: index === 0\r\n    })\r\n  })\r\n\r\n  return map\r\n})\r\n\r\n/**\r\n *  RIEENIE E + B: Gets sort information using computed Map (O(1) lookup)\r\n * Returns null if column is not sorted\r\n */\r\nfunction getSortInfo(columnName: string): { direction: 'asc' | 'desc'; order: number; isPrimary: boolean } | null {\r\n  return sortInfoMap.value.get(columnName) ?? null\r\n}\r\n\r\nfunction handleHeaderClick(event: MouseEvent, column: GridColumn) {\r\n  // For checkbox column, do nothing (checkbox handles its own click)\r\n  if (column.specialType === 'Checkbox') {\r\n    return\r\n  }\r\n\r\n  // For sortable columns with Shift key, toggle sort\r\n  if (column.isSortable && event.shiftKey) {\r\n    handleSort(column, true) // multi-sort mode\r\n    return\r\n  }\r\n\r\n  // For other columns, show context menu\r\n  showHeaderContextMenu(event, column)\r\n}\r\n\r\nfunction handleCheckboxHeaderClick() {\r\n  store.toggleAllCheckboxes()\r\n}\r\n\r\nfunction handleSort(column: GridColumn, multiSort = false) {\r\n  if (!column.isSortable) return\r\n\r\n  const currentSort = getSortInfo(column.name)\r\n\r\n  if (currentSort) {\r\n    // Column is already sorted - toggle direction\r\n    const newDirection = currentSort.direction === 'asc' ? 'desc' : 'asc'\r\n    store.addSort(column.name, newDirection, multiSort)\r\n  } else {\r\n    // Column is not sorted - add ascending sort\r\n    store.addSort(column.name, 'asc', multiSort)\r\n  }\r\n\r\n  // Emit for compatibility (even though store handles it)\r\n  const sortInfo = getSortInfo(column.name)\r\n  if (sortInfo) {\r\n    emit('sort', column.name, sortInfo.direction)\r\n  }\r\n}\r\n\r\nfunction startResize(column: GridColumn, event: MouseEvent) {\r\n  resizingColumn.value = column\r\n  resizeStartX.value = event.clientX\r\n  resizeStartWidth.value = column.width\r\n\r\n  window.addEventListener('mousemove', onResizeMove)\r\n  window.addEventListener('mouseup', onResizeEnd)\r\n}\r\n\r\nfunction onResizeMove(event: MouseEvent) {\r\n  if (!resizingColumn.value) return\r\n\r\n  const delta = event.clientX - resizeStartX.value\r\n  const newWidth = Math.max(\r\n    resizingColumn.value.minWidth,\r\n    Math.min(resizingColumn.value.maxWidth, resizeStartWidth.value + delta)\r\n  )\r\n\r\n  emit('resize', resizingColumn.value.name, newWidth)\r\n}\r\n\r\nfunction onResizeEnd() {\r\n  resizingColumn.value = null\r\n  window.removeEventListener('mousemove', onResizeMove)\r\n  window.removeEventListener('mouseup', onResizeEnd)\r\n}\r\n\r\nfunction showHeaderContextMenu(event: MouseEvent, column: GridColumn) {\r\n  //  FIX: Early return if grid is not ready\r\n  if (props.isGridReady === false) {\r\n    console.error('[showHeaderContextMenu] Grid not ready yet')\r\n    return\r\n  }\r\n\r\n  //  FIX: Early return if store is not initialized\r\n  if (!store) {\r\n    console.error('[showHeaderContextMenu] Store not initialized yet')\r\n    return\r\n  }\r\n\r\n  //  RIEENIE A: Check processing flag\r\n  if (props.isProcessing) {\r\n    console.error('[showHeaderContextMenu] Grid is currently processing data')\r\n    return  // Silent return - no alert needed\r\n  }\r\n\r\n  //  RIEENIE D: Defensive copy of reactive data\r\n  const sortColumnsCopy = [...store.sortColumns]\r\n  const filterExpressionCopy = store.filterExpression\r\n\r\n  const menuItems = []\r\n\r\n  // Sort options\r\n  if (column.isSortable) {\r\n    const currentSort = getSortInfo(column.name)\r\n    const hasOtherSorts = sortColumnsCopy.length > 0  //  Use copy\r\n\r\n    menuItems.push(\r\n      {\r\n        label: 'Sort Ascending',\r\n        icon: '',\r\n        onClick: () => {\r\n          store.addSort(column.name, 'asc', false)\r\n          emit('sort', column.name, 'asc')\r\n        }\r\n      },\r\n      {\r\n        label: 'Sort Descending',\r\n        icon: '',\r\n        onClick: () => {\r\n          store.addSort(column.name, 'desc', false)\r\n          emit('sort', column.name, 'desc')\r\n        }\r\n      }\r\n    )\r\n\r\n    // Multi-sort options\r\n    if (hasOtherSorts) {\r\n      menuItems.push(\r\n        { divided: true },\r\n        {\r\n          label: 'Add to Sort (Asc)',\r\n          icon: '+',\r\n          onClick: () => {\r\n            store.addSort(column.name, 'asc', true)\r\n          }\r\n        },\r\n        {\r\n          label: 'Add to Sort (Desc)',\r\n          icon: '+',\r\n          onClick: () => {\r\n            store.addSort(column.name, 'desc', true)\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    // Remove from sort if already sorted\r\n    if (currentSort) {\r\n      menuItems.push(\r\n        { divided: true },\r\n        {\r\n          label: `Remove from Sort (Order ${currentSort.order})`,\r\n          icon: '',\r\n          onClick: () => {\r\n            const newSorts = sortColumnsCopy.filter(s => s.columnName !== column.name)  //  Use copy\r\n            store.setSortColumns(newSorts)\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    // Clear all sorts\r\n    if (hasOtherSorts) {\r\n      menuItems.push(\r\n        {\r\n          label: 'Clear All Sorts',\r\n          icon: '',\r\n          onClick: () => {\r\n            store.clearSort()\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    menuItems.push({ divided: true })\r\n  }\r\n\r\n  // Filter option\r\n  if (column.isFilterable) {\r\n    menuItems.push(\r\n      {\r\n        label: 'Filter...',\r\n        icon: '',\r\n        onClick: () => emit('showFilter', column.name)\r\n      }\r\n    )\r\n\r\n    // Clear all filters option (show only if filters exist)\r\n    if (filterExpressionCopy !== null) {  //  Use copy\r\n      menuItems.push(\r\n        {\r\n          label: 'Clear All Filters',\r\n          icon: '',\r\n          onClick: () => {\r\n            store.clearFilter()\r\n          }\r\n        }\r\n      )\r\n    }\r\n\r\n    menuItems.push({ divided: true })\r\n  }\r\n\r\n  // Column management options (only for non-special columns)\r\n  if (!column.specialType) {\r\n    menuItems.push({\r\n      label: 'Auto-fit Column',\r\n      icon: '',\r\n      onClick: () => emit('autoFitColumn', column.name)\r\n    })\r\n\r\n    // Hide option only if showHiddenColumnsPanel is not explicitly false\r\n    if (props.showHiddenColumnsPanel !== false) {\r\n      menuItems.push({\r\n        label: 'Hide Column',\r\n        icon: '',\r\n        onClick: () => emit('hideColumn', column.name)\r\n      })\r\n    }\r\n  }\r\n\r\n  ContextMenu.showContextMenu({\r\n    x: event.x,\r\n    y: event.y,\r\n    items: menuItems\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grid-header {\r\n  display: grid; /* Changed from flex to grid for perfect column alignment */\r\n  /* grid-template-columns applied via inline style from parent */\r\n  background-color: var(--dg-header-bg, #f5f5f5);\r\n  color: var(--dg-header-fg, #212529);\r\n  border-bottom: 2px solid var(--dg-border-column, #ccc);\r\n  font-weight: bold;\r\n  position: sticky;\r\n  top: 0;\r\n  z-index: 10;\r\n  width: 100%; /* CRITICAL: Always fill container width */\r\n  max-width: 100%; /* CRITICAL: Never exceed container width */\r\n  /* CRITICAL: Compensate for vertical scrollbar width to align columns with rows */\r\n  /* Reduced to 8px for narrower spacing (user requested), can be customized via CSS variable */\r\n  padding-right: var(--dg-scrollbar-width, 8px);\r\n  box-sizing: border-box;\r\n  /* REMOVED min-width: fit-content - this was causing header to have different width than rows! */\r\n  /* Header MUST have identical width to rows for 1fr to resolve to same pixels */\r\n}\r\n\r\n.header-cell {\r\n  position: relative;\r\n  padding: 8px;\r\n  border-right: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  cursor: pointer;\r\n  user-select: none;\r\n  display: flex; /* Keep flex for internal layout (icon + text alignment) */\r\n  align-items: center;\r\n  gap: 4px;\r\n  overflow: hidden; /* Prevent content from breaking grid layout */\r\n}\r\n\r\n.header-cell:hover {\r\n  background-color: var(--dg-header-hover-bg, #eeeeee);\r\n}\r\n\r\n.header-cell:active {\r\n  background-color: var(--dg-header-pressed-bg, #dee2e6);\r\n}\r\n\r\n.header-text {\r\n  flex: 1;\r\n}\r\n\r\n.header-cell--auto-width {\r\n  /* Auto-width columns use Star sizing (flex-grow) to fill remaining space */\r\n  flex-shrink: 0;\r\n}\r\n\r\n.sort-icon {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2px;\r\n  font-size: 10px;\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n  font-weight: bold;\r\n}\r\n\r\n.sort-icon--primary {\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.sort-icon--secondary {\r\n  color: var(--dg-header-sort-secondary, #90caf9);\r\n  font-size: 9px;\r\n}\r\n\r\n.sort-order {\r\n  font-size: 9px;\r\n  font-weight: bold;\r\n  color: inherit;\r\n  padding-left: 1px;\r\n}\r\n\r\n.resize-grip {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  width: 4px;\r\n  cursor: col-resize;\r\n  background-color: transparent;\r\n}\r\n\r\n.resize-grip:hover {\r\n  background-color: var(--dg-ui-resize-grip, #2196f3);\r\n}\r\n\r\n/* Custom tri-state checkbox (not native input) */\r\n.custom-checkbox {\r\n  width: 18px;\r\n  height: 18px;\r\n  border: 2px solid var(--dg-header-checkbox-border, var(--dg-header-fg, #212529));\r\n  border-radius: 3px;\r\n  cursor: pointer;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  background-color: var(--dg-header-checkbox-bg, white);\r\n  transition: all 0.15s ease;\r\n  user-select: none;\r\n}\r\n\r\n.custom-checkbox:hover {\r\n  border-color: var(--dg-header-checkbox-border-hover, var(--dg-header-fg, #212529));\r\n}\r\n\r\n/* State: none (empty checkbox) */\r\n.custom-checkbox.checkbox-none {\r\n  background-color: var(--dg-header-checkbox-bg, white) !important;\r\n}\r\n\r\n/* State: some (indeterminate - dash) */\r\n.custom-checkbox.checkbox-some {\r\n  background-color: var(--dg-header-checkbox-bg, white) !important;\r\n  border-color: var(--dg-header-checkbox-border-checked, var(--dg-header-fg, #212529));\r\n}\r\n\r\n/* State: all (checked - checkmark) */\r\n.custom-checkbox.checkbox-all {\r\n  background-color: var(--dg-header-checkbox-bg, white) !important;\r\n  border-color: var(--dg-header-checkbox-border-checked, var(--dg-header-fg, #212529));\r\n}\r\n\r\n/* Icon inside checkbox (checkmark or dash) */\r\n.checkbox-icon {\r\n  color: var(--dg-header-checkbox-icon, var(--dg-header-fg, #212529));\r\n  font-size: 14px;\r\n  font-weight: bold;\r\n  line-height: 1;\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    ref=\"cellRef\"\r\n    class=\"grid-cell\"\r\n    :class=\"cellClasses\"\r\n    :style=\"cellStyle\"\r\n    @mousedown=\"handleMouseDown\"\r\n    @mouseenter=\"handleMouseEnter\"\r\n    @mouseleave=\"handleMouseLeave\"\r\n    @dblclick=\"handleDoubleClick\"\r\n    @keydown=\"handleCellKeyDown\"\r\n    @contextmenu=\"handleContextMenu\"\r\n    tabindex=\"0\"\r\n  >\r\n    <!-- Display mode -->\r\n    <div v-if=\"!isEditing\" class=\"cell-text\" v-html=\"highlightedValue\"></div>\r\n\r\n    <!-- Edit mode -->\r\n    <textarea\r\n      v-else\r\n      ref=\"inputRef\"\r\n      v-model=\"editValue\"\r\n      class=\"cell-input\"\r\n      @input=\"handleInput\"\r\n      @blur=\"handleBlur\"\r\n      @keydown=\"handleKeyDown\"\r\n    ></textarea>\r\n\r\n    <!-- Validation error tooltip - Teleported to body to avoid overflow:hidden issues -->\r\n    <Teleport to=\"body\">\r\n      <div\r\n        v-if=\"validationError && (isHovered || isSelected) && tooltipPosition\"\r\n        class=\"validation-tooltip\"\r\n        :class=\"{\r\n          'validation-tooltip--error': validationError.severity === 'Error' || validationError.severity === 'Critical',\r\n          'validation-tooltip--warning': validationError.severity === 'Warning' || validationError.severity === 'Info'\r\n        }\"\r\n        :style=\"{\r\n          position: 'fixed',\r\n          left: tooltipPosition.left + 'px',\r\n          top: tooltipPosition.top + 'px'\r\n        }\"\r\n      >\r\n        {{ validationError.message }}\r\n      </div>\r\n    </Teleport>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, nextTick, inject } from 'vue'\r\nimport { storeToRefs } from 'pinia'\r\nimport { useDataGridStore, type GridCell, type GridColumn } from '@/stores/dataGridStore'\r\nimport ContextMenu from '@imengyu/vue3-context-menu'\r\n\r\nconst props = defineProps<{\r\n  cell: GridCell\r\n  column: GridColumn\r\n  isSelected: boolean\r\n  gridId?: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  editComplete: [rowId: string, columnName: string, value: any]\r\n  cellInput: [rowId: string, columnName: string, value: any]\r\n  copy: []\r\n  cut: []\r\n  paste: []\r\n  delete: []\r\n  insertAbove: [rowId: string, count: number]\r\n  insertBelow: [rowId: string, count: number]\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId)()\r\nconst { isAutoRowHeightEnabled } = storeToRefs(store)\r\n\r\n// Inject validation from parent DataGrid component\r\nconst validation = inject('validation', null) as ReturnType<typeof import('@/composables/useValidation').useValidation> | null\r\n// FIXED: Don't destructure getValidationErrors - access validationErrors directly to preserve reactivity\r\nconst validateCellThrottled = validation?.validateCellThrottled || (() => {})\r\nconst validationErrors = validation?.validationErrors || {}\r\n\r\nconst cellRef = ref<HTMLElement>()\r\nconst inputRef = ref<HTMLTextAreaElement>()\r\nconst isEditing = ref(false)\r\nconst editValue = ref(props.cell.value)\r\nconst originalValue = ref<any>(null)  // Store original value before editing for cancel support\r\nconst isHovered = ref(false)  // Track hover state for validation tooltip\r\nconst tooltipPosition = ref<{ left: number; top: number } | null>(null)  // Tooltip position for Teleport\r\nconst isConfirming = ref(false)  // Track if we're in the process of confirming edit (prevents handleBlur race condition)\r\n\r\nconst displayValue = computed(() => {\r\n  if (props.cell.value == null) return ''\r\n  return String(props.cell.value)\r\n})\r\n\r\n// Check if cell value contains newlines (from Shift+Enter)\r\nconst hasNewlines = computed(() => {\r\n  return displayValue.value.includes('\\n')\r\n})\r\n\r\n// Highlighted value with search matches\r\nconst highlightedValue = computed(() => {\r\n  const text = displayValue.value\r\n  const searchQuery = store.searchQuery\r\n\r\n  if (!searchQuery || !text) {\r\n    return escapeHtml(text)\r\n  }\r\n\r\n  try {\r\n    // Escape special regex characters from search query for safety\r\n    const escapedQuery = searchQuery.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\r\n    const regex = new RegExp(`(${escapedQuery})`, 'gi')\r\n\r\n    return escapeHtml(text).replace(\r\n      regex,\r\n      '<mark class=\"search-highlight\">$1</mark>'\r\n    )\r\n  } catch (error) {\r\n    // If regex fails, return plain text\r\n    return escapeHtml(text)\r\n  }\r\n})\r\n\r\n// Escape HTML to prevent XSS\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement('div')\r\n  div.textContent = text\r\n  return div.innerHTML\r\n}\r\n\r\n// Check for validation errors - access validationErrors directly for reactivity\r\nconst validationError = computed(() => {\r\n  const errors = validationErrors[props.cell.rowId] || []\r\n  return errors.find((e: any) => e.columnName === props.cell.columnName)\r\n})\r\n\r\nconst cellClasses = computed(() => {\r\n  return {\r\n    'cell--selected': props.isSelected,\r\n    'cell--editing': isEditing.value,\r\n    'cell--validation-error': validationError.value?.severity === 'Error' || validationError.value?.severity === 'Critical',\r\n    'cell--validation-warning': validationError.value?.severity === 'Warning' || validationError.value?.severity === 'Info',\r\n    'cell--readonly': props.column.isReadOnly,\r\n    'cell--auto-height': isAutoRowHeightEnabled.value,\r\n    // Special case: has newlines but AutoRowHeight is OFF - still wrap by newlines only\r\n    'cell--has-newlines': hasNewlines.value && !isAutoRowHeightEnabled.value\r\n  }\r\n})\r\n\r\nconst cellStyle = computed(() => {\r\n  // CSS Grid handles column widths via grid-template-columns\r\n  // No need for flexbox properties (flexGrow, flexShrink, flexBasis)\r\n  return {}\r\n})\r\n\r\nfunction handleMouseDown(event: MouseEvent) {\r\n  // Only handle left mouse button\r\n  if (event.button !== 0) return\r\n\r\n  const isCtrlPressed = event.ctrlKey\r\n\r\n  console.log('[DataGridCell] MouseDown:', { rowId: props.cell.rowId, columnName: props.cell.columnName, isEditing: isEditing.value })\r\n\r\n  // Call store's selectCell method\r\n  store.selectCell(props.cell.rowId, props.cell.columnName, isCtrlPressed)\r\n}\r\n\r\nfunction handleMouseEnter(event: MouseEvent) {\r\n  // Track hover state for validation tooltip\r\n  isHovered.value = true\r\n\r\n  // Calculate tooltip position (above the cell)\r\n  if (cellRef.value) {\r\n    const rect = cellRef.value.getBoundingClientRect()\r\n    tooltipPosition.value = {\r\n      left: rect.left,\r\n      top: rect.top - 4  // 4px above the cell\r\n    }\r\n  }\r\n\r\n  // Block drag selection if Ctrl is currently pressed (real-time check)\r\n  // This matches the original WinUI component behavior\r\n  if (event.ctrlKey || store.wasCtrlPressed) {\r\n    return\r\n  }\r\n\r\n  // Check if left button is still pressed (dragging)\r\n  const isLeftButtonPressed = event.buttons === 1\r\n\r\n  // If we have a pressed cell and left button is still pressed\r\n  if (store.pressedCell && !store.isDragging && isLeftButtonPressed) {\r\n    // Check if entering the SAME cell - ignore to prevent premature drag\r\n    if (\r\n      props.cell.rowId === store.pressedCell.rowId &&\r\n      props.cell.columnName === store.pressedCell.columnName\r\n    ) {\r\n      return\r\n    }\r\n\r\n    // Different cell - start drag selection\r\n    store.startDragSelection(props.cell.rowId, props.cell.columnName)\r\n  } else if (store.isDragging && isLeftButtonPressed) {\r\n    // Already dragging - expand selection\r\n    store.expandDragSelection(props.cell.rowId, props.cell.columnName)\r\n  }\r\n}\r\n\r\nfunction handleMouseLeave() {\r\n  // Clear hover state for validation tooltip\r\n  isHovered.value = false\r\n  tooltipPosition.value = null\r\n}\r\n\r\nfunction handleCellKeyDown(event: KeyboardEvent) {\r\n  // When cell is selected but NOT editing, Enter key enters edit mode\r\n  if (!isEditing.value && props.isSelected && event.key === 'Enter' && !props.column.isReadOnly) {\r\n    event.preventDefault()\r\n    enterEditMode()\r\n  }\r\n}\r\n\r\nasync function enterEditMode() {\r\n  if (props.column.isReadOnly) return\r\n\r\n  console.log('[DataGridCell] enterEditMode:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    currentCellValue: props.cell.value,\r\n    storingAsOriginal: props.cell.value\r\n  })\r\n\r\n  // CRITICAL FIX: Store original value BEFORE editing starts\r\n  originalValue.value = props.cell.value\r\n\r\n  isEditing.value = true\r\n  editValue.value = props.cell.value\r\n\r\n  await nextTick()\r\n  inputRef.value?.focus()\r\n  inputRef.value?.select()\r\n}\r\n\r\nasync function handleDoubleClick() {\r\n  console.log('[DataGridCell] handleDoubleClick:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    currentValue: props.cell.value\r\n  })\r\n  enterEditMode()\r\n}\r\n\r\n// Get all cells from the current row (for empty row check)\r\nfunction getRowCells() {\r\n  const row = store.rows.find(r => r.rowId === props.cell.rowId)\r\n  if (!row) return undefined\r\n\r\n  // Return array of { columnName, value } for all cells\r\n  return row.cells.map(c => ({ columnName: c.columnName, value: c.value }))\r\n}\r\n\r\nfunction handleInput() {\r\n  console.log('[DataGridCell] handleInput:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    newValue: editValue.value,\r\n    autoValidate: store.config.autoValidate\r\n  })\r\n\r\n  // Throttled validation (300ms) with row cells for empty check - only if autoValidate is enabled\r\n  if (store.config.autoValidate && store.config.enableValidation) {\r\n    const rowCells = getRowCells()\r\n    validateCellThrottled(props.cell.rowId, props.cell.columnName, editValue.value, rowCells)\r\n  }\r\n\r\n  // Emit input event for AutoRowHeight real-time adjustment\r\n  emit('cellInput', props.cell.rowId, props.cell.columnName, editValue.value)\r\n}\r\n\r\nfunction confirmEdit() {\r\n  console.log('[DataGridCell] confirmEdit:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    confirmedValue: editValue.value,\r\n    originalWas: originalValue.value\r\n  })\r\n\r\n  // CRITICAL FIX: Set flag to prevent handleBlur from canceling during confirm\r\n  isConfirming.value = true\r\n\r\n  // Re-validate immediately before confirming (ensures empty values are properly validated) - only if autoValidate is enabled\r\n  if (store.config.autoValidate && store.config.enableValidation) {\r\n    const rowCells = getRowCells()\r\n    validateCellThrottled(props.cell.rowId, props.cell.columnName, editValue.value, rowCells)\r\n  }\r\n\r\n  // Always commit edit, even if there's a validation error\r\n  // Validation errors will be shown but won't block input\r\n  emit('editComplete', props.cell.rowId, props.cell.columnName, editValue.value)\r\n  isEditing.value = false\r\n\r\n  // Clear stored original value after successful commit\r\n  originalValue.value = null\r\n\r\n  // Restore focus to the cell so pressing Enter again will re-enter edit mode\r\n  nextTick(() => {\r\n    try {\r\n      console.log(`[DataGridCell] confirmEdit - Attempting to restore focus to cell: rowId=${props.cell.rowId}, column=${props.cell.columnName}`)\r\n      if (cellRef.value) {\r\n        cellRef.value.focus()\r\n        console.log('[DataGridCell] confirmEdit - Focus restored successfully')\r\n      } else {\r\n        console.log('[DataGridCell] confirmEdit - WARNING: cellRef.value is null/undefined')\r\n      }\r\n    } catch (error) {\r\n      console.log(`[DataGridCell] confirmEdit - ERROR restoring focus: ${error}`)\r\n    }\r\n  })\r\n\r\n  // Reset confirming flag after a delay to ensure blur doesn't cancel\r\n  setTimeout(() => {\r\n    isConfirming.value = false\r\n  }, 100)\r\n}\r\n\r\nfunction handleKeyDown(event: KeyboardEvent) {\r\n  console.log('[DataGridCell] handleKeyDown:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    key: event.key,\r\n    shift: event.shiftKey,\r\n    ctrl: event.ctrlKey\r\n  })\r\n\r\n  // ESC = cancel edit and restore original value\r\n  if (event.key === 'Escape') {\r\n    event.preventDefault()\r\n    event.stopPropagation()  // CRITICAL FIX: Prevent event from bubbling to parent div\r\n    cancelEdit()\r\n    return\r\n  }\r\n\r\n  // Enter without Shift = confirm edit\r\n  if (event.key === 'Enter' && !event.shiftKey) {\r\n    event.preventDefault()\r\n    event.stopPropagation()  // CRITICAL FIX: Prevent event from bubbling to parent div handleCellKeyDown\r\n    confirmEdit()\r\n    return\r\n  }\r\n\r\n  // Shift+Enter = new line (default textarea behavior, just allow it)\r\n  // Tab = insert tab character (prevent default tab navigation)\r\n  if (event.key === 'Tab') {\r\n    event.preventDefault()\r\n    const target = event.target as HTMLTextAreaElement\r\n    const start = target.selectionStart\r\n    const end = target.selectionEnd\r\n\r\n    // Insert tab character at cursor position\r\n    editValue.value = editValue.value.substring(0, start) + '\\t' + editValue.value.substring(end)\r\n\r\n    // Move cursor after the tab\r\n    nextTick(() => {\r\n      target.selectionStart = target.selectionEnd = start + 1\r\n    })\r\n  }\r\n}\r\n\r\nfunction cancelEdit() {\r\n  console.log('[DataGridCell] cancelEdit:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    originalValue: originalValue.value,\r\n    currentEditValue: editValue.value\r\n  })\r\n\r\n  // CRITICAL FIX: Restore original value from BEFORE editing started\r\n  editValue.value = originalValue.value\r\n  isEditing.value = false\r\n\r\n  // CRITICAL FIX: Emit editComplete with original value to restore it in the store\r\n  emit('editComplete', props.cell.rowId, props.cell.columnName, originalValue.value)\r\n\r\n  // Re-validate with original value - only if autoValidate is enabled\r\n  if (store.config.autoValidate && store.config.enableValidation) {\r\n    const rowCells = getRowCells()\r\n    validateCellThrottled(props.cell.rowId, props.cell.columnName, originalValue.value, rowCells)\r\n  }\r\n\r\n  // Clear stored original value\r\n  originalValue.value = null\r\n\r\n  // Restore focus to the cell so pressing Enter again will re-enter edit mode\r\n  nextTick(() => {\r\n    try {\r\n      console.log(`[DataGridCell] cancelEdit - Attempting to restore focus to cell: rowId=${props.cell.rowId}, column=${props.cell.columnName}`)\r\n      if (cellRef.value) {\r\n        cellRef.value.focus()\r\n        console.log('[DataGridCell] cancelEdit - Focus restored successfully')\r\n      } else {\r\n        console.log('[DataGridCell] cancelEdit - WARNING: cellRef.value is null/undefined')\r\n      }\r\n    } catch (error) {\r\n      console.log(`[DataGridCell] cancelEdit - ERROR restoring focus: ${error}`)\r\n    }\r\n  })\r\n}\r\n\r\nfunction handleBlur() {\r\n  console.log('[DataGridCell] handleBlur:', {\r\n    rowId: props.cell.rowId,\r\n    columnName: props.cell.columnName,\r\n    isEditing: isEditing.value,\r\n    isConfirming: isConfirming.value\r\n  })\r\n\r\n  // CRITICAL FIX: Don't cancel if we're in the process of confirming (prevents race condition)\r\n  // Cancel edit immediately on blur (clicking away or focus loss) ONLY if not confirming\r\n  if (isEditing.value && !isConfirming.value) {\r\n    cancelEdit()\r\n  }\r\n}\r\n\r\nfunction handleContextMenu(event: MouseEvent) {\r\n  // Only show context menu with Ctrl key pressed\r\n  if (!event.ctrlKey) {\r\n    return\r\n  }\r\n\r\n  event.preventDefault()\r\n\r\n  // Calculate selected row IDs and indices (like original component)\r\n  const selectedRowData = new Map<string, number>() // rowId -> rowIndex\r\n  store.selectedCells.forEach(cellKey => {\r\n    const [rowId] = cellKey.split(':')\r\n    const row = store.rows.find(r => r.rowId === rowId)\r\n    if (row) {\r\n      selectedRowData.set(rowId, row.rowIndex)\r\n    }\r\n  })\r\n\r\n  const selectedRowCount = selectedRowData.size\r\n  const selectedRowIndices = Array.from(selectedRowData.values())\r\n\r\n  // Find min/max row indices (like original WinUI component)\r\n  const minRowIndex = selectedRowIndices.length > 0 ? Math.min(...selectedRowIndices) : 0\r\n  const maxRowIndex = selectedRowIndices.length > 0 ? Math.max(...selectedRowIndices) : 0\r\n\r\n  // Get rowId for min/max indices\r\n  const minRow = store.rows.find(r => r.rowIndex === minRowIndex)\r\n  const maxRow = store.rows.find(r => r.rowIndex === maxRowIndex)\r\n\r\n  ContextMenu.showContextMenu({\r\n    x: event.x,\r\n    y: event.y,\r\n    items: [\r\n      {\r\n        label: 'Copy',\r\n        icon: '',\r\n        onClick: () => emit('copy'),\r\n        disabled: !props.isSelected\r\n      },\r\n      {\r\n        label: 'Cut',\r\n        icon: '',\r\n        onClick: () => emit('cut'),\r\n        disabled: !props.isSelected || props.column.isReadOnly\r\n      },\r\n      {\r\n        label: 'Paste',\r\n        icon: '',\r\n        onClick: () => emit('paste'),\r\n        disabled: props.column.isReadOnly\r\n      },\r\n      { divided: true },\r\n      {\r\n        label: 'Delete',\r\n        icon: '',\r\n        onClick: () => emit('delete'),\r\n        disabled: !props.isSelected || props.column.isReadOnly\r\n      },\r\n      { divided: true },\r\n      {\r\n        label: `Insert ${selectedRowCount} row(s) above`,\r\n        icon: '',\r\n        // Insert above the MINIMUM selected row index\r\n        onClick: () => emit('insertAbove', minRow?.rowId || props.cell.rowId, selectedRowCount || 1),\r\n        disabled: props.column.isReadOnly\r\n      },\r\n      {\r\n        label: `Insert ${selectedRowCount} row(s) below`,\r\n        icon: '',\r\n        // Insert below the MAXIMUM selected row index\r\n        onClick: () => emit('insertBelow', maxRow?.rowId || props.cell.rowId, selectedRowCount || 1),\r\n        disabled: props.column.isReadOnly\r\n      }\r\n    ]\r\n  })\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grid-cell {\r\n  position: relative;\r\n  padding: 5px 8px;  /* Increased from 4px to 5px for better spacing */\r\n  border-right: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  display: flex; /* Flex for internal content layout only */\r\n  align-items: flex-start;\r\n  background-color: var(--dg-cell-bg, #ffffff);\r\n  color: var(--dg-cell-fg, #212529);\r\n  font-size: 14px;  /* CRITICAL: Must match useAutoRowHeight config.fontSize */\r\n  height: 100%;\r\n  min-height: 100%;\r\n  box-sizing: border-box;\r\n  overflow: hidden; /* Prevent content from breaking grid layout */\r\n  /* Prevent browser text selection during drag selection */\r\n  user-select: none;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n}\r\n\r\n.grid-cell:hover {\r\n  background-color: var(--dg-cell-hover-bg, #f8f9fa);\r\n  color: var(--dg-cell-hover-fg, #212529);\r\n}\r\n\r\n.cell--selected {\r\n  /* Selection only changes background, not border - border is preserved from validation/other states */\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb);  /* More prominent blue (was #e3f2fd) */\r\n  color: var(--dg-cell-focused-fg, #0d6efd);\r\n  /* No border - let other states (validation, etc.) control border/outline */\r\n}\r\n\r\n/* Prevent hover from removing selection background */\r\n.cell--selected:hover {\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb);  /* Keep selection background on hover */\r\n  color: var(--dg-cell-focused-fg, #0d6efd);\r\n}\r\n\r\n.cell--editing {\r\n  padding: 0;\r\n}\r\n\r\n.cell--validation-error {\r\n  /* Use OUTLINE instead of BORDER to prevent layout shift (outline doesn't affect box model) */\r\n  outline: 2px solid var(--dg-validation-error-border, #ff4444);\r\n  outline-offset: -2px; /* Draw outline inside the cell */\r\n  background-color: var(--dg-validation-error-bg, #ffebee);\r\n  color: var(--dg-validation-error-fg, #c62828);\r\n  border: none;\r\n}\r\n\r\n.cell--validation-warning {\r\n  /* Use OUTLINE instead of BORDER to prevent layout shift (outline doesn't affect box model) */\r\n  /* DEFAULT: Red border same as error (user requested unified color) */\r\n  outline: 2px solid var(--dg-validation-warning-border, #ff4444);\r\n  outline-offset: -2px; /* Draw outline inside the cell */\r\n  /* DEFAULT: Red background same as error (user requested unified color) */\r\n  background-color: var(--dg-validation-warning-bg, #ffebee);\r\n  color: var(--dg-validation-warning-fg, #c62828);\r\n  border: none;\r\n}\r\n\r\n/* CRITICAL: When cell is BOTH selected AND has validation error, selection background overrides validation background */\r\n/* This makes selection visible on validation cells while keeping the red outline */\r\n.cell--selected.cell--validation-error,\r\n.cell--selected.cell--validation-warning {\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb) !important;  /* More prominent blue */\r\n  /* Keep validation outline and color */\r\n}\r\n\r\n/* Prevent hover from removing selection background on validation cells */\r\n.cell--selected.cell--validation-error:hover,\r\n.cell--selected.cell--validation-warning:hover {\r\n  background-color: var(--dg-cell-focused-bg, #bbdefb) !important;  /* Keep selection background on hover */\r\n}\r\n\r\n.cell--readonly {\r\n  background-color: var(--dg-cell-readonly-bg, #f5f5f5);\r\n  color: var(--dg-cell-readonly-fg, #495057);\r\n  cursor: not-allowed;\r\n}\r\n\r\n.cell-text {\r\n  flex: 1;\r\n  min-width: 0; /* CRITICAL: Allow flex item to shrink below content size for text wrapping */\r\n  line-height: 1.5;\r\n  /* Default: no wrapping, overflow hidden (when AutoRowHeight is OFF) */\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  /* Prevent browser text selection */\r\n  user-select: none;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  -ms-user-select: none;\r\n}\r\n\r\n/* When AutoRowHeight is enabled, allow text wrapping */\r\n.cell--auto-height .cell-text {\r\n  white-space: pre-wrap !important;\r\n  word-wrap: break-word !important;\r\n  overflow-wrap: break-word !important;\r\n  overflow: visible !important;\r\n  text-overflow: clip !important;\r\n}\r\n\r\n/* When cell has newlines but AutoRowHeight is OFF - wrap ONLY at \\n, not at spaces */\r\n.cell--has-newlines .cell-text {\r\n  white-space: pre !important;\r\n  overflow: visible !important;\r\n  text-overflow: clip !important;\r\n}\r\n\r\n.cell-input {\r\n  width: 100%;\r\n  height: 100%;\r\n  border: none;\r\n  outline: none;\r\n  padding: 4px 8px;\r\n  font-family: inherit;\r\n  font-size: inherit;\r\n  background-color: var(--dg-cell-focused-bg, #e3f2fd);\r\n  color: var(--dg-cell-focused-fg, #0d6efd);\r\n  resize: none;\r\n  /* Hide overflow so row expands instead of showing scrollbars */\r\n  overflow: hidden;\r\n  overflow-x: hidden;\r\n  overflow-y: hidden;\r\n  /* CRITICAL: Enable text wrapping */\r\n  white-space: pre-wrap;\r\n  word-wrap: break-word;\r\n  overflow-wrap: break-word;\r\n  /* Remove scrollbars completely - all browsers */\r\n  scrollbar-width: none; /* Firefox */\r\n  -ms-overflow-style: none; /* IE/Edge */\r\n  /* Remove native appearance */\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n  appearance: none;\r\n}\r\n\r\n/* Hide scrollbars for webkit browsers */\r\n.cell-input::-webkit-scrollbar {\r\n  display: none !important;\r\n  width: 0 !important;\r\n  height: 0 !important;\r\n}\r\n\r\n/* Remove any browser-specific controls */\r\n.cell-input::-webkit-resizer,\r\n.cell-input::-webkit-scrollbar-corner,\r\n.cell-input::-webkit-scrollbar-track,\r\n.cell-input::-webkit-scrollbar-thumb,\r\n.cell-input::-webkit-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n/* Remove Mozilla scrollbar buttons */\r\n.cell-input::-moz-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n.validation-tooltip {\r\n  /* position: fixed is set inline via :style */\r\n  color: white;\r\n  padding: 4px 8px;\r\n  border-radius: 4px;\r\n  font-size: 12px;\r\n  white-space: nowrap;\r\n  z-index: 10000;  /* Very high z-index since it's in body */\r\n  pointer-events: none;\r\n  max-width: 300px;\r\n  white-space: normal;\r\n  transform: translateY(-100%);  /* Position above the calculated point */\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);  /* Add shadow for visibility */\r\n}\r\n\r\n.validation-tooltip--error {\r\n  background: var(--dg-validation-error-fg, #ff4444);\r\n}\r\n\r\n.validation-tooltip--warning {\r\n  background: var(--dg-validation-warning-fg, #ff9800);\r\n}\r\n\r\n/* Search highlighting */\r\n:deep(.search-highlight) {\r\n  background-color: var(--dg-search-highlight-bg, #ffeb3b);\r\n  color: var(--dg-search-highlight-fg, #000);\r\n  font-weight: 500;\r\n  padding: 0 2px;\r\n  border-radius: 2px;\r\n}\r\n</style>\r\n","<template>\r\n  <div\r\n    class=\"special-cell\"\r\n    :class=\"specialCellClasses\"\r\n    :style=\"cellStyle\"\r\n    @mousedown.stop\r\n    @mouseenter.stop\r\n  >\r\n    <!-- Row Number Column -->\r\n    <span v-if=\"specialType === 'RowNumber'\" class=\"row-number\">\r\n      {{ rowNumber }}\r\n    </span>\r\n\r\n    <!-- Checkbox Column -->\r\n    <input\r\n      v-else-if=\"specialType === 'Checkbox'\"\r\n      type=\"checkbox\"\r\n      class=\"checkbox-input\"\r\n      :checked=\"isChecked\"\r\n      @change=\"handleCheckboxChange\"\r\n    />\r\n\r\n    <!-- Validation Alerts Column -->\r\n    <div\r\n      v-else-if=\"specialType === 'ValidationAlerts'\"\r\n      class=\"validation-alerts\"\r\n      :class=\"{ 'has-errors': hasValidationErrors || hasValidationWarnings }\"\r\n      :title=\"validationMessage\"\r\n    >\r\n      <span class=\"validation-message\">\r\n        {{ validationMessage }}\r\n      </span>\r\n    </div>\r\n\r\n    <!-- Delete Row Button -->\r\n    <button\r\n      v-else-if=\"specialType === 'DeleteRow'\"\r\n      class=\"delete-button\"\r\n      :disabled=\"isDeleting\"\r\n      @click=\"handleDelete\"\r\n      title=\"Delete row\"\r\n    >\r\n      \r\n    </button>\r\n\r\n    <!-- Insert Row Button -->\r\n    <button\r\n      v-else-if=\"specialType === 'InsertRow'\"\r\n      class=\"insert-button\"\r\n      @click=\"handleInsert\"\r\n      title=\"Insert new row\"\r\n    >\r\n      \r\n    </button>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, inject, watch } from 'vue'\r\nimport type { GridColumn } from '@/stores/dataGridStore'\r\n\r\nexport type SpecialColumnType = 'RowNumber' | 'Checkbox' | 'ValidationAlerts' | 'DeleteRow' | 'InsertRow'\r\n\r\nconst props = defineProps<{\r\n  specialType: SpecialColumnType\r\n  rowId: string\r\n  rowIndex: number\r\n  column: GridColumn\r\n  isChecked?: boolean\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  checkboxChange: [rowId: string, checked: boolean]\r\n  deleteRow: [rowId: string]\r\n  insertRow: [afterRowId: string]\r\n}>()\r\n\r\n// Debug: Watch isChecked prop changes\r\nwatch(() => props.isChecked, (newVal, oldVal) => {\r\n  if (props.specialType === 'Checkbox') {\r\n    console.log('[SpecialColumnCell] isChecked prop changed:', { rowId: props.rowId, newVal, oldVal })\r\n  }\r\n}, { immediate: true })\r\n\r\n// Inject validation from parent DataGrid component\r\nconst validation = inject('validation', null) as ReturnType<typeof import('@/composables/useValidation').useValidation> | null\r\n// validationErrors is now reactive<Record<>> instead of ref<Map<>>\r\nconst validationErrors = validation?.validationErrors || {}\r\n\r\nconst isDeleting = ref(false)\r\nconst lastDeleteClick = ref(0)\r\nconst DELETE_DEBOUNCE_MS = 300\r\n\r\nconst rowNumber = computed(() => props.rowIndex + 1)\r\n\r\nconst validationErrorsForRow = computed(() => {\r\n  return validationErrors[props.rowId] || []\r\n})\r\n\r\nconst hasValidationErrors = computed(() => {\r\n  return validationErrorsForRow.value.some((e: any) => e.severity === 'Error' || e.severity === 'Critical')\r\n})\r\n\r\nconst hasValidationWarnings = computed(() => {\r\n  return validationErrorsForRow.value.some((e: any) => e.severity === 'Warning')\r\n})\r\n\r\n// Format validation messages like in original component: \"columnName: message; columnName2: message2\"\r\nconst validationMessage = computed(() => {\r\n  const allErrors = validationErrorsForRow.value\r\n  if (allErrors.length === 0) return ''\r\n\r\n  // Join all errors with semicolon (like original component)\r\n  return allErrors\r\n    .map((e: any) => `${e.columnName}: ${e.message}`)\r\n    .join('; ')\r\n})\r\n\r\nconst specialCellClasses = computed(() => ({\r\n  'special-cell--row-number': props.specialType === 'RowNumber',\r\n  'special-cell--checkbox': props.specialType === 'Checkbox',\r\n  'special-cell--validation': props.specialType === 'ValidationAlerts',\r\n  'special-cell--delete': props.specialType === 'DeleteRow',\r\n  'special-cell--insert': props.specialType === 'InsertRow',\r\n}))\r\n\r\nconst cellStyle = computed(() => {\r\n  // CSS Grid handles column widths via grid-template-columns\r\n  // No need for flexbox properties\r\n  return {}\r\n})\r\n\r\nfunction handleCheckboxChange(event: Event) {\r\n  const target = event.target as HTMLInputElement\r\n  console.log('[SpecialColumnCell] Checkbox change:', { rowId: props.rowId, checked: target.checked, currentProp: props.isChecked })\r\n  emit('checkboxChange', props.rowId, target.checked)\r\n}\r\n\r\nfunction handleDelete() {\r\n  // Debounce protection - prevent rapid clicks\r\n  const now = Date.now()\r\n  if (now - lastDeleteClick.value < DELETE_DEBOUNCE_MS) {\r\n    return\r\n  }\r\n  lastDeleteClick.value = now\r\n\r\n  if (confirm('Are you sure you want to delete this row?')) {\r\n    isDeleting.value = true\r\n    emit('deleteRow', props.rowId)\r\n\r\n    // Reset deleting state after 1 second\r\n    setTimeout(() => {\r\n      isDeleting.value = false\r\n    }, 1000)\r\n  }\r\n}\r\n\r\nfunction handleInsert() {\r\n  emit('insertRow', props.rowId)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.special-cell {\r\n  position: relative;\r\n  padding: 4px 8px;\r\n  border-right: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  display: flex;\r\n  align-items: flex-start; /* Changed from center to flex-start for multi-line content */\r\n  justify-content: center;\r\n  background-color: var(--dg-special-rownumber-bg, #f5f5f5);\r\n  height: 100%;\r\n  min-height: 100%;\r\n  width: 100%; /* CRITICAL: Fill grid track width */\r\n  max-width: 100%; /* CRITICAL: Never exceed grid track width */\r\n  box-sizing: border-box;\r\n  overflow: hidden; /* CRITICAL: Hide all overflow */\r\n  overflow-x: hidden !important; /* Prevent horizontal overflow */\r\n  overflow-y: hidden !important; /* Hide scrollbars */\r\n  /* Remove all scrollbars - all browsers */\r\n  scrollbar-width: none; /* Firefox */\r\n  -ms-overflow-style: none; /* IE/Edge */\r\n}\r\n\r\n/* Hide scrollbars for webkit browsers */\r\n.special-cell::-webkit-scrollbar {\r\n  display: none !important;\r\n  width: 0 !important;\r\n  height: 0 !important;\r\n}\r\n\r\n/* Remove all webkit scrollbar parts */\r\n.special-cell::-webkit-scrollbar-button,\r\n.special-cell::-webkit-scrollbar-track,\r\n.special-cell::-webkit-scrollbar-thumb,\r\n.special-cell::-webkit-scrollbar-corner {\r\n  display: none !important;\r\n}\r\n\r\n/* Remove Mozilla scrollbar buttons */\r\n.special-cell::-moz-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n.special-cell--row-number {\r\n  color: var(--dg-special-rownumber-fg, #666);\r\n  font-weight: 500;\r\n  user-select: none;\r\n}\r\n\r\n.special-cell--checkbox {\r\n  cursor: pointer;\r\n  background-color: var(--dg-special-checkbox-bg, #ffffff);\r\n}\r\n\r\n.checkbox-input {\r\n  cursor: pointer;\r\n  width: 16px;\r\n  height: 16px;\r\n  border: 1px solid var(--dg-special-checkbox-border, #ced4da);\r\n}\r\n\r\n.special-cell--validation {\r\n  padding: 0;\r\n}\r\n\r\n.validation-alerts {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  width: 100%;\r\n  max-width: 100%; /* CRITICAL: Never exceed parent width */\r\n  height: 100%;\r\n  padding: 4px 8px;\r\n  overflow: hidden; /* CRITICAL: Clip content that exceeds bounds */\r\n  box-sizing: border-box; /* Include padding in width calculation */\r\n}\r\n\r\n.validation-alerts.has-errors {\r\n  background-color: var(--dg-special-validation-error-bg, #ffebee);\r\n}\r\n\r\n.validation-message {\r\n  font-size: 11px;\r\n  color: var(--dg-special-validation-error-fg, #c62828);\r\n  /* CHANGED: Allow text wrapping instead of ellipsis for AutoRowHeight support */\r\n  white-space: pre-wrap; /* Wrap text and preserve spaces */\r\n  word-wrap: break-word; /* Break long words */\r\n  overflow-wrap: break-word; /* Modern CSS property for word breaking */\r\n  display: block;\r\n  width: 100%;\r\n  max-width: 100%; /* CRITICAL: Never exceed parent width */\r\n  min-width: 0; /* CRITICAL: Allow flex item to shrink below content size */\r\n  line-height: 1.5; /* Match DataGridCell line-height */\r\n  box-sizing: border-box;\r\n}\r\n\r\n.validation-icon {\r\n  font-size: 18px;\r\n  cursor: help;\r\n}\r\n\r\n.validation-icon.error {\r\n  color: var(--dg-validation-error-fg, #ff4444);\r\n}\r\n\r\n.validation-icon.warning {\r\n  color: var(--dg-validation-warning-fg, #ff9800);\r\n}\r\n\r\n.delete-button,\r\n.insert-button {\r\n  border: none;\r\n  background: var(--dg-special-delete-bg, transparent);\r\n  color: var(--dg-special-delete-fg, #dc3545);\r\n  font-size: 16px;\r\n  cursor: pointer;\r\n  padding: 2px 4px;\r\n  transition: transform 0.1s, background-color 0.1s;\r\n  /* Remove browser default styling and controls */\r\n  -webkit-appearance: none !important;\r\n  -moz-appearance: none !important;\r\n  appearance: none !important;\r\n  -webkit-user-select: none;\r\n  -moz-user-select: none;\r\n  user-select: none;\r\n  outline: none;\r\n  /* Remove all scrollbars and arrows */\r\n  overflow: hidden !important;\r\n  scrollbar-width: none;\r\n  -ms-overflow-style: none;\r\n}\r\n\r\n/* Remove webkit scrollbar and all related controls from buttons */\r\n.delete-button::-webkit-scrollbar,\r\n.insert-button::-webkit-scrollbar {\r\n  display: none !important;\r\n  width: 0 !important;\r\n  height: 0 !important;\r\n}\r\n\r\n.delete-button::-webkit-scrollbar-button,\r\n.delete-button::-webkit-scrollbar-track,\r\n.delete-button::-webkit-scrollbar-thumb,\r\n.delete-button::-webkit-scrollbar-corner,\r\n.insert-button::-webkit-scrollbar-button,\r\n.insert-button::-webkit-scrollbar-track,\r\n.insert-button::-webkit-scrollbar-thumb,\r\n.insert-button::-webkit-scrollbar-corner {\r\n  display: none !important;\r\n}\r\n\r\n/* Remove webkit number input spinners (just in case) */\r\n.delete-button::-webkit-outer-spin-button,\r\n.delete-button::-webkit-inner-spin-button,\r\n.insert-button::-webkit-outer-spin-button,\r\n.insert-button::-webkit-inner-spin-button {\r\n  -webkit-appearance: none !important;\r\n  margin: 0 !important;\r\n  display: none !important;\r\n}\r\n\r\n/* Remove Mozilla scrollbar buttons */\r\n.delete-button::-moz-scrollbar-button,\r\n.insert-button::-moz-scrollbar-button {\r\n  display: none !important;\r\n}\r\n\r\n.delete-button:hover:not(:disabled) {\r\n  transform: scale(1.2);\r\n  background-color: var(--dg-special-delete-hover-bg, #ffebee);\r\n}\r\n\r\n.delete-button:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.insert-button {\r\n  background: var(--dg-special-insert-bg, transparent);\r\n  color: var(--dg-special-insert-fg, #28a745);\r\n}\r\n\r\n.insert-button:hover {\r\n  transform: scale(1.2);\r\n  background-color: var(--dg-special-insert-hover-bg, #e8f5e9);\r\n  color: var(--dg-special-insert-hover-fg, #1b5e20);\r\n}\r\n\r\n.insert-button:active,\r\n.delete-button:active {\r\n  transform: scale(0.95);\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"grid-row\" :style=\"{ height: row.height + 'px', gridTemplateColumns }\">\r\n    <template v-for=\"column in columns\" :key=\"`${row.rowId}:${column.name}`\">\r\n      <!-- Special Column Cell -->\r\n      <SpecialColumnCell\r\n        v-if=\"column.specialType\"\r\n        :special-type=\"column.specialType\"\r\n        :row-id=\"row.rowId\"\r\n        :row-index=\"row.rowIndex\"\r\n        :column=\"column\"\r\n        :is-checked=\"column.specialType === 'Checkbox' ? isRowCheckedComputed : undefined\"\r\n        @checkbox-change=\"handleCheckboxChange\"\r\n        @delete-row=\"handleDeleteRow\"\r\n        @insert-row=\"handleInsertRow\"\r\n      />\r\n\r\n      <!-- Regular Data Cell -->\r\n      <DataGridCell\r\n        v-else\r\n        :cell=\"getCellForColumn(column.name)\"\r\n        :column=\"column\"\r\n        :is-selected=\"store.isCellSelected(row.rowId, column.name)\"\r\n        :grid-id=\"gridId\"\r\n        @edit-complete=\"handleEditComplete\"\r\n        @cell-input=\"handleCellInput\"\r\n        @insert-above=\"handleInsertAbove\"\r\n        @insert-below=\"handleInsertBelow\"\r\n      />\r\n    </template>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed } from 'vue'\r\nimport DataGridCell from './DataGridCell.vue'\r\nimport SpecialColumnCell from './SpecialColumnCell.vue'\r\nimport { useDataGridStore, type GridRow, type GridColumn, type GridCell } from '@/stores/dataGridStore'\r\n\r\nconst props = defineProps<{\r\n  row: GridRow\r\n  columns: GridColumn[]\r\n  gridTemplateColumns: string\r\n  gridId?: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  cellEditComplete: [rowId: string, columnName: string, value: any]\r\n  cellInput: [rowId: string, columnName: string, value: any]\r\n  checkboxChange: [rowId: string, checked: boolean]\r\n  deleteRow: [rowId: string]\r\n  insertRow: [afterRowId: string]\r\n  insertAbove: [rowId: string, count: number]\r\n  insertBelow: [rowId: string, count: number]\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId)()\r\n\r\n// Log checkbox state for debugging\r\nconst isRowCheckedComputed = computed(() => {\r\n  const checked = store.isRowChecked(props.row.rowId)\r\n  console.log('[DataGridRow] Row checked state:', { rowId: props.row.rowId, checked })\r\n  return checked\r\n})\r\n\r\nfunction getCellForColumn(columnName: string): GridCell {\r\n  const cell = props.row.cells.find(c => c.columnName === columnName)\r\n\r\n  // If cell doesn't exist for this column, return a placeholder\r\n  if (!cell) {\r\n    return {\r\n      rowId: props.row.rowId,\r\n      columnName: columnName,\r\n      value: null,\r\n      isSelected: false,\r\n      isValidationError: false\r\n    }\r\n  }\r\n\r\n  return cell\r\n}\r\n\r\nfunction handleEditComplete(rowId: string, columnName: string, value: any) {\r\n  emit('cellEditComplete', rowId, columnName, value)\r\n}\r\n\r\nfunction handleCellInput(rowId: string, columnName: string, value: any) {\r\n  emit('cellInput', rowId, columnName, value)\r\n}\r\n\r\nfunction handleCheckboxChange(rowId: string, checked: boolean) {\r\n  emit('checkboxChange', rowId, checked)\r\n}\r\n\r\nfunction handleDeleteRow(rowId: string) {\r\n  emit('deleteRow', rowId)\r\n}\r\n\r\nfunction handleInsertRow(afterRowId: string) {\r\n  emit('insertRow', afterRowId)\r\n}\r\n\r\nfunction handleInsertAbove(rowId: string, count: number) {\r\n  emit('insertAbove', rowId, count)\r\n}\r\n\r\nfunction handleInsertBelow(rowId: string, count: number) {\r\n  emit('insertBelow', rowId, count)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.grid-row {\r\n  display: grid; /* Changed from flex to grid for perfect column alignment */\r\n  /* grid-template-columns applied via inline style from parent */\r\n  border-bottom: 1px solid #e0e0e0;\r\n  width: 100%; /* CRITICAL: Always fill container width */\r\n  max-width: 100%; /* CRITICAL: Never exceed container width */\r\n  /* REMOVED min-width: fit-content - this was causing each row to calculate 1fr differently! */\r\n  /* All rows MUST have identical width for 1fr to resolve to same pixels */\r\n}\r\n\r\n.grid-row:hover {\r\n  background-color: #fafafa;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"pagination\">\r\n    <button @click=\"emit('pageChange', 1)\" :disabled=\"currentPage === 1\">\r\n      First\r\n    </button>\r\n    <button @click=\"emit('pageChange', currentPage - 1)\" :disabled=\"currentPage === 1\">\r\n      Previous\r\n    </button>\r\n\r\n    <!-- Individual page number buttons -->\r\n    <div class=\"page-numbers\">\r\n      <button\r\n        v-for=\"page in visiblePages\"\r\n        :key=\"page\"\r\n        :class=\"{ 'page-number': true, 'active': page === currentPage }\"\r\n        @click=\"emit('pageChange', page)\"\r\n      >\r\n        {{ page }}\r\n      </button>\r\n    </div>\r\n\r\n    <button @click=\"emit('pageChange', currentPage + 1)\" :disabled=\"currentPage === totalPages\">\r\n      Next\r\n    </button>\r\n    <button @click=\"emit('pageChange', totalPages)\" :disabled=\"currentPage === totalPages\">\r\n      Last\r\n    </button>\r\n\r\n    <span class=\"page-info\">\r\n      ({{ totalRows }} rows)\r\n    </span>\r\n\r\n    <select :value=\"pageSize\" @change=\"handlePageSizeChange\">\r\n      <option v-for=\"size in sortedPageSizeOptions\" :key=\"size\" :value=\"size\">{{ size }}</option>\r\n    </select>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed } from 'vue'\r\n\r\nconst props = withDefaults(defineProps<{\r\n  currentPage: number\r\n  pageSize: number\r\n  totalRows: number\r\n  pageSizeOptions?: number[]\r\n}>(), {\r\n  pageSizeOptions: () => [50, 100, 200, 500]\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  pageChange: [page: number]\r\n  pageSizeChange: [size: number]\r\n}>()\r\n\r\n// Sort options from smallest to largest for display\r\n// If current pageSize is not in the options, include it (but only while it's the current value)\r\nconst sortedPageSizeOptions = computed(() => {\r\n  const options = [...props.pageSizeOptions]\r\n\r\n  // Add current pageSize if not in options (will be removed from list once user changes to another value)\r\n  if (!options.includes(props.pageSize)) {\r\n    options.push(props.pageSize)\r\n  }\r\n\r\n  return options.sort((a, b) => a - b)\r\n})\r\n\r\nconst totalPages = computed(() => Math.ceil(props.totalRows / props.pageSize))\r\n\r\n// Generate visible page numbers - intelligently distribute max 20 pages across range\r\n// If total <= 20: show all pages (1 2 3 4 ... 20)\r\n// If total > 20: distribute evenly (1 6 11 16 21 26 ... 96)\r\n// Always include: first, last, and current page\r\nconst visiblePages = computed(() => {\r\n  const total = totalPages.value\r\n  const current = props.currentPage\r\n  const maxVisible = 20\r\n\r\n  if (total <= maxVisible) {\r\n    // Show all pages if 20 or fewer\r\n    const pages: number[] = []\r\n    for (let i = 1; i <= total; i++) {\r\n      pages.push(i)\r\n    }\r\n    return pages\r\n  }\r\n\r\n  // Calculate step size to show ~20 pages distributed across range\r\n  const step = Math.ceil(total / maxVisible)\r\n  const pages = new Set<number>()\r\n\r\n  // Always add first and last page\r\n  pages.add(1)\r\n  pages.add(total)\r\n\r\n  // Always add current page and neighbors\r\n  pages.add(current)\r\n  if (current > 1) pages.add(current - 1)\r\n  if (current < total) pages.add(current + 1)\r\n\r\n  // Add evenly distributed pages\r\n  for (let i = 1; i <= total; i += step) {\r\n    pages.add(i)\r\n  }\r\n\r\n  // Convert to sorted array\r\n  return Array.from(pages).sort((a, b) => a - b)\r\n})\r\n\r\nfunction handlePageSizeChange(event: Event) {\r\n  const target = event.target as HTMLSelectElement\r\n  emit('pageSizeChange', Number(target.value))\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.pagination {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 12px;\r\n  background-color: var(--dg-ui-pagination-bg, #f5f5f5);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n  border-top: 1px solid var(--dg-ui-pagination-border, #ccc);\r\n}\r\n\r\nbutton {\r\n  padding: 6px 12px;\r\n  background-color: var(--dg-header-sort-indicator, #2196f3);\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\nbutton:hover:not(:disabled) {\r\n  background-color: var(--dg-ui-pagination-button-hover-bg, #1976d2);\r\n}\r\n\r\nbutton:disabled {\r\n  background-color: var(--dg-cell-disabled-bg, #ccc);\r\n  color: var(--dg-cell-disabled-fg, #6c757d);\r\n  cursor: not-allowed;\r\n}\r\n\r\n.page-numbers {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  overflow-x: auto; /* Allow horizontal scroll if many pages */\r\n  max-width: 600px; /* Limit width, will scroll if more pages */\r\n  padding: 2px 0; /* Padding for scrollbar */\r\n}\r\n\r\n.page-number {\r\n  min-width: 36px;\r\n  padding: 6px 8px;\r\n  background-color: var(--dg-ui-pagination-bg, #ffffff);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n  border: 1px solid var(--dg-ui-pagination-border, #ccc);\r\n  border-radius: 4px;\r\n}\r\n\r\n.page-number:hover:not(:disabled):not(.active) {\r\n  background-color: var(--dg-ui-pagination-button-hover-bg, #e3f2fd);\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.page-number.active {\r\n  background-color: var(--dg-header-sort-indicator, #2196f3);\r\n  color: white;\r\n  font-weight: bold;\r\n  border-color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.page-info {\r\n  margin: 0 8px;\r\n  font-size: 14px;\r\n  color: var(--dg-ui-pagination-fg, #666);\r\n}\r\n\r\nselect {\r\n  padding: 6px 8px;\r\n  border: 1px solid var(--dg-ui-pagination-border, #ccc);\r\n  background-color: var(--dg-ui-pagination-bg, #ffffff);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n}\r\n</style>\r\n","<template>\r\n  <teleport to=\"body\">\r\n    <div v-if=\"visible\" class=\"filter-flyout-overlay\" @click.self=\"handleClose\">\r\n      <div class=\"filter-flyout\" :style=\"{ top: position.y + 'px', left: position.x + 'px' }\">\r\n        <!-- Header -->\r\n        <div class=\"filter-header\">\r\n          <h3 class=\"filter-title\">Filter: {{ columnName }}</h3>\r\n          <button class=\"close-button\" @click=\"handleClose\"></button>\r\n        </div>\r\n\r\n        <!-- Mode selector -->\r\n        <div class=\"filter-mode\">\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              :value=\"'checkbox'\"\r\n              v-model=\"filterMode\"\r\n              name=\"filterMode\"\r\n            />\r\n            <span>Checkbox</span>\r\n          </label>\r\n          <label>\r\n            <input\r\n              type=\"radio\"\r\n              :value=\"'regex'\"\r\n              v-model=\"filterMode\"\r\n              name=\"filterMode\"\r\n            />\r\n            <span>Regex</span>\r\n          </label>\r\n        </div>\r\n\r\n        <!-- Checkbox mode content -->\r\n        <div v-if=\"filterMode === 'checkbox'\" class=\"filter-content\">\r\n          <!-- Search box for filtering values -->\r\n          <input\r\n            v-model=\"searchText\"\r\n            type=\"text\"\r\n            class=\"filter-search\"\r\n            placeholder=\"Search values...\"\r\n          />\r\n\r\n          <!-- Select All / Deselect All buttons -->\r\n          <div class=\"filter-actions\">\r\n            <button class=\"action-button\" @click=\"selectAll\">Select All</button>\r\n            <button class=\"action-button\" @click=\"deselectAll\">Deselect All</button>\r\n          </div>\r\n\r\n          <!-- Values list with checkboxes -->\r\n          <div class=\"filter-values\">\r\n            <label\r\n              v-for=\"item in filteredValues\"\r\n              :key=\"item.value\"\r\n              class=\"value-item\"\r\n              :class=\"{ 'value-item--selected': item.isSelected }\"\r\n            >\r\n              <input\r\n                type=\"checkbox\"\r\n                v-model=\"item.isSelected\"\r\n                class=\"value-checkbox\"\r\n              />\r\n              <span class=\"value-text\">{{ item.displayText || displayText(item) }}</span>\r\n            </label>\r\n\r\n            <div v-if=\"filteredValues.length === 0\" class=\"no-values\">\r\n              No values found\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Regex mode content -->\r\n        <div v-else class=\"filter-content\">\r\n          <label class=\"regex-label\">\r\n            <span>Regex Pattern:</span>\r\n            <input\r\n              v-model=\"regexPattern\"\r\n              type=\"text\"\r\n              class=\"regex-input\"\r\n              placeholder=\"^test.*|.*example$\"\r\n            />\r\n          </label>\r\n\r\n          <div class=\"regex-help\">\r\n            <details>\r\n              <summary>Regex Examples</summary>\r\n              <ul>\r\n                <li><code>^test</code> - Starts with \"test\"</li>\r\n                <li><code>example$</code> - Ends with \"example\"</li>\r\n                <li><code>^test.*example$</code> - Starts with \"test\" and ends with \"example\"</li>\r\n                <li><code>test|example</code> - Contains \"test\" OR \"example\"</li>\r\n                <li><code>\\d{3}</code> - Contains exactly 3 digits</li>\r\n              </ul>\r\n            </details>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Footer buttons -->\r\n        <div class=\"filter-footer\">\r\n          <button class=\"footer-button footer-button--apply\" @click=\"handleApply\">\r\n            Apply Filter\r\n          </button>\r\n          <button class=\"footer-button footer-button--clear\" @click=\"handleClear\">\r\n            Clear Filter\r\n          </button>\r\n          <button class=\"footer-button footer-button--cancel\" @click=\"handleClose\">\r\n            Cancel\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </teleport>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch } from 'vue'\r\n\r\nexport interface FilterValue {\r\n  value: string\r\n  isSelected: boolean\r\n  count: number\r\n  displayText?: string\r\n}\r\n\r\nconst props = defineProps<{\r\n  visible: boolean\r\n  columnName: string\r\n  position: { x: number; y: number }\r\n  uniqueValues: FilterValue[]\r\n  currentMode?: 'checkbox' | 'regex'\r\n  currentPattern?: string\r\n}>()\r\n\r\nconst emit = defineEmits<{\r\n  close: []\r\n  applyCheckbox: [selectedValues: string[]]\r\n  applyRegex: [pattern: string]\r\n  clearFilter: []\r\n}>()\r\n\r\n// Local state\r\nconst filterMode = ref<'checkbox' | 'regex'>(props.currentMode || 'checkbox')\r\nconst searchText = ref('')\r\nconst regexPattern = ref(props.currentPattern || '')\r\nconst values = ref<FilterValue[]>([])\r\n\r\n// Watch for prop changes\r\nwatch(() => props.uniqueValues, (newValues) => {\r\n  values.value = newValues.map(v => ({ ...v }))\r\n}, { immediate: true, deep: true })\r\n\r\nwatch(() => props.currentPattern, (newPattern) => {\r\n  if (newPattern) {\r\n    regexPattern.value = newPattern\r\n  }\r\n}, { immediate: true })\r\n\r\n// Computed: filtered values based on search text\r\nconst filteredValues = computed(() => {\r\n  if (!searchText.value) {\r\n    return values.value\r\n  }\r\n\r\n  const search = searchText.value.toLowerCase()\r\n  return values.value.filter(item =>\r\n    item.value.toLowerCase().includes(search)\r\n  )\r\n})\r\n\r\n// Computed: display text with count\r\nconst displayText = (item: FilterValue) => {\r\n  return item.count > 0 ? `${item.value} (${item.count})` : item.value\r\n}\r\n\r\n// Methods\r\nfunction selectAll() {\r\n  filteredValues.value.forEach(item => {\r\n    item.isSelected = true\r\n  })\r\n}\r\n\r\nfunction deselectAll() {\r\n  filteredValues.value.forEach(item => {\r\n    item.isSelected = false\r\n  })\r\n}\r\n\r\nfunction handleApply() {\r\n  if (filterMode.value === 'checkbox') {\r\n    const selectedValues = values.value\r\n      .filter(item => item.isSelected)\r\n      .map(item => item.value)\r\n\r\n    emit('applyCheckbox', selectedValues)\r\n  } else {\r\n    emit('applyRegex', regexPattern.value)\r\n  }\r\n\r\n  handleClose()\r\n}\r\n\r\nfunction handleClear() {\r\n  emit('clearFilter')\r\n  handleClose()\r\n}\r\n\r\nfunction handleClose() {\r\n  emit('close')\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.filter-flyout-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background-color: rgba(0, 0, 0, 0.3);\r\n  z-index: 1000;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.filter-flyout {\r\n  position: fixed;\r\n  background-color: var(--dg-ui-dialog-bg, white);\r\n  color: var(--dg-ui-dialog-fg, #212529);\r\n  border: 1px solid var(--dg-ui-dialog-border, #ccc);\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\r\n  min-width: 320px;\r\n  max-width: 480px;\r\n  max-height: 600px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  z-index: 1001;\r\n}\r\n\r\n.filter-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 12px 16px;\r\n  border-bottom: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  background-color: var(--dg-header-bg, #f5f5f5);\r\n}\r\n\r\n.filter-title {\r\n  margin: 0;\r\n  font-size: 16px;\r\n  font-weight: 600;\r\n  color: var(--dg-header-fg, #212529);\r\n}\r\n\r\n.close-button {\r\n  background: none;\r\n  border: none;\r\n  font-size: 20px;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  width: 24px;\r\n  height: 24px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: var(--dg-ui-dialog-fg, #666);\r\n  border-radius: 4px;\r\n}\r\n\r\n.close-button:hover {\r\n  background-color: var(--dg-cell-hover-bg, #e0e0e0);\r\n  color: var(--dg-ui-dialog-fg, #000);\r\n}\r\n\r\n.filter-mode {\r\n  display: flex;\r\n  gap: 16px;\r\n  padding: 12px 16px;\r\n  border-bottom: 1px solid var(--dg-border-cell, #e0e0e0);\r\n}\r\n\r\n.filter-mode label {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n}\r\n\r\n.filter-mode input[type=\"radio\"] {\r\n  cursor: pointer;\r\n}\r\n\r\n.filter-content {\r\n  flex: 1;\r\n  padding: 16px;\r\n  overflow-y: auto;\r\n  min-height: 200px;\r\n}\r\n\r\n.filter-search {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid var(--dg-ui-filter-border, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  background-color: var(--dg-ui-filter-bg, white);\r\n  color: var(--dg-ui-filter-fg, #212529);\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.filter-search:focus {\r\n  outline: none;\r\n  border-color: var(--dg-border-focused-cell, #2196f3);\r\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\r\n}\r\n\r\n.filter-actions {\r\n  display: flex;\r\n  gap: 8px;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n.action-button {\r\n  flex: 1;\r\n  padding: 6px 12px;\r\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\r\n  border: 1px solid var(--dg-border-cell, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 13px;\r\n  cursor: pointer;\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n}\r\n\r\n.action-button:hover {\r\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\r\n}\r\n\r\n.filter-values {\r\n  max-height: 300px;\r\n  overflow-y: auto;\r\n  border: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  border-radius: 4px;\r\n  background-color: var(--dg-cell-bg, white);\r\n}\r\n\r\n.value-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  padding: 8px 12px;\r\n  cursor: pointer;\r\n  border-bottom: 1px solid var(--dg-border-cell, #f0f0f0);\r\n  font-size: 14px;\r\n}\r\n\r\n.value-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.value-item:hover {\r\n  background-color: var(--dg-cell-hover-bg, #f8f9fa);\r\n}\r\n\r\n.value-item--selected {\r\n  background-color: var(--lb-item-selected-bg, #e3f2fd);\r\n}\r\n\r\n.value-checkbox {\r\n  cursor: pointer;\r\n}\r\n\r\n.value-text {\r\n  flex: 1;\r\n}\r\n\r\n.no-values {\r\n  text-align: center;\r\n  padding: 24px;\r\n  color: var(--dg-ui-placeholder, #999);\r\n  font-size: 14px;\r\n}\r\n\r\n.regex-label {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n}\r\n\r\n.regex-input {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid var(--dg-ui-filter-border, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  font-family: 'Consolas', 'Monaco', monospace;\r\n  background-color: var(--dg-ui-filter-bg, white);\r\n  color: var(--dg-ui-filter-fg, #212529);\r\n}\r\n\r\n.regex-input:focus {\r\n  outline: none;\r\n  border-color: var(--dg-border-focused-cell, #2196f3);\r\n  box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.1);\r\n}\r\n\r\n.regex-help {\r\n  margin-top: 16px;\r\n  font-size: 13px;\r\n}\r\n\r\n.regex-help details {\r\n  background-color: var(--dg-ui-menu-bg, #f8f9fa);\r\n  border: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  border-radius: 4px;\r\n  padding: 8px;\r\n}\r\n\r\n.regex-help summary {\r\n  cursor: pointer;\r\n  font-weight: 500;\r\n  color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.regex-help ul {\r\n  margin: 8px 0 0 0;\r\n  padding-left: 20px;\r\n}\r\n\r\n.regex-help li {\r\n  margin: 4px 0;\r\n}\r\n\r\n.regex-help code {\r\n  background-color: var(--dg-cell-bg, #e9ecef);\r\n  padding: 2px 6px;\r\n  border-radius: 3px;\r\n  font-family: 'Consolas', 'Monaco', monospace;\r\n  font-size: 12px;\r\n}\r\n\r\n.filter-footer {\r\n  display: flex;\r\n  gap: 8px;\r\n  padding: 12px 16px;\r\n  border-top: 1px solid var(--dg-border-cell, #e0e0e0);\r\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\r\n}\r\n\r\n.footer-button {\r\n  flex: 1;\r\n  padding: 8px 16px;\r\n  border: 1px solid var(--dg-border-cell, #ccc);\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.footer-button--apply {\r\n  background-color: var(--dg-header-sort-indicator, #2196f3);\r\n  color: white;\r\n  border-color: var(--dg-header-sort-indicator, #2196f3);\r\n}\r\n\r\n.footer-button--apply:hover {\r\n  background-color: #1976d2;\r\n  border-color: #1976d2;\r\n}\r\n\r\n.footer-button--clear {\r\n  background-color: var(--dg-validation-warning-bg, #fff3cd);\r\n  color: var(--dg-validation-warning-fg, #856404);\r\n  border-color: var(--dg-validation-warning-border, #ffc107);\r\n}\r\n\r\n.footer-button--clear:hover {\r\n  background-color: #ffe69c;\r\n}\r\n\r\n.footer-button--cancel {\r\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\r\n  color: var(--dg-ui-pagination-fg, #212529);\r\n}\r\n\r\n.footer-button--cancel:hover {\r\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\r\n}\r\n\r\n/* Scrollbar styling */\r\n.filter-values::-webkit-scrollbar,\r\n.filter-content::-webkit-scrollbar {\r\n  width: 8px;\r\n}\r\n\r\n.filter-values::-webkit-scrollbar-track,\r\n.filter-content::-webkit-scrollbar-track {\r\n  background: var(--lb-scrollbar-track-bg, #f1f1f1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.filter-values::-webkit-scrollbar-thumb,\r\n.filter-content::-webkit-scrollbar-thumb {\r\n  background: var(--lb-scrollbar-thumb-bg, #c1c1c1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.filter-values::-webkit-scrollbar-thumb:hover,\r\n.filter-content::-webkit-scrollbar-thumb:hover {\r\n  background: var(--lb-scrollbar-thumb-hover-bg, #a8a8a8);\r\n}\r\n</style>\r\n","<template>\n  <div class=\"data-grid\" :style=\"cssVariables\">\n    <!-- Loading overlay during processing -->\n    <div v-if=\"isProcessing\" class=\"processing-overlay\">\n      <div class=\"processing-content\">\n        <div class=\"processing-spinner\"></div>\n        <div class=\"processing-text\">Processing {{ store.rows.length }} rows...</div>\n\n        <!--  RIEENIE #4: Progress bar for validation -->\n        <div v-if=\"validationProgress.isValidating\" class=\"progress-container\">\n          <div class=\"progress-bar-wrapper\">\n            <div class=\"progress-bar\" :style=\"{ width: validationProgress.percentage + '%' }\"></div>\n          </div>\n          <div class=\"progress-text\">\n            {{ validationProgress.current }} / {{ validationProgress.total }} cells validated ({{ validationProgress.percentage }}%)\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Toolbar -->\n    <div class=\"grid-toolbar\">\n      <!-- Auto Row Height toggle -->\n      <div class=\"toolbar-section\">\n        <button\n          class=\"toolbar-button\"\n          :class=\"{ 'toolbar-button--active': store.isAutoRowHeightEnabled }\"\n          @click=\"toggleAutoRowHeight\"\n          :title=\"store.isAutoRowHeightEnabled ? 'Disable auto row height' : 'Enable auto row height'\"\n        >\n           Auto Height {{ store.isAutoRowHeightEnabled ? 'ON' : 'OFF' }}\n        </button>\n      </div>\n\n      <!-- Backend API sync -->\n      <div class=\"toolbar-section\">\n        <button\n          class=\"toolbar-button\"\n          :class=\"{ 'toolbar-button--disabled': !isBackendConnected }\"\n          :disabled=\"isLoadingFromBackend || !isBackendConnected\"\n          @click=\"loadDataFromBackend\"\n          title=\"Load data from backend\"\n        >\n          {{ isLoadingFromBackend ? ' Loading...' : ' Load from Backend' }}\n        </button>\n        <button\n          class=\"toolbar-button\"\n          :class=\"{ 'toolbar-button--disabled': !isBackendConnected }\"\n          :disabled=\"isSavingToBackend || !isBackendConnected\"\n          @click=\"saveDataToBackend\"\n          title=\"Save data to backend\"\n        >\n          {{ isSavingToBackend ? ' Saving...' : ' Save to Backend' }}\n        </button>\n        <span\n          class=\"connection-status\"\n          :class=\"{ 'connection-status--connected': isBackendConnected, 'connection-status--disconnected': !isBackendConnected }\"\n          @click=\"checkBackendConnection\"\n          title=\"Click to refresh connection status\"\n        >\n          {{ isBackendConnected ? ' Connected' : ' Disconnected' }}\n        </span>\n      </div>\n    </div>\n\n    <!-- Hidden columns notification -->\n    <div v-if=\"showHiddenColumnsPanel !== false && hiddenColumns.length > 0\" class=\"hidden-columns-panel\">\n      <span class=\"hidden-columns-label\">Hidden columns:</span>\n      <button\n        v-for=\"col in hiddenColumns\"\n        :key=\"col.name\"\n        class=\"show-column-button\"\n        @click=\"showColumn(col.name)\"\n        :title=\"`Show column: ${col.header}`\"\n      >\n        {{ col.header }}\n      </button>\n      <button class=\"show-all-button\" @click=\"showAllColumns\" title=\"Show all columns\">\n        Show All\n      </button>\n    </div>\n\n    <div class=\"grid-container\">\n      <DataGridHeader\n        :columns=\"allColumns\"\n        :grid-template-columns=\"gridTemplateColumns\"\n        :grid-id=\"instanceId\"\n        :is-grid-ready=\"isGridReady\"\n        :is-processing=\"isProcessing\"\n        :show-hidden-columns-panel=\"showHiddenColumnsPanel\"\n        @sort=\"handleSort\"\n        @resize=\"handleResize\"\n        @hide-column=\"handleHideColumn\"\n        @auto-fit-column=\"handleAutoFitColumn\"\n        @show-filter=\"handleShowFilter\"\n      />\n\n      <DynamicScroller\n        ref=\"scrollerRef\"\n        :items=\"visibleRows\"\n        :min-item-size=\"40\"\n        :buffer=\"200\"\n        key-field=\"rowId\"\n        class=\"scroller\"\n      >\n        <!-- @ts-ignore - DynamicScroller slot types -->\n        <template #default=\"{ item, index, active }\">\n          <DynamicScrollerItem\n            :item=\"item\"\n            :active=\"active\"\n            :size-dependencies=\"[item.height, item.cells.length, item.validationErrorCount]\"\n            :data-index=\"index\"\n          >\n            <DataGridRow\n              :row=\"item\"\n              :columns=\"allColumns\"\n              :grid-template-columns=\"gridTemplateColumns\"\n              :grid-id=\"instanceId\"\n              @cell-edit-complete=\"handleCellEditComplete\"\n              @cell-input=\"handleCellInput\"\n              @checkbox-change=\"handleCheckboxChange\"\n              @delete-row=\"handleDeleteRow\"\n              @insert-row=\"handleInsertRow\"\n              @insert-above=\"handleInsertAbove\"\n              @insert-below=\"handleInsertBelow\"\n            />\n          </DynamicScrollerItem>\n        </template>\n      </DynamicScroller>\n    </div>\n\n    <PaginationControl\n      :page-size=\"store.pageSize\"\n      :page-size-options=\"store.config.pageSizeOptions\"\n      :total-rows=\"store.totalRows\"\n      :current-page=\"store.currentPage\"\n      @page-change=\"store.goToPage\"\n      @page-size-change=\"store.setPageSize\"\n    />\n\n    <FilterFlyout\n      :visible=\"filterFlyout.visible\"\n      :column-name=\"filterFlyout.columnName\"\n      :position=\"filterFlyout.position\"\n      :unique-values=\"filterFlyout.uniqueValues\"\n      :current-mode=\"filterFlyout.mode\"\n      :current-pattern=\"filterFlyout.pattern\"\n      @close=\"closeFilterFlyout\"\n      @apply-checkbox=\"handleApplyCheckboxFilter\"\n      @apply-regex=\"handleApplyRegexFilter\"\n      @clear-filter=\"handleClearFilter\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, watch, onMounted, onUnmounted, onBeforeMount, onBeforeUnmount, provide, nextTick } from 'vue'\nimport { useDebounceFn } from '@vueuse/core'\nimport { DynamicScroller, DynamicScrollerItem } from 'vue-virtual-scroller'\nimport { useDataGridStore, type GridColumn } from '@/stores/dataGridStore'\nimport { useValidation } from '@/composables/useValidation'\nimport { useCopyPaste } from '@/composables/useCopyPaste'\nimport { useImportExport, ImportMode } from '@/composables/useImportExport'\nimport { useAutoRowHeight, defaultAutoRowHeightConfig } from '@/composables/useAutoRowHeight'\nimport { useShortcuts, createDefaultShortcuts, ShortcutContext } from '@/composables/useShortcuts'\nimport { useLogger } from '@/composables/useLogger'\nimport { gridApi } from '@/services/gridApi'\nimport { generateDataGridCSSVariables, defaultDataGridTheme } from '@/composables/useTheme'\nimport type { DataGridTheme } from '@/types/theme'\nimport { useFiltering, type FilterExpression, type SimpleFilter, type CompositeFilter } from '@/composables/useFiltering'\nimport DataGridHeader from './DataGridHeader.vue'\nimport DataGridRow from './DataGridRow.vue'\nimport PaginationControl from './PaginationControl.vue'\nimport FilterFlyout from './FilterFlyout.vue'\nimport type { FilterValue } from './FilterFlyout.vue'\n\nconst props = defineProps<{\n  config?: any\n  columns?: GridColumn[]\n  gridId?: string  // Optional unique ID for this grid instance\n  theme?: Partial<DataGridTheme>  // Optional theme customization\n  minTableWidth?: number  // Minimum table width in pixels - triggers horizontal scroll when container is smaller\n  width?: string  // Table width (e.g., \"100%\", \"800px\", \"50vw\") - defaults to \"100%\"\n  height?: string  // Table height (e.g., \"600px\", \"80vh\", \"auto\") - defaults to \"600px\"\n  autoRowHeightEnabled?: boolean  // Optional: Enable AutoRowHeight on initialization (default: false)\n  minRows?: number  // Optional: Minimum number of rows to display (default: 5)\n  showHiddenColumnsPanel?: boolean  // Optional: Show hidden columns panel (default: true)\n}>()\n\n// Generate unique store ID for this grid instance\nconst instanceId = props.gridId || `grid-${Math.random().toString(36).substr(2, 9)}`\n\n// Initialize logger for this component\nconst logger = useLogger(`DataGrid[${instanceId}]`)\nlogger.info(' Component initializing', {\n  gridId: instanceId,\n  hasConfig: !!props.config,\n  hasColumns: !!props.columns,\n  columnCount: props.columns?.length || 0\n})\n\n// Create a unique store instance for this DataGrid\nconsole.log('[DataGrid] Creating store with ID:', instanceId)\nconst storeFactory = useDataGridStore(instanceId)\nconsole.log('[DataGrid] Store factory created:', typeof storeFactory, storeFactory)\n\nlet store: ReturnType<typeof storeFactory>\ntry {\n  store = storeFactory()\n  console.log('[DataGrid] Store instance created:', store)\n  logger.debug(' Store created', { instanceId })\n} catch (error) {\n  console.error('[DataGrid] FAILED to create store:', error)\n  logger.error(' Store creation failed', { instanceId, error })\n  throw error\n}\n\n// Set initial AutoRowHeight state from props (default: false)\nif (props.autoRowHeightEnabled !== undefined) {\n  store.setAutoRowHeightEnabled(props.autoRowHeightEnabled)\n  logger.info(` AutoRowHeight initialized to: ${props.autoRowHeightEnabled}`)\n}\n\n// Set minimum rows from props (default: 5)\nif (props.minRows !== undefined) {\n  store.setMinRows(props.minRows)\n  logger.info(` MinRows initialized to: ${props.minRows}`)\n}\n\n// Create validation instance for this DataGrid and provide it to child components\nconst validation = useValidation()\nprovide('validation', validation)\n\n// Create copy/paste instance\nconst copyPaste = useCopyPaste()\n\n// Create import/export instance\nconst importExport = useImportExport()\n\n// Create filtering instance\nconst { filterRows: filterRowsHelper, evaluateFilter } = useFiltering()\n\n//  FIX: Loading flag to prevent race conditions\nconst isGridReady = ref(false)\n\n//  FIX: Processing flag to prevent interactions during validation/AutoRowHeight\nconst isProcessing = ref(false)\n\n//  RIEENIE #1: Validation guard to prevent concurrent validation runs\nconst isValidating = ref(false)\n\n//  RIEENIE #4: Progress tracking for validation\nconst validationProgress = ref({\n  isValidating: false,\n  current: 0,\n  total: 0,\n  percentage: 0\n})\n\n//  RIEENIE #5: Cancellation token for validation\nlet validationCancelled = false\n\n// Create auto row height instance with dynamic maxHeight based on container height\nconst containerHeight = ref(800)  // Default container height (will be measured dynamically)\n\n// Compute maxHeight as 70% of container height, minimum 32px\nconst computedMaxHeight = computed(() => {\n  const maxHeight = Math.max(32, Math.floor(containerHeight.value * 0.7))\n  console.log(`[AutoRowHeight] Computed maxHeight: ${maxHeight}px (container: ${containerHeight.value}px)`)\n  return maxHeight\n})\n\n// Initialize with dynamic config\nconst autoRowHeight = useAutoRowHeight({\n  minHeight: 32,\n  maxHeight: computedMaxHeight.value,\n  fontFamily: 'system-ui, -apple-system, sans-serif',\n  fontSize: 14,\n  enableWrapping: true,\n  padding: 16\n})\n\n// Watch for container height changes and update maxHeight\nwatch(computedMaxHeight, async (newMaxHeight) => {\n  console.log(`[AutoRowHeight] maxHeight changed to: ${newMaxHeight}px`)\n  autoRowHeight.updateMaxHeight(newMaxHeight)\n\n  // If AutoRowHeight is enabled, recalculate all row heights with new maxHeight\n  if (store.isAutoRowHeightEnabled && store.rows.length > 0) {\n    console.log('[AutoRowHeight] maxHeight changed - recalculating all row heights...')\n    await applyAutoRowHeightToAll()\n  }\n})\n\n// Measure container height function (defined at top level for cleanup)\nconst measureContainerHeight = () => {\n  // CRITICAL FIX: Guard against undefined $el\n  if (!scrollerRef.value) {\n    console.log('[AutoRowHeight] Cannot measure: scrollerRef is null')\n    return\n  }\n\n  if (!scrollerRef.value.$el) {\n    console.log('[AutoRowHeight] Cannot measure: scrollerRef.$el is undefined')\n    return\n  }\n\n  const height = scrollerRef.value.$el.clientHeight\n  if (height > 0) {\n    containerHeight.value = height\n    console.log(`[AutoRowHeight] Container height measured: ${height}px`)\n  } else {\n    console.log('[AutoRowHeight] Container height is 0, keeping default')\n  }\n}\n\n//  RIEENIE C: Single async onMounted - ensures proper initialization sequence\nonMounted(async () => {\n  logger.info('==========  Component mounted - START initialization ==========', {\n    gridId: props.gridId,\n    autoRowHeight: store.isAutoRowHeightEnabled,\n    rowCount: store.rows.length,\n    columnCount: store.columns.length\n  })\n\n  // 1. Register event listeners FIRST\n  document.addEventListener('mouseup', handleDocumentMouseUp)\n  document.addEventListener('keydown', handleKeyboardShortcuts)\n  logger.debug(' Event listeners registered (mouseup, keydown)')\n\n  // 2. Auto-initialize: If columns are provided but no rows exist, initialize empty rows\n  if (props.columns && props.columns.length > 0 && store.rows.length === 0) {\n    logger.info(' Auto-initializing empty rows from provided columns', {\n      columnCount: props.columns.length\n    })\n    try {\n      store.setColumns(props.columns)\n      store.initializeEmptyRows()\n      logger.info(` Auto-initialized ${store.rows.length} empty rows`)\n    } catch (error) {\n      logger.error(' Failed to set columns:', error)\n      alert(`Column configuration error: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n\n  // 3. Check backend connection (async)\n  checkBackendConnection()\n\n  // 4. Wait for DOM to be ready\n  await nextTick()\n  logger.debug(' DOM ready after nextTick')\n\n  // 5. Measure container height\n  measureContainerHeight()\n\n  // 6. Apply AutoRowHeight if enabled (async operation)\n  if (store.isAutoRowHeightEnabled && store.rows.length > 0) {\n    logger.info(' AutoRowHeight enabled - applying heights...')\n    await nextTick()\n    try {\n      await applyAutoRowHeightToAll()\n      logger.info(' AutoRowHeight applied successfully on mount')\n    } catch (error) {\n      logger.error(' AutoRowHeight ERROR on mount:', error)\n    }\n  } else {\n    logger.debug(` Skipping AutoRowHeight: enabled=${store.isAutoRowHeightEnabled}, rowCount=${store.rows.length}`)\n  }\n\n  // 7. Register resize listener\n  window.addEventListener('resize', measureContainerHeight)\n  logger.debug(' Resize listener registered')\n\n  // 8. ONLY NOW mark grid as ready (after ALL async operations complete)\n  await nextTick()\n  isGridReady.value = true\n  logger.info('==========  Grid marked as READY for user interaction ==========')\n})\n\n// Cleanup on unmount (must be at top level, NOT inside onMounted)\nonBeforeUnmount(() => {\n  window.removeEventListener('resize', measureContainerHeight)\n  document.removeEventListener('mouseup', handleDocumentMouseUp)\n  document.removeEventListener('keydown', handleKeyboardShortcuts)\n  logger.info(' Cleanup: All event listeners removed')\n})\n\n// Use store.isAutoRowHeightEnabled instead of local ref\n\n// Backend API connection status\nconst isBackendConnected = ref(false)\nconst isLoadingFromBackend = ref(false)\nconst isSavingToBackend = ref(false)\n\n// DynamicScroller ref for force updates\nconst scrollerRef = ref<InstanceType<typeof DynamicScroller>>()\n\n// Get selected rows for copy/paste operations\nconst getSelectedRows = () => {\n  const selectedCells = Array.from(store.selectedCells)\n  if (selectedCells.length === 0) return []\n\n  // Get unique row IDs from selected cells\n  const rowIds = new Set(selectedCells.map(cellId => cellId.split(':')[0]))\n  return store.rows.filter(row => rowIds.has(row.rowId))\n}\n\n// Get column names (excluding special columns)\nconst getDataColumnNames = () => {\n  return dataColumns.value\n    .filter(col => !col.specialType)\n    .map(col => col.name)\n}\n\n// Copy handler\nconst handleCopy = async () => {\n  const rows = getSelectedRows()\n  if (rows.length === 0) {\n    console.warn('No rows selected for copy')\n    return\n  }\n\n  const columnNames = getDataColumnNames()\n  const result = await copyPaste.copyToClipboard(rows, columnNames, { includeHeaders: true })\n\n  if (result.success) {\n    console.log(result.message)\n  } else {\n    console.error(result.message)\n  }\n}\n\n// Paste handler\nconst handlePaste = async () => {\n  const result = await copyPaste.pasteFromClipboard()\n\n  if (result.success && result.rows && result.rows.length > 0) {\n    // Find the target position (first selected cell or append to end)\n    const selectedCells = Array.from(store.selectedCells)\n    let targetRowIndex = store.rows.length\n\n    if (selectedCells.length > 0) {\n      // Get first selected cell position\n      const firstCellId = selectedCells[0]\n      const rowId = firstCellId.split(':')[0]\n      const rowIndex = store.rows.findIndex(r => r.rowId === rowId)\n      if (rowIndex >= 0) {\n        targetRowIndex = rowIndex\n      }\n    }\n\n    // Add pasted rows to the store\n    result.rows.forEach((rowData, index) => {\n      if (targetRowIndex + index < store.rows.length) {\n        // Overwrite existing row\n        const targetRow = store.rows[targetRowIndex + index]\n        Object.keys(rowData).forEach(key => {\n          if (dataColumns.value.some(col => col.name === key)) {\n            store.updateCell(targetRow.rowId, key, rowData[key])\n          }\n        })\n      } else {\n        // Append new row - insert empty row at end and populate with data\n        const lastRowId = store.rows[store.rows.length - 1]?.rowId\n        if (lastRowId) {\n          store.insertRow(lastRowId)\n          // Get the newly created row and update its cells with data\n          const newRow = store.rows[store.rows.length - 1]\n          Object.keys(rowData).forEach(key => {\n            if (dataColumns.value.some(col => col.name === key)) {\n              store.updateCell(newRow.rowId, key, rowData[key])\n            }\n          })\n        }\n      }\n    })\n\n    console.log(result.message)\n  } else {\n    console.error(result.message)\n  }\n}\n\n// Cut handler (copy + delete)\nconst handleCut = async () => {\n  await handleCopy()\n\n  // Delete selected cells content\n  const selectedCells = Array.from(store.selectedCells)\n  selectedCells.forEach(cellId => {\n    const [rowId, columnName] = cellId.split(':')\n    if (!dataColumns.value.find(col => col.name === columnName)?.isReadOnly) {\n      store.updateCell(rowId, columnName, null)\n    }\n  })\n}\n\n// Delete handler\nconst handleDelete = () => {\n  const selectedCells = Array.from(store.selectedCells)\n  selectedCells.forEach(cellId => {\n    const [rowId, columnName] = cellId.split(':')\n    if (!dataColumns.value.find(col => col.name === columnName)?.isReadOnly) {\n      store.updateCell(rowId, columnName, null)\n    }\n  })\n}\n\n// Select All handler\nconst handleSelectAll = () => {\n  // Select all cells in all rows\n  store.rows.forEach(row => {\n    dataColumns.value.forEach(col => {\n      if (!col.specialType) { // Only select data columns\n        store.selectCell(row.rowId, col.name, true) // true for Ctrl to add to selection\n      }\n    })\n  })\n}\n\n// Register keyboard shortcuts\nconst shortcuts = useShortcuts({ enabled: true, context: ShortcutContext.Normal })\n\nshortcuts.registerShortcuts(createDefaultShortcuts({\n  onCopy: handleCopy,\n  onPaste: handlePaste,\n  onCut: handleCut,\n  onDelete: handleDelete,\n  onSelectAll: handleSelectAll,\n  onFind: () => console.log('Find not implemented yet')\n}))\n\nconst visibleRows = computed(() => store.visibleRows)\n\n// Use provided columns or default to store columns WITH DEFAULTS\nconst dataColumns = computed(() => {\n  const cols = Array.isArray(props.columns) && props.columns.length > 0\n    ? props.columns\n    : store.columns\n\n  // Apply defaults to DATA columns (not special columns)\n  return cols.map(col => {\n    // Skip special columns - they have their own defaults\n    if (col.specialType) {\n      return col\n    }\n\n    // Apply defaults for DATA columns only\n    return {\n      ...col,\n      minWidth: col.minWidth ?? 50,           // Default: 50\n      maxWidth: col.maxWidth ?? 200,          // Default: 200\n      isSortable: col.isSortable ?? false,    // Default: false\n      isFilterable: col.isFilterable ?? false // Default: false\n    }\n  })\n})\n\n// Keyboard handler for Ctrl+C / Ctrl+V\nfunction handleKeyboardShortcuts(event: KeyboardEvent) {\n  // Only handle if Ctrl (or Cmd on Mac) is pressed\n  if (!event.ctrlKey && !event.metaKey) return\n\n  // Ctrl+C - Copy selected cells\n  if (event.key === 'c' || event.key === 'C') {\n    event.preventDefault()\n    console.log('[DataGrid] Ctrl+C pressed - copying selected cells')\n    handleCopySelectedCells()\n  }\n\n  // Ctrl+V - Paste from clipboard\n  if (event.key === 'v' || event.key === 'V') {\n    event.preventDefault()\n    console.log('[DataGrid] Ctrl+V pressed - pasting from clipboard')\n    handlePasteSelectedCells()\n  }\n}\n\n// Copy selected cells (new implementation with position preservation)\nasync function handleCopySelectedCells() {\n  if (store.selectedCells.size === 0) {\n    console.warn('[DataGrid] No cells selected for copy')\n    return\n  }\n\n  console.log('[DataGrid] Copying selected cells:', {\n    selectedCount: store.selectedCells.size,\n    selectedCells: Array.from(store.selectedCells)\n  })\n\n  // Use new copySelectedCells method that preserves positions\n  const result = await copyPaste.copySelectedCells(\n    store.selectedCells,\n    store.rows,\n    allColumns.value\n  )\n\n  if (result.success) {\n    console.log('[DataGrid] Copy successful:', result.message)\n  } else {\n    console.error('[DataGrid] Copy failed:', result.message)\n  }\n}\n\n// Paste from clipboard to selected cells\nasync function handlePasteSelectedCells() {\n  const result = await copyPaste.pasteFromClipboard()\n\n  if (result.success && result.rows && result.rows.length > 0) {\n    console.log('[DataGrid] Paste successful:', {\n      rowCount: result.rows.length,\n      headers: result.headers\n    })\n\n    // Find the target position (first selected cell or top-left)\n    let targetRowIndex = 0\n    let targetColIndex = 0\n\n    if (store.selectedCells.size > 0) {\n      // Get first selected cell as paste target\n      const firstCellKey = Array.from(store.selectedCells)[0]\n      const [firstRowId, firstColName] = firstCellKey.split(':')\n      const firstRow = store.rows.find(r => r.rowId === firstRowId)\n      const firstColIdx = allColumns.value.findIndex(c => c.name === firstColName)\n\n      if (firstRow && firstColIdx !== -1) {\n        targetRowIndex = firstRow.rowIndex\n        targetColIndex = firstColIdx\n      }\n    }\n\n    console.log('[DataGrid] Pasting at position:', {\n      targetRowIndex,\n      targetColIndex\n    })\n\n    // Paste data row by row, column by column\n    result.rows.forEach((rowData, rowOffset) => {\n      const pasteRowIndex = targetRowIndex + rowOffset\n\n      if (pasteRowIndex >= store.rows.length) {\n        console.warn('[DataGrid] Paste row out of bounds:', { pasteRowIndex, maxRows: store.rows.length })\n        return\n      }\n\n      const targetRow = store.rows[pasteRowIndex]\n\n      // Paste each column value\n      Object.keys(rowData).forEach((columnKey, colOffset) => {\n        const pasteColIndex = targetColIndex + colOffset\n\n        if (pasteColIndex >= allColumns.value.length) {\n          console.warn('[DataGrid] Paste column out of bounds:', { pasteColIndex, maxCols: allColumns.value.length })\n          return\n        }\n\n        const targetColumn = allColumns.value[pasteColIndex]\n        const value = rowData[columnKey]\n\n        // Update cell value\n        store.updateCell(targetRow.rowId, targetColumn.name, value)\n\n        console.log('[DataGrid] Pasted cell:', {\n          row: pasteRowIndex,\n          col: pasteColIndex,\n          columnName: targetColumn.name,\n          value\n        })\n      })\n    })\n\n    console.log('[DataGrid] Paste complete')\n  } else {\n    console.error('[DataGrid] Paste failed:', result.message)\n  }\n}\n\n// Lifecycle: Before mount\nonBeforeMount(() => {\n  logger.info(' Component before mount')\n})\n\n//  RIEENIE C: Second onMounted REMOVED - merged into single async onMounted above\n\n// Lifecycle: Before unmount\nonBeforeUnmount(() => {\n  logger.info(' Component before unmount')\n})\n\n// Lifecycle: Unmounted - cleanup event listeners\nonUnmounted(() => {\n  logger.info(' Component unmounted - final cleanup')\n  logger.info(' Component cleanup complete')\n})\n\n// Batch validation - validates cells in batches to avoid UI freeze\n// Solution B + C: Only validate unvalidated cells, process asynchronously in batches\n// SOLUTION 2: Enhanced logging to debug validation issues\n//  RIEENIE #7: Calculate optimal batch size based on total cells\n// Adaptive batch sizing to balance memory usage and performance\nfunction calculateOptimalBatchSize(totalCells: number): number {\n  if (totalCells < 1000) {\n    return 25   // Small dataset: smaller batches for responsiveness\n  } else if (totalCells < 5000) {\n    return 50   // Medium dataset: moderate batch size\n  } else if (totalCells < 15000) {\n    return 100  // Large dataset: bigger batches\n  } else {\n    return 200  // Very large dataset: maximum batch size\n  }\n}\n\nasync function validateAllCellsInBatches() {\n  //  RIEENIE #5: If validation is running, cancel it and wait for completion\n  if (isValidating.value) {\n    console.log('[validateAllCellsInBatches]  Validation already in progress, cancelling previous validation...')\n    validationCancelled = true\n\n    // Wait for previous validation to finish (max 5 seconds)\n    const startWait = Date.now()\n    while (isValidating.value && Date.now() - startWait < 5000) {\n      await new Promise(resolve => setTimeout(resolve, 100))\n    }\n\n    if (isValidating.value) {\n      console.error('[validateAllCellsInBatches]  Previous validation did not finish in time')\n      return\n    }\n  }\n\n  //  RIEENIE #1: Set flag before starting\n  isValidating.value = true\n  //  RIEENIE #5: Reset cancellation flag\n  validationCancelled = false\n\n  try {\n    console.log('[validateAllCellsInBatches]  START', {\n      enableValidation: store.config.enableValidation,\n      hasValidation: !!validation,\n      totalRows: store.rows.length,\n      totalColumns: store.columns.length\n    })\n\n    if (!store.config.enableValidation || !validation) {\n      console.log('[validateAllCellsInBatches]  SKIPPED - validation not enabled or not available')\n      return\n    }\n\n    // Solution B: Get only cells that need validation (changed or unvalidated)\n    // Pass forceValidateAll=true to validate ALL cells, including those in currently empty rows\n    const cellsToValidate = store.getCellsNeedingValidation(true)\n\n    console.log('[validateAllCellsInBatches]  Cells needing validation:', {\n      count: cellsToValidate.length,\n      sample: cellsToValidate.slice(0, 5).map(c => `${c.rowId}:${c.columnName}`)\n    })\n\n    if (cellsToValidate.length === 0) {\n      console.log('[validateAllCellsInBatches]  NO CELLS NEED VALIDATION - all cells already validated')\n      return\n    }\n\n    //  RIEENIE #4: Initialize progress tracking\n    validationProgress.value = {\n      isValidating: true,\n      current: 0,\n      total: cellsToValidate.length,\n      percentage: 0\n    }\n\n    //  RIEENIE #7: Dynamic batch size based on total cells\n    const PARALLEL_BATCH_SIZE = calculateOptimalBatchSize(cellsToValidate.length)\n    let validatedCount = 0\n\n    console.log('[validateAllCellsInBatches] Starting PARALLEL batch validation...', {\n      totalCells: cellsToValidate.length,\n      parallelBatchSize: PARALLEL_BATCH_SIZE,\n      estimatedBatches: Math.ceil(cellsToValidate.length / PARALLEL_BATCH_SIZE)\n    })\n\n    // Process in batches - validate ALL cells in batch SIMULTANEOUSLY\n    for (let i = 0; i < cellsToValidate.length; i += PARALLEL_BATCH_SIZE) {\n      //  RIEENIE #5: Check cancellation before each batch\n      if (validationCancelled) {\n        console.log('[validateAllCellsInBatches]  CANCELLED by user')\n        return\n      }\n\n      const batch = cellsToValidate.slice(i, i + PARALLEL_BATCH_SIZE)\n      const batchNumber = Math.floor(i / PARALLEL_BATCH_SIZE) + 1\n\n      console.log(`[validateAllCellsInBatches]  Processing batch ${batchNumber} (PARALLEL):`, {\n        batchSize: batch.length,\n        from: i,\n        to: i + batch.length\n      })\n\n      //  Create array of validation promises - ALL cells validate in parallel\n      const validationPromises = batch.map(({ rowId, columnName }) => {\n        //  RIEENIE #3: Use O(1) Map.get() instead of O(n) array.find()\n        const row = store.getRow(rowId)\n        if (!row) {\n          console.warn('[validateAllCellsInBatches]  Row not found:', rowId)\n          return Promise.resolve()\n        }\n\n        const cell = row.cells.find(c => c.columnName === columnName)\n        if (!cell) {\n          console.warn('[validateAllCellsInBatches]  Cell not found:', { rowId, columnName })\n          return Promise.resolve()\n        }\n\n        const rowCells = row.cells.map(c => ({ columnName: c.columnName, value: c.value }))\n\n        //  RIEENIE #2: Use validateCellDirect with skipErrorCountUpdate=true for bulk validation\n        return validation.validateCellDirect(rowId, columnName, cell.value, rowCells, true)\n          .then(() => {\n            store.markCellValidated(rowId, columnName)\n            validatedCount++\n          })\n          .catch(err => {\n            console.error('[validateAllCellsInBatches]  Validation error:', { rowId, columnName, err })\n          })\n      })\n\n      //  Wait for ALL cells in batch to complete (parallel execution)\n      await Promise.all(validationPromises)\n\n      //  RIEENIE #4: Update progress after each batch\n      validationProgress.value.current = validatedCount\n      validationProgress.value.percentage = Math.round((validatedCount / cellsToValidate.length) * 100)\n\n      // Yield to UI after each batch to prevent freeze\n      await nextTick()\n\n      console.log(`[validateAllCellsInBatches]  Batch ${batchNumber} complete (PARALLEL):`, {\n        validated: validatedCount,\n        total: cellsToValidate.length,\n        progress: `${validationProgress.value.percentage}%`\n      })\n    }\n\n    //  RIEENIE #2: Update error count ONCE at the end of batch validation\n    validation.updateErrorCount()\n\n    console.log('[validateAllCellsInBatches]  COMPLETE:', {\n      totalValidated: validatedCount,\n      totalRequested: cellsToValidate.length,\n      success: validatedCount === cellsToValidate.length\n    })\n  } catch (error) {\n    console.error('[validateAllCellsInBatches]  ERROR:', error)\n    throw error\n  } finally {\n    //  RIEENIE #1: Always reset flag, even if error occurs\n    isValidating.value = false\n\n    //  RIEENIE #4: Reset progress tracking\n    validationProgress.value.isValidating = false\n\n    console.log('[validateAllCellsInBatches]  END')\n  }\n}\n\n// Watch for autoValidate toggle - validate all cells when enabled\nwatch(() => store.config.autoValidate, async (enabled, wasEnabled) => {\n  console.log('[DataGrid] autoValidate changed:', { wasEnabled, enabled })\n\n  if (enabled && !wasEnabled && store.config.enableValidation) {\n    console.log('[DataGrid] Auto-validation enabled - validating all unvalidated cells')\n    await validateAllCellsInBatches()\n  }\n})\n\nfunction handleDocumentMouseUp() {\n  if (store.isDragging || store.pressedCell) {\n    store.endDragSelection()\n  }\n}\n\n// Create special columns based on config\nconst specialColumns = computed(() => {\n  const cols: GridColumn[] = []\n  const config = store.config\n\n  if (config.showRowNumber) {\n    cols.push({\n      name: '__rowNumber',\n      header: '#',\n      width: 50,\n      minWidth: 40,\n      maxWidth: 80,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'RowNumber'\n    })\n  }\n\n  if (config.showCheckbox) {\n    cols.push({\n      name: '__checkbox',\n      header: '',\n      width: 40,\n      minWidth: 40,\n      maxWidth: 40,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: true,  //  FIX: Povoli filtrovanie pre Checkbox stpec\n      specialType: 'Checkbox'\n    })\n  }\n\n  return cols\n})\n\n// Validation column (goes after data columns, before action columns)\n// Uses autoWidth (1fr) to fill remaining space between data columns and action columns\n// NO maxWidth constraint - can expand as much as needed for long validation messages\nconst validationColumn = computed(() => {\n  const cols: GridColumn[] = []\n  const config = store.config\n\n  if (config.showValidationAlerts) {\n    cols.push({\n      name: '__validationAlerts',\n      header: ' Validation',\n      width: 200,  // Default width (only used if autoWidth is false)\n      minWidth: 150,\n      maxWidth: 9999,  // No maximum - can grow as needed\n      autoWidth: true,  // Use 1fr to fill remaining space to full width\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'ValidationAlerts'\n    })\n  }\n\n  return cols\n})\n\n// Create action columns (at the end)\n// Order: Insert first, then Delete (as per original WinUI component)\nconst actionColumns = computed(() => {\n  const cols: GridColumn[] = []\n  const config = store.config\n\n  // Insert button first\n  if (config.showInsertButton) {\n    cols.push({\n      name: '__insertRow',\n      header: 'Insert',\n      width: 60,\n      minWidth: 50,\n      maxWidth: 80,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'InsertRow'\n    })\n  }\n\n  // Delete button second\n  if (config.showDeleteButton) {\n    cols.push({\n      name: '__deleteRow',\n      header: 'Delete',\n      width: 60,\n      minWidth: 50,\n      maxWidth: 80,\n      isVisible: true,\n      isReadOnly: true,\n      isSortable: false,\n      isFilterable: false,\n      specialType: 'DeleteRow'\n    })\n  }\n\n  return cols\n})\n\n// Combine columns in correct order:\n// 1. RowNumber, Checkbox (specialColumns)\n// 2. Data columns (only visible ones with visibleForGrid !== false)\n// 3. ValidationAlerts (validationColumn)\n// 4. Insert, Delete (actionColumns)\nconst allColumns = computed(() => [\n  ...specialColumns.value,\n  ...dataColumns.value.filter(col => !col.specialType && col.isVisible && col.visibleForGrid !== false), // Only visible non-special columns that are shown in grid\n  ...validationColumn.value,\n  ...actionColumns.value\n])\n\n// Generate CSS Grid template columns\n// Example: \"50px 150px 200px 1fr 50px\" for fixed and auto-width columns\nconst gridTemplateColumns = computed(() => {\n  const template = allColumns.value.map(col => {\n    if (col.autoWidth) {\n      return '1fr'  // Auto-width columns use fractional unit\n    }\n    return `${col.width}px`  // Fixed-width columns use pixels\n  }).join(' ')\n\n  // Debug: Log grid template and columns\n  console.log('[GridTemplate] All Columns:', allColumns.value.map(c => ({\n    name: c.name,\n    header: c.header,\n    width: c.width,\n    autoWidth: c.autoWidth,\n    specialType: c.specialType\n  })))\n  console.log('[GridTemplate] Generated Template:', template)\n\n  return template\n})\n\n// Watch for config changes from props\nwatch(() => props.config, (newConfig) => {\n  if (newConfig) {\n    store.setConfig(newConfig)\n  }\n}, { immediate: true, deep: true })\n\n// Watch for columns changes from props\nwatch(() => props.columns, (newColumns) => {\n  console.log('[DataGrid] Columns watch triggered:', {\n    hasColumns: newColumns?.length,\n    rowsLength: store.rows.length,\n    willInitialize: newColumns && newColumns.length > 0 && store.rows.length === 0\n  })\n\n  if (newColumns && newColumns.length > 0) {\n    try {\n      store.setColumns(newColumns)\n      console.log('[DataGrid] After setColumns, rowsLength:', store.rows.length)\n\n      // Initialize empty rows if store is empty\n      if (store.rows.length === 0) {\n        console.log('[DataGrid] Calling initializeEmptyRows...')\n        store.initializeEmptyRows()\n        console.log('[DataGrid] After initializeEmptyRows, rowsLength:', store.rows.length)\n      } else {\n        console.log('[DataGrid] SKIPPED initializeEmptyRows - rows already exist!')\n      }\n    } catch (error) {\n      console.error('[DataGrid] Failed to set columns:', error)\n      alert(`Column configuration error: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    }\n  }\n}, { immediate: true, deep: true })\n\n// Watch validation rules - trigger auto-validation when rules are added after data exists\n// FIXED: Watch ruleCount (reactive counter) instead of validationRules.value (Map.set doesn't trigger reactivity)\nwatch(() => validation?.ruleCount?.value ?? 0, async (newCount, oldCount) => {\n  const rulesSize = validation?.validationRules?.value?.size || 0\n\n  console.log('[WATCHER] Validation rules changed!', {\n    ruleCount: newCount,\n    oldCount,\n    hasRules: rulesSize > 0,\n    hasData: store.rows.length > 0,\n    autoValidateEnabled: store.config.autoValidate\n  })\n\n  // Only auto-validate if:\n  // 1. Rules exist\n  // 2. Data already exists\n  // 3. Auto-validation is enabled in config\n  if (rulesSize === 0 || store.rows.length === 0 || !store.config.autoValidate) {\n    console.log('[WATCHER] Skipping auto-validation:', {\n      noRules: rulesSize === 0,\n      noData: store.rows.length === 0,\n      autoValidateDisabled: !store.config.autoValidate\n    })\n    return\n  }\n\n  // SOLUTION 1C: Always trigger validation when rules exist and data exists\n  console.log('[WATCHER] Triggering auto-validation for all rows...')\n\n  // Clear validation tracking before re-validating with new rules\n  store.clearValidationTracking()\n\n  try {\n    // FIXED: Double nextTick to ensure UI is stable before validation\n    await nextTick()\n    console.log('[WATCHER] First nextTick done')\n    await nextTick()\n    console.log('[WATCHER] Second nextTick done')\n\n    await validateAllCellsInBatches()\n    console.log('[WATCHER]  Auto-validation completed after adding rules')\n  } catch (error) {\n    console.error('[WATCHER]  Error during auto-validation:', error)\n  }\n})\n\n//  RIEENIE #4: Deep watch REMOVED - validcia je explicitne volan v loadDataFromBackend() a v ruleCount watch\n\n// SOLUTION A: Watch errorCount ref from useValidation (reactive counter)\nwatch(() => validation?.errorCount?.value ?? 0, async (errorCount, oldErrorCount) => {\n  const newErrors = validation?.validationErrors\n\n  console.log('[WATCHER] Validation errors changed!', {\n    errorCount,\n    oldErrorCount,\n    hasErrors: errorCount > 0,\n    isAutoRowHeightEnabled: store.isAutoRowHeightEnabled,\n    validationErrorsKeys: newErrors ? Object.keys(newErrors) : []\n  })\n\n  // FIXED: ALWAYS update validationErrorCount, even when errorCount = 0\n  // This ensures stale values are cleared when errors are resolved\n  console.log('[WATCHER] Updating validationErrorCount for all rows...')\n  store.rows.forEach(row => {\n    // If no errors object or no errors for this row, set to 0\n    const count = (newErrors && newErrors[row.rowId]) ? newErrors[row.rowId].length : 0\n    row.validationErrorCount = count\n    if (count > 0 || row.validationErrorCount !== count) {\n      console.log('[WATCHER] Updated validationErrorCount:', { rowId: row.rowId, count })\n    }\n  })\n\n  // If no errors, we're done - no need to recalculate heights\n  if (!newErrors || errorCount === 0) {\n    console.log('[WATCHER] No validation errors, heights updated, done.')\n    return\n  }\n\n  // Wait for Vue to finish current render cycle\n  await nextTick()\n\n  if (store.isAutoRowHeightEnabled) {\n    // If AutoRowHeight is ON, recalculate with validation text included\n    console.log('[WATCHER] AutoRowHeight is ON, calling applyAutoRowHeightToAll...')\n    await applyAutoRowHeightToAll()\n    console.log('[WATCHER] applyAutoRowHeightToAll completed')\n  } else {\n    // If AutoRowHeight is OFF, reset all rows to default height\n    console.log('[WATCHER] AutoRowHeight is OFF, calling resetAllRowHeights...')\n    await resetAllRowHeights()\n    console.log('[WATCHER] resetAllRowHeights completed')\n  }\n})\n\nfunction handleSort(columnName: string, direction: 'asc' | 'desc') {\n  // Check if column exists and is sortable\n  const column = store.columns.find(c => c.name === columnName)\n  if (!column) {\n    console.error(`[handleSort] Column not found: ${columnName}`)\n    return\n  }\n\n  if (!column.isSortable) {\n    console.warn(`[handleSort] Column '${columnName}' is not sortable`)\n    return\n  }\n\n  // Check if column has visibleForGrid=false (should not be sorted)\n  if (column.visibleForGrid === false) {\n    console.warn(`[handleSort] Column '${columnName}' has visibleForGrid=false, sorting not allowed`)\n    return\n  }\n\n  store.addSort(columnName, direction, false)\n}\n\nfunction handleResize(columnName: string, newWidth: number) {\n  const col = store.columns.find(c => c.name === columnName)\n  if (col) {\n    col.width = newWidth\n  }\n}\n\nasync function handleCellEditComplete(rowId: string, columnName: string, value: any) {\n  console.log(`[DataGrid] handleCellEditComplete: rowId=${rowId}, columnName=${columnName}, newValue=${value}, autoValidate=${store.config.autoValidate}, autoRowHeight=${store.isAutoRowHeightEnabled}`)\n\n  store.updateCell(rowId, columnName, value)\n\n  // CRITICAL: Validate cell immediately after edit if auto-validate is enabled\n  if (store.config.autoValidate && store.config.enableValidation && validation) {\n    const row = store.rows.find(r => r.rowId === rowId)\n    const rowCells = row?.cells.map(c => ({ columnName: c.columnName, value: c.value }))\n    await validation.validateCellThrottled(rowId, columnName, value, rowCells)\n    const hasErrors = validation.validationErrors[rowId] && validation.validationErrors[rowId].length > 0\n    console.log('[DataGrid] Cell validated after edit:', { rowId, columnName, hasErrors })\n  }\n\n  // Recalculate row height if auto row height is enabled\n  if (store.isAutoRowHeightEnabled) {\n    console.log('[DataGrid] Recalculating row height:', { rowId })\n    await recalculateRowHeightAfterEdit(rowId)\n    await nextTick()\n  }\n  //  FIX: When AutoRowHeight is OFF, ALWAYS recalculate height based on current row values\n  // This handles both:\n  // 1. Adding newlines (Shift+Enter)  increases height\n  // 2. Cancel edit (ESC) with previous newlines  restores original height\n  else {\n    console.log('[DataGrid] Recalculating height for newlines (AutoRowHeight OFF):', { rowId })\n    await recalculateRowHeightForNewlines(rowId)\n  }\n}\n\nasync function handleCellInput(rowId: string, columnName: string, value: any) {\n  console.log('[handleCellInput] Called:', { rowId, columnName, value, autoRowHeightEnabled: store.isAutoRowHeightEnabled })\n\n  // Update cell value in store (needed for real-time validation and AutoRowHeight)\n  // cancelEdit() will restore original value if user cancels\n  store.updateCell(rowId, columnName, value)\n\n  // Recalculate row height in real-time if AutoRowHeight is enabled\n  if (store.isAutoRowHeightEnabled) {\n    await recalculateRowHeightAfterEdit(rowId)\n    await nextTick()\n  }\n  // Special case: if value contains newlines but AutoRowHeight is OFF, still recalculate\n  else if (value != null && String(value).includes('\\n')) {\n    await recalculateRowHeightForNewlines(rowId)\n  }\n}\n\nfunction handleCheckboxChange(rowId: string, checked: boolean) {\n  store.toggleCheckbox(rowId, checked)\n}\n\nfunction handleDeleteRow(rowId: string) {\n  store.deleteRow(rowId)\n}\n\nfunction handleInsertRow(afterRowId: string) {\n  store.insertRow(afterRowId)\n}\n\nfunction handleInsertAbove(rowId: string, count: number) {\n  store.insertMultipleRows(rowId, count, 'above')\n}\n\nfunction handleInsertBelow(rowId: string, count: number) {\n  store.insertMultipleRows(rowId, count, 'below')\n}\n\n// Hidden columns management\nconst hiddenColumns = computed(() => {\n  return dataColumns.value.filter(col => !col.isVisible && !col.specialType && col.visibleForGrid !== false)\n})\n\nfunction handleHideColumn(columnName: string) {\n  const col = dataColumns.value.find(c => c.name === columnName)\n  if (col && !col.specialType) {\n    col.isVisible = false\n    console.log(`Hidden column: ${columnName}`)\n  }\n}\n\nfunction showColumn(columnName: string) {\n  const col = dataColumns.value.find(c => c.name === columnName)\n  if (col) {\n    col.isVisible = true\n    console.log(`Shown column: ${columnName}`)\n  }\n}\n\nfunction showAllColumns() {\n  dataColumns.value.forEach(col => {\n    if (!col.specialType) {\n      col.isVisible = true\n    }\n  })\n  console.log('Shown all columns')\n}\n\nfunction handleAutoFitColumn(columnName: string) {\n  const col = dataColumns.value.find(c => c.name === columnName)\n  if (!col) return\n\n  // Create a temporary canvas to measure text width\n  const canvas = document.createElement('canvas')\n  const context = canvas.getContext('2d')\n  if (!context) return\n\n  // Set font to match grid cell font\n  context.font = '14px system-ui, -apple-system, sans-serif'\n\n  let maxWidth = 0\n\n  // Measure header text\n  const headerWidth = context.measureText(col.header).width\n  maxWidth = Math.max(maxWidth, headerWidth + 40) // Add padding for sort icon, etc.\n\n  // Measure all cell values in this column\n  store.rows.forEach(row => {\n    const cell = row.cells.find(c => c.columnName === columnName)\n    const value = cell?.value\n    const textValue = value?.toString() ?? ''\n    if (textValue) {\n      const textWidth = context.measureText(textValue).width\n      maxWidth = Math.max(maxWidth, textWidth + 24) // Add padding for cell content\n    }\n  })\n\n  // Apply constraints (min/max width)\n  const newWidth = Math.max(\n    col.minWidth,\n    Math.min(col.maxWidth, Math.ceil(maxWidth))\n  )\n\n  col.width = newWidth\n  console.log(`Auto-fit column ${columnName}: ${newWidth}px (measured: ${Math.ceil(maxWidth)}px)`)\n}\n\n// Filter Flyout state\nconst filterFlyout = ref<{\n  visible: boolean\n  columnName: string\n  position: { x: number; y: number }\n  uniqueValues: FilterValue[]\n  mode: 'checkbox' | 'regex'\n  pattern: string\n}>({\n  visible: false,\n  columnName: '',\n  position: { x: 0, y: 0 },\n  uniqueValues: [],\n  mode: 'checkbox',\n  pattern: ''\n})\n\n//  HELPER: Extract all filters EXCEPT filters for specific column\nfunction extractFiltersExceptColumn(filter: FilterExpression | null | undefined, excludeColumnName: string): FilterExpression | null {\n  //  FIX: Handle undefined filter expression (early initialization)\n  if (filter === null || filter === undefined) return null\n\n  if (filter.type === 'simple') {\n    const simpleFilter = filter as SimpleFilter\n    // If this filter is for the excluded column, remove it\n    return simpleFilter.columnName === excludeColumnName ? null : filter\n  }\n\n  // Composite filter - recursively process left and right\n  const compositeFilter = filter as CompositeFilter\n\n  //  FIX: Defensive check for null/undefined children\n  if (!compositeFilter.left || !compositeFilter.right) {\n    console.error('[extractFiltersExceptColumn] Invalid composite filter - missing children:', compositeFilter)\n    return null\n  }\n\n  const leftFiltered = extractFiltersExceptColumn(compositeFilter.left, excludeColumnName)\n  const rightFiltered = extractFiltersExceptColumn(compositeFilter.right, excludeColumnName)\n\n  // Rebuild composite filter\n  if (!leftFiltered && !rightFiltered) return null\n  if (!leftFiltered) return rightFiltered\n  if (!rightFiltered) return leftFiltered\n\n  return {\n    type: 'composite',\n    left: leftFiltered,\n    right: rightFiltered,\n    operator: compositeFilter.operator\n  } as CompositeFilter\n}\n\n//  HELPER: Extract currently selected values for a column from filter expression\nfunction extractSelectedValuesForColumn(filter: FilterExpression | null | undefined, columnName: string): Set<string> {\n  const selectedValues = new Set<string>()\n\n  //  FIX: Handle undefined filter expression (early initialization)\n  if (filter === null || filter === undefined) return selectedValues\n\n  function traverse(expr: FilterExpression) {\n    if (expr.type === 'simple') {\n      const simpleFilter = expr as SimpleFilter\n      if (simpleFilter.columnName === columnName && simpleFilter.operator === 'Equals') {\n        selectedValues.add(String(simpleFilter.value))\n      }\n    } else {\n      const compositeFilter = expr as CompositeFilter\n      //  FIX: Prechdzaj VETKY vetvy (AND aj OR)\n      // Pre checkbox filter: hodnoty pre jeden stpec s spojen OR\n      // Rzne stpce s spojen AND\n      // Musme prejs cez AND, aby sme nali OR vetvy pre n stpec\n      traverse(compositeFilter.left)\n      traverse(compositeFilter.right)\n    }\n  }\n\n  traverse(filter)\n  return selectedValues\n}\n\n// Get unique values for a column with counts\n//  VARIANTA 3 FIX: Shows ALL unique values (with filters applied EXCEPT filter for this column)\n// REASON: User should see all possible values, not just currently filtered ones\n// EXAMPLE: If \"Status\" filtered to [\"Active\"], flyout should show [Active, Pending, Completed], not just [Active]\nfunction getUniqueValues(columnName: string): FilterValue[] {\n  try {\n    //  FIX: Wrap in try-catch for error handling and debugging\n    console.log(`[getUniqueValues] Starting for column: ${columnName}`)\n\n    //  FIX: Early return if store or rows are not initialized\n    if (!store || !store.rows) {\n      console.warn(`[getUniqueValues] Store or rows not initialized yet, returning empty array`)\n      return []\n    }\n\n    //  FIX: Special handling for Checkbox column\n    if (columnName === '__checkbox') {\n      // Checkbox column - return true/false options\n      // Apply filters from other columns to count correctly\n      const filtersExceptThisColumn = extractFiltersExceptColumn(store.filterExpression, columnName)\n      console.log(`[getUniqueValues] Checkbox - Has filters to apply: ${!!filtersExceptThisColumn}`)\n\n      const allRows = store.rows\n      console.log(`[getUniqueValues] Checkbox - Total rows before filtering: ${allRows.length}`)\n\n      //  FIX: Pass store to filterRowsHelper so it can access checkbox state\n      const filteredRows = filtersExceptThisColumn ? filterRowsHelper(allRows, filtersExceptThisColumn, store) : allRows\n      console.log(`[getUniqueValues] Checkbox - Total rows after filtering: ${filteredRows.length}`)\n\n      //  DEBUG: Log first few rows to see checkbox values\n      const sampleSize = Math.min(3, filteredRows.length)\n      for (let i = 0; i < sampleSize; i++) {\n        const cell = filteredRows[i].cells.find(c => c.columnName === '__checkbox')\n        console.log(`[getUniqueValues] Checkbox - Row ${i}: cell=${!!cell}, value=${cell?.value}, type=${typeof cell?.value}`)\n      }\n\n      const trueCount = filteredRows.filter(row => {\n        //  FIX: Checkbox state je v store.checkedRows, NIE v row.cells\n        return store.isRowChecked(row.rowId)\n      }).length\n\n      const falseCount = filteredRows.length - trueCount\n\n      const currentlySelectedValues = extractSelectedValuesForColumn(store.filterExpression, columnName)\n\n      console.log(`[getUniqueValues] Checkbox column: true=${trueCount}, false=${falseCount}, selected=${Array.from(currentlySelectedValues)}`)\n\n      return [\n        {\n          value: 'true',\n          isSelected: currentlySelectedValues.has('true'),\n          count: trueCount,\n          displayText: ` Checked (${trueCount})`\n        },\n        {\n          value: 'false',\n          isSelected: currentlySelectedValues.has('false'),\n          count: falseCount,\n          displayText: ` Unchecked (${falseCount})`\n        }\n      ]\n    }\n\n    //  Normal columns processing\n    const valueMap = new Map<string, number>()\n\n    //  VARIANTA 3 FIX: Extract filters EXCEPT filter for this column\n    const filtersExceptThisColumn = extractFiltersExceptColumn(store.filterExpression, columnName)\n    console.log(`[getUniqueValues] Has filters to apply for '${columnName}': ${!!filtersExceptThisColumn}`)\n\n    //  VARIANTA 3 FIX: Load ALL rows (without any filtering)\n    const allRows = store.rows\n\n    //  VARIANTA 3 FIX: Apply filters manually (all EXCEPT this column's filter)\n    //  FIX: Pass store to filterRowsHelper so it can access checkbox state\n    const filteredRows = filtersExceptThisColumn ? filterRowsHelper(allRows, filtersExceptThisColumn, store) : allRows\n\n    console.log(`[getUniqueValues] Column=${columnName}, AllRows=${allRows.length}, FilteredRows=${filteredRows.length}`)\n\n    // Extract unique values from filtered rows\n    filteredRows.forEach(row => {\n      const cell = row.cells.find(c => c.columnName === columnName)\n      const value = cell?.value?.toString() ?? ''\n      valueMap.set(value, (valueMap.get(value) || 0) + 1)\n    })\n\n    // Get currently selected values for this column (to mark checkboxes as checked)\n    const currentlySelectedValues = extractSelectedValuesForColumn(store.filterExpression, columnName)\n\n    console.log(`[getUniqueValues] Column=${columnName}, UniqueValues=${valueMap.size}, SelectedValues=${currentlySelectedValues.size}`)\n\n    const result = Array.from(valueMap.entries())\n      .map(([value, count]) => {\n        // Display empty values as \"(Empty)\"\n        const displayValue = value === '' ? '(Empty)' : value\n        return {\n          value,\n          isSelected: currentlySelectedValues.has(value), //  Mark checkbox based on current filter\n          count,\n          displayText: `${displayValue} (${count})`\n        }\n      })\n      .sort((a, b) => {\n        // Sort empty values to bottom\n        if (a.value === '' && b.value !== '') return 1\n        if (a.value !== '' && b.value === '') return -1\n        return a.value.localeCompare(b.value)\n      })\n\n    console.log(`[getUniqueValues] Returning ${result.length} unique values`)\n    return result\n  } catch (error) {\n    console.error(`[getUniqueValues] ERROR for column '${columnName}':`, error)\n    console.error(`[getUniqueValues] Filter expression at time of error:`, store.filterExpression)\n    console.error(`[getUniqueValues] Stack trace:`, error instanceof Error ? error.stack : 'No stack trace')\n    // Return empty array to prevent UI crash\n    return []\n  }\n}\n\nfunction handleShowFilter(columnName: string) {\n  try {\n    console.log(`[handleShowFilter] START for column: ${columnName}`)\n\n    //  Check if grid is ready\n    if (!isGridReady.value) {\n      console.error(`[handleShowFilter] Grid not ready yet`)\n      alert('Please wait for the grid to finish loading before opening filters.')\n      return\n    }\n\n    //  Check if processing (validation/AutoRowHeight)\n    if (isProcessing.value) {\n      console.error(`[handleShowFilter] Grid is currently processing data`)\n      alert('Please wait while data is being processed...')\n      return\n    }\n\n    //  Check if column exists and is filterable\n    const column = dataColumns.value.find(c => c.name === columnName)\n    if (!column) {\n      console.error(`[handleShowFilter] Column not found: ${columnName}`)\n      return\n    }\n\n    if (!column.isFilterable) {\n      console.warn(`[handleShowFilter] Column '${columnName}' is not filterable`)\n      return\n    }\n\n    //  Check if column has visibleForGrid=false (should not be filtered)\n    if (column.visibleForGrid === false) {\n      console.warn(`[handleShowFilter] Column '${columnName}' has visibleForGrid=false, filtering not allowed`)\n      return\n    }\n\n    //  Check if store is initialized\n    if (!store || !store.rows || store.rows.length === 0) {\n      console.error(`[handleShowFilter] Store not initialized or no data`)\n      alert('Please load data before opening filters.')\n      return\n    }\n\n    // Get unique values for the column\n    const uniqueValues = getUniqueValues(columnName)\n    console.log(`[handleShowFilter] Got ${uniqueValues.length} unique values`)\n\n    // Calculate position (centered on screen for now)\n    const position = {\n      x: window.innerWidth / 2 - 200, // 200 is roughly half the flyout width\n      y: window.innerHeight / 2 - 300 // 300 is roughly half the flyout height\n    }\n\n    filterFlyout.value = {\n      visible: true,\n      columnName,\n      position,\n      uniqueValues,\n      mode: 'checkbox',\n      pattern: ''\n    }\n\n    console.log(`[handleShowFilter] Filter flyout opened successfully`)\n  } catch (error) {\n    console.error(`[handleShowFilter] CRITICAL ERROR for column '${columnName}':`, error)\n    console.error(`[handleShowFilter] Stack trace:`, error instanceof Error ? error.stack : 'No stack trace')\n    alert(`Error opening filter for column '${columnName}': ${error instanceof Error ? error.message : String(error)}`)\n  }\n}\n\nfunction closeFilterFlyout() {\n  filterFlyout.value.visible = false\n}\n\n// Helper: Extract filters grouped by column from a filter expression tree\n// Returns a Map where key is columnName and value is the filter expression for that column\nfunction extractColumnFilters(filter: FilterExpression | null): Map<string, FilterExpression> {\n  const columnFilters = new Map<string, FilterExpression>()\n\n  function traverse(expr: FilterExpression, isAndContext: boolean): string | null {\n    if (expr.type === 'simple') {\n      const simple = expr as SimpleFilter\n      // In AND context at top level, this is a separate column filter\n      if (isAndContext) {\n        columnFilters.set(simple.columnName, expr)\n      }\n      return simple.columnName\n    } else {\n      const composite = expr as CompositeFilter\n\n      if (composite.operator === 'AND') {\n        // AND operator separates different columns\n        traverse(composite.left, true)\n        traverse(composite.right, true)\n        return null\n      } else {\n        // OR operator keeps same column together\n        const leftCol: string | null = traverse(composite.left, false)\n        const rightCol: string | null = traverse(composite.right, false)\n\n        // Both sides should be same column in OR\n        const columnName: string | null = leftCol || rightCol\n        if (columnName && isAndContext) {\n          columnFilters.set(columnName, expr)\n        }\n        return columnName\n      }\n    }\n  }\n\n  if (filter) {\n    traverse(filter, true)\n  }\n\n  return columnFilters\n}\n\n// Helper: Combine multiple filters with AND operator\nfunction combineFiltersWithAnd(filters: FilterExpression[]): FilterExpression | null {\n  //  FIX: Filter out null/undefined values to prevent corrupted filter structures\n  const validFilters = filters.filter(f => f != null)\n\n  if (validFilters.length === 0) return null\n  if (validFilters.length === 1) return validFilters[0]\n\n  let result = validFilters[0]\n  for (let i = 1; i < validFilters.length; i++) {\n    result = {\n      type: 'composite',\n      left: result,\n      right: validFilters[i],\n      operator: 'AND'\n    } as CompositeFilter\n  }\n\n  return result\n}\n\n// Helper: Combine a new filter with existing filters (per-column replacement + cumulative)\nfunction combineWithExistingFilters(newColumnFilter: FilterExpression, columnName: string): FilterExpression {\n  // Get current filter expression\n  const currentFilter = store.filterExpression\n\n  // Extract filters grouped by column\n  const columnFilters = extractColumnFilters(currentFilter)\n\n  // Replace or add the filter for this column\n  columnFilters.set(columnName, newColumnFilter)\n\n  // Combine all column filters with AND\n  const allFilters = Array.from(columnFilters.values())\n  return combineFiltersWithAnd(allFilters) || newColumnFilter\n}\n\nfunction handleApplyCheckboxFilter(selectedValues: string[]) {\n  const columnName = filterFlyout.value.columnName\n\n  if (selectedValues.length === 0) {\n    // No values selected = remove filter for this column only\n    const columnFilters = extractColumnFilters(store.filterExpression)\n    columnFilters.delete(columnName)\n\n    if (columnFilters.size === 0) {\n      store.clearFilter()\n    } else {\n      const allFilters = Array.from(columnFilters.values())\n      const combinedFilter = combineFiltersWithAnd(allFilters)\n      store.setFilter(combinedFilter)\n    }\n  } else {\n    //  FIX: Convert string values to boolean for Checkbox column\n    const filterValues = columnName === '__checkbox'\n      ? selectedValues.map(v => v === 'true')\n      : selectedValues\n\n    // Build new filter for this column\n    let newColumnFilter: FilterExpression\n\n    if (filterValues.length === 1) {\n      // Single value - use simple filter\n      newColumnFilter = {\n        type: 'simple',\n        columnName,\n        operator: 'Equals',\n        value: filterValues[0]\n      } as SimpleFilter\n    } else {\n      // Multiple values - build composite OR filter\n      newColumnFilter = {\n        type: 'simple',\n        columnName,\n        operator: 'Equals',\n        value: filterValues[0]\n      } as SimpleFilter\n\n      for (let i = 1; i < filterValues.length; i++) {\n        newColumnFilter = {\n          type: 'composite',\n          left: newColumnFilter,\n          right: {\n            type: 'simple',\n            columnName,\n            operator: 'Equals',\n            value: filterValues[i]\n          } as SimpleFilter,\n          operator: 'OR'\n        } as CompositeFilter\n      }\n    }\n\n    // Combine with existing filters from other columns\n    const combinedFilter = combineWithExistingFilters(newColumnFilter, columnName)\n    store.setFilter(combinedFilter)\n  }\n\n  console.log(`Applied checkbox filter to ${columnName}:`, selectedValues, 'Final filter:', store.filterExpression)\n}\n\nfunction handleApplyRegexFilter(pattern: string) {\n  const columnName = filterFlyout.value.columnName\n\n  if (!pattern) {\n    // Empty pattern = remove filter for this column only\n    const columnFilters = extractColumnFilters(store.filterExpression)\n    columnFilters.delete(columnName)\n\n    if (columnFilters.size === 0) {\n      store.clearFilter()\n    } else {\n      const allFilters = Array.from(columnFilters.values())\n      const combinedFilter = combineFiltersWithAnd(allFilters)\n      store.setFilter(combinedFilter)\n    }\n    return\n  }\n\n  // Note: Full regex support is not available in the declarative filter system\n  // Using 'Contains' operator as a simplified pattern match\n  // For more complex patterns, a custom filter operator would need to be added\n  const newColumnFilter: SimpleFilter = {\n    type: 'simple',\n    columnName,\n    operator: 'Contains',\n    value: pattern\n  }\n\n  // Combine with existing filters from other columns\n  const combinedFilter = combineWithExistingFilters(newColumnFilter, columnName)\n  store.setFilter(combinedFilter)\n\n  console.log(`Applied text contains filter to ${columnName}:`, pattern, 'Final filter:', store.filterExpression)\n}\n\nfunction handleClearFilter() {\n  const columnName = filterFlyout.value.columnName\n\n  // Remove filter for this column only\n  const columnFilters = extractColumnFilters(store.filterExpression)\n  columnFilters.delete(columnName)\n\n  if (columnFilters.size === 0) {\n    store.clearFilter()\n  } else {\n    const allFilters = Array.from(columnFilters.values())\n    const combinedFilter = combineFiltersWithAnd(allFilters)\n    store.setFilter(combinedFilter)\n  }\n\n  console.log(`Cleared filter for ${columnName}`, 'Final filter:', store.filterExpression)\n}\n\n// Auto Row Height handlers\nasync function toggleAutoRowHeight() {\n  try {\n    console.log('[toggleAutoRowHeight] ========== FUNCTION CALLED ==========')\n    console.log(`[toggleAutoRowHeight] Current state: ${store.isAutoRowHeightEnabled}`)\n    console.log('[toggleAutoRowHeight] Rows BEFORE:', store.rows.slice(0, 5).map(r => ({ id: r.rowId, height: r.height })))\n\n    const newValue = !store.isAutoRowHeightEnabled\n    console.log(`[toggleAutoRowHeight] New state will be: ${newValue}`)\n\n    store.setAutoRowHeightEnabled(newValue)\n    console.log('[toggleAutoRowHeight] Store updated')\n\n    if (newValue) {\n      // Apply heights immediately to all existing rows\n      console.log('[toggleAutoRowHeight] Enabled - applying heights to all rows...')\n      await applyAutoRowHeightToAll()\n      console.log('[toggleAutoRowHeight] Heights applied successfully')\n    } else {\n      // Reset all rows to default height when disabling\n      console.log('[toggleAutoRowHeight] Disabled - resetting all row heights...')\n      await resetAllRowHeights()\n      console.log('[toggleAutoRowHeight] Heights reset successfully')\n    }\n\n    console.log('[toggleAutoRowHeight] Rows AFTER:', store.rows.slice(0, 5).map(r => ({ id: r.rowId, height: r.height })))\n    console.log('[toggleAutoRowHeight] ========== FUNCTION COMPLETED ==========')\n  } catch (error) {\n    console.log(`[toggleAutoRowHeight]  ERROR: ${error}`)\n    console.log(`[toggleAutoRowHeight] Error stack: ${error instanceof Error ? error.stack : 'N/A'}`)\n  }\n}\n\nasync function applyAutoRowHeightToAll() {\n  // Pass ALL columns but skip ValidationAlerts to avoid inflated heights\n  // ValidationAlerts uses ellipsis, doesn't need measurement\n  const columnsForMeasurement = allColumns.value\n    .filter(col => !col.specialType || col.specialType !== 'ValidationAlerts')\n    .map(col => ({\n      name: col.name,\n      width: col.width,\n      specialType: col.specialType\n    }))\n\n  console.log('[applyAutoRowHeightToAll] ========== START ==========')\n  console.log('[applyAutoRowHeightToAll] AutoRowHeight is ON')\n\n  // Log ALL row heights BEFORE changes\n  const heightsBefore = store.rows.map(r => ({ rowId: r.rowId, heightBefore: r.height }))\n  console.log('[applyAutoRowHeightToAll] BEFORE - All row heights:', heightsBefore.slice(0, 10))\n\n  console.log('[applyAutoRowHeightToAll] Measuring columns:', columnsForMeasurement.map(c => `${c.name} (${c.width}px, special: ${c.specialType || 'none'})`).join(', '))\n\n  const result = await autoRowHeight.applyAutoRowHeight(store.rows, columnsForMeasurement)\n\n  // Log ALL row heights AFTER changes and compare\n  const heightsAfter = store.rows.map((r, i) => ({\n    rowId: r.rowId,\n    heightBefore: heightsBefore[i].heightBefore,\n    heightAfter: r.height,\n    changed: heightsBefore[i].heightBefore !== r.height\n  }))\n\n  console.log('[applyAutoRowHeightToAll] AFTER - All row heights (first 10):', heightsAfter.slice(0, 10))\n  console.log('[applyAutoRowHeightToAll] Changed rows:', heightsAfter.filter(h => h.changed).length)\n  console.log(`[applyAutoRowHeightToAll] Summary: ${result.totalRowsUpdated} rows updated, average height: ${result.averageHeight.toFixed(1)}px`)\n\n  // CRITICAL: Wait for Vue to update DOM before forcing scroller update\n  await nextTick()\n  console.log('[applyAutoRowHeightToAll] First nextTick complete')\n\n  // Double nextTick to ensure all reactive updates complete\n  await nextTick()\n  console.log('[applyAutoRowHeightToAll] Second nextTick complete')\n\n  // Triple nextTick for good measure\n  await nextTick()\n  console.log('[applyAutoRowHeightToAll] Third nextTick complete')\n\n  // Small delay to ensure DynamicScroller has processed all changes\n  await new Promise(resolve => setTimeout(resolve, 50))\n  console.log('[applyAutoRowHeightToAll] Delay complete, calling forceUpdate...')\n\n  // Then force DynamicScroller to recalculate sizes\n  if (scrollerRef.value) {\n    scrollerRef.value.forceUpdate()\n    console.log('[applyAutoRowHeightToAll] DynamicScroller forceUpdate() called')\n  } else {\n    console.log('[applyAutoRowHeightToAll] ERROR: scrollerRef is null, cannot forceUpdate')\n  }\n\n  console.log('[applyAutoRowHeightToAll] ========== COMPLETE ==========')\n}\n\nasync function resetAllRowHeights() {\n  console.log('[resetAllRowHeights] START - AutoRowHeight is OFF, resetting to default height')\n\n  // When AutoRowHeight is OFF, reset ALL rows to default height\n  // Do NOT calculate heights based on validation text - that only happens when AutoRowHeight is ON\n  let rowsProcessed = 0\n  const defaultHeight = 32\n\n  store.rows.forEach((row) => {\n    row.height = defaultHeight\n    rowsProcessed++\n  })\n\n  console.log('[resetAllRowHeights] Summary:', {\n    totalRows: rowsProcessed,\n    resetToHeight: defaultHeight\n  })\n\n  console.log('[resetAllRowHeights] All row heights reset to default')\n\n  // CRITICAL: Wait for Vue to update DOM before forcing scroller update\n  await nextTick()\n  console.log('[resetAllRowHeights] First nextTick complete')\n\n  // Double nextTick to ensure all reactive updates complete\n  await nextTick()\n  console.log('[resetAllRowHeights] Second nextTick complete')\n\n  // Triple nextTick for good measure\n  await nextTick()\n  console.log('[resetAllRowHeights] Third nextTick complete')\n\n  // Small delay to ensure DynamicScroller has processed all changes\n  await new Promise(resolve => setTimeout(resolve, 50))\n  console.log('[resetAllRowHeights] Delay complete, calling forceUpdate...')\n\n  // Then force DynamicScroller to recalculate sizes\n  if (scrollerRef.value) {\n    scrollerRef.value.forceUpdate()\n    console.log('[resetAllRowHeights] DynamicScroller forceUpdate() called')\n  } else {\n    console.log('[resetAllRowHeights] ERROR: scrollerRef is null, cannot forceUpdate')\n  }\n\n  console.log('[resetAllRowHeights] COMPLETE')\n}\n\nasync function recalculateRowHeightAfterEdit(rowId: string) {\n  if (!store.isAutoRowHeightEnabled) return\n\n  // Skip ValidationAlerts column from measurement - validation messages use ellipsis\n  const columnsForMeasurement = allColumns.value\n    .filter(col => !col.specialType || col.specialType !== 'ValidationAlerts')\n    .map(col => ({\n      name: col.name,\n      width: col.width,\n      specialType: col.specialType\n    }))\n\n  const row = store.rows.find(r => r.rowId === rowId)\n  if (!row) return\n\n  const updatedCount = autoRowHeight.recalculateRows(store.rows, [rowId], columnsForMeasurement)\n\n  if (updatedCount > 0 && row) {\n    // CRITICAL: Force Vue reactivity by reassigning through store\n    store.updateRowHeight(rowId, row.height)\n\n    await nextTick()\n  }\n}\n\n/**\n * Calculates row height based on newlines when AutoRowHeight is OFF\n * Only counts explicit newlines (\\n), doesn't wrap by spaces\n */\nasync function recalculateRowHeightForNewlines(rowId: string) {\n  const row = store.rows.find(r => r.rowId === rowId)\n  if (!row) return\n\n  let maxLines = 1\n\n  // Check all data cells for newlines\n  for (const cell of row.cells) {\n    if (cell.value == null) continue\n\n    const textValue = String(cell.value)\n    if (textValue.includes('\\n')) {\n      // Count lines (split by \\n)\n      const lines = textValue.split('\\n').length\n      maxLines = Math.max(maxLines, lines)\n    }\n  }\n\n  // Calculate height: lineHeight (21px) * lines + vertical padding (10px)\n  const lineHeight = 21  // 14px font-size * 1.5 line-height\n  const verticalPadding = 10  // 5px top + 5px bottom\n  const calculatedHeight = maxLines * lineHeight + verticalPadding\n\n  // Update row height\n  store.updateRowHeight(rowId, calculatedHeight)\n  await nextTick()\n}\n\n// Backend API handlers\nasync function checkBackendConnection() {\n  logger.debug(' Checking backend connection...')\n\n  try {\n    isBackendConnected.value = await gridApi.healthCheck()\n\n    if (isBackendConnected.value) {\n      logger.info(' Backend connected')\n    } else {\n      logger.warn(' Backend disconnected')\n    }\n  } catch (error: any) {\n    logger.error(' Backend connection check failed', {\n      error: error?.message || error?.toString() || 'Unknown error',\n      stack: error?.stack\n    })\n    isBackendConnected.value = false\n  }\n}\n\n//  RIEENIE #6: Original function (to be wrapped with debounce)\nasync function loadDataFromBackendOriginal() {\n  console.log('[loadDataFromBackend]  START')\n\n  //  RIEENIE #7: Guard - prevent concurrent data loads\n  if (isProcessing.value) {\n    console.log('[loadDataFromBackend]  Already processing, skipping')\n    return\n  }\n\n  isLoadingFromBackend.value = true\n  isProcessing.value = true\n\n  try {\n    console.log('[loadDataFromBackend] Calling gridApi.getData()...')\n    const response = await gridApi.getData()\n    console.log('[loadDataFromBackend] Response received:', {\n      success: response.success,\n      dataLength: response.data?.length,\n      hasError: !!response.error\n    })\n\n    if (response.success && response.data) {\n      console.log('[loadDataFromBackend] Converting data format...')\n      // Convert backend data format to store format\n      // Backend returns: { RowId, RowHeight, Checkbox, Data: { name, email, ... } }\n      // Store expects: { __rowId, __rowHeight, __checkbox, name, email, ... }\n      const rows = response.data.map((row, index) => ({\n        __rowId: row.RowId || `row-${Date.now()}-${index}`,\n        __rowHeight: row.RowHeight || 40,\n        __checkbox: row.Checkbox,\n        ...row.Data  // Spread Data dictionary to root level\n      }))\n      console.log('[loadDataFromBackend] Converted rows:', rows.length)\n\n      // Clear validation tracking before loading new data (bulk load)\n      console.log('[loadDataFromBackend] Calling clearValidationTracking()...')\n      store.clearValidationTracking()\n\n      console.log('[loadDataFromBackend] Calling store.loadRows()...')\n      store.loadRows(rows)\n      console.log(`[loadDataFromBackend]  Loaded ${rows.length} rows from backend`)\n\n      //  RIEENIE #4B: Explicit validation call after data load (replaces deep watch on rows)\n      // Validate all cells after loading data if auto-validation is enabled\n      if (store.config.autoValidate && store.config.enableValidation) {\n        const rulesCount = validation?.validationRules?.value?.size || 0\n        console.log('[loadDataFromBackend] Auto-validation check:', {\n          autoValidate: store.config.autoValidate,\n          enableValidation: store.config.enableValidation,\n          rulesCount\n        })\n\n        if (rulesCount > 0) {\n          console.log('[loadDataFromBackend] Starting auto-validation...')\n\n          //  RIEENIE #4B: Wait for DOM to stabilize before validating\n          await nextTick()\n          console.log('[loadDataFromBackend] First nextTick done - rows mounted')\n          await nextTick()\n          console.log('[loadDataFromBackend] Second nextTick done - scroller ready')\n\n          //  RIEENIE #4B: Additional small delay for stability\n          await new Promise(resolve => setTimeout(resolve, 50))\n          console.log('[loadDataFromBackend] Delay done - starting validation')\n\n          await validateAllCellsInBatches()\n          console.log('[loadDataFromBackend]  Auto-validation complete')\n        } else {\n          console.log('[loadDataFromBackend]  Skipping validation - no rules defined yet')\n        }\n      } else {\n        console.log('[loadDataFromBackend]  Auto-validation disabled in config')\n      }\n    } else {\n      console.error('[loadDataFromBackend]  Failed to load data:', response.error)\n      alert(`Failed to load data: ${response.error}`)\n    }\n  } catch (error) {\n    console.error('[loadDataFromBackend]  EXCEPTION:', error)\n    alert(`Error loading data: ${error instanceof Error ? error.message : 'Unknown error'}`)\n  } finally {\n    isLoadingFromBackend.value = false\n    isProcessing.value = false\n    console.log('[loadDataFromBackend]  END')\n  }\n}\n\n//  RIEENIE #6: Debounced wrapper (1 second debounce, max 2 seconds wait)\nconst loadDataFromBackend = useDebounceFn(loadDataFromBackendOriginal, 1000, {\n  maxWait: 2000\n})\n\nasync function saveDataToBackend() {\n  isSavingToBackend.value = true\n\n  try {\n    // Extract data columns only\n    const data = store.rows.map(row => {\n      const rowData: Record<string, any> = {}\n\n      dataColumns.value.forEach(col => {\n        if (!col.specialType) {\n          const cell = row.cells.find(c => c.columnName === col.name)\n          if (cell) {\n            rowData[col.name] = cell.value\n          }\n        }\n      })\n\n      return rowData\n    })\n\n    const response = await gridApi.importData(data)\n\n    if (response.success) {\n      console.log(`Saved ${data.length} rows to backend`)\n    } else {\n      console.error('Failed to save data to backend:', response.error)\n      alert(`Failed to save data: ${response.error}`)\n    }\n  } catch (error) {\n    console.error('Error saving data to backend:', error)\n    alert(`Error saving data: ${error instanceof Error ? error.message : 'Unknown error'}`)\n  } finally {\n    isSavingToBackend.value = false\n  }\n}\n\n// Import/Export handlers\n// async function handleExportToJson() {\n//   const rows = store.rows.map(row => {\n//     const rowData: Record<string, any> = {}\n\n//     // Extract data columns only (exclude special columns)\n//     dataColumns.value.forEach(col => {\n//       if (!col.specialType) {\n//         const cell = row.cells.find(c => c.columnName === col.name)\n//         if (cell) {\n//           rowData[col.name] = cell.value\n//         }\n//       }\n//     })\n\n//     return rowData\n//   })\n\n//   const columnNames = getDataColumnNames()\n//   const result = importExport.exportToJson(rows, columnNames, {\n//     prettify: true,\n//     includeHiddenColumns: false,\n//     includeSpecialComponents: false\n//   })\n\n//   console.log(result.message)\n// }\n\nasync function handleImportFromJson(mode: ImportMode = ImportMode.Append) {\n  const currentRows = store.rows.map(row => {\n    const rowData: Record<string, any> = { __rowId: row.rowId, __rowIndex: row.rowIndex }\n\n    row.cells.forEach(cell => {\n      rowData[cell.columnName] = cell.value\n    })\n\n    return rowData\n  })\n\n  const columnNames = getDataColumnNames()\n  const result = await importExport.openImportDialog(currentRows, columnNames, {\n    mode,\n    validateSchema: true\n  })\n\n  if (result.success && result.rows) {\n    console.log(result.message)\n\n    // Load the imported rows into the store\n    store.loadRows(result.rows)\n\n    console.log(`Successfully imported ${result.rowsImported} rows into grid`)\n  } else {\n    console.error('Import failed:', result.errors)\n    alert(`Import failed: ${result.message}\\n${result.errors.join('\\n')}`)\n  }\n}\n\n// Merge theme with defaults\nconst mergedTheme = computed(() => {\n  return {\n    ...defaultDataGridTheme,\n    cellColors: { ...defaultDataGridTheme.cellColors, ...(props.theme?.cellColors || {}) },\n    rowColors: { ...defaultDataGridTheme.rowColors, ...(props.theme?.rowColors || {}) },\n    headerColors: { ...defaultDataGridTheme.headerColors, ...(props.theme?.headerColors || {}) },\n    validationColors: { ...defaultDataGridTheme.validationColors, ...(props.theme?.validationColors || {}) },\n    selectionColors: { ...defaultDataGridTheme.selectionColors, ...(props.theme?.selectionColors || {}) },\n    borderColors: { ...defaultDataGridTheme.borderColors, ...(props.theme?.borderColors || {}) },\n    specialColumnColors: { ...defaultDataGridTheme.specialColumnColors, ...(props.theme?.specialColumnColors || {}) },\n    uiControlColors: { ...defaultDataGridTheme.uiControlColors, ...(props.theme?.uiControlColors || {}) }\n  }\n})\n\n// Generate CSS variables from theme and add minTableWidth, width, height\nconst cssVariables = computed(() => {\n  const themeVars = generateDataGridCSSVariables(mergedTheme.value)\n  return {\n    ...themeVars,\n    '--dg-min-table-width': props.minTableWidth ? `${props.minTableWidth}px` : 'fit-content',\n    width: props.width || '100%',\n    height: props.height || '600px'\n  }\n})\n\n// Enhanced validation API with tracking and auto-validate support\nconst enhancedValidation = {\n  ...validation,\n\n  /**\n   * Validates only cells that need validation (changed or unvalidated)\n   * Returns true if all non-empty cells are valid\n   * Respects autoValidate config\n   */\n  async validateRequired(): Promise<boolean> {\n    if (!store.config.enableValidation) {\n      return true\n    }\n\n    const cellsToValidate = store.getCellsNeedingValidation()\n\n    if (cellsToValidate.length === 0) {\n      // Nothing to validate - return current validation state\n      return store.areNonEmptyRowsValid()\n    }\n\n    // Validate each cell that needs validation\n    for (const { rowId, columnName } of cellsToValidate) {\n      const row = store.rows.find(r => r.rowId === rowId)\n      if (!row) continue\n\n      const cell = row.cells.find(c => c.columnName === columnName)\n      if (!cell) continue\n\n      // Validate the cell using existing validation rules\n      await validation.validateCell(rowId, columnName, cell.value)\n\n      // Mark as validated\n      store.markCellValidated(rowId, columnName)\n    }\n\n    return store.areNonEmptyRowsValid()\n  },\n\n  /**\n   * Checks if all non-empty rows are valid (without running validation)\n   * Returns true if valid, false if there are errors\n   */\n  isAllValid(): boolean {\n    return store.areNonEmptyRowsValid()\n  },\n\n  /**\n   * Forces validation of all cells regardless of tracking\n   * Returns true if all non-empty cells are valid\n   */\n  async validateAll(rows?: any[]): Promise<{ isValid: boolean; totalErrors: number }> {\n    if (!store.config.enableValidation) {\n      return { isValid: true, totalErrors: 0 }\n    }\n\n    // Use original validateAll method\n    const result = await validation.validateAll(rows || store.rows)\n\n    // Clear tracking and mark all cells as validated\n    store.clearValidationTracking()\n\n    for (const row of store.rows) {\n      for (const cell of row.cells) {\n        store.markCellValidated(cell.rowId, cell.columnName)\n      }\n    }\n\n    return result\n  }\n}\n\n// Expose validation, copy/paste, and shortcuts to parent components\ndefineExpose({\n  loadDataFromBackend,\n  validation: enhancedValidation,\n  copyPaste,\n  shortcuts,\n  handleCopy,\n  handlePaste,\n  handleCut\n})\n</script>\n\n<style scoped>\n.data-grid {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  border: 1px solid var(--dg-border-grid, #ddd);\n  background-color: var(--dg-cell-bg, white);\n  border-radius: 4px;\n  overflow: hidden;\n  position: relative; /* For absolute positioning of overlay */\n}\n\n/* Loading overlay during processing */\n.processing-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  backdrop-filter: blur(2px);\n}\n\n.processing-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  background-color: white;\n  padding: 32px 48px;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.processing-spinner {\n  width: 48px;\n  height: 48px;\n  border: 4px solid var(--dg-border-cell, #e0e0e0);\n  border-top-color: var(--dg-header-sort-indicator, #2196f3);\n  border-radius: 50%;\n  animation: spinner-rotate 0.8s linear infinite;\n}\n\n@keyframes spinner-rotate {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n.processing-text {\n  font-size: 14px;\n  font-weight: 500;\n  color: var(--dg-cell-fg, #212529);\n  white-space: nowrap;\n}\n\n/*  RIEENIE #4: Progress bar styles */\n.progress-container {\n  width: 100%;\n  max-width: 400px;\n  margin-top: 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.progress-bar-wrapper {\n  width: 100%;\n  height: 8px;\n  background-color: var(--dg-border-cell, #e0e0e0);\n  border-radius: 4px;\n  overflow: hidden;\n}\n\n.progress-bar {\n  height: 100%;\n  background-color: var(--dg-header-sort-indicator, #2196f3);\n  border-radius: 4px;\n  transition: width 0.3s ease;\n}\n\n.progress-text {\n  font-size: 12px;\n  font-weight: 400;\n  color: var(--dg-cell-fg, #212529);\n  text-align: center;\n}\n\n.grid-toolbar {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 8px 12px;\n  background-color: var(--dg-ui-pagination-bg, #f8f9fa);\n  border-bottom: 1px solid var(--dg-border-cell, #e0e0e0);\n}\n\n.toolbar-section {\n  display: flex;\n  gap: 8px;\n}\n\n.toolbar-button {\n  padding: 6px 12px;\n  background-color: var(--dg-ui-pagination-bg, white);\n  border: 1px solid var(--dg-border-cell, #ccc);\n  border-radius: 4px;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  color: var(--dg-ui-pagination-fg, #212529);\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n}\n\n.toolbar-button:hover {\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\n  border-color: var(--dg-header-sort-indicator, #2196f3);\n}\n\n.toolbar-button:active {\n  transform: translateY(1px);\n}\n\n.toolbar-button--active {\n  background-color: var(--dg-header-sort-indicator, #2196f3);\n  color: white;\n  border-color: var(--dg-header-sort-indicator, #2196f3);\n}\n\n.toolbar-button--active:hover {\n  background-color: #1976d2;\n  border-color: #1976d2;\n}\n\n.toolbar-button--disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.toolbar-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  pointer-events: none;\n}\n\n.connection-status {\n  padding: 6px 12px;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  user-select: none;\n  transition: all 0.2s;\n}\n\n.connection-status--connected {\n  color: var(--dg-header-sort-indicator, #4caf50);\n}\n\n.connection-status--disconnected {\n  color: var(--dg-validation-error-fg, #f44336);\n}\n\n.connection-status:hover {\n  background-color: var(--dg-cell-hover-bg, #f0f0f0);\n}\n\n.hidden-columns-panel {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background-color: var(--dg-validation-warning-bg, #fff3cd);\n  border-bottom: 1px solid var(--dg-validation-warning-border, #ffc107);\n  font-size: 13px;\n}\n\n.hidden-columns-label {\n  font-weight: 500;\n  color: var(--dg-validation-warning-fg, #856404);\n}\n\n.show-column-button,\n.show-all-button {\n  padding: 4px 12px;\n  background-color: var(--dg-ui-pagination-bg, white);\n  border: 1px solid var(--dg-border-cell, #ccc);\n  border-radius: 4px;\n  font-size: 12px;\n  cursor: pointer;\n  color: var(--dg-ui-pagination-fg, #212529);\n  transition: all 0.2s;\n}\n\n.show-column-button:hover,\n.show-all-button:hover {\n  background-color: var(--dg-cell-hover-bg, #e9ecef);\n  border-color: var(--dg-header-sort-indicator, #2196f3);\n}\n\n.show-all-button {\n  font-weight: 500;\n  background-color: var(--dg-header-sort-indicator, #2196f3);\n  color: white;\n  border-color: var(--dg-header-sort-indicator, #2196f3);\n  margin-left: auto;\n}\n\n.show-all-button:hover {\n  background-color: #1976d2;\n  border-color: #1976d2;\n  color: white;\n}\n\n.grid-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  width: 100%; /* CRITICAL: Fill full width of parent */\n  min-width: 100%; /* CRITICAL: Ensure table fills full width */\n}\n\n.scroller {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: auto; /* Enable horizontal scroll when table is wider than container */\n}\n\n/* Scrollbar styling - vertical */\n.scroller::-webkit-scrollbar {\n  width: 8px;\n  height: 8px; /* Height for horizontal scrollbar */\n}\n\n.scroller::-webkit-scrollbar-track {\n  background: var(--dg-ui-pagination-bg, #f1f1f1);\n}\n\n.scroller::-webkit-scrollbar-thumb {\n  background: var(--dg-border-cell, #c1c1c1);\n  border-radius: 4px;\n}\n\n.scroller::-webkit-scrollbar-thumb:hover {\n  background: var(--dg-ui-resize-grip, #a8a8a8);\n}\n</style>\n","<template>\r\n  <div class=\"listbox-container\">\r\n    <div v-if=\"title\" class=\"listbox-title\">{{ title }}</div>\r\n    <div\r\n      class=\"listbox\"\r\n      :class=\"{ 'listbox--multi': multiSelect }\"\r\n      :style=\"listboxStyle\"\r\n    >\r\n      <div\r\n        v-for=\"item in items\"\r\n        :key=\"item.value\"\r\n        class=\"listbox-item\"\r\n        :class=\"{\r\n          'listbox-item--selected': isSelected(item.value),\r\n          'listbox-item--hover': hoveredValue === item.value\r\n        }\"\r\n        @click=\"handleItemClick(item)\"\r\n        @mouseenter=\"hoveredValue = item.value\"\r\n        @mouseleave=\"hoveredValue = null\"\r\n      >\r\n        <input\r\n          v-if=\"multiSelect\"\r\n          type=\"checkbox\"\r\n          :checked=\"isSelected(item.value)\"\r\n          class=\"listbox-checkbox\"\r\n          @click.stop=\"handleItemClick(item)\"\r\n        />\r\n        <span class=\"listbox-item-text\">{{ item.name }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch } from 'vue'\r\nimport { generateListBoxCSSVariables, defaultListBoxTheme } from '@/composables/useTheme'\r\nimport type { ListBoxTheme } from '@/types/theme'\r\n\r\nexport interface ListBoxItem {\r\n  name: string\r\n  value: string\r\n}\r\n\r\nconst props = withDefaults(defineProps<{\r\n  items: ListBoxItem[]\r\n  title?: string\r\n  multiSelect?: boolean\r\n  preSelected?: string[]\r\n  height?: number\r\n  width?: number\r\n  theme?: Partial<ListBoxTheme>  // Optional theme customization\r\n}>(), {\r\n  title: '',\r\n  multiSelect: false,\r\n  preSelected: () => [],\r\n  height: 200,\r\n  width: 250\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  selectionChange: [selectedValues: string[]]\r\n}>()\r\n\r\nconst selectedValues = ref<Set<string>>(new Set())\r\nconst hoveredValue = ref<string | null>(null)\r\n\r\n// Initialize with pre-selected items\r\nwatch(() => props.preSelected, (newPreSelected) => {\r\n  selectedValues.value = new Set(newPreSelected)\r\n}, { immediate: true })\r\n\r\n// Merge theme with defaults\r\nconst mergedTheme = computed(() => {\r\n  return {\r\n    ...defaultListBoxTheme,\r\n    itemColors: { ...defaultListBoxTheme.itemColors, ...(props.theme?.itemColors || {}) },\r\n    containerColors: { ...defaultListBoxTheme.containerColors, ...(props.theme?.containerColors || {}) },\r\n    checkboxColors: { ...defaultListBoxTheme.checkboxColors, ...(props.theme?.checkboxColors || {}) },\r\n    scrollbarColors: { ...defaultListBoxTheme.scrollbarColors, ...(props.theme?.scrollbarColors || {}) }\r\n  }\r\n})\r\n\r\n// Generate CSS variables from theme\r\nconst cssVariables = computed(() => generateListBoxCSSVariables(mergedTheme.value))\r\n\r\nconst listboxStyle = computed(() => ({\r\n  height: `${props.height}px`,\r\n  width: `${props.width}px`,\r\n  ...cssVariables.value\r\n}))\r\n\r\nfunction isSelected(value: string): boolean {\r\n  return selectedValues.value.has(value)\r\n}\r\n\r\nfunction handleItemClick(item: ListBoxItem) {\r\n  if (props.multiSelect) {\r\n    // Multi-select: toggle selection\r\n    if (selectedValues.value.has(item.value)) {\r\n      selectedValues.value.delete(item.value)\r\n    } else {\r\n      selectedValues.value.add(item.value)\r\n    }\r\n  } else {\r\n    // Single-select: clear previous and select this one\r\n    selectedValues.value.clear()\r\n    selectedValues.value.add(item.value)\r\n  }\r\n\r\n  // Emit selection change\r\n  emit('selectionChange', Array.from(selectedValues.value))\r\n}\r\n\r\n// Expose selected values for programmatic access\r\ndefineExpose({\r\n  getSelectedValues: () => Array.from(selectedValues.value),\r\n  clearSelection: () => {\r\n    selectedValues.value.clear()\r\n    emit('selectionChange', [])\r\n  },\r\n  selectValue: (value: string) => {\r\n    if (props.multiSelect) {\r\n      selectedValues.value.add(value)\r\n    } else {\r\n      selectedValues.value.clear()\r\n      selectedValues.value.add(value)\r\n    }\r\n    emit('selectionChange', Array.from(selectedValues.value))\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.listbox-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.listbox-title {\r\n  font-weight: 600;\r\n  font-size: 14px;\r\n  color: var(--lb-title-fg, #212529);\r\n  padding-bottom: 4px;\r\n}\r\n\r\n.listbox {\r\n  border: 1px solid var(--lb-container-border, #ced4da);\r\n  border-radius: 4px;\r\n  overflow-y: auto;\r\n  overflow-x: auto; /* Enable horizontal scroll when content is wider than container */\r\n  background-color: var(--lb-container-bg, white);\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.listbox:focus-within {\r\n  border-color: var(--lb-container-focused-border, #0d6efd);\r\n  box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1);\r\n}\r\n\r\n.listbox-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 8px 12px;\r\n  cursor: pointer;\r\n  user-select: none;\r\n  transition: background-color 0.15s ease;\r\n  border-bottom: 1px solid var(--lb-container-border, #f0f0f0);\r\n  background-color: var(--lb-item-bg, #ffffff);\r\n  color: var(--lb-item-fg, #212529);\r\n}\r\n\r\n.listbox-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.listbox-item--hover {\r\n  background-color: var(--lb-item-hover-bg, #f8f9fa);\r\n  color: var(--lb-item-hover-fg, #212529);\r\n}\r\n\r\n.listbox-item--selected {\r\n  background-color: var(--lb-item-selected-bg, #e3f2fd);\r\n  color: var(--lb-item-selected-fg, #0d6efd);\r\n  border-left: 3px solid var(--lb-container-focused-border, #2196f3);\r\n  padding-left: 9px;\r\n}\r\n\r\n.listbox-item--selected.listbox-item--hover {\r\n  background-color: var(--lb-item-selected-hover-bg, #bbdefb);\r\n  color: var(--lb-item-selected-hover-fg, #0d6efd);\r\n}\r\n\r\n.listbox-checkbox {\r\n  margin-right: 8px;\r\n  cursor: pointer;\r\n  width: 16px;\r\n  height: 16px;\r\n  border: 1px solid var(--lb-checkbox-border, #ced4da);\r\n  background-color: var(--lb-checkbox-bg, #ffffff);\r\n}\r\n\r\n.listbox-checkbox:checked {\r\n  background-color: var(--lb-checkbox-checked-bg, #0d6efd);\r\n  border-color: var(--lb-checkbox-checked-border, #0d6efd);\r\n}\r\n\r\n.listbox-checkbox:hover {\r\n  border-color: var(--lb-checkbox-hover-border, #adb5bd);\r\n}\r\n\r\n.listbox-item-text {\r\n  flex: 1;\r\n  font-size: 14px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n.listbox-item--selected .listbox-item-text {\r\n  font-weight: 500;\r\n}\r\n\r\n/* Scrollbar styling */\r\n.listbox::-webkit-scrollbar {\r\n  width: 8px;\r\n  height: 8px; /* Height for horizontal scrollbar */\r\n}\r\n\r\n.listbox::-webkit-scrollbar-track {\r\n  background: var(--lb-scrollbar-track-bg, #f1f1f1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.listbox::-webkit-scrollbar-thumb {\r\n  background: var(--lb-scrollbar-thumb-bg, #c1c1c1);\r\n  border-radius: 4px;\r\n}\r\n\r\n.listbox::-webkit-scrollbar-thumb:hover {\r\n  background: var(--lb-scrollbar-thumb-hover-bg, #a8a8a8);\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"search-panel\" :class=\"{ 'search-panel--collapsed': isCollapsed }\">\r\n    <div class=\"search-panel__header\">\r\n      <button\r\n        class=\"search-panel__toggle\"\r\n        @click=\"toggleCollapse\"\r\n        :title=\"isCollapsed ? 'Expand search' : 'Collapse search'\"\r\n      >\r\n        {{ isCollapsed ? '' : '' }}\r\n      </button>\r\n      <span class=\"search-panel__title\">Search</span>\r\n      <span v-if=\"store.searchResults?.length > 0\" class=\"search-panel__count\">\r\n        {{ store.searchResults.length }} result(s)\r\n      </span>\r\n    </div>\r\n\r\n    <div v-if=\"!isCollapsed\" class=\"search-panel__content\">\r\n      <div class=\"search-panel__row\">\r\n        <input\r\n          v-model=\"searchQuery\"\r\n          type=\"text\"\r\n          class=\"search-panel__input\"\r\n          placeholder=\"Enter search query...\"\r\n          @input=\"handleSearch\"\r\n        />\r\n\r\n        <select\r\n          v-model=\"searchMode\"\r\n          class=\"search-panel__mode-select\"\r\n          @change=\"handleSearch\"\r\n        >\r\n          <option value=\"Exact\">Exact</option>\r\n          <option value=\"Contains\">Contains</option>\r\n          <option value=\"StartsWith\">Starts With</option>\r\n          <option value=\"EndsWith\">Ends With</option>\r\n          <option value=\"Regex\">Regex</option>\r\n          <option value=\"Fuzzy\">Fuzzy</option>\r\n        </select>\r\n\r\n        <button\r\n          class=\"search-panel__clear-btn\"\r\n          @click=\"handleClearSearch\"\r\n          :disabled=\"!searchQuery\"\r\n          title=\"Clear search\"\r\n        >\r\n          \r\n        </button>\r\n      </div>\r\n\r\n      <div class=\"search-panel__options\">\r\n        <label class=\"search-panel__checkbox\">\r\n          <input\r\n            v-model=\"caseSensitive\"\r\n            type=\"checkbox\"\r\n            @change=\"handleSearch\"\r\n          />\r\n          <span>Case sensitive</span>\r\n        </label>\r\n\r\n        <label v-if=\"searchMode === 'Fuzzy'\" class=\"search-panel__threshold\">\r\n          <span>Threshold: {{ fuzzyThreshold }}</span>\r\n          <input\r\n            v-model.number=\"fuzzyThreshold\"\r\n            type=\"range\"\r\n            min=\"0\"\r\n            max=\"10\"\r\n            step=\"1\"\r\n            class=\"search-panel__slider\"\r\n            @input=\"handleSearch\"\r\n          />\r\n        </label>\r\n      </div>\r\n\r\n      <!-- Search Results Summary -->\r\n      <div v-if=\"searchQuery && store.searchResults?.length > 0\" class=\"search-panel__results\">\r\n        <div class=\"search-panel__navigation\">\r\n          <button\r\n            class=\"search-panel__nav-btn\"\r\n            @click=\"goToPreviousResult\"\r\n            :disabled=\"currentResultIndex <= 0\"\r\n            title=\"Previous result\"\r\n          >\r\n            \r\n          </button>\r\n          <span class=\"search-panel__nav-info\">\r\n            {{ currentResultIndex + 1 }} / {{ store.searchResults.length }}\r\n          </span>\r\n          <button\r\n            class=\"search-panel__nav-btn\"\r\n            @click=\"goToNextResult\"\r\n            :disabled=\"currentResultIndex >= store.searchResults.length - 1\"\r\n            title=\"Next result\"\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, toRef } from 'vue'\r\nimport { useDataGridStore } from '@/stores/dataGridStore'\r\nimport { useSearch, type SearchMode } from '@/composables/useSearch'\r\n\r\nconst props = defineProps<{\r\n  visible?: boolean\r\n  gridId?: string\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId || 'dataGrid')()\r\nconst { searchInRows, goToNextResult, goToPreviousResult, currentResultIndex } = useSearch(toRef(store, 'rows'))\r\n\r\nconst isCollapsed = ref(false)\r\nconst searchQuery = ref('')\r\nconst searchMode = ref<SearchMode>('Contains')\r\nconst caseSensitive = ref(false)\r\nconst fuzzyThreshold = ref(3)\r\n\r\nconst debouncedSearch = debounce(() => {\r\n  if (searchQuery.value.trim()) {\r\n    searchInRows(\r\n      searchQuery.value,\r\n      searchMode.value,\r\n      {\r\n        caseSensitive: caseSensitive.value,\r\n        fuzzyThreshold: fuzzyThreshold.value\r\n      }\r\n    )\r\n    store.setSearchQuery(searchQuery.value)\r\n  } else {\r\n    store.clearSearch()\r\n  }\r\n}, 300)\r\n\r\nfunction handleSearch() {\r\n  debouncedSearch()\r\n}\r\n\r\nfunction handleClearSearch() {\r\n  searchQuery.value = ''\r\n  store.clearSearch()\r\n}\r\n\r\nfunction toggleCollapse() {\r\n  isCollapsed.value = !isCollapsed.value\r\n}\r\n\r\n// Simple debounce implementation\r\nfunction debounce<T extends (...args: any[]) => any>(func: T, delay: number): (...args: Parameters<T>) => void {\r\n  let timeoutId: ReturnType<typeof setTimeout> | null = null\r\n\r\n  return function(...args: Parameters<T>) {\r\n    if (timeoutId) {\r\n      clearTimeout(timeoutId)\r\n    }\r\n    timeoutId = setTimeout(() => {\r\n      func(...args)\r\n    }, delay)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.search-panel {\r\n  background-color: #f8f9fa;\r\n  border-bottom: 1px solid #dee2e6;\r\n  padding: 12px;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.search-panel--collapsed {\r\n  padding: 8px 12px;\r\n}\r\n\r\n.search-panel__header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.search-panel__toggle {\r\n  border: none;\r\n  background: transparent;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  padding: 4px;\r\n  color: #6c757d;\r\n  transition: color 0.2s;\r\n}\r\n\r\n.search-panel__toggle:hover {\r\n  color: #212529;\r\n}\r\n\r\n.search-panel__title {\r\n  font-weight: 600;\r\n  color: #212529;\r\n  font-size: 14px;\r\n}\r\n\r\n.search-panel__count {\r\n  margin-left: auto;\r\n  font-size: 12px;\r\n  color: #6c757d;\r\n  background-color: #e9ecef;\r\n  padding: 2px 8px;\r\n  border-radius: 12px;\r\n}\r\n\r\n.search-panel__content {\r\n  margin-top: 12px;\r\n}\r\n\r\n.search-panel__row {\r\n  display: flex;\r\n  gap: 8px;\r\n  align-items: center;\r\n}\r\n\r\n.search-panel__input {\r\n  flex: 1;\r\n  padding: 8px 12px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  outline: none;\r\n  transition: border-color 0.2s;\r\n}\r\n\r\n.search-panel__input:focus {\r\n  border-color: #0d6efd;\r\n  box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1);\r\n}\r\n\r\n.search-panel__mode-select {\r\n  padding: 8px 12px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  background-color: white;\r\n  cursor: pointer;\r\n  outline: none;\r\n  min-width: 130px;\r\n}\r\n\r\n.search-panel__mode-select:focus {\r\n  border-color: #0d6efd;\r\n}\r\n\r\n.search-panel__clear-btn {\r\n  padding: 8px 12px;\r\n  border: 1px solid #dc3545;\r\n  background-color: white;\r\n  color: #dc3545;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.search-panel__clear-btn:hover:not(:disabled) {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.search-panel__clear-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.search-panel__options {\r\n  display: flex;\r\n  gap: 16px;\r\n  align-items: center;\r\n  margin-top: 8px;\r\n}\r\n\r\n.search-panel__checkbox {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  font-size: 13px;\r\n  color: #495057;\r\n  cursor: pointer;\r\n}\r\n\r\n.search-panel__checkbox input[type=\"checkbox\"] {\r\n  cursor: pointer;\r\n}\r\n\r\n.search-panel__threshold {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  font-size: 13px;\r\n  color: #495057;\r\n}\r\n\r\n.search-panel__slider {\r\n  width: 120px;\r\n  cursor: pointer;\r\n}\r\n\r\n.search-panel__results {\r\n  margin-top: 12px;\r\n  padding-top: 12px;\r\n  border-top: 1px solid #dee2e6;\r\n}\r\n\r\n.search-panel__navigation {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  justify-content: center;\r\n}\r\n\r\n.search-panel__nav-btn {\r\n  padding: 6px 12px;\r\n  border: 1px solid #ced4da;\r\n  background-color: white;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.search-panel__nav-btn:hover:not(:disabled) {\r\n  background-color: #f8f9fa;\r\n  border-color: #0d6efd;\r\n  color: #0d6efd;\r\n}\r\n\r\n.search-panel__nav-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.search-panel__nav-info {\r\n  font-size: 13px;\r\n  color: #495057;\r\n  min-width: 80px;\r\n  text-align: center;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"filter-row\">\r\n    <div class=\"filter-row__header\">\r\n      <button\r\n        class=\"filter-row__toggle\"\r\n        @click=\"toggleCollapse\"\r\n        :title=\"isCollapsed ? 'Expand filters' : 'Collapse filters'\"\r\n      >\r\n        {{ isCollapsed ? '' : '' }}\r\n      </button>\r\n      <span class=\"filter-row__title\">Filters</span>\r\n      <span v-if=\"activeFiltersCount > 0\" class=\"filter-row__count\">\r\n        {{ activeFiltersCount }} active\r\n      </span>\r\n      <button\r\n        v-if=\"activeFiltersCount > 0\"\r\n        class=\"filter-row__clear-all\"\r\n        @click=\"clearAllFilters\"\r\n        title=\"Clear all filters\"\r\n      >\r\n        Clear All\r\n      </button>\r\n    </div>\r\n\r\n    <div v-if=\"!isCollapsed\" class=\"filter-row__content\">\r\n      <!-- Filter Builder -->\r\n      <div class=\"filter-row__filters\">\r\n        <div\r\n          v-for=\"(filter, index) in columnFilters\"\r\n          :key=\"index\"\r\n          class=\"filter-row__filter-item\"\r\n        >\r\n          <!-- Column Selector -->\r\n          <select\r\n            v-model=\"filter.columnName\"\r\n            class=\"filter-row__column-select\"\r\n            @change=\"updateFilters\"\r\n          >\r\n            <option value=\"\">Select column...</option>\r\n            <option\r\n              v-for=\"col in dataColumns\"\r\n              :key=\"col.name\"\r\n              :value=\"col.name\"\r\n            >\r\n              {{ col.header }}\r\n            </option>\r\n          </select>\r\n\r\n          <!-- Operator Selector -->\r\n          <select\r\n            v-model=\"filter.operator\"\r\n            class=\"filter-row__operator-select\"\r\n            @change=\"updateFilters\"\r\n          >\r\n            <option value=\"Equals\">Equals</option>\r\n            <option value=\"NotEquals\">Not Equals</option>\r\n            <option value=\"Contains\">Contains</option>\r\n            <option value=\"StartsWith\">Starts With</option>\r\n            <option value=\"EndsWith\">Ends With</option>\r\n            <option value=\"GreaterThan\">Greater Than</option>\r\n            <option value=\"LessThan\">Less Than</option>\r\n            <option value=\"GreaterThanOrEquals\"></option>\r\n            <option value=\"LessThanOrEquals\"></option>\r\n            <option value=\"IsEmpty\">Is Empty</option>\r\n            <option value=\"IsNotEmpty\">Is Not Empty</option>\r\n          </select>\r\n\r\n          <!-- Value Input (hide for IsEmpty/IsNotEmpty) -->\r\n          <input\r\n            v-if=\"!['IsEmpty', 'IsNotEmpty'].includes(filter.operator)\"\r\n            v-model=\"filter.value\"\r\n            type=\"text\"\r\n            class=\"filter-row__value-input\"\r\n            placeholder=\"Filter value...\"\r\n            @input=\"updateFilters\"\r\n          />\r\n\r\n          <!-- Logic Operator (for next filter) -->\r\n          <select\r\n            v-if=\"index < columnFilters.length - 1\"\r\n            v-model=\"filter.logicOperator\"\r\n            class=\"filter-row__logic-select\"\r\n            @change=\"updateFilters\"\r\n          >\r\n            <option value=\"AND\">AND</option>\r\n            <option value=\"OR\">OR</option>\r\n          </select>\r\n\r\n          <!-- Remove Filter Button -->\r\n          <button\r\n            class=\"filter-row__remove-btn\"\r\n            @click=\"removeFilter(index)\"\r\n            title=\"Remove filter\"\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Add Filter Button -->\r\n      <button\r\n        class=\"filter-row__add-btn\"\r\n        @click=\"addFilter\"\r\n      >\r\n        + Add Filter\r\n      </button>\r\n\r\n      <!-- Quick Filters (if any active) -->\r\n      <div v-if=\"activeFiltersCount > 0\" class=\"filter-row__active\">\r\n        <div class=\"filter-row__active-title\">Active filters:</div>\r\n        <div class=\"filter-row__active-list\">\r\n          <span\r\n            v-for=\"(filter, index) in activeColumnFilters\"\r\n            :key=\"index\"\r\n            class=\"filter-row__active-chip\"\r\n          >\r\n            {{ getColumnHeader(filter.columnName) }}\r\n            <strong>{{ filter.operator }}</strong>\r\n            <span v-if=\"filter.value\">\"{{ filter.value }}\"</span>\r\n            <button\r\n              class=\"filter-row__chip-remove\"\r\n              @click=\"removeFilter(columnFilters.indexOf(filter))\"\r\n            >\r\n              \r\n            </button>\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed } from 'vue'\r\nimport { useDataGridStore } from '@/stores/dataGridStore'\r\nimport { type FilterOperator, type SimpleFilter } from '@/composables/useFiltering'\r\n\r\nconst props = defineProps<{\r\n  gridId?: string\r\n}>()\r\n\r\nconst store = useDataGridStore(props.gridId || 'dataGrid')()\r\n\r\nconst isCollapsed = ref(false)\r\n\r\ninterface ColumnFilter {\r\n  columnName: string\r\n  operator: FilterOperator\r\n  value: string\r\n  logicOperator: 'AND' | 'OR'\r\n}\r\n\r\nconst columnFilters = ref<ColumnFilter[]>([\r\n  {\r\n    columnName: '',\r\n    operator: 'Contains',\r\n    value: '',\r\n    logicOperator: 'AND'\r\n  }\r\n])\r\n\r\nconst dataColumns = computed(() => {\r\n  return store.columns.filter(col => !col.specialType)\r\n})\r\n\r\nconst activeColumnFilters = computed(() => {\r\n  return columnFilters.value.filter(f => f.columnName && (f.value || ['IsEmpty', 'IsNotEmpty'].includes(f.operator)))\r\n})\r\n\r\nconst activeFiltersCount = computed(() => activeColumnFilters.value.length)\r\n\r\nfunction addFilter() {\r\n  columnFilters.value.push({\r\n    columnName: '',\r\n    operator: 'Contains',\r\n    value: '',\r\n    logicOperator: 'AND'\r\n  })\r\n}\r\n\r\nfunction removeFilter(index: number) {\r\n  columnFilters.value.splice(index, 1)\r\n\r\n  // Ensure at least one empty filter exists\r\n  if (columnFilters.value.length === 0) {\r\n    addFilter()\r\n  }\r\n\r\n  updateFilters()\r\n}\r\n\r\nfunction clearAllFilters() {\r\n  columnFilters.value = [\r\n    {\r\n      columnName: '',\r\n      operator: 'Contains',\r\n      value: '',\r\n      logicOperator: 'AND'\r\n    }\r\n  ]\r\n  store.clearFilter()\r\n}\r\n\r\nfunction updateFilters() {\r\n  const active = activeColumnFilters.value\r\n\r\n  if (active.length === 0) {\r\n    store.clearFilter()\r\n    return\r\n  }\r\n\r\n  // Build composite filter expression\r\n  if (active.length === 1) {\r\n    // Single filter\r\n    const f = active[0]\r\n    const simpleFilter: SimpleFilter = {\r\n      type: 'simple',\r\n      columnName: f.columnName,\r\n      operator: f.operator,\r\n      value: f.value\r\n    }\r\n    store.setFilter(simpleFilter)\r\n  } else {\r\n    // Multiple filters - build composite expression\r\n    let filterExpression: any = {\r\n      type: 'simple',\r\n      columnName: active[0].columnName,\r\n      operator: active[0].operator,\r\n      value: active[0].value\r\n    }\r\n\r\n    for (let i = 1; i < active.length; i++) {\r\n      const currentFilter = active[i]\r\n      const previousLogicOp = active[i - 1].logicOperator\r\n\r\n      filterExpression = {\r\n        type: 'composite',\r\n        operator: previousLogicOp,\r\n        left: filterExpression,\r\n        right: {\r\n          type: 'simple',\r\n          columnName: currentFilter.columnName,\r\n          operator: currentFilter.operator,\r\n          value: currentFilter.value\r\n        }\r\n      }\r\n    }\r\n\r\n    store.setFilter(filterExpression)\r\n  }\r\n}\r\n\r\nfunction toggleCollapse() {\r\n  isCollapsed.value = !isCollapsed.value\r\n}\r\n\r\nfunction getColumnHeader(columnName: string): string {\r\n  const col = store.columns.find(c => c.name === columnName)\r\n  return col?.header || columnName\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.filter-row {\r\n  background-color: #f8f9fa;\r\n  border-bottom: 1px solid #dee2e6;\r\n  padding: 12px;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.filter-row__header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n}\r\n\r\n.filter-row__toggle {\r\n  border: none;\r\n  background: transparent;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  padding: 4px;\r\n  color: #6c757d;\r\n  transition: color 0.2s;\r\n}\r\n\r\n.filter-row__toggle:hover {\r\n  color: #212529;\r\n}\r\n\r\n.filter-row__title {\r\n  font-weight: 600;\r\n  color: #212529;\r\n  font-size: 14px;\r\n}\r\n\r\n.filter-row__count {\r\n  margin-left: auto;\r\n  font-size: 12px;\r\n  color: #0d6efd;\r\n  background-color: #e7f1ff;\r\n  padding: 2px 8px;\r\n  border-radius: 12px;\r\n  font-weight: 500;\r\n}\r\n\r\n.filter-row__clear-all {\r\n  padding: 4px 12px;\r\n  border: 1px solid #dc3545;\r\n  background-color: white;\r\n  color: #dc3545;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.filter-row__clear-all:hover {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.filter-row__content {\r\n  margin-top: 12px;\r\n}\r\n\r\n.filter-row__filters {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.filter-row__filter-item {\r\n  display: flex;\r\n  gap: 8px;\r\n  align-items: center;\r\n}\r\n\r\n.filter-row__column-select {\r\n  padding: 8px 12px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  background-color: white;\r\n  cursor: pointer;\r\n  outline: none;\r\n  min-width: 150px;\r\n}\r\n\r\n.filter-row__column-select:focus {\r\n  border-color: #0d6efd;\r\n}\r\n\r\n.filter-row__operator-select {\r\n  padding: 8px 12px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  background-color: white;\r\n  cursor: pointer;\r\n  outline: none;\r\n  min-width: 130px;\r\n}\r\n\r\n.filter-row__operator-select:focus {\r\n  border-color: #0d6efd;\r\n}\r\n\r\n.filter-row__value-input {\r\n  flex: 1;\r\n  padding: 8px 12px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 14px;\r\n  outline: none;\r\n  transition: border-color 0.2s;\r\n}\r\n\r\n.filter-row__value-input:focus {\r\n  border-color: #0d6efd;\r\n  box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1);\r\n}\r\n\r\n.filter-row__logic-select {\r\n  padding: 8px 12px;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  font-size: 13px;\r\n  background-color: #e9ecef;\r\n  cursor: pointer;\r\n  outline: none;\r\n  font-weight: 600;\r\n  color: #495057;\r\n  min-width: 80px;\r\n}\r\n\r\n.filter-row__logic-select:focus {\r\n  border-color: #0d6efd;\r\n}\r\n\r\n.filter-row__remove-btn {\r\n  padding: 8px 12px;\r\n  border: 1px solid #dc3545;\r\n  background-color: white;\r\n  color: #dc3545;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.filter-row__remove-btn:hover {\r\n  background-color: #dc3545;\r\n  color: white;\r\n}\r\n\r\n.filter-row__add-btn {\r\n  margin-top: 8px;\r\n  padding: 8px 16px;\r\n  border: 1px dashed #0d6efd;\r\n  background-color: white;\r\n  color: #0d6efd;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  transition: all 0.2s;\r\n}\r\n\r\n.filter-row__add-btn:hover {\r\n  background-color: #e7f1ff;\r\n}\r\n\r\n.filter-row__active {\r\n  margin-top: 12px;\r\n  padding-top: 12px;\r\n  border-top: 1px solid #dee2e6;\r\n}\r\n\r\n.filter-row__active-title {\r\n  font-size: 12px;\r\n  color: #6c757d;\r\n  margin-bottom: 8px;\r\n  font-weight: 500;\r\n}\r\n\r\n.filter-row__active-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n}\r\n\r\n.filter-row__active-chip {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 6px;\r\n  padding: 4px 8px;\r\n  background-color: #e7f1ff;\r\n  color: #0d6efd;\r\n  border-radius: 16px;\r\n  font-size: 12px;\r\n}\r\n\r\n.filter-row__active-chip strong {\r\n  font-weight: 600;\r\n}\r\n\r\n.filter-row__chip-remove {\r\n  border: none;\r\n  background: transparent;\r\n  color: #0d6efd;\r\n  cursor: pointer;\r\n  font-size: 14px;\r\n  padding: 0 4px;\r\n  margin-left: 4px;\r\n  transition: color 0.2s;\r\n}\r\n\r\n.filter-row__chip-remove:hover {\r\n  color: #dc3545;\r\n}\r\n</style>\r\n","/**\r\n * RPA Advanced Table - Vue 3 Component Library\r\n * Exports DataGrid and ListBox components for TypeScript and JavaScript\r\n */\r\n\r\nimport type { App } from 'vue'\r\nimport DataGrid from './components/DataGrid.vue'\r\nimport ListBox from './components/ListBox.vue'\r\nimport SearchPanel from './components/SearchPanel.vue'\r\nimport FilterRow from './components/FilterRow.vue'\r\n\r\n// Export components individually\r\nexport { DataGrid, ListBox, SearchPanel, FilterRow }\r\n\r\n// Export AdvancedTable as alias for DataGrid (for backwards compatibility)\r\nexport { DataGrid as AdvancedTable }\r\n\r\n// Export composables\r\nexport { useValidation } from './composables/useValidation'\r\nexport { useAutoRowHeight } from './composables/useAutoRowHeight'\r\nexport { useFiltering } from './composables/useFiltering'\r\nexport { useSearch } from './composables/useSearch'\r\nexport { useShortcuts } from './composables/useShortcuts'\r\n\r\n// Export stores\r\nexport { useDataGridStore } from './stores/dataGridStore'\r\n\r\n// Export Pinia (for apps using this library)\r\nexport { createPinia, setActivePinia, getActivePinia } from 'pinia'\r\nexport type { Pinia } from 'pinia'\r\n\r\n// Export services\r\nexport { gridApi } from './services/gridApi'\r\n\r\n// Export types\r\nexport type { ListBoxItem } from './components/ListBox.vue'\r\nexport type {\r\n  GridCell,\r\n  GridRow,\r\n  GridColumn,\r\n  GridConfig\r\n} from './stores/dataGridStore'\r\n\r\nexport type {\r\n  ValidationRule,\r\n  ValidationError,\r\n  ValidationResult\r\n} from './composables/useValidation'\r\n\r\nexport type {\r\n  AutoRowHeightConfig,\r\n  RowHeightResult\r\n} from './composables/useAutoRowHeight'\r\n\r\nexport type {\r\n  FilterExpression,\r\n  SimpleFilter,\r\n  CompositeFilter,\r\n  FilterOperator\r\n} from './composables/useFiltering'\r\n\r\n// Plugin install function\r\nexport function install(app: App) {\r\n  app.component('DataGrid', DataGrid)\r\n  app.component('ListBox', ListBox)\r\n  app.component('SearchPanel', SearchPanel)\r\n  app.component('FilterRow', FilterRow)\r\n}\r\n\r\n// Default export for Vue.use()\r\nexport default {\r\n  install\r\n}\r\n"],"names":["script","_hoisted_1","render","_typeof","obj","props","throttled","VisibilityState","n","style","overflow","scroll","ResizeObserver$1","index","h","_hoisted_2","simpleArray","MutationType","open","state","store","now","$reset","options","value","searchTerm","regex","config","BATCH_SIZE","ShortcutContext","shortcut","_createElementBlock","_Fragment","_renderList","_normalizeClass","_withModifiers","_unref","_hoisted_3","_openBlock","_hoisted_4","_toDisplayString","_createTextVNode","_hoisted_5","_createElementVNode","_createBlock","_Teleport","_normalizeStyle","pages","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_10","_vModelCheckbox","_hoisted_9","isProcessing","_a","filtersExceptThisColumn","allRows","filteredRows","currentlySelectedValues","combinedFilter","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_createVNode","DynamicScroller","DynamicScrollerItem","_vModelSelect","_vModelText"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10]}